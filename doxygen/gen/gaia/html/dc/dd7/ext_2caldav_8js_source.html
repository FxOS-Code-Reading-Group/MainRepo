<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: caldav.js ソースファイル</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dc/dd7/ext_2caldav_8js.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">caldav.js</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/dd7/ext_2caldav_8js.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* sax js - LICENSE: https://github.com/isaacs/sax-js/blob/master/LICENSE */</span>
<a name="l00002"></a>00002 <span class="comment">// wrapper for non-node envs</span>
<a name="l00003"></a><a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a5363025b2c2d773292f0f064aeb11f9e">00003</a> ;(<span class="keyword">function</span> (sax) {
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 sax.parser = <span class="keyword">function</span> (<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>) { <span class="keywordflow">return</span> <span class="keyword">new</span> SAXParser(<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>) }
<a name="l00006"></a>00006 sax.SAXParser = SAXParser
<a name="l00007"></a>00007 sax.SAXStream = SAXStream
<a name="l00008"></a>00008 sax.createStream = createStream
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="comment">// When we pass the MAX_BUFFER_LENGTH position, start checking for buffer overruns.</span>
<a name="l00011"></a>00011 <span class="comment">// When we check, schedule the next check for MAX_BUFFER_LENGTH - (max(buffer lengths)),</span>
<a name="l00012"></a>00012 <span class="comment">// since that&#39;s the earliest that a buffer overrun could occur.  This way, checks are</span>
<a name="l00013"></a>00013 <span class="comment">// as rare as required, but as often as necessary to ensure never crossing this bound.</span>
<a name="l00014"></a>00014 <span class="comment">// Furthermore, buffers are only tested at most once per write(), so passing a very</span>
<a name="l00015"></a>00015 <span class="comment">// large string into write() might have undesirable effects, but this is manageable by</span>
<a name="l00016"></a>00016 <span class="comment">// the caller, so it is assumed to be safe.  Thus, a call to write() may, in the extreme</span>
<a name="l00017"></a>00017 <span class="comment">// edge case, result in creating at most one complete copy of the string passed in.</span>
<a name="l00018"></a>00018 <span class="comment">// Set to Infinity to have unlimited buffers.</span>
<a name="l00019"></a>00019 sax.MAX_BUFFER_LENGTH = 64 * 1024
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 var buffers = [
<a name="l00022"></a>00022   <span class="stringliteral">&quot;comment&quot;</span>, <span class="stringliteral">&quot;sgmlDecl&quot;</span>, <span class="stringliteral">&quot;textNode&quot;</span>, <span class="stringliteral">&quot;tagName&quot;</span>, <span class="stringliteral">&quot;doctype&quot;</span>,
<a name="l00023"></a>00023   <span class="stringliteral">&quot;procInstName&quot;</span>, <span class="stringliteral">&quot;procInstBody&quot;</span>, <span class="stringliteral">&quot;entity&quot;</span>, <span class="stringliteral">&quot;attribName&quot;</span>,
<a name="l00024"></a>00024   <span class="stringliteral">&quot;attribValue&quot;</span>, <span class="stringliteral">&quot;cdata&quot;</span>, <span class="stringliteral">&quot;script&quot;</span>
<a name="l00025"></a>00025 ]
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 sax.EVENTS = <span class="comment">// for discoverability.</span>
<a name="l00028"></a>00028   [ <span class="stringliteral">&quot;text&quot;</span>
<a name="l00029"></a>00029   , <span class="stringliteral">&quot;processinginstruction&quot;</span>
<a name="l00030"></a>00030   , <span class="stringliteral">&quot;sgmldeclaration&quot;</span>
<a name="l00031"></a>00031   , <span class="stringliteral">&quot;doctype&quot;</span>
<a name="l00032"></a>00032   , <span class="stringliteral">&quot;comment&quot;</span>
<a name="l00033"></a>00033   , <span class="stringliteral">&quot;attribute&quot;</span>
<a name="l00034"></a>00034   , <span class="stringliteral">&quot;opentag&quot;</span>
<a name="l00035"></a>00035   , <span class="stringliteral">&quot;closetag&quot;</span>
<a name="l00036"></a>00036   , <span class="stringliteral">&quot;opencdata&quot;</span>
<a name="l00037"></a>00037   , <span class="stringliteral">&quot;cdata&quot;</span>
<a name="l00038"></a>00038   , <span class="stringliteral">&quot;closecdata&quot;</span>
<a name="l00039"></a>00039   , <span class="stringliteral">&quot;error&quot;</span>
<a name="l00040"></a>00040   , <span class="stringliteral">&quot;end&quot;</span>
<a name="l00041"></a>00041   , <span class="stringliteral">&quot;ready&quot;</span>
<a name="l00042"></a>00042   , <span class="stringliteral">&quot;script&quot;</span>
<a name="l00043"></a>00043   , <span class="stringliteral">&quot;opennamespace&quot;</span>
<a name="l00044"></a>00044   , <span class="stringliteral">&quot;closenamespace&quot;</span>
<a name="l00045"></a>00045   ]
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="keyword">function</span> SAXParser (<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>) {
<a name="l00048"></a>00048   <span class="keywordflow">if</span> (!(<span class="keyword">this</span> instanceof SAXParser)) <span class="keywordflow">return</span> <span class="keyword">new</span> SAXParser(<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>)
<a name="l00049"></a>00049 
<a name="l00050"></a>00050   var <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a> = <span class="keyword">this</span>
<a name="l00051"></a>00051   clearBuffers(parser)
<a name="l00052"></a>00052   parser.q = parser.c = <span class="stringliteral">&quot;&quot;</span>
<a name="l00053"></a>00053   parser.bufferCheckPosition = sax.MAX_BUFFER_LENGTH
<a name="l00054"></a>00054   parser.opt = <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a> || {}
<a name="l00055"></a>00055   parser.opt.lowercase = parser.opt.lowercase || parser.opt.lowercasetags;
<a name="l00056"></a>00056   parser.looseCase = parser.opt.lowercase ? <span class="stringliteral">&quot;toLowerCase&quot;</span> : <span class="stringliteral">&quot;toUpperCase&quot;</span>
<a name="l00057"></a>00057   parser.tags = []
<a name="l00058"></a>00058   parser.closed = parser.closedRoot = parser.sawRoot = <span class="keyword">false</span>
<a name="l00059"></a>00059   parser.tag = parser.error = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>
<a name="l00060"></a>00060   parser.strict = !!<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>
<a name="l00061"></a>00061   parser.noscript = !!(<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a> || parser.opt.noscript)
<a name="l00062"></a>00062   parser.state = S.BEGIN
<a name="l00063"></a>00063   parser.ENTITIES = Object.create(sax.ENTITIES)
<a name="l00064"></a>00064   parser.attribList = []
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   <span class="comment">// namespaces form a prototype chain.</span>
<a name="l00067"></a>00067   <span class="comment">// it always points at the current tag,</span>
<a name="l00068"></a>00068   <span class="comment">// which protos to its parent tag.</span>
<a name="l00069"></a>00069   <span class="keywordflow">if</span> (parser.opt.xmlns) parser.ns = Object.create(rootNS)
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="comment">// mostly just for error reporting</span>
<a name="l00072"></a>00072   parser.position = parser.line = parser.column = 0
<a name="l00073"></a>00073   <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(parser, <span class="stringliteral">&quot;onready&quot;</span>)
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="keyword">function</span> checkBufferLength (<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>) {
<a name="l00079"></a>00079   var maxAllowed = Math.max(sax.MAX_BUFFER_LENGTH, 10)
<a name="l00080"></a>00080     , maxActual = 0
<a name="l00081"></a>00081   <span class="keywordflow">for</span> (var <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> = 0, <a class="code" href="../../d9/d6a/ns_color_8h.html#a0ad4b5fc255f59a8dace6aa74c5ca790">l</a> = buffers.length; <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> &lt; <a class="code" href="../../d9/d6a/ns_color_8h.html#a0ad4b5fc255f59a8dace6aa74c5ca790">l</a>; <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> ++) {
<a name="l00082"></a>00082     var <a class="code" href="../../d9/d04/expat_8h.html#a5df20ff5bc70fb664abe3912796e90df">len</a> = <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>[buffers[<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>]].length
<a name="l00083"></a>00083     <span class="keywordflow">if</span> (len &gt; maxAllowed) {
<a name="l00084"></a>00084       <span class="comment">// Text/cdata nodes can get big, and since they&#39;re buffered,</span>
<a name="l00085"></a>00085       <span class="comment">// we can get here under normal conditions.</span>
<a name="l00086"></a>00086       <span class="comment">// Avoid issues by emitting the text node now,</span>
<a name="l00087"></a>00087       <span class="comment">// so at least it won&#39;t get any bigger.</span>
<a name="l00088"></a>00088       <span class="keywordflow">switch</span> (buffers[<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>]) {
<a name="l00089"></a>00089         <span class="keywordflow">case</span> <span class="stringliteral">&quot;textNode&quot;</span>:
<a name="l00090"></a>00090           closeText(<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>)
<a name="l00091"></a>00091         <span class="keywordflow">break</span>
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         <span class="keywordflow">case</span> <span class="stringliteral">&quot;cdata&quot;</span>:
<a name="l00094"></a>00094           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>, <span class="stringliteral">&quot;oncdata&quot;</span>, <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.cdata)
<a name="l00095"></a>00095           <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.cdata = <span class="stringliteral">&quot;&quot;</span>
<a name="l00096"></a>00096         <span class="keywordflow">break</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098         <span class="keywordflow">case</span> <span class="stringliteral">&quot;script&quot;</span>:
<a name="l00099"></a>00099           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>, <span class="stringliteral">&quot;onscript&quot;</span>, <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.script)
<a name="l00100"></a>00100           <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.script = <span class="stringliteral">&quot;&quot;</span>
<a name="l00101"></a>00101         <span class="keywordflow">break</span>
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         <span class="keywordflow">default</span>:
<a name="l00104"></a>00104           <a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a>(<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>, <span class="stringliteral">&quot;Max buffer length exceeded: &quot;</span>+buffers[i])
<a name="l00105"></a>00105       }
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107     maxActual = Math.max(maxActual, len)
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109   <span class="comment">// schedule the next check for the earliest possible buffer overrun.</span>
<a name="l00110"></a>00110   <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.bufferCheckPosition = (sax.MAX_BUFFER_LENGTH - maxActual)
<a name="l00111"></a>00111                              + <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.position
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">function</span> clearBuffers (<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>) {
<a name="l00115"></a>00115   <span class="keywordflow">for</span> (var <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> = 0, <a class="code" href="../../d9/d6a/ns_color_8h.html#a0ad4b5fc255f59a8dace6aa74c5ca790">l</a> = buffers.length; <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> &lt; <a class="code" href="../../d9/d6a/ns_color_8h.html#a0ad4b5fc255f59a8dace6aa74c5ca790">l</a>; <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> ++) {
<a name="l00116"></a>00116     <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>[buffers[<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>]] = <span class="stringliteral">&quot;&quot;</span>
<a name="l00117"></a>00117   }
<a name="l00118"></a>00118 }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 SAXParser.prototype =
<a name="l00121"></a>00121   { <a class="code" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a>: <span class="keyword">function</span> () { <a class="code" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a>(<span class="keyword">this</span>) }
<a name="l00122"></a>00122   , write: write
<a name="l00123"></a>00123   , resume: <span class="keyword">function</span> () { this.<a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a> = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>; <span class="keywordflow">return</span> <span class="keyword">this</span> }
<a name="l00124"></a>00124   , <a class="code" href="../../dd/df0/dialogs__end__init_8js.html#acdb1449d11a5550a30ee4a18b9c7f133">close</a>: <span class="keyword">function</span> () { <span class="keywordflow">return</span> this.write(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>) }
<a name="l00125"></a>00125   }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="keywordflow">try</span> {
<a name="l00128"></a>00128   var Stream = <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&quot;stream&quot;</span>).Stream
<a name="l00129"></a>00129 } <span class="keywordflow">catch</span> (ex) {
<a name="l00130"></a>00130   var Stream = <span class="keyword">function</span> () {}
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 var streamWraps = sax.EVENTS.filter(<span class="keyword">function</span> (ev) {
<a name="l00135"></a>00135   <span class="keywordflow">return</span> ev !== <span class="stringliteral">&quot;error&quot;</span> &amp;&amp; ev !== <span class="stringliteral">&quot;end&quot;</span>
<a name="l00136"></a>00136 })
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="keyword">function</span> createStream (<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>) {
<a name="l00139"></a>00139   <span class="keywordflow">return</span> <span class="keyword">new</span> SAXStream(<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>)
<a name="l00140"></a>00140 }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="keyword">function</span> SAXStream (<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>) {
<a name="l00143"></a>00143   <span class="keywordflow">if</span> (!(<span class="keyword">this</span> instanceof SAXStream)) <span class="keywordflow">return</span> <span class="keyword">new</span> SAXStream(<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>)
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   Stream.apply(me)
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   this._parser = <span class="keyword">new</span> SAXParser(<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>)
<a name="l00148"></a>00148   this.writable = <span class="keyword">true</span>
<a name="l00149"></a>00149   this.readable = <span class="keyword">true</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   var me = <span class="keyword">this</span>
<a name="l00153"></a>00153 
<a name="l00154"></a>00154   this._parser.onend = <span class="keyword">function</span> () {
<a name="l00155"></a>00155     me.emit(<span class="stringliteral">&quot;end&quot;</span>)
<a name="l00156"></a>00156   }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158   this._parser.onerror = <span class="keyword">function</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a>) {
<a name="l00159"></a>00159     me.emit(<span class="stringliteral">&quot;error&quot;</span>, <a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a>)
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">// if didn&#39;t throw, then means error was handled.</span>
<a name="l00162"></a>00162     <span class="comment">// go ahead and clear error, so we can write again.</span>
<a name="l00163"></a>00163     me._parser.error = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>
<a name="l00164"></a>00164   }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   streamWraps.forEach(<span class="keyword">function</span> (ev) {
<a name="l00167"></a>00167     Object.defineProperty(me, <span class="stringliteral">&quot;on&quot;</span> + ev, {
<a name="l00168"></a>00168       <span class="keyword">get</span>: <span class="keyword">function</span> () { <span class="keywordflow">return</span> me._parser[<span class="stringliteral">&quot;on&quot;</span> + ev] },
<a name="l00169"></a>00169       <span class="keyword">set</span>: <span class="keyword">function</span> (h) {
<a name="l00170"></a>00170         <span class="keywordflow">if</span> (!h) {
<a name="l00171"></a>00171           me.removeAllListeners(ev)
<a name="l00172"></a>00172           <span class="keywordflow">return</span> me._parser[<span class="stringliteral">&quot;on&quot;</span>+ev] = h
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174         me.on(ev, h)
<a name="l00175"></a>00175         <span class="keywordflow">return</span> <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l00176"></a>00176       },
<a name="l00177"></a>00177       enumerable: <span class="keyword">true</span>,
<a name="l00178"></a>00178       configurable: <span class="keyword">false</span>
<a name="l00179"></a>00179     })
<a name="l00180"></a>00180   })
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 SAXStream.prototype = Object.create(Stream.prototype,
<a name="l00186"></a>00186   { <a class="code" href="../../d8/d14/_cloud_apps_8js.html#af72715521e98346fe28d30efb7887846">constructor</a>: { <a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>: SAXStream } })
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 SAXStream.prototype.write = <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> (<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l00189"></a>00189   this._parser.write(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.toString())
<a name="l00190"></a>00190   this.<a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(<span class="stringliteral">&quot;data&quot;</span>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>)
<a name="l00191"></a>00191   <span class="keywordflow">return</span> <span class="keyword">true</span>
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 SAXStream.prototype.end = <span class="keyword">function</span> (chunk) {
<a name="l00195"></a>00195   <span class="keywordflow">if</span> (chunk &amp;&amp; chunk.length) this._parser.write(chunk.toString())
<a name="l00196"></a>00196   this._parser.end()
<a name="l00197"></a>00197   <span class="keywordflow">return</span> <span class="keyword">true</span>
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 SAXStream.prototype.on = <span class="keyword">function</span> (ev, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l00201"></a>00201   var me = <span class="keyword">this</span>
<a name="l00202"></a>00202   <span class="keywordflow">if</span> (!me._parser[<span class="stringliteral">&quot;on&quot;</span>+ev] &amp;&amp; streamWraps.indexOf(ev) !== -1) {
<a name="l00203"></a>00203     me._parser[<span class="stringliteral">&quot;on&quot;</span>+ev] = <span class="keyword">function</span> () {
<a name="l00204"></a>00204       var <a class="code" href="../../db/d7b/r_8js.html#a283fa4dd58795cf5b621404be6601e86">args</a> = arguments.length === 1 ? [arguments[0]]
<a name="l00205"></a>00205                : Array.apply(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, arguments)
<a name="l00206"></a>00206       args.splice(0, 0, ev)
<a name="l00207"></a>00207       me.emit.apply(me, args)
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <span class="keywordflow">return</span> Stream.prototype.on.call(me, ev, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>)
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="comment">// character classes and tokens</span>
<a name="l00217"></a>00217 var whitespace = <span class="stringliteral">&quot;\r\n\t &quot;</span>
<a name="l00218"></a>00218   <span class="comment">// this really needs to be replaced with character classes.</span>
<a name="l00219"></a>00219   <span class="comment">// XML allows all manner of ridiculous numbers and digits.</span>
<a name="l00220"></a>00220   , number = <span class="stringliteral">&quot;0124356789&quot;</span>
<a name="l00221"></a>00221   , letter = <span class="stringliteral">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>
<a name="l00222"></a>00222   <span class="comment">// (Letter | &quot;_&quot; | &quot;:&quot;)</span>
<a name="l00223"></a>00223   , nameStart = letter+<span class="stringliteral">&quot;_:&quot;</span>
<a name="l00224"></a>00224   , nameBody = nameStart+number+<span class="stringliteral">&quot;-.&quot;</span>
<a name="l00225"></a>00225   , <a class="code" href="../../d2/d7d/jsapi_8h.html#ac4bd1a994615eb46382478a0dab2858b">quote</a> = <span class="stringliteral">&quot;&#39;\&quot;&quot;</span>
<a name="l00226"></a>00226   , entity = number+letter+<span class="stringliteral">&quot;#&quot;</span>
<a name="l00227"></a>00227   , attribEnd = whitespace + <span class="stringliteral">&quot;&gt;&quot;</span>
<a name="l00228"></a>00228   , CDATA = <span class="stringliteral">&quot;[CDATA[&quot;</span>
<a name="l00229"></a>00229   , DOCTYPE = <span class="stringliteral">&quot;DOCTYPE&quot;</span>
<a name="l00230"></a>00230   , XML_NAMESPACE = <span class="stringliteral">&quot;http://www.w3.org/XML/1998/namespace&quot;</span>
<a name="l00231"></a>00231   , XMLNS_NAMESPACE = <span class="stringliteral">&quot;http://www.w3.org/2000/xmlns/&quot;</span>
<a name="l00232"></a>00232   , rootNS = { xml: XML_NAMESPACE, xmlns: XMLNS_NAMESPACE }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="comment">// turn all the string character sets into character class objects.</span>
<a name="l00235"></a>00235 whitespace = charClass(whitespace)
<a name="l00236"></a>00236 number = charClass(number)
<a name="l00237"></a>00237 letter = charClass(letter)
<a name="l00238"></a>00238 nameStart = charClass(nameStart)
<a name="l00239"></a>00239 nameBody = charClass(nameBody)
<a name="l00240"></a>00240 quote = charClass(quote)
<a name="l00241"></a>00241 entity = charClass(entity)
<a name="l00242"></a>00242 attribEnd = charClass(attribEnd)
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> charClass (<a class="code" href="../../df/d44/permission__manager_8js.html#a176e0fe9a3e516f5aa501f9dcf2eb97b">str</a>) {
<a name="l00245"></a>00245   <span class="keywordflow">return</span> str.split(<span class="stringliteral">&quot;&quot;</span>).reduce(<span class="keyword">function</span> (<a class="code" href="../../d9/d04/expat_8h.html#afa4d928795b38748c167cba7f7b9f04c">s</a>, <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>) {
<a name="l00246"></a>00246     <a class="code" href="../../d9/d04/expat_8h.html#afa4d928795b38748c167cba7f7b9f04c">s</a>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>] = <span class="keyword">true</span>
<a name="l00247"></a>00247     <span class="keywordflow">return</span> <a class="code" href="../../d9/d04/expat_8h.html#afa4d928795b38748c167cba7f7b9f04c">s</a>
<a name="l00248"></a>00248   }, {})
<a name="l00249"></a>00249 }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 <span class="keyword">function</span> is (charclass, <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>) {
<a name="l00252"></a>00252   <span class="keywordflow">return</span> charclass[<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>]
<a name="l00253"></a>00253 }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="keyword">function</span> not (charclass, <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>) {
<a name="l00256"></a>00256   <span class="keywordflow">return</span> !charclass[<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>]
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 var S = 0
<a name="l00260"></a>00260 sax.STATE =
<a name="l00261"></a>00261 { BEGIN                     : S++
<a name="l00262"></a>00262 , TEXT                      : S++ <span class="comment">// general stuff</span>
<a name="l00263"></a>00263 , TEXT_ENTITY               : S++ <span class="comment">// &amp;amp and such.</span>
<a name="l00264"></a>00264 , OPEN_WAKA                 : S++ <span class="comment">// &lt;</span>
<a name="l00265"></a>00265 , SGML_DECL                 : S++ <span class="comment">// &lt;!BLARG</span>
<a name="l00266"></a>00266 , SGML_DECL_QUOTED          : S++ <span class="comment">// &lt;!BLARG foo &quot;bar</span>
<a name="l00267"></a>00267 , DOCTYPE                   : S++ <span class="comment">// &lt;!DOCTYPE</span>
<a name="l00268"></a>00268 , DOCTYPE_QUOTED            : S++ <span class="comment">// &lt;!DOCTYPE &quot;//blah</span>
<a name="l00269"></a>00269 , DOCTYPE_DTD               : S++ <span class="comment">// &lt;!DOCTYPE &quot;//blah&quot; [ ...</span>
<a name="l00270"></a>00270 , DOCTYPE_DTD_QUOTED        : S++ <span class="comment">// &lt;!DOCTYPE &quot;//blah&quot; [ &quot;foo</span>
<a name="l00271"></a>00271 , COMMENT_STARTING          : S++ <span class="comment">// &lt;!-</span>
<a name="l00272"></a>00272 , COMMENT                   : S++ <span class="comment">// &lt;!--</span>
<a name="l00273"></a>00273 , COMMENT_ENDING            : S++ <span class="comment">// &lt;!-- blah -</span>
<a name="l00274"></a>00274 , COMMENT_ENDED             : S++ <span class="comment">// &lt;!-- blah --</span>
<a name="l00275"></a>00275 , CDATA                     : S++ <span class="comment">// &lt;![CDATA[ something</span>
<a name="l00276"></a>00276 , CDATA_ENDING              : S++ <span class="comment">// ]</span>
<a name="l00277"></a>00277 , CDATA_ENDING_2            : S++ <span class="comment">// ]]</span>
<a name="l00278"></a>00278 , PROC_INST                 : S++ <span class="comment">// &lt;?hi</span>
<a name="l00279"></a>00279 , PROC_INST_BODY            : S++ <span class="comment">// &lt;?hi there</span>
<a name="l00280"></a>00280 , PROC_INST_QUOTED          : S++ <span class="comment">// &lt;?hi &quot;there</span>
<a name="l00281"></a>00281 , PROC_INST_ENDING          : S++ <span class="comment">// &lt;?hi &quot;there&quot; ?</span>
<a name="l00282"></a>00282 , OPEN_TAG                  : S++ <span class="comment">// &lt;strong</span>
<a name="l00283"></a>00283 , OPEN_TAG_SLASH            : S++ <span class="comment">// &lt;strong /</span>
<a name="l00284"></a>00284 , ATTRIB                    : S++ <span class="comment">// &lt;a</span>
<a name="l00285"></a>00285 , ATTRIB_NAME               : S++ <span class="comment">// &lt;a foo</span>
<a name="l00286"></a>00286 , ATTRIB_NAME_SAW_WHITE     : S++ <span class="comment">// &lt;a foo _</span>
<a name="l00287"></a>00287 , ATTRIB_VALUE              : S++ <span class="comment">// &lt;a foo=</span>
<a name="l00288"></a>00288 , ATTRIB_VALUE_QUOTED       : S++ <span class="comment">// &lt;a foo=&quot;bar</span>
<a name="l00289"></a>00289 , ATTRIB_VALUE_UNQUOTED     : S++ <span class="comment">// &lt;a foo=bar</span>
<a name="l00290"></a>00290 , ATTRIB_VALUE_ENTITY_Q     : S++ <span class="comment">// &lt;foo bar=&quot;&amp;quot;&quot;</span>
<a name="l00291"></a>00291 , ATTRIB_VALUE_ENTITY_U     : S++ <span class="comment">// &lt;foo bar=&amp;quot;</span>
<a name="l00292"></a>00292 , CLOSE_TAG                 : S++ <span class="comment">// &lt;/a</span>
<a name="l00293"></a>00293 , CLOSE_TAG_SAW_WHITE       : S++ <span class="comment">// &lt;/a   &gt;</span>
<a name="l00294"></a>00294 , SCRIPT                    : S++ <span class="comment">// &lt;script&gt; ...</span>
<a name="l00295"></a>00295 , SCRIPT_ENDING             : S++ <span class="comment">// &lt;script&gt; ... &lt;</span>
<a name="l00296"></a>00296 }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 sax.ENTITIES =
<a name="l00299"></a>00299 { <span class="stringliteral">&quot;apos&quot;</span> : <span class="stringliteral">&quot;&#39;&quot;</span>
<a name="l00300"></a>00300 , <span class="stringliteral">&quot;quot&quot;</span> : <span class="stringliteral">&quot;\&quot;&quot;</span>
<a name="l00301"></a>00301 , <span class="stringliteral">&quot;amp&quot;</span>  : <span class="stringliteral">&quot;&amp;&quot;</span>
<a name="l00302"></a>00302 , <span class="stringliteral">&quot;gt&quot;</span>   : <span class="stringliteral">&quot;&gt;&quot;</span>
<a name="l00303"></a>00303 , <span class="stringliteral">&quot;lt&quot;</span>   : <span class="stringliteral">&quot;&lt;&quot;</span>
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 <span class="keywordflow">for</span> (var S in sax.STATE) sax.STATE[sax.STATE[S]] = S
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="comment">// shorthand</span>
<a name="l00309"></a>00309 S = sax.STATE
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="keyword">function</span> <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a> (<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>, <a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l00312"></a>00312   <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>] &amp;&amp; <a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>](<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>)
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="keyword">function</span> <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a> (<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>, nodeType, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l00316"></a>00316   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>.textNode) closeText(<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>)
<a name="l00317"></a>00317   <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(<a class="code" href="../../d1/d3e/namespaceadditional-extensions.html#a31dc95d3bc13df39986d40a96bc88a9e">parser</a>, nodeType, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>)
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> closeText (parser) {
<a name="l00321"></a>00321   parser.textNode = textopts(parser.opt, parser.textNode)
<a name="l00322"></a>00322   <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (parser.textNode) <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(parser, &quot;ontext&quot;, parser.textNode)
<a name="l00323"></a>00323   parser.textNode = &quot;&quot;
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> textopts (<a class="code" href="../../d2/d7d/jsapi_8h.html#aefde3c032db0d11ae0c92cb43ad6ef1f">opt</a>, <a class="code" href="../../dd/dfa/classtext.html">text</a>) {
<a name="l00327"></a>00327   <span class="keywordflow">if</span> (opt.trim) text = text.trim()
<a name="l00328"></a>00328   <span class="keywordflow">if</span> (opt.normalize) text = text.replace(/\<a class="code" href="../../d9/d04/expat_8h.html#afa4d928795b38748c167cba7f7b9f04c">s</a>+/<a class="code" href="../../d8/dad/apps_2email_2js_2ext_2mailapi_2chewlayer_8js.html#a73c18c59a39b18382081ec00bb456d43">g</a>, <span class="stringliteral">&quot; &quot;</span>)
<a name="l00329"></a>00329   <span class="keywordflow">return</span> text
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">function</span> <a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a> (parser, <a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a>) {
<a name="l00333"></a>00333   closeText(parser)
<a name="l00334"></a>00334   <a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a> += &quot;\nLine: &quot;+parser.<a class="code" href="../../da/d7d/cook_8js.html#ae379b8c31475b8ad7712b7ead5ce1173">line</a>+
<a name="l00335"></a>00335         &quot;\nColumn: &quot;+parser.column+
<a name="l00336"></a>00336         &quot;\nChar: &quot;+parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00337"></a>00337   <a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a> = new <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a>)
<a name="l00338"></a>00338   parser.<a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a> = <a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a>
<a name="l00339"></a>00339   <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(parser, &quot;<a class="code" href="../../d4/d76/camera_2js_2filmstrip_8js.html#a9c95fb48715b0deb285f7bfd8f10df50">onerror</a>&quot;, <a class="code" href="../../d2/d7d/jsapi_8h.html#aca241430796cc1ddfb977bb37c38590b">er</a>)
<a name="l00340"></a>00340   <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> parser
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> <a class="code" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a> (parser) {
<a name="l00344"></a>00344   <span class="keywordflow">if</span> (parser.state !== S.TEXT) <a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a>(parser, <span class="stringliteral">&quot;Unexpected end&quot;</span>)
<a name="l00345"></a>00345   closeText(parser)
<a name="l00346"></a>00346   parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> = &quot;&quot;
<a name="l00347"></a>00347   parser.closed = <a class="code" href="../../d7/dd2/qcmstypes_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a>
<a name="l00348"></a>00348   <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(parser, &quot;onend&quot;)
<a name="l00349"></a>00349   SAXParser.<a class="code" href="../../d3/d4b/lockscreen_8js.html#a8b146780469f40ff2867e5067d0d33f5">call</a>(parser, parser.<a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>, parser.opt)
<a name="l00350"></a>00350   <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> parser
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> strictFail (parser, <a class="code" href="../../d1/d04/app__install__manager_8js.html#ad031ac2c2bcd5e0fe9c6b67fc309acd4">message</a>) {
<a name="l00354"></a>00354   <span class="keywordflow">if</span> (parser.strict) <a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a>(parser, message)
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="keyword">function</span> newTag (parser) {
<a name="l00358"></a>00358   <span class="keywordflow">if</span> (!parser.strict) parser.tagName = parser.tagName[parser.looseCase]()
<a name="l00359"></a>00359   var <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a> = parser.tags[parser.tags.length - 1] || parser
<a name="l00360"></a>00360     , tag = parser.tag = { <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a> : parser.tagName, attributes : {} }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362   <span class="comment">// will be overridden if tag contails an xmlns=&quot;foo&quot; or xmlns:foo=&quot;bar&quot;</span>
<a name="l00363"></a>00363   <span class="keywordflow">if</span> (parser.opt.xmlns) tag.ns = <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a>.ns
<a name="l00364"></a>00364   parser.attribList.length = 0
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 <span class="keyword">function</span> qname (<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>) {
<a name="l00368"></a>00368   var <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a> = <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>.indexOf(<span class="stringliteral">&quot;:&quot;</span>)
<a name="l00369"></a>00369     , qualName = i &lt; 0 ? [ <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a> ] : <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>.split(<span class="stringliteral">&quot;:&quot;</span>)
<a name="l00370"></a>00370     , <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = qualName[0]
<a name="l00371"></a>00371     , local = qualName[1]
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="comment">// &lt;x &quot;xmlns&quot;=&quot;http://foo&quot;&gt;</span>
<a name="l00374"></a>00374   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a> === <span class="stringliteral">&quot;xmlns&quot;</span>) {
<a name="l00375"></a>00375     <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = <span class="stringliteral">&quot;xmlns&quot;</span>
<a name="l00376"></a>00376     local = <span class="stringliteral">&quot;&quot;</span>
<a name="l00377"></a>00377   }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379   <span class="keywordflow">return</span> { <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>: <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>, local: local }
<a name="l00380"></a>00380 }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="keyword">function</span> attrib (parser) {
<a name="l00383"></a>00383   <span class="keywordflow">if</span> (!parser.strict) parser.attribName = parser.attribName[parser.looseCase]()
<a name="l00384"></a>00384   <span class="keywordflow">if</span> (parser.opt.xmlns) {
<a name="l00385"></a>00385     var qn = qname(parser.attribName)
<a name="l00386"></a>00386       , <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = qn.prefix
<a name="l00387"></a>00387       , local = qn.local
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> === <span class="stringliteral">&quot;xmlns&quot;</span>) {
<a name="l00390"></a>00390       <span class="comment">// namespace binding attribute; push the binding into scope</span>
<a name="l00391"></a>00391       <span class="keywordflow">if</span> (local === <span class="stringliteral">&quot;xml&quot;</span> &amp;&amp; parser.attribValue !== XML_NAMESPACE) {
<a name="l00392"></a>00392         strictFail( parser
<a name="l00393"></a>00393                   , <span class="stringliteral">&quot;xml: prefix must be bound to &quot;</span> + XML_NAMESPACE + <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00394"></a>00394                   + <span class="stringliteral">&quot;Actual: &quot;</span> + parser.attribValue )
<a name="l00395"></a>00395       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (local === <span class="stringliteral">&quot;xmlns&quot;</span> &amp;&amp; parser.attribValue !== XMLNS_NAMESPACE) {
<a name="l00396"></a>00396         strictFail( parser
<a name="l00397"></a>00397                   , <span class="stringliteral">&quot;xmlns: prefix must be bound to &quot;</span> + XMLNS_NAMESPACE + <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00398"></a>00398                   + <span class="stringliteral">&quot;Actual: &quot;</span> + parser.attribValue )
<a name="l00399"></a>00399       } <span class="keywordflow">else</span> {
<a name="l00400"></a>00400         var tag = parser.tag
<a name="l00401"></a>00401           , <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a> = parser.tags[parser.tags.length - 1] || parser
<a name="l00402"></a>00402         <span class="keywordflow">if</span> (tag.ns === <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a>.ns) {
<a name="l00403"></a>00403           tag.ns = Object.create(<a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a>.ns)
<a name="l00404"></a>00404         }
<a name="l00405"></a>00405         tag.ns[local] = parser.attribValue
<a name="l00406"></a>00406       }
<a name="l00407"></a>00407     }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409     <span class="comment">// defer onattribute events until all attributes have been seen</span>
<a name="l00410"></a>00410     <span class="comment">// so any new bindings can take effect; preserve attribute order</span>
<a name="l00411"></a>00411     <span class="comment">// so deferred events can be emitted in document order</span>
<a name="l00412"></a>00412     parser.attribList.push([parser.attribName, parser.attribValue])
<a name="l00413"></a>00413   } <span class="keywordflow">else</span> {
<a name="l00414"></a>00414     <span class="comment">// in non-xmlns mode, we can emit the event right away</span>
<a name="l00415"></a>00415     parser.tag.attributes[parser.attribName] = parser.attribValue
<a name="l00416"></a>00416     <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>( parser
<a name="l00417"></a>00417             , <span class="stringliteral">&quot;onattribute&quot;</span>
<a name="l00418"></a>00418             , { <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>: parser.attribName
<a name="l00419"></a>00419               , <a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>: parser.attribValue } )
<a name="l00420"></a>00420   }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   parser.attribName = parser.attribValue = <span class="stringliteral">&quot;&quot;</span>
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="keyword">function</span> openTag (parser, selfClosing) {
<a name="l00426"></a>00426   <span class="keywordflow">if</span> (parser.opt.xmlns) {
<a name="l00427"></a>00427     <span class="comment">// emit namespace binding events</span>
<a name="l00428"></a>00428     var tag = parser.tag
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="comment">// add namespace info to tag</span>
<a name="l00431"></a>00431     var qn = qname(parser.tagName)
<a name="l00432"></a>00432     tag.<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = qn.<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>
<a name="l00433"></a>00433     tag.local = qn.local
<a name="l00434"></a>00434     tag.<a class="code" href="../../d9/d04/expat_8h.html#a5a9fdd6c2606370ad12f24c078ac6585">uri</a> = tag.<a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>[qn.<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>] || qn.<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (tag.<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> &amp;&amp; !tag.<a class="code" href="../../d9/d04/expat_8h.html#a5a9fdd6c2606370ad12f24c078ac6585">uri</a>) {
<a name="l00437"></a>00437       strictFail(parser, <span class="stringliteral">&quot;Unbound namespace prefix: &quot;</span>
<a name="l00438"></a>00438                        + JSON.stringify(parser.tagName))
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a> = parser.tags[parser.tags.length - 1] || parser
<a name="l00442"></a>00442     <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (tag.ns &amp;&amp; <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a>.ns !== tag.ns) {
<a name="l00443"></a>00443       Object.keys(tag.ns).forEach(<span class="keyword">function</span> (<a class="code" href="../../db/de5/namespacedefault__timezones.html#a28422cbbc99cee3f1b68cd64c3ded285">p</a>) {
<a name="l00444"></a>00444         <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>( parser
<a name="l00445"></a>00445                 , <span class="stringliteral">&quot;onopennamespace&quot;</span>
<a name="l00446"></a>00446                 , { <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>: <a class="code" href="../../db/de5/namespacedefault__timezones.html#a28422cbbc99cee3f1b68cd64c3ded285">p</a> , uri: tag.ns[<a class="code" href="../../db/de5/namespacedefault__timezones.html#a28422cbbc99cee3f1b68cd64c3ded285">p</a>] } )
<a name="l00447"></a>00447       })
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="comment">// handle deferred onattribute events</span>
<a name="l00451"></a>00451     <span class="keywordflow">for</span> (var i = 0, <a class="code" href="../../d9/d6a/ns_color_8h.html#a0ad4b5fc255f59a8dace6aa74c5ca790">l</a> = parser.attribList.length; i &lt; <a class="code" href="../../d9/d6a/ns_color_8h.html#a0ad4b5fc255f59a8dace6aa74c5ca790">l</a>; i ++) {
<a name="l00452"></a>00452       var nv = parser.attribList[<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>]
<a name="l00453"></a>00453       var <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a> = nv[0]
<a name="l00454"></a>00454         , <a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a> = nv[1]
<a name="l00455"></a>00455         , qualName = qname(name)
<a name="l00456"></a>00456         , <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = qualName.prefix
<a name="l00457"></a>00457         , local = qualName.local
<a name="l00458"></a>00458         , uri = tag.ns[<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>] || <span class="stringliteral">&quot;&quot;</span>
<a name="l00459"></a>00459         , <a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> = { name: <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>
<a name="l00460"></a>00460               , value: <a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>
<a name="l00461"></a>00461               , <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>: <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>
<a name="l00462"></a>00462               , local: local
<a name="l00463"></a>00463               , uri: uri
<a name="l00464"></a>00464               }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466       <span class="comment">// if there&#39;s any attributes with an undefined namespace,</span>
<a name="l00467"></a>00467       <span class="comment">// then fail on them now.</span>
<a name="l00468"></a>00468       <span class="keywordflow">if</span> (<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> &amp;&amp; <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> != <span class="stringliteral">&quot;xmlns&quot;</span> &amp;&amp; !uri) {
<a name="l00469"></a>00469         strictFail(parser, <span class="stringliteral">&quot;Unbound namespace prefix: &quot;</span>
<a name="l00470"></a>00470                          + JSON.stringify(<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>))
<a name="l00471"></a>00471         <a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>.uri = <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>
<a name="l00472"></a>00472       }
<a name="l00473"></a>00473       parser.tag.attributes[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>] = <a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>
<a name="l00474"></a>00474       <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onattribute&quot;</span>, <a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>)
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476     parser.attribList.length = 0
<a name="l00477"></a>00477   }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   <span class="comment">// process the tag</span>
<a name="l00480"></a>00480   parser.sawRoot = <span class="keyword">true</span>
<a name="l00481"></a>00481   parser.tags.push(parser.tag)
<a name="l00482"></a>00482   <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onopentag&quot;</span>, parser.tag)
<a name="l00483"></a>00483   <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (!selfClosing) {
<a name="l00484"></a>00484     <span class="comment">// special case for &lt;script&gt; in non-strict mode.</span>
<a name="l00485"></a>00485     <span class="keywordflow">if</span> (!parser.noscript &amp;&amp; parser.tagName.toLowerCase() === <span class="stringliteral">&quot;script&quot;</span>) {
<a name="l00486"></a>00486       parser.state = S.SCRIPT
<a name="l00487"></a>00487     } <span class="keywordflow">else</span> {
<a name="l00488"></a>00488       parser.state = S.TEXT
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490     parser.tag = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>
<a name="l00491"></a>00491     parser.tagName = <span class="stringliteral">&quot;&quot;</span>
<a name="l00492"></a>00492   }
<a name="l00493"></a>00493   parser.attribName = parser.attribValue = <span class="stringliteral">&quot;&quot;</span>
<a name="l00494"></a>00494   parser.attribList.length = 0
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 <span class="keyword">function</span> closeTag (parser) {
<a name="l00498"></a>00498   <span class="keywordflow">if</span> (!parser.tagName) {
<a name="l00499"></a>00499     strictFail(parser, <span class="stringliteral">&quot;Weird empty close tag.&quot;</span>)
<a name="l00500"></a>00500     parser.textNode += &quot;&lt;/&gt;&quot;
<a name="l00501"></a>00501     parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00502"></a>00502     <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a>
<a name="l00503"></a>00503   }
<a name="l00504"></a>00504   <span class="comment">// first make sure that the closing tag actually exists.</span>
<a name="l00505"></a>00505   <span class="comment">// &lt;a&gt;&lt;b&gt;&lt;/c&gt;&lt;/b&gt;&lt;/a&gt; will close everything, otherwise.</span>
<a name="l00506"></a>00506   var t = parser.tags.<a class="code" href="../../d3/d91/j3d_8js.html#a3f87557d7488bfe7545844c394baa854">length</a>
<a name="l00507"></a>00507   var tagName = parser.tagName
<a name="l00508"></a>00508   <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (!parser.strict) tagName = tagName[parser.looseCase]()
<a name="l00509"></a>00509   var closeTo = tagName
<a name="l00510"></a>00510   <a class="code" href="../../da/d7d/cook_8js.html#a57dbef5a4ee6c348416799f90566d0a3">while</a> (t --) {
<a name="l00511"></a>00511     var <a class="code" href="../../dd/df0/dialogs__end__init_8js.html#acdb1449d11a5550a30ee4a18b9c7f133">close</a> = parser.tags[t]
<a name="l00512"></a>00512     <span class="keywordflow">if</span> (close.name !== closeTo) {
<a name="l00513"></a>00513       <span class="comment">// fail the first time in strict mode</span>
<a name="l00514"></a>00514       strictFail(parser, <span class="stringliteral">&quot;Unexpected close tag&quot;</span>)
<a name="l00515"></a>00515     } <span class="keywordflow">else</span> <span class="keywordflow">break</span>
<a name="l00516"></a>00516   }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <span class="comment">// didn&#39;t find it.  we already failed for strict, so just abort.</span>
<a name="l00519"></a>00519   <span class="keywordflow">if</span> (t &lt; 0) {
<a name="l00520"></a>00520     strictFail(parser, <span class="stringliteral">&quot;Unmatched closing tag: &quot;</span>+parser.tagName)
<a name="l00521"></a>00521     parser.textNode += &quot;&lt;/&quot; + parser.tagName + &quot;&gt;&quot;
<a name="l00522"></a>00522     parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00523"></a>00523     <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a>
<a name="l00524"></a>00524   }
<a name="l00525"></a>00525   parser.tagName = tagName
<a name="l00526"></a>00526   var <a class="code" href="../../d9/d04/expat_8h.html#afa4d928795b38748c167cba7f7b9f04c">s</a> = parser.tags.<a class="code" href="../../d3/d91/j3d_8js.html#a3f87557d7488bfe7545844c394baa854">length</a>
<a name="l00527"></a>00527   <a class="code" href="../../da/d7d/cook_8js.html#a57dbef5a4ee6c348416799f90566d0a3">while</a> (<a class="code" href="../../d9/d04/expat_8h.html#afa4d928795b38748c167cba7f7b9f04c">s</a> --&gt; t) {
<a name="l00528"></a>00528     var tag = parser.tag = parser.tags.pop()
<a name="l00529"></a>00529     parser.tagName = parser.tag.name
<a name="l00530"></a>00530     <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onclosetag&quot;</span>, parser.tagName)
<a name="l00531"></a>00531 
<a name="l00532"></a>00532     var x = {}
<a name="l00533"></a>00533     <span class="keywordflow">for</span> (var i in tag.ns) x[<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>] = tag.ns[<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>]
<a name="l00534"></a>00534 
<a name="l00535"></a>00535     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a> = parser.tags[parser.tags.length - 1] || parser
<a name="l00536"></a>00536     <span class="keywordflow">if</span> (parser.opt.xmlns &amp;&amp; tag.ns !== parent.ns) {
<a name="l00537"></a>00537       <span class="comment">// remove namespace bindings introduced by tag</span>
<a name="l00538"></a>00538       Object.keys(tag.ns).forEach(<span class="keyword">function</span> (<a class="code" href="../../db/de5/namespacedefault__timezones.html#a28422cbbc99cee3f1b68cd64c3ded285">p</a>) {
<a name="l00539"></a>00539         var <a class="code" href="../../d2/d7d/jsapi_8h.html#aa5a8b9a2d5edc8e2e7ba67d7e2ee4e69">n</a> = tag.ns[<a class="code" href="../../db/de5/namespacedefault__timezones.html#a28422cbbc99cee3f1b68cd64c3ded285">p</a>]
<a name="l00540"></a>00540         <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onclosenamespace&quot;</span>, { <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>: <a class="code" href="../../db/de5/namespacedefault__timezones.html#a28422cbbc99cee3f1b68cd64c3ded285">p</a>, uri: n })
<a name="l00541"></a>00541       })
<a name="l00542"></a>00542     }
<a name="l00543"></a>00543   }
<a name="l00544"></a>00544   <span class="keywordflow">if</span> (t === 0) parser.closedRoot = <span class="keyword">true</span>
<a name="l00545"></a>00545   parser.tagName = parser.attribValue = parser.attribName = <span class="stringliteral">&quot;&quot;</span>
<a name="l00546"></a>00546   parser.attribList.length = 0
<a name="l00547"></a>00547   parser.state = S.TEXT
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="keyword">function</span> parseEntity (parser) {
<a name="l00551"></a>00551   var entity = parser.entity.toLowerCase()
<a name="l00552"></a>00552     , <a class="code" href="../../de/d81/xpt__struct_8h.html#af23ba264fc6071dcd37179d8a2b5440b">num</a>
<a name="l00553"></a>00553     , numStr = <span class="stringliteral">&quot;&quot;</span>
<a name="l00554"></a>00554   <span class="keywordflow">if</span> (parser.ENTITIES[entity]) <span class="keywordflow">return</span> parser.ENTITIES[entity]
<a name="l00555"></a>00555   <span class="keywordflow">if</span> (entity.charAt(0) === <span class="stringliteral">&quot;#&quot;</span>) {
<a name="l00556"></a>00556     <span class="keywordflow">if</span> (entity.charAt(1) === <span class="stringliteral">&quot;x&quot;</span>) {
<a name="l00557"></a>00557       entity = entity.slice(2)
<a name="l00558"></a>00558       <a class="code" href="../../de/d81/xpt__struct_8h.html#af23ba264fc6071dcd37179d8a2b5440b">num</a> = parseInt(entity, 16)
<a name="l00559"></a>00559       numStr = <a class="code" href="../../de/d81/xpt__struct_8h.html#af23ba264fc6071dcd37179d8a2b5440b">num</a>.<a class="code" href="../../d4/d23/binary__string__view_8js.html#a64379212b203168995cd87810b47adbe">toString</a>(16)
<a name="l00560"></a>00560     } else {
<a name="l00561"></a>00561       entity = entity.slice(1)
<a name="l00562"></a>00562       <a class="code" href="../../de/d81/xpt__struct_8h.html#af23ba264fc6071dcd37179d8a2b5440b">num</a> = parseInt(entity, 10)
<a name="l00563"></a>00563       numStr = <a class="code" href="../../de/d81/xpt__struct_8h.html#af23ba264fc6071dcd37179d8a2b5440b">num</a>.<a class="code" href="../../d4/d23/binary__string__view_8js.html#a64379212b203168995cd87810b47adbe">toString</a>(10)
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565   }
<a name="l00566"></a>00566   entity = entity.<a class="code" href="../../dc/d89/wappush_2js_2message_8js.html#a7c5f9536f6c7849a4a7a592bfedf18f1">replace</a>(/^0+/, &quot;&quot;)
<a name="l00567"></a>00567   <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (numStr.toLowerCase() !== entity) {
<a name="l00568"></a>00568     strictFail(parser, <span class="stringliteral">&quot;Invalid character entity&quot;</span>)
<a name="l00569"></a>00569     <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> &quot;&amp;&quot;+parser.entity + &quot;;&quot;
<a name="l00570"></a>00570   }
<a name="l00571"></a>00571   <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> String.fromCharCode(<a class="code" href="../../de/d81/xpt__struct_8h.html#af23ba264fc6071dcd37179d8a2b5440b">num</a>)
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <a class="code" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> write (chunk) {
<a name="l00575"></a>00575   var parser = <span class="keyword">this</span>
<a name="l00576"></a>00576   <span class="keywordflow">if</span> (this.<a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a>) <span class="keywordflow">throw</span> this.<a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a>
<a name="l00577"></a>00577   <span class="keywordflow">if</span> (parser.closed) <span class="keywordflow">return</span> <a class="code" href="../../d0/de6/fake-oncall-desktop_8js.html#a6efd5e1eedff09b640ec574dc6dd2879">error</a>(parser,
<a name="l00578"></a>00578     <span class="stringliteral">&quot;Cannot write after close. Assign an onready handler.&quot;</span>)
<a name="l00579"></a>00579   <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (chunk === <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>) <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> <a class="code" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a>(parser)
<a name="l00580"></a>00580   var i = 0, <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> = &quot;&quot;
<a name="l00581"></a>00581   <a class="code" href="../../da/d7d/cook_8js.html#a57dbef5a4ee6c348416799f90566d0a3">while</a> ((parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> = <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> = chunk.<a class="code" href="../../d4/d23/binary__string__view_8js.html#a1e22de8ef86f392759996c442eea4b55">charAt</a>(i++))) {
<a name="l00582"></a>00582     parser.position ++
<a name="l00583"></a>00583     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;\n&quot;</span>) {
<a name="l00584"></a>00584       parser.line ++
<a name="l00585"></a>00585       parser.column = 0
<a name="l00586"></a>00586     } <span class="keywordflow">else</span> parser.column ++
<a name="l00587"></a>00587     <span class="keywordflow">switch</span> (parser.state) {
<a name="l00588"></a>00588 
<a name="l00589"></a>00589       <span class="keywordflow">case</span> S.BEGIN:
<a name="l00590"></a>00590         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;&lt;&quot;</span>) parser.state = S.OPEN_WAKA
<a name="l00591"></a>00591         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (not(whitespace,<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>)) {
<a name="l00592"></a>00592           <span class="comment">// have to process this as a text node.</span>
<a name="l00593"></a>00593           <span class="comment">// weird, but happens.</span>
<a name="l00594"></a>00594           strictFail(parser, <span class="stringliteral">&quot;Non-whitespace before first tag.&quot;</span>)
<a name="l00595"></a>00595           parser.textNode = <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00596"></a>00596           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00597"></a>00597         }
<a name="l00598"></a>00598       continue
<a name="l00599"></a>00599 
<a name="l00600"></a>00600       case S.TEXT:
<a name="l00601"></a>00601         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (parser.sawRoot &amp;&amp; !parser.closedRoot) {
<a name="l00602"></a>00602           var starti = i-1
<a name="l00603"></a>00603           <span class="keywordflow">while</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> &amp;&amp; <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>!==<span class="stringliteral">&quot;&lt;&quot;</span> &amp;&amp; <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>!==<span class="stringliteral">&quot;&amp;&quot;</span>) {
<a name="l00604"></a>00604             <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> = chunk.charAt(i++)
<a name="l00605"></a>00605             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>) {
<a name="l00606"></a>00606               parser.position ++
<a name="l00607"></a>00607               <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;\n&quot;</span>) {
<a name="l00608"></a>00608                 parser.line ++
<a name="l00609"></a>00609                 parser.column = 0
<a name="l00610"></a>00610               } <span class="keywordflow">else</span> parser.column ++
<a name="l00611"></a>00611             }
<a name="l00612"></a>00612           }
<a name="l00613"></a>00613           parser.textNode += chunk.substring(starti, i-1)
<a name="l00614"></a>00614         }
<a name="l00615"></a>00615         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;&lt;&quot;</span>) parser.state = S.OPEN_WAKA
<a name="l00616"></a>00616         <span class="keywordflow">else</span> {
<a name="l00617"></a>00617           <span class="keywordflow">if</span> (not(whitespace, <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>) &amp;&amp; (!parser.sawRoot || parser.closedRoot))
<a name="l00618"></a>00618             strictFail(<span class="stringliteral">&quot;Text data outside of root node.&quot;</span>)
<a name="l00619"></a>00619           <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === &quot;&amp;&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT_ENTITY
<a name="l00620"></a>00620           else parser.textNode += <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00621"></a>00621         }
<a name="l00622"></a>00622       continue
<a name="l00623"></a>00623 
<a name="l00624"></a>00624       case S.SCRIPT:
<a name="l00625"></a>00625         <span class="comment">// only non-strict</span>
<a name="l00626"></a>00626         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === &quot;&lt;&quot;) {
<a name="l00627"></a>00627           parser.state = S.SCRIPT_ENDING
<a name="l00628"></a>00628         } <span class="keywordflow">else</span> parser.script += <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00629"></a>00629       <span class="keywordflow">continue</span>
<a name="l00630"></a>00630 
<a name="l00631"></a>00631       <span class="keywordflow">case</span> S.SCRIPT_ENDING:
<a name="l00632"></a>00632         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;/&quot;</span>) {
<a name="l00633"></a>00633           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onscript&quot;</span>, parser.script)
<a name="l00634"></a>00634           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.CLOSE_TAG
<a name="l00635"></a>00635           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#a31bd60a30b08f545ac3bb2e4c17c4d97">script</a> = &quot;&quot;
<a name="l00636"></a>00636           parser.tagName = &quot;&quot;
<a name="l00637"></a>00637         } else {
<a name="l00638"></a>00638           parser.script += <span class="stringliteral">&quot;&lt;&quot;</span> + <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00639"></a>00639           parser.state = S.SCRIPT
<a name="l00640"></a>00640         }
<a name="l00641"></a>00641       <span class="keywordflow">continue</span>
<a name="l00642"></a>00642 
<a name="l00643"></a>00643       <span class="keywordflow">case</span> S.OPEN_WAKA:
<a name="l00644"></a>00644         <span class="comment">// either a /, ?, !, or text is coming next.</span>
<a name="l00645"></a>00645         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;!&quot;</span>) {
<a name="l00646"></a>00646           parser.state = S.SGML_DECL
<a name="l00647"></a>00647           parser.sgmlDecl = <span class="stringliteral">&quot;&quot;</span>
<a name="l00648"></a>00648         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is(whitespace, <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>)) {
<a name="l00649"></a>00649           <span class="comment">// wait for it...</span>
<a name="l00650"></a>00650         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is(nameStart,<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>)) {
<a name="l00651"></a>00651           parser.startTagPosition = parser.position - 1
<a name="l00652"></a>00652           parser.state = S.OPEN_TAG
<a name="l00653"></a>00653           parser.tagName = <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00654"></a>00654         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;/&quot;</span>) {
<a name="l00655"></a>00655           parser.startTagPosition = parser.position - 1
<a name="l00656"></a>00656           parser.state = S.CLOSE_TAG
<a name="l00657"></a>00657           parser.tagName = <span class="stringliteral">&quot;&quot;</span>
<a name="l00658"></a>00658         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === <span class="stringliteral">&quot;?&quot;</span>) {
<a name="l00659"></a>00659           parser.state = S.PROC_INST
<a name="l00660"></a>00660           parser.procInstName = parser.procInstBody = <span class="stringliteral">&quot;&quot;</span>
<a name="l00661"></a>00661         } <span class="keywordflow">else</span> {
<a name="l00662"></a>00662           strictFail(parser, <span class="stringliteral">&quot;Unencoded &lt;&quot;</span>)
<a name="l00663"></a>00663           parser.textNode += &quot;&lt;&quot; + <a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>
<a name="l00664"></a>00664           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666       continue
<a name="l00667"></a>00667 
<a name="l00668"></a>00668       case S.SGML_DECL:
<a name="l00669"></a>00669         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> ((parser.sgmlDecl+<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>).toUpperCase() === CDATA) {
<a name="l00670"></a>00670           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onopencdata&quot;</span>)
<a name="l00671"></a>00671           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.CDATA
<a name="l00672"></a>00672           parser.sgmlDecl = &quot;&quot;
<a name="l00673"></a>00673           parser.cdata = &quot;&quot;
<a name="l00674"></a>00674         } else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (parser.sgmlDecl+<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === &quot;--&quot;) {
<a name="l00675"></a>00675           parser.state = S.COMMENT
<a name="l00676"></a>00676           parser.comment = <span class="stringliteral">&quot;&quot;</span>
<a name="l00677"></a>00677           parser.sgmlDecl = <span class="stringliteral">&quot;&quot;</span>
<a name="l00678"></a>00678         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((parser.sgmlDecl+<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>).toUpperCase() === DOCTYPE) {
<a name="l00679"></a>00679           parser.state = S.DOCTYPE
<a name="l00680"></a>00680           <span class="keywordflow">if</span> (parser.doctype || parser.sawRoot) strictFail(parser,
<a name="l00681"></a>00681             <span class="stringliteral">&quot;Inappropriately located doctype declaration&quot;</span>)
<a name="l00682"></a>00682           parser.doctype = &quot;&quot;
<a name="l00683"></a>00683           parser.sgmlDecl = &quot;&quot;
<a name="l00684"></a>00684         } else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a> === &quot;&gt;&quot;) {
<a name="l00685"></a>00685           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onsgmldeclaration&quot;</span>, parser.sgmlDecl)
<a name="l00686"></a>00686           parser.sgmlDecl = &quot;&quot;
<a name="l00687"></a>00687           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00688"></a>00688         } else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(quote, c)) {
<a name="l00689"></a>00689           parser.state = S.SGML_DECL_QUOTED
<a name="l00690"></a>00690           parser.sgmlDecl += c
<a name="l00691"></a>00691         } <span class="keywordflow">else</span> parser.sgmlDecl += c
<a name="l00692"></a>00692       <span class="keywordflow">continue</span>
<a name="l00693"></a>00693 
<a name="l00694"></a>00694       <span class="keywordflow">case</span> S.SGML_DECL_QUOTED:
<a name="l00695"></a>00695         <span class="keywordflow">if</span> (c === parser.q) {
<a name="l00696"></a>00696           parser.state = S.SGML_DECL
<a name="l00697"></a>00697           parser.q = <span class="stringliteral">&quot;&quot;</span>
<a name="l00698"></a>00698         }
<a name="l00699"></a>00699         parser.sgmlDecl += c
<a name="l00700"></a>00700       <span class="keywordflow">continue</span>
<a name="l00701"></a>00701 
<a name="l00702"></a>00702       <span class="keywordflow">case</span> S.DOCTYPE:
<a name="l00703"></a>00703         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;&gt;&quot;</span>) {
<a name="l00704"></a>00704           parser.state = S.TEXT
<a name="l00705"></a>00705           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;ondoctype&quot;</span>, parser.doctype)
<a name="l00706"></a>00706           parser.doctype = <a class="code" href="../../d7/dd2/qcmstypes_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a> <span class="comment">// just remember that we saw it.</span>
<a name="l00707"></a>00707         } else {
<a name="l00708"></a>00708           parser.doctype += c
<a name="l00709"></a>00709           <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;[&quot;</span>) parser.state = S.DOCTYPE_DTD
<a name="l00710"></a>00710           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is(quote, c)) {
<a name="l00711"></a>00711             parser.state = S.DOCTYPE_QUOTED
<a name="l00712"></a>00712             parser.q = c
<a name="l00713"></a>00713           }
<a name="l00714"></a>00714         }
<a name="l00715"></a>00715       <span class="keywordflow">continue</span>
<a name="l00716"></a>00716 
<a name="l00717"></a>00717       <span class="keywordflow">case</span> S.DOCTYPE_QUOTED:
<a name="l00718"></a>00718         parser.doctype += c
<a name="l00719"></a>00719         <span class="keywordflow">if</span> (c === parser.q) {
<a name="l00720"></a>00720           parser.q = <span class="stringliteral">&quot;&quot;</span>
<a name="l00721"></a>00721           parser.state = S.DOCTYPE
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723       <span class="keywordflow">continue</span>
<a name="l00724"></a>00724 
<a name="l00725"></a>00725       <span class="keywordflow">case</span> S.DOCTYPE_DTD:
<a name="l00726"></a>00726         parser.doctype += c
<a name="l00727"></a>00727         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;]&quot;</span>) parser.state = S.DOCTYPE
<a name="l00728"></a>00728         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is(quote,c)) {
<a name="l00729"></a>00729           parser.state = S.DOCTYPE_DTD_QUOTED
<a name="l00730"></a>00730           parser.q = c
<a name="l00731"></a>00731         }
<a name="l00732"></a>00732       <span class="keywordflow">continue</span>
<a name="l00733"></a>00733 
<a name="l00734"></a>00734       <span class="keywordflow">case</span> S.DOCTYPE_DTD_QUOTED:
<a name="l00735"></a>00735         parser.doctype += c
<a name="l00736"></a>00736         <span class="keywordflow">if</span> (c === parser.q) {
<a name="l00737"></a>00737           parser.state = S.DOCTYPE_DTD
<a name="l00738"></a>00738           parser.q = <span class="stringliteral">&quot;&quot;</span>
<a name="l00739"></a>00739         }
<a name="l00740"></a>00740       <span class="keywordflow">continue</span>
<a name="l00741"></a>00741 
<a name="l00742"></a>00742       <span class="keywordflow">case</span> S.COMMENT:
<a name="l00743"></a>00743         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;-&quot;</span>) parser.state = S.COMMENT_ENDING
<a name="l00744"></a>00744         <span class="keywordflow">else</span> parser.comment += c
<a name="l00745"></a>00745       <span class="keywordflow">continue</span>
<a name="l00746"></a>00746 
<a name="l00747"></a>00747       <span class="keywordflow">case</span> S.COMMENT_ENDING:
<a name="l00748"></a>00748         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;-&quot;</span>) {
<a name="l00749"></a>00749           parser.state = S.COMMENT_ENDED
<a name="l00750"></a>00750           parser.comment = textopts(parser.opt, parser.comment)
<a name="l00751"></a>00751           <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (parser.comment) <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, &quot;oncomment&quot;, parser.comment)
<a name="l00752"></a>00752           parser.comment = &quot;&quot;
<a name="l00753"></a>00753         } else {
<a name="l00754"></a>00754           parser.comment += <span class="stringliteral">&quot;-&quot;</span> + c
<a name="l00755"></a>00755           parser.state = S.COMMENT
<a name="l00756"></a>00756         }
<a name="l00757"></a>00757       <span class="keywordflow">continue</span>
<a name="l00758"></a>00758 
<a name="l00759"></a>00759       <span class="keywordflow">case</span> S.COMMENT_ENDED:
<a name="l00760"></a>00760         <span class="keywordflow">if</span> (c !== <span class="stringliteral">&quot;&gt;&quot;</span>) {
<a name="l00761"></a>00761           strictFail(parser, <span class="stringliteral">&quot;Malformed comment&quot;</span>)
<a name="l00762"></a>00762           <span class="comment">// allow &lt;!-- blah -- bloo --&gt; in non-strict mode,</span>
<a name="l00763"></a>00763           <span class="comment">// which is a comment of &quot; blah -- bloo &quot;</span>
<a name="l00764"></a>00764           parser.comment += &quot;--&quot; + c
<a name="l00765"></a>00765           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.COMMENT
<a name="l00766"></a>00766         } else parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00767"></a>00767       continue
<a name="l00768"></a>00768 
<a name="l00769"></a>00769       case S.CDATA:
<a name="l00770"></a>00770         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;]&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.CDATA_ENDING
<a name="l00771"></a>00771         else parser.cdata += c
<a name="l00772"></a>00772       continue
<a name="l00773"></a>00773 
<a name="l00774"></a>00774       case S.CDATA_ENDING:
<a name="l00775"></a>00775         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;]&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.CDATA_ENDING_2
<a name="l00776"></a>00776         else {
<a name="l00777"></a>00777           parser.cdata += <span class="stringliteral">&quot;]&quot;</span> + c
<a name="l00778"></a>00778           parser.state = S.CDATA
<a name="l00779"></a>00779         }
<a name="l00780"></a>00780       <span class="keywordflow">continue</span>
<a name="l00781"></a>00781 
<a name="l00782"></a>00782       <span class="keywordflow">case</span> S.CDATA_ENDING_2:
<a name="l00783"></a>00783         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;&gt;&quot;</span>) {
<a name="l00784"></a>00784           <span class="keywordflow">if</span> (parser.cdata) <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;oncdata&quot;</span>, parser.cdata)
<a name="l00785"></a>00785           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, &quot;onclosecdata&quot;)
<a name="l00786"></a>00786           parser.cdata = &quot;&quot;
<a name="l00787"></a>00787           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.TEXT
<a name="l00788"></a>00788         } else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;]&quot;) {
<a name="l00789"></a>00789           parser.cdata += <span class="stringliteral">&quot;]&quot;</span>
<a name="l00790"></a>00790         } <span class="keywordflow">else</span> {
<a name="l00791"></a>00791           parser.cdata += <span class="stringliteral">&quot;]]&quot;</span> + c
<a name="l00792"></a>00792           parser.state = S.CDATA
<a name="l00793"></a>00793         }
<a name="l00794"></a>00794       <span class="keywordflow">continue</span>
<a name="l00795"></a>00795 
<a name="l00796"></a>00796       <span class="keywordflow">case</span> S.PROC_INST:
<a name="l00797"></a>00797         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;?&quot;</span>) parser.state = S.PROC_INST_ENDING
<a name="l00798"></a>00798         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is(whitespace, c)) parser.state = S.PROC_INST_BODY
<a name="l00799"></a>00799         <span class="keywordflow">else</span> parser.procInstName += c
<a name="l00800"></a>00800       <span class="keywordflow">continue</span>
<a name="l00801"></a>00801 
<a name="l00802"></a>00802       <span class="keywordflow">case</span> S.PROC_INST_BODY:
<a name="l00803"></a>00803         <span class="keywordflow">if</span> (!parser.procInstBody &amp;&amp; is(whitespace, c)) <span class="keywordflow">continue</span>
<a name="l00804"></a>00804         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;?&quot;</span>) parser.state = S.PROC_INST_ENDING
<a name="l00805"></a>00805         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is(quote, c)) {
<a name="l00806"></a>00806           parser.state = S.PROC_INST_QUOTED
<a name="l00807"></a>00807           parser.q = c
<a name="l00808"></a>00808           parser.procInstBody += c
<a name="l00809"></a>00809         } <span class="keywordflow">else</span> parser.procInstBody += c
<a name="l00810"></a>00810       <span class="keywordflow">continue</span>
<a name="l00811"></a>00811 
<a name="l00812"></a>00812       <span class="keywordflow">case</span> S.PROC_INST_ENDING:
<a name="l00813"></a>00813         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;&gt;&quot;</span>) {
<a name="l00814"></a>00814           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, <span class="stringliteral">&quot;onprocessinginstruction&quot;</span>, {
<a name="l00815"></a>00815             name : parser.procInstName,
<a name="l00816"></a>00816             body : parser.procInstBody
<a name="l00817"></a>00817           })
<a name="l00818"></a>00818           parser.procInstName = parser.procInstBody = <span class="stringliteral">&quot;&quot;</span>
<a name="l00819"></a>00819           parser.state = S.TEXT
<a name="l00820"></a>00820         } <span class="keywordflow">else</span> {
<a name="l00821"></a>00821           parser.procInstBody += <span class="stringliteral">&quot;?&quot;</span> + c
<a name="l00822"></a>00822           parser.state = S.PROC_INST_BODY
<a name="l00823"></a>00823         }
<a name="l00824"></a>00824       <span class="keywordflow">continue</span>
<a name="l00825"></a>00825 
<a name="l00826"></a>00826       <span class="keywordflow">case</span> S.PROC_INST_QUOTED:
<a name="l00827"></a>00827         parser.procInstBody += c
<a name="l00828"></a>00828         <span class="keywordflow">if</span> (c === parser.q) {
<a name="l00829"></a>00829           parser.state = S.PROC_INST_BODY
<a name="l00830"></a>00830           parser.q = <span class="stringliteral">&quot;&quot;</span>
<a name="l00831"></a>00831         }
<a name="l00832"></a>00832       <span class="keywordflow">continue</span>
<a name="l00833"></a>00833 
<a name="l00834"></a>00834       <span class="keywordflow">case</span> S.OPEN_TAG:
<a name="l00835"></a>00835         <span class="keywordflow">if</span> (is(nameBody, c)) parser.tagName += c
<a name="l00836"></a>00836         <span class="keywordflow">else</span> {
<a name="l00837"></a>00837           newTag(parser)
<a name="l00838"></a>00838           <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;&gt;&quot;) openTag(parser)
<a name="l00839"></a>00839           else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;/&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.OPEN_TAG_SLASH
<a name="l00840"></a>00840           else {
<a name="l00841"></a>00841             <span class="keywordflow">if</span> (not(whitespace, c)) strictFail(
<a name="l00842"></a>00842               parser, <span class="stringliteral">&quot;Invalid character in tag name&quot;</span>)
<a name="l00843"></a>00843             parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB
<a name="l00844"></a>00844           }
<a name="l00845"></a>00845         }
<a name="l00846"></a>00846       continue
<a name="l00847"></a>00847 
<a name="l00848"></a>00848       case S.OPEN_TAG_SLASH:
<a name="l00849"></a>00849         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;&gt;&quot;) {
<a name="l00850"></a>00850           openTag(parser, <span class="keyword">true</span>)
<a name="l00851"></a>00851           closeTag(parser)
<a name="l00852"></a>00852         } else {
<a name="l00853"></a>00853           strictFail(parser, <span class="stringliteral">&quot;Forward-slash in opening tag not followed by &gt;&quot;</span>)
<a name="l00854"></a>00854           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB
<a name="l00855"></a>00855         }
<a name="l00856"></a>00856       continue
<a name="l00857"></a>00857 
<a name="l00858"></a>00858       case S.ATTRIB:
<a name="l00859"></a>00859         <span class="comment">// haven&#39;t read the attribute name yet.</span>
<a name="l00860"></a>00860         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(whitespace, c)) continue
<a name="l00861"></a>00861         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;&gt;&quot;) openTag(parser)
<a name="l00862"></a>00862         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;/&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.OPEN_TAG_SLASH
<a name="l00863"></a>00863         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(nameStart, c)) {
<a name="l00864"></a>00864           parser.attribName = c
<a name="l00865"></a>00865           parser.attribValue = <span class="stringliteral">&quot;&quot;</span>
<a name="l00866"></a>00866           parser.state = S.ATTRIB_NAME
<a name="l00867"></a>00867         } <span class="keywordflow">else</span> strictFail(parser, <span class="stringliteral">&quot;Invalid attribute name&quot;</span>)
<a name="l00868"></a>00868       continue
<a name="l00869"></a>00869 
<a name="l00870"></a>00870       case S.ATTRIB_NAME:
<a name="l00871"></a>00871         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;=&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB_VALUE
<a name="l00872"></a>00872         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(whitespace, c)) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB_NAME_SAW_WHITE
<a name="l00873"></a>00873         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(nameBody, c)) parser.attribName += c
<a name="l00874"></a>00874         else strictFail(parser, &quot;Invalid attribute name&quot;)
<a name="l00875"></a>00875       continue
<a name="l00876"></a>00876 
<a name="l00877"></a>00877       case S.ATTRIB_NAME_SAW_WHITE:
<a name="l00878"></a>00878         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;=&quot;) parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB_VALUE
<a name="l00879"></a>00879         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(whitespace, c)) continue
<a name="l00880"></a>00880         else {
<a name="l00881"></a>00881           strictFail(parser, <span class="stringliteral">&quot;Attribute without value&quot;</span>)
<a name="l00882"></a>00882           parser.tag.attributes[parser.attribName] = &quot;&quot;
<a name="l00883"></a>00883           parser.attribValue = &quot;&quot;
<a name="l00884"></a>00884           <a class="code" href="../../da/df2/namespacexml2dict.html#aa3d8b21c660c990b34e7bbcff414d529">emitNode</a>(parser, &quot;onattribute&quot;,
<a name="l00885"></a>00885                    { name : parser.attribName, value : <span class="stringliteral">&quot;&quot;</span> })
<a name="l00886"></a>00886           parser.attribName = <span class="stringliteral">&quot;&quot;</span>
<a name="l00887"></a>00887           <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === <span class="stringliteral">&quot;&gt;&quot;</span>) openTag(parser)
<a name="l00888"></a>00888           else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(nameStart, c)) {
<a name="l00889"></a>00889             parser.attribName = c
<a name="l00890"></a>00890             parser.state = S.ATTRIB_NAME
<a name="l00891"></a>00891           } <span class="keywordflow">else</span> {
<a name="l00892"></a>00892             strictFail(parser, <span class="stringliteral">&quot;Invalid attribute name&quot;</span>)
<a name="l00893"></a>00893             parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB
<a name="l00894"></a>00894           }
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896       continue
<a name="l00897"></a>00897 
<a name="l00898"></a>00898       case S.ATTRIB_VALUE:
<a name="l00899"></a>00899         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(whitespace, c)) continue
<a name="l00900"></a>00900         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(quote, c)) {
<a name="l00901"></a>00901           parser.q = c
<a name="l00902"></a>00902           parser.state = S.ATTRIB_VALUE_QUOTED
<a name="l00903"></a>00903         } <span class="keywordflow">else</span> {
<a name="l00904"></a>00904           strictFail(parser, <span class="stringliteral">&quot;Unquoted attribute value&quot;</span>)
<a name="l00905"></a>00905           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB_VALUE_UNQUOTED
<a name="l00906"></a>00906           parser.attribValue = c
<a name="l00907"></a>00907         }
<a name="l00908"></a>00908       continue
<a name="l00909"></a>00909 
<a name="l00910"></a>00910       case S.ATTRIB_VALUE_QUOTED:
<a name="l00911"></a>00911         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c !== parser.q) {
<a name="l00912"></a>00912           <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;&amp;&quot;</span>) parser.state = S.ATTRIB_VALUE_ENTITY_Q
<a name="l00913"></a>00913           <span class="keywordflow">else</span> parser.attribValue += c
<a name="l00914"></a>00914           <span class="keywordflow">continue</span>
<a name="l00915"></a>00915         }
<a name="l00916"></a>00916         attrib(parser)
<a name="l00917"></a>00917         parser.q = &quot;&quot;
<a name="l00918"></a>00918         parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB
<a name="l00919"></a>00919       continue
<a name="l00920"></a>00920 
<a name="l00921"></a>00921       case S.ATTRIB_VALUE_UNQUOTED:
<a name="l00922"></a>00922         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (not(attribEnd,c)) {
<a name="l00923"></a>00923           <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;&amp;&quot;</span>) parser.state = S.ATTRIB_VALUE_ENTITY_U
<a name="l00924"></a>00924           <span class="keywordflow">else</span> parser.attribValue += c
<a name="l00925"></a>00925           <span class="keywordflow">continue</span>
<a name="l00926"></a>00926         }
<a name="l00927"></a>00927         attrib(parser)
<a name="l00928"></a>00928         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;&gt;&quot;) openTag(parser)
<a name="l00929"></a>00929         else parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.ATTRIB
<a name="l00930"></a>00930       continue
<a name="l00931"></a>00931 
<a name="l00932"></a>00932       case S.CLOSE_TAG:
<a name="l00933"></a>00933         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (!parser.tagName) {
<a name="l00934"></a>00934           <span class="keywordflow">if</span> (is(whitespace, c)) <span class="keywordflow">continue</span>
<a name="l00935"></a>00935           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (not(nameStart, c)) strictFail(parser,
<a name="l00936"></a>00936             <span class="stringliteral">&quot;Invalid tagname in closing tag.&quot;</span>)
<a name="l00937"></a>00937           else parser.tagName = c
<a name="l00938"></a>00938         }
<a name="l00939"></a>00939         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;&gt;&quot;) closeTag(parser)
<a name="l00940"></a>00940         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(nameBody, c)) parser.tagName += c
<a name="l00941"></a>00941         else {
<a name="l00942"></a>00942           <span class="keywordflow">if</span> (not(whitespace, c)) strictFail(parser,
<a name="l00943"></a>00943             <span class="stringliteral">&quot;Invalid tagname in closing tag&quot;</span>)
<a name="l00944"></a>00944           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = S.CLOSE_TAG_SAW_WHITE
<a name="l00945"></a>00945         }
<a name="l00946"></a>00946       continue
<a name="l00947"></a>00947 
<a name="l00948"></a>00948       case S.CLOSE_TAG_SAW_WHITE:
<a name="l00949"></a>00949         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(whitespace, c)) continue
<a name="l00950"></a>00950         <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (c === &quot;&gt;&quot;) closeTag(parser)
<a name="l00951"></a>00951         else strictFail(&quot;Invalid characters in closing tag&quot;)
<a name="l00952"></a>00952       continue
<a name="l00953"></a>00953 
<a name="l00954"></a>00954       case S.TEXT_ENTITY:
<a name="l00955"></a>00955       case S.ATTRIB_VALUE_ENTITY_Q:
<a name="l00956"></a>00956       case S.ATTRIB_VALUE_ENTITY_U:
<a name="l00957"></a>00957         <a class="code" href="../../d5/d62/build__stage_2email_2shared_2style_2_r_e_a_d_m_e_8md.html#a6e4d98b7c4557bf9c2e3600f5f42a2f8">switch</a>(parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a>) {
<a name="l00958"></a>00958           <span class="keywordflow">case</span> S.TEXT_ENTITY:
<a name="l00959"></a>00959             var returnState = S.TEXT, <a class="code" href="../../d6/da5/libpinyin_8js.html#abd91b1aab0a10c5027ca2eb5577f759f">buffer</a> = <span class="stringliteral">&quot;textNode&quot;</span>
<a name="l00960"></a>00960           <span class="keywordflow">break</span>
<a name="l00961"></a>00961 
<a name="l00962"></a>00962           <span class="keywordflow">case</span> S.ATTRIB_VALUE_ENTITY_Q:
<a name="l00963"></a>00963             var returnState = S.ATTRIB_VALUE_QUOTED, <a class="code" href="../../d6/da5/libpinyin_8js.html#abd91b1aab0a10c5027ca2eb5577f759f">buffer</a> = <span class="stringliteral">&quot;attribValue&quot;</span>
<a name="l00964"></a>00964           <span class="keywordflow">break</span>
<a name="l00965"></a>00965 
<a name="l00966"></a>00966           <span class="keywordflow">case</span> S.ATTRIB_VALUE_ENTITY_U:
<a name="l00967"></a>00967             var returnState = S.ATTRIB_VALUE_UNQUOTED, <a class="code" href="../../d6/da5/libpinyin_8js.html#abd91b1aab0a10c5027ca2eb5577f759f">buffer</a> = <span class="stringliteral">&quot;attribValue&quot;</span>
<a name="l00968"></a>00968           <span class="keywordflow">break</span>
<a name="l00969"></a>00969         }
<a name="l00970"></a>00970         <span class="keywordflow">if</span> (c === <span class="stringliteral">&quot;;&quot;</span>) {
<a name="l00971"></a>00971           parser[<a class="code" href="../../d6/da5/libpinyin_8js.html#abd91b1aab0a10c5027ca2eb5577f759f">buffer</a>] += parseEntity(parser)
<a name="l00972"></a>00972           parser.entity = &quot;&quot;
<a name="l00973"></a>00973           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = returnState
<a name="l00974"></a>00974         }
<a name="l00975"></a>00975         else <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (is(entity, c)) parser.entity += c
<a name="l00976"></a>00976         else {
<a name="l00977"></a>00977           strictFail(<span class="stringliteral">&quot;Invalid character entity&quot;</span>)
<a name="l00978"></a>00978           parser[<a class="code" href="../../d6/da5/libpinyin_8js.html#abd91b1aab0a10c5027ca2eb5577f759f">buffer</a>] += &quot;&amp;&quot; + parser.entity + c
<a name="l00979"></a>00979           parser.entity = &quot;&quot;
<a name="l00980"></a>00980           parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a> = returnState
<a name="l00981"></a>00981         }
<a name="l00982"></a>00982       continue
<a name="l00983"></a>00983 
<a name="l00984"></a>00984       default:
<a name="l00985"></a>00985         throw new <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(parser, &quot;<a class="code" href="../../d8/d00/namespacemozilla_1_1gl.html#ab5b0d7a0e0b562dfa17e536a3e788071">Unknown</a> <a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a>: &quot; + parser.<a class="code" href="../../d2/d7d/jsapi_8h.html#afa45f986123242ddd418c959eb87e242">state</a>)
<a name="l00986"></a>00986     }
<a name="l00987"></a>00987   } <span class="comment">// while</span>
<a name="l00988"></a>00988   <span class="comment">// cdata blocks can get very big under normal conditions. emit and move on.</span>
<a name="l00989"></a>00989   <span class="comment">// if (parser.state === S.CDATA &amp;&amp; parser.cdata) {</span>
<a name="l00990"></a>00990   <span class="comment">//   emitNode(parser, &quot;oncdata&quot;, parser.cdata)</span>
<a name="l00991"></a>00991   <span class="comment">//   parser.cdata = &quot;&quot;</span>
<a name="l00992"></a>00992   <span class="comment">// }</span>
<a name="l00993"></a>00993   <a class="code" href="../../d6/d52/js_2browser_8js.html#a7321fd84345f4f9455f25996b932b8fd">if</a> (parser.<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#acd1cdae9d6d8493a6f34d308f8259f55">position</a> &gt;= parser.bufferCheckPosition) checkBufferLength(parser)
<a name="l00994"></a>00994   <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> parser
<a name="l00995"></a>00995 }
<a name="l00996"></a>00996 
<a name="l00997"></a>00997 })(<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a> <a class="code" href="../../d8/deb/test_2marionette_2lib_2browser_8js.html#aa4072ba4b6b56b0fb6f4801f17ab2b34">exports</a> === &quot;undefined&quot; ? <a class="code" href="../../d5/d09/apps_2email_2test_2integration_2_r_e_a_d_m_e_8md.html#ad995d7ecb156c0e4738ce089b58e2714">this</a>.sax = {} : <a class="code" href="../../d8/deb/test_2marionette_2lib_2browser_8js.html#aa4072ba4b6b56b0fb6f4801f17ab2b34">exports</a>)
<a name="l00998"></a>00998 
<a name="l00999"></a>00999 ;
<a name="l01000"></a>01000 <span class="comment">/* caldav.js - https://github.com/mozilla-b2g/caldav */</span>
<a name="l01001"></a>01001 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a5363025b2c2d773292f0f064aeb11f9e">global</a>, <a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>) {
<a name="l01002"></a>01002 
<a name="l01007"></a>01007   var paths = {};
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 
<a name="l01016"></a>01016   <span class="keyword">function</span> Exports(<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>) {
<a name="l01017"></a>01017     this.<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a> = <a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>;
<a name="l01018"></a>01018   }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020   Exports.prototype = {
<a name="l01021"></a>01021 
<a name="l01028"></a>01028     <span class="keyword">register</span>: <span class="keyword">function</span>(<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>, <a class="code" href="../../d5/d62/build__stage_2email_2shared_2style_2_r_e_a_d_m_e_8md.html#a3324c12c8fd4a56057ace952fd0d4bc5">object</a>) {
<a name="l01029"></a>01029       paths[<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>] = <a class="code" href="../../d5/d62/build__stage_2email_2shared_2style_2_r_e_a_d_m_e_8md.html#a3324c12c8fd4a56057ace952fd0d4bc5">object</a>;
<a name="l01030"></a>01030     },
<a name="l01031"></a>01031 
<a name="l01043"></a>01043     <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>: <span class="keyword">function</span> exportRequire(<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>) {
<a name="l01044"></a>01044       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l01045"></a>01045         <span class="keywordflow">return</span> <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;path&#39;</span>).<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(__dirname, <a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>));
<a name="l01046"></a>01046       } <span class="keywordflow">else</span> {
<a name="l01047"></a>01047         <span class="keywordflow">if</span> (<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a> in paths) {
<a name="l01048"></a>01048           <span class="keywordflow">return</span> paths[<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>];
<a name="l01049"></a>01049         } <span class="keywordflow">else</span> {
<a name="l01050"></a>01050           <span class="keywordflow">return</span> <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l01051"></a>01051         }
<a name="l01052"></a>01052       }
<a name="l01053"></a>01053     },
<a name="l01054"></a>01054 
<a name="l01058"></a>01058     <span class="keyword">set</span> <a class="code" href="../../d8/deb/test_2marionette_2lib_2browser_8js.html#aa4072ba4b6b56b0fb6f4801f17ab2b34">exports</a>(<a class="code" href="../../d7/d27/jpeglib_8h.html#abde23394a8cafaa525be2efd5c6d4b2e">val</a>) {
<a name="l01059"></a>01059       this.<span class="keyword">register</span>(this.<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>, <a class="code" href="../../d7/d27/jpeglib_8h.html#abde23394a8cafaa525be2efd5c6d4b2e">val</a>);
<a name="l01060"></a>01060     },
<a name="l01061"></a>01061 
<a name="l01062"></a>01062     <span class="keyword">get</span> <a class="code" href="../../d8/deb/test_2marionette_2lib_2browser_8js.html#aa4072ba4b6b56b0fb6f4801f17ab2b34">exports</a>() {
<a name="l01063"></a>01063       <span class="keywordflow">return</span> paths[this.<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>];
<a name="l01064"></a>01064     }
<a name="l01065"></a>01065   };
<a name="l01066"></a>01066 
<a name="l01078"></a>01078   <span class="keyword">function</span> <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>(<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>) {
<a name="l01079"></a>01079     <span class="keywordflow">return</span> <span class="keyword">new</span> Exports(<a class="code" href="../../db/d6d/mkdirp_8js.html#aa72e0c8a20e6bcc571d3a1c51846e627">path</a>);
<a name="l01080"></a>01080   }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082   <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>.register = Exports.prototype.register;
<a name="l01083"></a>01083   <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>.require = Exports.prototype.require;
<a name="l01084"></a>01084   <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>.exports = <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>;
<a name="l01085"></a>01085   <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>._paths = paths;
<a name="l01086"></a>01086 
<a name="l01098"></a>01098   <a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>.exports = <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>;
<a name="l01099"></a>01099 
<a name="l01106"></a>01106   <span class="keywordflow">if</span> (this.<a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>)
<a name="l01107"></a>01107     <a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>.Caldav = <a class="code" href="../../d6/da5/libpinyin_8js.html#a88683b64d84542943724ba0f211153af">Module</a>;
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 }(
<a name="l01110"></a>01110   <span class="keyword">this</span>,
<a name="l01111"></a>01111   (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>) === <span class="stringliteral">&#39;undefined&#39;</span>) ?
<a name="l01112"></a>01112     {} :
<a name="l01113"></a>01113     <a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>
<a name="l01114"></a>01114 ));
<a name="l01115"></a>01115 
<a name="l01119"></a><a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">01119</a> (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l01125"></a>01125   <span class="keyword">function</span> Responder(events) {
<a name="l01126"></a>01126     this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events = Object.create(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>);
<a name="l01127"></a>01127 
<a name="l01128"></a>01128     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(events) !== <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l01129"></a>01129       this.<a class="code" href="../../d8/d0d/transfer_8js.html#abd169909fbdd66534e2d19bf20938d8b">addEventListener</a>(events);
<a name="l01130"></a>01130     }
<a name="l01131"></a>01131   };
<a name="l01132"></a>01132 
<a name="l01141"></a>01141   Responder.stringify = <span class="keyword">function</span> <a class="code" href="../../d1/d22/ical_8js.html#a8076921037776baf4e4838660048f802">stringify</a>(command, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l01142"></a>01142     <span class="keywordflow">return</span> JSON.stringify([command, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>]);
<a name="l01143"></a>01143   };
<a name="l01144"></a>01144 
<a name="l01151"></a>01151   Responder.parse = <span class="keyword">function</span> <a class="code" href="../../d1/d22/ical_8js.html#a2c438207bb0df36648d3da7ccaac2441">parse</a>(json) {
<a name="l01152"></a>01152     var <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l01153"></a>01153     <span class="keywordflow">try</span> {
<a name="l01154"></a>01154       data = (json.forEach) ? json : JSON.parse(json);
<a name="l01155"></a>01155     } <span class="keywordflow">catch</span> (<a class="code" href="../../d1/d04/app__install__manager_8js.html#ab5902775854a8b8440bcd25e0fe1c120">e</a>) {
<a name="l01156"></a>01156       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&quot;Could not parse json: &#39;&quot;</span> + json + <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l01157"></a>01157     }
<a name="l01158"></a>01158 
<a name="l01159"></a>01159     <span class="keywordflow">return</span> {<span class="keyword">event</span>: data[0], data: data[1]};
<a name="l01160"></a>01160   };
<a name="l01161"></a>01161 
<a name="l01162"></a>01162   Responder.prototype = {
<a name="l01163"></a>01163     <a class="code" href="../../d1/d22/ical_8js.html#a2c438207bb0df36648d3da7ccaac2441">parse</a>: Responder.parse,
<a name="l01164"></a>01164     <a class="code" href="../../d1/d22/ical_8js.html#a8076921037776baf4e4838660048f802">stringify</a>: Responder.stringify,
<a name="l01165"></a>01165 
<a name="l01171"></a>01171     <a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l01172"></a>01172 
<a name="l01182"></a>01182     respond: <span class="keyword">function</span> respond(json) {
<a name="l01183"></a>01183       var <span class="keyword">event</span> = Responder.parse(json),
<a name="l01184"></a>01184           args = Array.prototype.slice.call(arguments).slice(1);
<a name="l01185"></a>01185 
<a name="l01186"></a>01186       args.unshift(<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>.data);
<a name="l01187"></a>01187       args.unshift(<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>.event);
<a name="l01188"></a>01188 
<a name="l01189"></a>01189       this.<a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>.apply(<span class="keyword">this</span>, args);
<a name="l01190"></a>01190 
<a name="l01191"></a>01191       <span class="keywordflow">return</span> <a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>;
<a name="l01192"></a>01192     },
<a name="l01193"></a>01193 
<a name="l01194"></a>01194     <span class="comment">//TODO: Extract event emitter logic</span>
<a name="l01195"></a>01195 
<a name="l01203"></a>01203     <a class="code" href="../../d8/d0d/transfer_8js.html#abd169909fbdd66534e2d19bf20938d8b">addEventListener</a>: <span class="keyword">function</span> <a class="code" href="../../d8/d0d/transfer_8js.html#abd169909fbdd66534e2d19bf20938d8b">addEventListener</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l01204"></a>01204       var <a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>;
<a name="l01205"></a>01205 
<a name="l01206"></a>01206       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) === <span class="stringliteral">&#39;undefined&#39;</span> &amp;&amp; <a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>) === <span class="stringliteral">&#39;object&#39;</span>) {
<a name="l01207"></a>01207         <span class="keywordflow">for</span> (event in <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>) {
<a name="l01208"></a>01208           <span class="keywordflow">if</span> (Object.hasOwnProperty.call(type, event)) {
<a name="l01209"></a>01209             this.<a class="code" href="../../d8/d0d/transfer_8js.html#abd169909fbdd66534e2d19bf20938d8b">addEventListener</a>(event, type[event]);
<a name="l01210"></a>01210           }
<a name="l01211"></a>01211         }
<a name="l01212"></a>01212 
<a name="l01213"></a>01213         <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l01214"></a>01214       }
<a name="l01215"></a>01215 
<a name="l01216"></a>01216       <span class="keywordflow">if</span> (!(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a> in this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events)) {
<a name="l01217"></a>01217         this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>] = [];
<a name="l01218"></a>01218       }
<a name="l01219"></a>01219 
<a name="l01220"></a>01220       this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>].push(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>);
<a name="l01221"></a>01221 
<a name="l01222"></a>01222       <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l01223"></a>01223     },
<a name="l01224"></a>01224 
<a name="l01233"></a>01233     <a class="code" href="../../de/dfc/events_8js.html#a801b0668ecf79a79c81f75dbbabb4ebf">once</a>: <span class="keyword">function</span> <a class="code" href="../../de/dfc/events_8js.html#a801b0668ecf79a79c81f75dbbabb4ebf">once</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l01234"></a>01234       var <span class="keyword">self</span> = <span class="keyword">this</span>;
<a name="l01235"></a>01235       <span class="keyword">function</span> onceCb() {
<a name="l01236"></a>01236         <span class="keyword">self</span>.removeEventListener(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, onceCb);
<a name="l01237"></a>01237         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>.apply(<span class="keyword">this</span>, arguments);
<a name="l01238"></a>01238       }
<a name="l01239"></a>01239 
<a name="l01240"></a>01240       this.<a class="code" href="../../d8/d0d/transfer_8js.html#abd169909fbdd66534e2d19bf20938d8b">addEventListener</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, onceCb);
<a name="l01241"></a>01241 
<a name="l01242"></a>01242       <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l01243"></a>01243     },
<a name="l01244"></a>01244 
<a name="l01254"></a>01254     <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>: <span class="keyword">function</span> <a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>() {
<a name="l01255"></a>01255       var args = Array.prototype.slice.call(arguments),
<a name="l01256"></a>01256           <span class="keyword">event</span> = args.shift(),
<a name="l01257"></a>01257           eventList,
<a name="l01258"></a>01258           <span class="keyword">self</span> = <span class="keyword">this</span>;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260       <span class="keywordflow">if</span> (<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a> in this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events) {
<a name="l01261"></a>01261         eventList = this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>];
<a name="l01262"></a>01262 
<a name="l01263"></a>01263         eventList.forEach(<span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l01264"></a>01264           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>.apply(<span class="keyword">self</span>, args);
<a name="l01265"></a>01265         });
<a name="l01266"></a>01266       }
<a name="l01267"></a>01267 
<a name="l01268"></a>01268       <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l01269"></a>01269     },
<a name="l01270"></a>01270 
<a name="l01277"></a>01277     removeAllEventListeners: <span class="keyword">function</span> removeAllEventListeners(name) {
<a name="l01278"></a>01278       <span class="keywordflow">if</span> (name in this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events) {
<a name="l01279"></a>01279         <span class="comment">//reuse array</span>
<a name="l01280"></a>01280         this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>].length = 0;
<a name="l01281"></a>01281       }
<a name="l01282"></a>01282 
<a name="l01283"></a>01283       <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l01284"></a>01284     },
<a name="l01285"></a>01285 
<a name="l01294"></a>01294     <a class="code" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>: <span class="keyword">function</span> <a class="code" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>(name, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l01295"></a>01295       var <a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>, <a class="code" href="../../d3/d91/j3d_8js.html#a3f87557d7488bfe7545844c394baa854">length</a>, events;
<a name="l01296"></a>01296 
<a name="l01297"></a>01297       <span class="keywordflow">if</span> (!(name in this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events)) {
<a name="l01298"></a>01298         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01299"></a>01299       }
<a name="l01300"></a>01300 
<a name="l01301"></a>01301       events = this.<a class="code" href="../../d6/d52/js_2browser_8js.html#a6e69a5af94d7d53886e51f89fb3bd6b4">_</a>$events[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>];
<a name="l01302"></a>01302 
<a name="l01303"></a>01303       <span class="keywordflow">for</span> (i = 0, length = events.length; i &lt; length; i++) {
<a name="l01304"></a>01304         <span class="keywordflow">if</span> (events[i] &amp;&amp; events[i] === <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l01305"></a>01305           events.splice(i, 1);
<a name="l01306"></a>01306           <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01307"></a>01307         }
<a name="l01308"></a>01308       }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01311"></a>01311     }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313   };
<a name="l01314"></a>01314 
<a name="l01315"></a>01315   Responder.prototype.on = Responder.prototype.addEventListener;
<a name="l01316"></a>01316   <a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>.exports = Responder;
<a name="l01317"></a>01317 
<a name="l01318"></a>01318 }.apply(
<a name="l01319"></a>01319   <span class="keyword">this</span>,
<a name="l01320"></a>01320   (this.Caldav) ?
<a name="l01321"></a>01321     [Caldav(<span class="stringliteral">&#39;responder&#39;</span>), Caldav] :
<a name="l01322"></a>01322     [<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l01323"></a>01323 ));
<a name="l01324"></a>01324 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l01325"></a>01325 
<a name="l01326"></a>01326   Errors = {};
<a name="l01327"></a>01327 
<a name="l01334"></a>01334   [
<a name="l01335"></a>01335     { symbol: <span class="stringliteral">&#39;Authentication&#39;</span>, name: <span class="stringliteral">&#39;authentication&#39;</span> },
<a name="l01336"></a>01336     { symbol: <span class="stringliteral">&#39;InvalidEntrypoint&#39;</span>, name: <span class="stringliteral">&#39;invalid-entrypoint&#39;</span> },
<a name="l01337"></a>01337     { symbol: <span class="stringliteral">&#39;ServerFailure&#39;</span>, name: <span class="stringliteral">&#39;server-failure&#39;</span> },
<a name="l01338"></a>01338     { symbol: <span class="stringliteral">&#39;Unknown&#39;</span>, name: <span class="stringliteral">&#39;unknown&#39;</span> }
<a name="l01339"></a>01339   ].forEach(<span class="keyword">function</span> createError(<a class="code" href="../../d2/d7d/jsapi_8h.html#a6d77125b32b2b42d84796493ad83a708">def</a>) {
<a name="l01340"></a>01340     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a2219cf9467e8547184b3cf2b051e8067">obj</a> = Errors[<a class="code" href="../../d2/d7d/jsapi_8h.html#a6d77125b32b2b42d84796493ad83a708">def</a>.symbol] = <span class="keyword">function</span>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#ad031ac2c2bcd5e0fe9c6b67fc309acd4">message</a>) {
<a name="l01341"></a>01341       this.message = <a class="code" href="../../d1/d04/app__install__manager_8js.html#ad031ac2c2bcd5e0fe9c6b67fc309acd4">message</a>;
<a name="l01342"></a>01342       this.name = <span class="stringliteral">&#39;caldav-&#39;</span> + <a class="code" href="../../d2/d7d/jsapi_8h.html#a6d77125b32b2b42d84796493ad83a708">def</a>.name;
<a name="l01343"></a>01343 
<a name="l01344"></a>01344       <span class="keywordflow">try</span> {
<a name="l01345"></a>01345         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>();
<a name="l01346"></a>01346       } <span class="keywordflow">catch</span> (<a class="code" href="../../d1/d04/app__install__manager_8js.html#ab5902775854a8b8440bcd25e0fe1c120">e</a>) {
<a name="l01347"></a>01347         this.<a class="code" href="../../d6/d1b/pprthred_8h.html#afe76c3c951fe40bd646fbf0b89cbcd17">stack</a> = <a class="code" href="../../d1/d04/app__install__manager_8js.html#ab5902775854a8b8440bcd25e0fe1c120">e</a>.stack;
<a name="l01348"></a>01348       }
<a name="l01349"></a>01349     };
<a name="l01350"></a>01350 
<a name="l01351"></a>01351     <span class="comment">// just so instanceof Error works</span>
<a name="l01352"></a>01352     obj.prototype = Object.create(<a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>.prototype);
<a name="l01353"></a>01353   });
<a name="l01354"></a>01354 
<a name="l01355"></a>01355   module.exports = Errors;
<a name="l01356"></a>01356 
<a name="l01357"></a>01357 }.apply(
<a name="l01358"></a>01358   <span class="keyword">this</span>,
<a name="l01359"></a>01359   (this.Caldav) ?
<a name="l01360"></a>01360     [Caldav(<span class="stringliteral">&#39;errors&#39;</span>), Caldav] :
<a name="l01361"></a>01361     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l01362"></a>01362 ));
<a name="l01363"></a>01363 
<a name="l01364"></a>01364 <span class="comment">// Copyright Joyent, Inc. and other Node contributors.</span>
<a name="l01365"></a>01365 <span class="comment">//</span>
<a name="l01366"></a>01366 <span class="comment">// Permission is hereby granted, free of charge, to any person obtaining a</span>
<a name="l01367"></a>01367 <span class="comment">// copy of this software and associated documentation files (the</span>
<a name="l01368"></a>01368 <span class="comment">// &quot;Software&quot;), to deal in the Software without restriction, including</span>
<a name="l01369"></a>01369 <span class="comment">// without limitation the rights to use, copy, modify, merge, publish,</span>
<a name="l01370"></a>01370 <span class="comment">// distribute, sublicense, and/or sell copies of the Software, and to permit</span>
<a name="l01371"></a>01371 <span class="comment">// persons to whom the Software is furnished to do so, subject to the</span>
<a name="l01372"></a>01372 <span class="comment">// following conditions:</span>
<a name="l01373"></a>01373 <span class="comment">//</span>
<a name="l01374"></a>01374 <span class="comment">// The above copyright notice and this permission notice shall be included</span>
<a name="l01375"></a>01375 <span class="comment">// in all copies or substantial portions of the Software.</span>
<a name="l01376"></a>01376 <span class="comment">//</span>
<a name="l01377"></a>01377 <span class="comment">// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS</span>
<a name="l01378"></a>01378 <span class="comment">// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<a name="l01379"></a>01379 <span class="comment">// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN</span>
<a name="l01380"></a>01380 <span class="comment">// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,</span>
<a name="l01381"></a>01381 <span class="comment">// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR</span>
<a name="l01382"></a>01382 <span class="comment">// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE</span>
<a name="l01383"></a>01383 <span class="comment">// USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<a name="l01384"></a>01384 
<a name="l01385"></a>01385 <span class="comment">// Query String Utilities</span>
<a name="l01386"></a>01386 
<a name="l01387"></a>01387 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l01388"></a>01388 
<a name="l01389"></a>01389   var <a class="code" href="../../da/d73/querystring_8js.html#a03f6f092188d5fa3903c412bce1e5e61">QueryString</a> = {};
<a name="l01390"></a>01390 
<a name="l01391"></a>01391   QueryString.escape = <span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#a176e0fe9a3e516f5aa501f9dcf2eb97b">str</a>) {
<a name="l01392"></a>01392     <span class="keywordflow">return</span> encodeURIComponent(str);
<a name="l01393"></a>01393   };
<a name="l01394"></a>01394 
<a name="l01395"></a>01395   var stringifyPrimitive = <span class="keyword">function</span>(<a class="code" href="../../db/db1/namespace_j_s_1_1detail.html#a5d38b5ed0e5a6c44c34f95302820c4d7">v</a>) {
<a name="l01396"></a>01396     <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a> <a class="code" href="../../db/db1/namespace_j_s_1_1detail.html#a5d38b5ed0e5a6c44c34f95302820c4d7">v</a>) {
<a name="l01397"></a>01397       <span class="keywordflow">case</span> <span class="stringliteral">&#39;string&#39;</span>:
<a name="l01398"></a>01398         <span class="keywordflow">return</span> <a class="code" href="../../db/db1/namespace_j_s_1_1detail.html#a5d38b5ed0e5a6c44c34f95302820c4d7">v</a>;
<a name="l01399"></a>01399 
<a name="l01400"></a>01400       <span class="keywordflow">case</span> <span class="stringliteral">&#39;boolean&#39;</span>:
<a name="l01401"></a>01401         <span class="keywordflow">return</span> v ? <span class="stringliteral">&#39;true&#39;</span> : <span class="stringliteral">&#39;false&#39;</span>;
<a name="l01402"></a>01402 
<a name="l01403"></a>01403       <span class="keywordflow">case</span> <span class="stringliteral">&#39;number&#39;</span>:
<a name="l01404"></a>01404         <span class="keywordflow">return</span> isFinite(v) ? v : <span class="stringliteral">&#39;&#39;</span>;
<a name="l01405"></a>01405 
<a name="l01406"></a>01406       <span class="keywordflow">default</span>:
<a name="l01407"></a>01407         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01408"></a>01408     }
<a name="l01409"></a>01409   };
<a name="l01410"></a>01410 
<a name="l01411"></a>01411 
<a name="l01412"></a>01412   QueryString.stringify = QueryString.encode = <span class="keyword">function</span>(<a class="code" href="../../d2/d7d/jsapi_8h.html#a2219cf9467e8547184b3cf2b051e8067">obj</a>, <a class="code" href="../../db/df4/geoloc_8js.html#aa75c75cf4d83cba5de758b2eb2442ecf">sep</a>, eq, <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>) {
<a name="l01413"></a>01413     sep = sep || <span class="charliteral">&#39;&amp;&#39;</span>;
<a name="l01414"></a>01414     eq = eq || <span class="charliteral">&#39;=&#39;</span>;
<a name="l01415"></a>01415     <span class="keywordflow">if</span> (obj === <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>) {
<a name="l01416"></a>01416       obj = undefined;
<a name="l01417"></a>01417     }
<a name="l01418"></a>01418 
<a name="l01419"></a>01419     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a> obj === <span class="stringliteral">&#39;object&#39;</span>) {
<a name="l01420"></a>01420       <span class="keywordflow">return</span> Object.keys(obj).map(<span class="keyword">function</span>(<a class="code" href="../../da/d7d/sylvester_8js.html#ae8667dd07a5b15efad1c9ed229e131da">k</a>) {
<a name="l01421"></a>01421         var <a class="code" href="../../dd/d9f/namespaceconv.html#a1aa0dd0649669f6981418a69cff03422">ks</a> = QueryString.escape(stringifyPrimitive(<a class="code" href="../../da/d7d/sylvester_8js.html#ae8667dd07a5b15efad1c9ed229e131da">k</a>)) + eq;
<a name="l01422"></a>01422         <span class="keywordflow">if</span> (Array.isArray(obj[<a class="code" href="../../da/d7d/sylvester_8js.html#ae8667dd07a5b15efad1c9ed229e131da">k</a>])) {
<a name="l01423"></a>01423           <span class="keywordflow">return</span> obj[<a class="code" href="../../da/d7d/sylvester_8js.html#ae8667dd07a5b15efad1c9ed229e131da">k</a>].map(<span class="keyword">function</span>(<a class="code" href="../../db/db1/namespace_j_s_1_1detail.html#a5d38b5ed0e5a6c44c34f95302820c4d7">v</a>) {
<a name="l01424"></a>01424             <span class="keywordflow">return</span> ks + QueryString.escape(stringifyPrimitive(<a class="code" href="../../db/db1/namespace_j_s_1_1detail.html#a5d38b5ed0e5a6c44c34f95302820c4d7">v</a>));
<a name="l01425"></a>01425           }).<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(sep);
<a name="l01426"></a>01426         } <span class="keywordflow">else</span> {
<a name="l01427"></a>01427           <span class="keywordflow">return</span> ks + QueryString.escape(stringifyPrimitive(obj[k]));
<a name="l01428"></a>01428         }
<a name="l01429"></a>01429       }).<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(sep);
<a name="l01430"></a>01430 
<a name="l01431"></a>01431     }
<a name="l01432"></a>01432 
<a name="l01433"></a>01433     <span class="keywordflow">if</span> (!name) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01434"></a>01434     <span class="keywordflow">return</span> QueryString.escape(stringifyPrimitive(name)) + eq +
<a name="l01435"></a>01435            QueryString.escape(stringifyPrimitive(obj));
<a name="l01436"></a>01436   };
<a name="l01437"></a>01437 
<a name="l01438"></a>01438   module.exports = <a class="code" href="../../da/d73/querystring_8js.html#a03f6f092188d5fa3903c412bce1e5e61">QueryString</a>;
<a name="l01439"></a>01439 
<a name="l01440"></a>01440 }.apply(
<a name="l01441"></a>01441   <span class="keyword">this</span>,
<a name="l01442"></a>01442   (this.Caldav) ?
<a name="l01443"></a>01443     [Caldav(<span class="stringliteral">&#39;querystring&#39;</span>), Caldav] :
<a name="l01444"></a>01444     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l01445"></a>01445 ));
<a name="l01446"></a>01446 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l01447"></a>01447 
<a name="l01448"></a>01448   var Responder = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;responder&#39;</span>);
<a name="l01449"></a>01449 
<a name="l01450"></a>01450   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l01451"></a>01451     Parser.sax = <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;sax&#39;</span>);
<a name="l01452"></a>01452   } <span class="keywordflow">else</span> {
<a name="l01453"></a>01453     Parser.sax = sax;
<a name="l01454"></a>01454   }
<a name="l01455"></a>01455 
<a name="l01461"></a>01461   <span class="keyword">function</span> Parser(baseHandler) {
<a name="l01462"></a>01462     var <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464     var events = [
<a name="l01465"></a>01465       <span class="stringliteral">&#39;ontext&#39;</span>,
<a name="l01466"></a>01466       <span class="stringliteral">&#39;onopentag&#39;</span>,
<a name="l01467"></a>01467       <span class="stringliteral">&#39;onclosetag&#39;</span>,
<a name="l01468"></a>01468       <span class="stringliteral">&#39;onerror&#39;</span>,
<a name="l01469"></a>01469       <span class="stringliteral">&#39;onend&#39;</span>
<a name="l01470"></a>01470     ];
<a name="l01471"></a>01471 
<a name="l01472"></a>01472     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(baseHandler) !== <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l01473"></a>01473       handler = baseHandler;
<a name="l01474"></a>01474     } <span class="keywordflow">else</span> {
<a name="l01475"></a>01475       handler = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/base&#39;</span>);
<a name="l01476"></a>01476     }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     this.<a class="code" href="../../d6/d1b/pprthred_8h.html#afe76c3c951fe40bd646fbf0b89cbcd17">stack</a> = [];
<a name="l01479"></a>01479     this.handles = {};
<a name="l01480"></a>01480     this._handlerStack = [];
<a name="l01481"></a>01481     this.tagStack = [];
<a name="l01482"></a>01482     this.<a class="code" href="../../d1/df9/apps_2email_2js_2ext_2mailapi_2activesync_2configurator_8js.html#a11a10a6834f3c54a5380f4ff04d002a9">root</a> = this.current = {};
<a name="l01483"></a>01483 
<a name="l01484"></a>01484     this.setHandler(handler);
<a name="l01485"></a>01485 
<a name="l01486"></a>01486     this._parse = Parser.sax.parser(<span class="keyword">true</span>, {
<a name="l01487"></a>01487       xmlns: <span class="keyword">true</span>,
<a name="l01488"></a>01488       <a class="code" href="../../d4/d23/binary__string__view_8js.html#ac7106a90f1d2ff063c3561a32c177ec0">trim</a>: <span class="keyword">true</span>,
<a name="l01489"></a>01489       <a class="code" href="../../d3/d91/j3d_8js.html#a367e17b01895f0e355d52621424e2f24">normalize</a>: <span class="keyword">false</span>,
<a name="l01490"></a>01490       lowercase: <span class="keyword">true</span>
<a name="l01491"></a>01491     });
<a name="l01492"></a>01492 
<a name="l01493"></a>01493     events.forEach(<span class="keyword">function</span>(<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>) {
<a name="l01494"></a>01494       this._parse[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>] = <span class="keyword">this</span>[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>].bind(<span class="keyword">this</span>);
<a name="l01495"></a>01495     }, <span class="keyword">this</span>);
<a name="l01496"></a>01496 
<a name="l01497"></a>01497     Responder.call(<span class="keyword">this</span>);
<a name="l01498"></a>01498   }
<a name="l01499"></a>01499 
<a name="l01500"></a>01500   Parser.prototype = {
<a name="l01501"></a>01501 
<a name="l01502"></a>01502     __proto__: Responder.prototype,
<a name="l01503"></a>01503 
<a name="l01511"></a>01511     setHandler: <span class="keyword">function</span>(<a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>, storeOriginal) {
<a name="l01512"></a>01512       <span class="keywordflow">if</span> (storeOriginal) {
<a name="l01513"></a>01513         this._handlerStack.push(this.handler);
<a name="l01514"></a>01514       }
<a name="l01515"></a>01515 
<a name="l01516"></a>01516       this.handler = <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l01517"></a>01517     },
<a name="l01518"></a>01518 
<a name="l01522"></a>01522     restoreHandler: <span class="keyword">function</span>() {
<a name="l01523"></a>01523       <span class="keywordflow">if</span> (this._handlerStack.length) {
<a name="l01524"></a>01524         this.handler = this._handlerStack.pop();
<a name="l01525"></a>01525       }
<a name="l01526"></a>01526     },
<a name="l01527"></a>01527 
<a name="l01537"></a>01537     registerHandler: <span class="keyword">function</span>(tag, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l01538"></a>01538       this.handles[tag] = <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l01539"></a>01539     },
<a name="l01540"></a>01540 
<a name="l01546"></a>01546     write: <span class="keyword">function</span>(chunk) {
<a name="l01547"></a>01547       <span class="keywordflow">return</span> this._parse.write(chunk);
<a name="l01548"></a>01548     },
<a name="l01549"></a>01549 
<a name="l01550"></a>01550     close: <span class="keyword">function</span>() {
<a name="l01551"></a>01551       this._parse.close();
<a name="l01552"></a>01552     },
<a name="l01553"></a>01553 
<a name="l01554"></a>01554     <span class="keyword">get</span> closed() {
<a name="l01555"></a>01555       <span class="keywordflow">return</span> this._parse.closed;
<a name="l01556"></a>01556     },
<a name="l01557"></a>01557 
<a name="l01563"></a>01563     getHandler: <span class="keyword">function</span>(tagSpec) {
<a name="l01564"></a>01564       var <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l01565"></a>01565       var handlers = this.handler.handles;
<a name="l01566"></a>01566 
<a name="l01567"></a>01567       <span class="keywordflow">if</span> (!handlers) {
<a name="l01568"></a>01568         handlers = this.handles;
<a name="l01569"></a>01569       }
<a name="l01570"></a>01570 
<a name="l01571"></a>01571       <span class="keywordflow">if</span> (tagSpec in handlers) {
<a name="l01572"></a>01572         handler = handlers[tagSpec];
<a name="l01573"></a>01573 
<a name="l01574"></a>01574         <span class="keywordflow">if</span> (handler !== this.handler) {
<a name="l01575"></a>01575           <span class="keywordflow">return</span> <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l01576"></a>01576         }
<a name="l01577"></a>01577       }
<a name="l01578"></a>01578 
<a name="l01579"></a>01579       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01580"></a>01580     },
<a name="l01581"></a>01581 
<a name="l01582"></a>01582     _fireHandler: <span class="keyword">function</span>(<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l01583"></a>01583       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(this.handler[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>]) === <span class="stringliteral">&#39;function&#39;</span>) {
<a name="l01584"></a>01584         this.handler[<a class="code" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>].call(<span class="keyword">this</span>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, this.handler);
<a name="l01585"></a>01585       }
<a name="l01586"></a>01586     },
<a name="l01587"></a>01587 
<a name="l01588"></a>01588     onopentag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l01589"></a>01589       var <a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>;
<a name="l01590"></a>01590       var stackData = {
<a name="l01591"></a>01591         local: <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.local,
<a name="l01592"></a>01592         name: <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.name
<a name="l01593"></a>01593       };
<a name="l01594"></a>01594 
<a name="l01595"></a>01595       <span class="comment">//build tagSpec for others to use.</span>
<a name="l01596"></a>01596       <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.tagSpec = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.uri + <span class="charliteral">&#39;/&#39;</span> + <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.local;
<a name="l01597"></a>01597 
<a name="l01598"></a>01598       <span class="comment">//add to stackData</span>
<a name="l01599"></a>01599       stackData.tagSpec = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.tagSpec;
<a name="l01600"></a>01600 
<a name="l01601"></a>01601       <span class="comment">//determine if we need to switch to another</span>
<a name="l01602"></a>01602       <span class="comment">//handler object.</span>
<a name="l01603"></a>01603       handle = this.getHandler(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>.tagSpec);
<a name="l01604"></a>01604 
<a name="l01605"></a>01605       <span class="keywordflow">if</span> (handle) {
<a name="l01606"></a>01606         <span class="comment">//switch to new handler object</span>
<a name="l01607"></a>01607         this.setHandler(handle, <span class="keyword">true</span>);
<a name="l01608"></a>01608         stackData.handler = <a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>;
<a name="l01609"></a>01609       }
<a name="l01610"></a>01610 
<a name="l01611"></a>01611       this.tagStack.push(stackData);
<a name="l01612"></a>01612       this._fireHandler(<span class="stringliteral">&#39;onopentag&#39;</span>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>);
<a name="l01613"></a>01613     },
<a name="l01614"></a>01614 
<a name="l01615"></a>01615     <span class="comment">//XXX: optimize later</span>
<a name="l01616"></a>01616     <span class="keyword">get</span> currentTag() {
<a name="l01617"></a>01617       <span class="keywordflow">return</span> this.tagStack[this.tagStack.length - 1];
<a name="l01618"></a>01618     },
<a name="l01619"></a>01619 
<a name="l01620"></a>01620     onclosetag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l01621"></a>01621       var <a class="code" href="../../d6/d1b/pprthred_8h.html#afe76c3c951fe40bd646fbf0b89cbcd17">stack</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l01622"></a>01622 
<a name="l01623"></a>01623       stack = this.currentTag;
<a name="l01624"></a>01624 
<a name="l01625"></a>01625       <span class="keywordflow">if</span> (stack.handler) {
<a name="l01626"></a>01626         <span class="comment">//fire oncomplete handler if available</span>
<a name="l01627"></a>01627         this._fireHandler(<span class="stringliteral">&#39;oncomplete&#39;</span>);
<a name="l01628"></a>01628       }
<a name="l01629"></a>01629 
<a name="l01630"></a>01630       <span class="comment">//fire the onclosetag event</span>
<a name="l01631"></a>01631       this._fireHandler(<span class="stringliteral">&#39;onclosetag&#39;</span>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>);
<a name="l01632"></a>01632 
<a name="l01633"></a>01633       <span class="keywordflow">if</span> (stack.handler) {
<a name="l01634"></a>01634         <span class="comment">//restore previous handler</span>
<a name="l01635"></a>01635         this.restoreHandler();
<a name="l01636"></a>01636       }
<a name="l01637"></a>01637 
<a name="l01638"></a>01638       <span class="comment">//actually remove the stack tag</span>
<a name="l01639"></a>01639       this.tagStack.pop();
<a name="l01640"></a>01640     },
<a name="l01641"></a>01641 
<a name="l01642"></a>01642     ontext: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l01643"></a>01643       this._fireHandler(<span class="stringliteral">&#39;ontext&#39;</span>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>);
<a name="l01644"></a>01644     },
<a name="l01645"></a>01645 
<a name="l01646"></a>01646     onerror: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l01647"></a>01647       <span class="comment">//TODO: XXX implement handling of parsing errors.</span>
<a name="l01648"></a>01648       <span class="comment">//unlikely but possible if server goes down</span>
<a name="l01649"></a>01649       <span class="comment">//or there is some authentication issue that</span>
<a name="l01650"></a>01650       <span class="comment">//we miss.</span>
<a name="l01651"></a>01651       this._fireHandler(<span class="stringliteral">&#39;onerror&#39;</span>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>);
<a name="l01652"></a>01652     },
<a name="l01653"></a>01653 
<a name="l01654"></a>01654     onend: <span class="keyword">function</span>() {
<a name="l01655"></a>01655       this._fireHandler(<span class="stringliteral">&#39;onend&#39;</span>, this.<a class="code" href="../../d1/df9/apps_2email_2js_2ext_2mailapi_2activesync_2configurator_8js.html#a11a10a6834f3c54a5380f4ff04d002a9">root</a>);
<a name="l01656"></a>01656     }
<a name="l01657"></a>01657   };
<a name="l01658"></a>01658 
<a name="l01659"></a>01659   module.exports = Parser;
<a name="l01660"></a>01660 
<a name="l01661"></a>01661 }.apply(
<a name="l01662"></a>01662   <span class="keyword">this</span>,
<a name="l01663"></a>01663   (this.Caldav) ?
<a name="l01664"></a>01664     [Caldav(<span class="stringliteral">&#39;sax&#39;</span>), Caldav] :
<a name="l01665"></a>01665     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l01666"></a>01666 ));
<a name="l01667"></a>01667 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l01668"></a>01668 
<a name="l01669"></a>01669   <span class="keyword">function</span> <a class="code" href="../../d6/d5f/build__stage_2email_2shared_2js_2template_8js.html#aab83dedcadf384ff4b12e9316e74d266">Template</a>(<a class="code" href="../../d1/df9/apps_2email_2js_2ext_2mailapi_2activesync_2configurator_8js.html#a11a10a6834f3c54a5380f4ff04d002a9">root</a>, rootAttrs) {
<a name="l01670"></a>01670     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(rootAttrs) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l01671"></a>01671       rootAttrs = {};
<a name="l01672"></a>01672     }
<a name="l01673"></a>01673 
<a name="l01674"></a>01674     this.rootTag = <a class="code" href="../../d1/df9/apps_2email_2js_2ext_2mailapi_2activesync_2configurator_8js.html#a11a10a6834f3c54a5380f4ff04d002a9">root</a>;
<a name="l01675"></a>01675     this.rootAttrs = rootAttrs;
<a name="l01676"></a>01676     this.activeNamespaces = {};
<a name="l01677"></a>01677   }
<a name="l01678"></a>01678 
<a name="l01679"></a>01679   <a class="code" href="../../d6/d5f/build__stage_2email_2shared_2js_2template_8js.html#aab83dedcadf384ff4b12e9316e74d266">Template</a>.prototype = {
<a name="l01680"></a>01680 
<a name="l01681"></a>01681     defaultNamespace: <span class="stringliteral">&#39;dav&#39;</span>,
<a name="l01682"></a>01682     doctype: <span class="stringliteral">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#39;</span>,
<a name="l01683"></a>01683 
<a name="l01684"></a>01684     _nsId: 0,
<a name="l01685"></a>01685 
<a name="l01686"></a>01686     xmlns: {
<a name="l01687"></a>01687       dav: <span class="stringliteral">&#39;DAV:&#39;</span>,
<a name="l01688"></a>01688       calserver: <span class="stringliteral">&#39;http://calendarserver.org/ns/&#39;</span>,
<a name="l01689"></a>01689       ical: <span class="stringliteral">&#39;http://apple.com/ns/ical/&#39;</span>,
<a name="l01690"></a>01690       <a class="code" href="../../d9/d42/caldav__worker_8js.html#aef73e4c20c2dc733b2714c15b203256d">caldav</a>: <span class="stringliteral">&#39;urn:ietf:params:xml:ns:caldav&#39;</span>
<a name="l01691"></a>01691     },
<a name="l01692"></a>01692 
<a name="l01693"></a>01693     <a class="code" href="../../de/df6/homescreen_2js_2page_8js.html#ae7817194480cfc900873938c8e7dd602">render</a>: <span class="keyword">function</span>(<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l01694"></a>01694       var <a class="code" href="../../df/d12/latin__test_8js.html#a34687689873d42dec2c94cc27f36e1e9">output</a> = this.doctype;
<a name="l01695"></a>01695       output += this.tag(this.rootTag, this.rootAttrs, <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>);
<a name="l01696"></a>01696 
<a name="l01697"></a>01697       <span class="keywordflow">return</span> <a class="code" href="../../df/d12/latin__test_8js.html#a34687689873d42dec2c94cc27f36e1e9">output</a>;
<a name="l01698"></a>01698     },
<a name="l01699"></a>01699 
<a name="l01707"></a>01707     _registerTag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>, tag) {
<a name="l01708"></a>01708       <span class="keywordflow">if</span> (<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> in this.xmlns) {
<a name="l01709"></a>01709         <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = this.xmlns[<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>];
<a name="l01710"></a>01710       }
<a name="l01711"></a>01711 
<a name="l01712"></a>01712       <span class="keywordflow">if</span> (<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> in this.activeNamespaces) {
<a name="l01713"></a>01713         <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = this.activeNamespaces[<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>];
<a name="l01714"></a>01714       } <span class="keywordflow">else</span> {
<a name="l01715"></a>01715         var alias = <span class="charliteral">&#39;N&#39;</span> + this._nsId++;
<a name="l01716"></a>01716         this.activeNamespaces[<a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>] = alias;
<a name="l01717"></a>01717         this.rootAttrs[<span class="stringliteral">&#39;xmlns:&#39;</span> + alias] = <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a>;
<a name="l01718"></a>01718         <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> = alias;
<a name="l01719"></a>01719       }
<a name="l01720"></a>01720 
<a name="l01721"></a>01721       <span class="keywordflow">return</span> <a class="code" href="../../d9/d04/expat_8h.html#ab9c3d990bb61927ef5406b25c41652ee">prefix</a> + <span class="charliteral">&#39;:&#39;</span> + tag;
<a name="l01722"></a>01722     },
<a name="l01723"></a>01723 
<a name="l01738"></a>01738     tag: <span class="keyword">function</span>(tagDesc, <a class="code" href="../../d2/d7d/jsapi_8h.html#a7f0be3e0a2eb197d2af05fa53b624612">attrs</a>, <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l01739"></a>01739 
<a name="l01740"></a>01740       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(attrs) === <span class="stringliteral">&#39;string&#39;</span>) {
<a name="l01741"></a>01741         <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a> = <a class="code" href="../../d2/d7d/jsapi_8h.html#a7f0be3e0a2eb197d2af05fa53b624612">attrs</a>;
<a name="l01742"></a>01742         attrs = {};
<a name="l01743"></a>01743       }
<a name="l01744"></a>01744 
<a name="l01745"></a>01745       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l01746"></a>01746         <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a> = <span class="keyword">false</span>;
<a name="l01747"></a>01747       }
<a name="l01748"></a>01748 
<a name="l01749"></a>01749       <span class="keywordflow">if</span> (attrs &amp;&amp; <a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(attrs.render) === <span class="stringliteral">&#39;function&#39;</span>) {
<a name="l01750"></a>01750         <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a> = attrs.render(<span class="keyword">this</span>);
<a name="l01751"></a>01751         attrs = {};
<a name="l01752"></a>01752       }
<a name="l01753"></a>01753 
<a name="l01754"></a>01754       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(tagDesc) === <span class="stringliteral">&#39;string&#39;</span>) {
<a name="l01755"></a>01755         tagDesc = [this.defaultNamespace, tagDesc];
<a name="l01756"></a>01756       }
<a name="l01757"></a>01757 
<a name="l01758"></a>01758       var fullTag = this._registerTag(tagDesc[0], tagDesc[1]);
<a name="l01759"></a>01759       var <a class="code" href="../../df/d12/latin__test_8js.html#a34687689873d42dec2c94cc27f36e1e9">output</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01760"></a>01760       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l01761"></a>01761 
<a name="l01762"></a>01762       output += <span class="charliteral">&#39;&lt;&#39;</span> + fullTag + <span class="stringliteral">&#39;&#39;</span>;
<a name="l01763"></a>01763 
<a name="l01764"></a>01764       <span class="keywordflow">for</span> (key in attrs) {
<a name="l01765"></a>01765         output += <span class="charliteral">&#39; &#39;</span> + key + <span class="stringliteral">&#39;=&quot;&#39;</span> + attrs[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] + <span class="charliteral">&#39;&quot;&#39;</span>;
<a name="l01766"></a>01766       }
<a name="l01767"></a>01767 
<a name="l01768"></a>01768       <span class="keywordflow">if</span> (<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l01769"></a>01769         output += <span class="charliteral">&#39;&gt;&#39;</span> + <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a> + <span class="stringliteral">&#39;&lt;/&#39;</span> + fullTag + <span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l01770"></a>01770       } <span class="keywordflow">else</span> {
<a name="l01771"></a>01771         output += <span class="stringliteral">&#39; /&gt;&#39;</span>;
<a name="l01772"></a>01772       }
<a name="l01773"></a>01773 
<a name="l01774"></a>01774       <span class="keywordflow">return</span> <a class="code" href="../../df/d12/latin__test_8js.html#a34687689873d42dec2c94cc27f36e1e9">output</a>;
<a name="l01775"></a>01775     }
<a name="l01776"></a>01776 
<a name="l01777"></a>01777   };
<a name="l01778"></a>01778 
<a name="l01779"></a>01779   module.exports = <a class="code" href="../../d6/d5f/build__stage_2email_2shared_2js_2template_8js.html#aab83dedcadf384ff4b12e9316e74d266">Template</a>;
<a name="l01780"></a>01780 
<a name="l01781"></a>01781 }.apply(
<a name="l01782"></a>01782   <span class="keyword">this</span>,
<a name="l01783"></a>01783   (this.Caldav) ?
<a name="l01784"></a>01784     [Caldav(<span class="stringliteral">&#39;template&#39;</span>), Caldav] :
<a name="l01785"></a>01785     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l01786"></a>01786 ));
<a name="l01790"></a>01790 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l01791"></a>01791   var <a class="code" href="../../d6/d5f/build__stage_2email_2shared_2js_2template_8js.html#aab83dedcadf384ff4b12e9316e74d266">Template</a> = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;template&#39;</span>);
<a name="l01792"></a>01792 
<a name="l01800"></a>01800   <span class="keyword">function</span> <a class="code" href="../../d0/dfb/namespacemozilla_1_1dom_1_1prototypes_1_1id.html#addcec93baff9084aadf2519231ea4a28a8be53c23beac95a245d8b7c3e0694116">Node</a>(builder, name, isProp) {
<a name="l01801"></a>01801     this.name = <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>;
<a name="l01802"></a>01802     this.builder = builder;
<a name="l01803"></a>01803     this.isProp = !!isProp;
<a name="l01804"></a>01804 
<a name="l01805"></a>01805     this.comps = Object.create(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>);
<a name="l01806"></a>01806     this.<a class="code" href="../../de/dc5/jsfriendapi_8h.html#a0c4e9efe1571ce3ef20a0baf42a47be9">props</a> = Object.create(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>);
<a name="l01807"></a>01807   }
<a name="l01808"></a>01808 
<a name="l01809"></a>01809   <a class="code" href="../../d0/dfb/namespacemozilla_1_1dom_1_1prototypes_1_1id.html#addcec93baff9084aadf2519231ea4a28a8be53c23beac95a245d8b7c3e0694116">Node</a>.prototype = {
<a name="l01810"></a>01810 
<a name="l01819"></a>01819     <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l01820"></a>01820 
<a name="l01826"></a>01826     appendString: <span class="keyword">function</span>(<a class="code" href="../../df/d9e/prnetdb_8h.html#aed1cfb225a5fb77461e7972691e68a72">string</a>) {
<a name="l01827"></a>01827       <span class="keywordflow">if</span> (!this.<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l01828"></a>01828         this.<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a> = [];
<a name="l01829"></a>01829       }
<a name="l01830"></a>01830 
<a name="l01831"></a>01831       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<span class="keywordtype">string</span>) !== <span class="stringliteral">&#39;string&#39;</span>) {
<a name="l01832"></a>01832         <span class="keywordtype">string</span> = <span class="keywordtype">string</span>.toString();
<a name="l01833"></a>01833       }
<a name="l01834"></a>01834 
<a name="l01835"></a>01835       this.<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>.push(<span class="keywordtype">string</span>);
<a name="l01836"></a>01836     },
<a name="l01837"></a>01837 
<a name="l01838"></a>01838     _timeRange: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l01839"></a>01839 
<a name="l01859"></a>01859     setTimeRange: <span class="keyword">function</span>(range) {
<a name="l01860"></a>01860       this._timeRange = range;
<a name="l01861"></a>01861     },
<a name="l01862"></a>01862 
<a name="l01867"></a>01867     removeProp: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>) {
<a name="l01868"></a>01868       <span class="keyword">delete</span> this.<a class="code" href="../../de/dc5/jsfriendapi_8h.html#a0c4e9efe1571ce3ef20a0baf42a47be9">props</a>[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>];
<a name="l01869"></a>01869     },
<a name="l01870"></a>01870 
<a name="l01876"></a>01876     removeComp: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>) {
<a name="l01877"></a>01877       <span class="keyword">delete</span> this.comps[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>];
<a name="l01878"></a>01878     },
<a name="l01879"></a>01879 
<a name="l01880"></a>01880     _addNodes: <span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, <a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a>) {
<a name="l01881"></a>01881       <span class="comment">// return value when is array</span>
<a name="l01882"></a>01882       var <a class="code" href="../../da/d7d/cook_8js.html#a65ab37df1aa3fe0eb3d8e51a835fb617">result</a> = <span class="keyword">this</span>;
<a name="l01883"></a>01883 
<a name="l01884"></a>01884       <span class="keywordflow">if</span> (!Array.isArray(<a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a>)) {
<a name="l01885"></a>01885         <span class="comment">// clear out the return value as we will</span>
<a name="l01886"></a>01886         <span class="comment">// now use the first node.</span>
<a name="l01887"></a>01887         result = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l01888"></a>01888       }
<a name="l01889"></a>01889 
<a name="l01890"></a>01890       <a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a> = (Array.isArray(<a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a>)) ? <a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a> : [<a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a>];
<a name="l01891"></a>01891 
<a name="l01892"></a>01892       var idx = 0;
<a name="l01893"></a>01893       var <a class="code" href="../../d9/d04/expat_8h.html#a5df20ff5bc70fb664abe3912796e90df">len</a> = <a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a>.length;
<a name="l01894"></a>01894       var <a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>;
<a name="l01895"></a>01895       var <a class="code" href="../../d1/d04/app__install__manager_8js.html#a9ed71aaefba3c241c5255080e6a99884">node</a>;
<a name="l01896"></a>01896 
<a name="l01897"></a>01897       <span class="keywordflow">for</span> (; idx &lt; <a class="code" href="../../d9/d04/expat_8h.html#a5df20ff5bc70fb664abe3912796e90df">len</a>; idx++) {
<a name="l01898"></a>01898         name = <a class="code" href="../../da/df2/namespacexml2dict.html#aaabd7336a42f36f8a79edd9e5fc821cf">nodes</a>[idx];
<a name="l01899"></a>01899         node = <span class="keyword">new</span> <a class="code" href="../../d0/dfb/namespacemozilla_1_1dom_1_1prototypes_1_1id.html#addcec93baff9084aadf2519231ea4a28a8be53c23beac95a245d8b7c3e0694116">Node</a>(this.builder, name, <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a> === <span class="stringliteral">&#39;props&#39;</span>);
<a name="l01900"></a>01900         <span class="keyword">this</span>[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>][<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>] = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a9ed71aaefba3c241c5255080e6a99884">node</a>;
<a name="l01901"></a>01901       }
<a name="l01902"></a>01902 
<a name="l01903"></a>01903       <span class="comment">// when we where not given an array of nodes</span>
<a name="l01904"></a>01904       <span class="comment">// assume we want one specific one so set that</span>
<a name="l01905"></a>01905       <span class="comment">// as the return value.</span>
<a name="l01906"></a>01906       <span class="keywordflow">if</span> (!result)
<a name="l01907"></a>01907         result = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a9ed71aaefba3c241c5255080e6a99884">node</a>;
<a name="l01908"></a>01908 
<a name="l01909"></a>01909       <span class="keywordflow">return</span> <a class="code" href="../../da/d7d/cook_8js.html#a65ab37df1aa3fe0eb3d8e51a835fb617">result</a>;
<a name="l01910"></a>01910     },
<a name="l01911"></a>01911 
<a name="l01920"></a>01920     prop: <span class="keyword">function</span>(prop) {
<a name="l01921"></a>01921       <span class="keywordflow">return</span> this._addNodes(<span class="stringliteral">&#39;props&#39;</span>, prop);
<a name="l01922"></a>01922     },
<a name="l01923"></a>01923 
<a name="l01932"></a>01932     comp: <span class="keyword">function</span>(comp) {
<a name="l01933"></a>01933       <span class="keywordflow">return</span> this._addNodes(<span class="stringliteral">&#39;comps&#39;</span>, comp);
<a name="l01934"></a>01934     },
<a name="l01935"></a>01935 
<a name="l01936"></a>01936     xmlAttributes: <span class="keyword">function</span>() {
<a name="l01937"></a>01937       <span class="keywordflow">return</span> { name: this.name };
<a name="l01938"></a>01938     },
<a name="l01939"></a>01939 
<a name="l01948"></a>01948     <a class="code" href="../../d4/d23/binary__string__view_8js.html#a64379212b203168995cd87810b47adbe">toString</a>: <span class="keyword">function</span>() {
<a name="l01949"></a>01949       var <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01950"></a>01950       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l01951"></a>01951       var <span class="keyword">template</span> = this.builder.template;
<a name="l01952"></a>01952 
<a name="l01953"></a>01953       <span class="keywordflow">if</span> (this._timeRange) {
<a name="l01954"></a>01954         content += <span class="keyword">template</span>.tag(
<a name="l01955"></a>01955           [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;time-range&#39;</span>],
<a name="l01956"></a>01956           this._timeRange
<a name="l01957"></a>01957         );
<a name="l01958"></a>01958       }
<a name="l01959"></a>01959 
<a name="l01960"></a>01960       <span class="comment">// render out children</span>
<a name="l01961"></a>01961       <span class="keywordflow">for</span> (key in this.<a class="code" href="../../de/dc5/jsfriendapi_8h.html#a0c4e9efe1571ce3ef20a0baf42a47be9">props</a>) {
<a name="l01962"></a>01962         content += this.props[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>].toString();
<a name="l01963"></a>01963       }
<a name="l01964"></a>01964 
<a name="l01965"></a>01965       <span class="keywordflow">for</span> (key in this.comps) {
<a name="l01966"></a>01966         content += this.comps[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>].toString();
<a name="l01967"></a>01967       }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969       <span class="keywordflow">if</span> (this.content) {
<a name="l01970"></a>01970         content += this.content.join(<span class="stringliteral">&#39;&#39;</span>);
<a name="l01971"></a>01971       }
<a name="l01972"></a>01972 
<a name="l01973"></a>01973       <span class="comment">// determine the tag name</span>
<a name="l01974"></a>01974       var tag;
<a name="l01975"></a>01975       <span class="keywordflow">if</span> (this.isProp) {
<a name="l01976"></a>01976         tag = this.builder.propTag;
<a name="l01977"></a>01977       } <span class="keywordflow">else</span> {
<a name="l01978"></a>01978         tag = this.builder.compTag;
<a name="l01979"></a>01979       }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981       <span class="comment">// build the xml element and return it.</span>
<a name="l01982"></a>01982       <span class="keywordflow">return</span> <span class="keyword">template</span>.tag(
<a name="l01983"></a>01983         tag,
<a name="l01984"></a>01984         this.xmlAttributes(),
<a name="l01985"></a>01985         content
<a name="l01986"></a>01986       );
<a name="l01987"></a>01987     }
<a name="l01988"></a>01988   };
<a name="l01989"></a>01989 
<a name="l02004"></a>02004   <span class="keyword">function</span> QueryBuilder(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>) {
<a name="l02005"></a>02005     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>)
<a name="l02006"></a>02006       <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a> = {};
<a name="l02007"></a>02007 
<a name="l02008"></a>02008     <span class="keywordflow">if</span> (!(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>.template instanceof Template)) {
<a name="l02009"></a>02009       <span class="keywordflow">throw</span> <span class="keyword">new</span> TypeError(
<a name="l02010"></a>02010         <span class="stringliteral">&#39;.template must be an instance&#39;</span> +
<a name="l02011"></a>02011         <span class="stringliteral">&#39; of Caldav.Template given &quot;&#39;</span> + <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>.template + <span class="charliteral">&#39;&quot;&#39;</span>
<a name="l02012"></a>02012       );
<a name="l02013"></a>02013     }
<a name="l02014"></a>02014 
<a name="l02015"></a>02015     <span class="keywordflow">for</span> (var key in <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>) {
<a name="l02016"></a>02016       <span class="keywordflow">if</span> (options.hasOwnProperty(key)) {
<a name="l02017"></a>02017         <span class="keyword">this</span>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02018"></a>02018       }
<a name="l02019"></a>02019     }
<a name="l02020"></a>02020   }
<a name="l02021"></a>02021 
<a name="l02022"></a>02022   QueryBuilder.prototype = {
<a name="l02023"></a>02023     tag: [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;calendar-data&#39;</span>],
<a name="l02024"></a>02024 
<a name="l02025"></a>02025     compTag: [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;comp&#39;</span>],
<a name="l02026"></a>02026 
<a name="l02027"></a>02027     propTag: [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;prop&#39;</span>],
<a name="l02028"></a>02028 
<a name="l02029"></a>02029     attributes: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02030"></a>02030 
<a name="l02031"></a>02031     _limitRecurrenceSet: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02032"></a>02032 
<a name="l02052"></a>02052     setRecurrenceSetLimit: <span class="keyword">function</span>(limit) {
<a name="l02053"></a>02053       this._limitRecurrenceSet = limit;
<a name="l02054"></a>02054     },
<a name="l02055"></a>02055 
<a name="l02060"></a>02060     setComp: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>) {
<a name="l02061"></a>02061       <span class="keywordflow">return</span> this._compRoot = <span class="keyword">new</span> <a class="code" href="../../d0/dfb/namespacemozilla_1_1dom_1_1prototypes_1_1id.html#addcec93baff9084aadf2519231ea4a28a8be53c23beac95a245d8b7c3e0694116">Node</a>(<span class="keyword">this</span>, name);
<a name="l02062"></a>02062     },
<a name="l02063"></a>02063 
<a name="l02067"></a>02067     getComp: <span class="keyword">function</span>() {
<a name="l02068"></a>02068       <span class="keywordflow">return</span> this._compRoot;
<a name="l02069"></a>02069     },
<a name="l02070"></a>02070 
<a name="l02071"></a>02071     <a class="code" href="../../d4/d23/binary__string__view_8js.html#a64379212b203168995cd87810b47adbe">toString</a>: <span class="keyword">function</span>() {
<a name="l02072"></a>02072       var content = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02073"></a>02073       var comp = this.getComp();
<a name="l02074"></a>02074 
<a name="l02075"></a>02075       <span class="keywordflow">if</span> (this._limitRecurrenceSet) {
<a name="l02076"></a>02076         content += this.<span class="keyword">template</span>.tag(
<a name="l02077"></a>02077           [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;limit-recurrence-set&#39;</span>],
<a name="l02078"></a>02078           this._limitRecurrenceSet
<a name="l02079"></a>02079         );
<a name="l02080"></a>02080       }
<a name="l02081"></a>02081 
<a name="l02082"></a>02082       <span class="keywordflow">if</span> (comp) {
<a name="l02083"></a>02083         content += comp.toString();
<a name="l02084"></a>02084       }
<a name="l02085"></a>02085 
<a name="l02086"></a>02086       <span class="keywordflow">return</span> this.<span class="keyword">template</span>.tag(
<a name="l02087"></a>02087         this.tag,
<a name="l02088"></a>02088         this.attributes,
<a name="l02089"></a>02089         content
<a name="l02090"></a>02090       );
<a name="l02091"></a>02091     }
<a name="l02092"></a>02092 
<a name="l02093"></a>02093   };
<a name="l02094"></a>02094 
<a name="l02095"></a>02095   QueryBuilder.Node = <a class="code" href="../../d0/dfb/namespacemozilla_1_1dom_1_1prototypes_1_1id.html#addcec93baff9084aadf2519231ea4a28a8be53c23beac95a245d8b7c3e0694116">Node</a>;
<a name="l02096"></a>02096   module.exports = QueryBuilder;
<a name="l02097"></a>02097 
<a name="l02098"></a>02098 }.apply(
<a name="l02099"></a>02099   <span class="keyword">this</span>,
<a name="l02100"></a>02100   (this.Caldav) ?
<a name="l02101"></a>02101     [Caldav(<span class="stringliteral">&#39;query_builder&#39;</span>), Caldav] :
<a name="l02102"></a>02102     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l02103"></a>02103 ));
<a name="l02104"></a>02104 
<a name="l02108"></a>02108 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02109"></a>02109   var <a class="code" href="../../db/da2/namespacejs.html#a57fe29ed5db728ac1d0dccca139555bd">Native</a>;
<a name="l02110"></a>02110   var Errors = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;errors&#39;</span>);
<a name="l02111"></a>02111 
<a name="l02112"></a>02112   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l02113"></a>02113     Native = <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;xmlhttprequest&#39;</span>).XMLHttpRequest;
<a name="l02114"></a>02114   } <span class="keywordflow">else</span> {
<a name="l02115"></a>02115     Native = <a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>.XMLHttpRequest;
<a name="l02116"></a>02116   }
<a name="l02117"></a>02117 
<a name="l02118"></a>02118   <span class="keyword">function</span> determineHttpStatusError(<a class="code" href="../../da/da1/communications_2contacts_2js_2utilities_2status_8js.html#a0818854fd36b9ae0fdfe5872464dae94">status</a>) {
<a name="l02119"></a>02119     var message = <span class="stringliteral">&#39;Cannot handle request due to server response&#39;</span>;
<a name="l02120"></a>02120     var err = <span class="stringliteral">&#39;Unknown&#39;</span>;
<a name="l02121"></a>02121 
<a name="l02122"></a>02122     <span class="keywordflow">if</span> (<a class="code" href="../../da/da1/communications_2contacts_2js_2utilities_2status_8js.html#a0818854fd36b9ae0fdfe5872464dae94">status</a> === 500)
<a name="l02123"></a>02123       err = <span class="stringliteral">&#39;ServerFailure&#39;</span>;
<a name="l02124"></a>02124 
<a name="l02125"></a>02125     <span class="keywordflow">if</span> (<a class="code" href="../../da/da1/communications_2contacts_2js_2utilities_2status_8js.html#a0818854fd36b9ae0fdfe5872464dae94">status</a> === 401)
<a name="l02126"></a>02126       err = <span class="stringliteral">&#39;Authentication&#39;</span>;
<a name="l02127"></a>02127 
<a name="l02128"></a>02128     <span class="keywordflow">return</span> <span class="keyword">new</span> Errors[err](<a class="code" href="../../d1/d04/app__install__manager_8js.html#ad031ac2c2bcd5e0fe9c6b67fc309acd4">message</a>);
<a name="l02129"></a>02129   }
<a name="l02130"></a>02130 
<a name="l02148"></a>02148   <span class="keyword">function</span> Xhr(options) {
<a name="l02149"></a>02149     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l02150"></a>02150     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l02151"></a>02151       options = {};
<a name="l02152"></a>02152     }
<a name="l02153"></a>02153 
<a name="l02154"></a>02154     <span class="keywordflow">for</span> (key in options) {
<a name="l02155"></a>02155       <span class="keywordflow">if</span> (Object.hasOwnProperty.call(options, key)) {
<a name="l02156"></a>02156         <span class="keyword">this</span>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02157"></a>02157       }
<a name="l02158"></a>02158     }
<a name="l02159"></a>02159   }
<a name="l02160"></a>02160 
<a name="l02161"></a>02161   Xhr.prototype = {
<a name="l02162"></a>02162     globalXhrOptions: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02163"></a>02163     xhrClass: <a class="code" href="../../db/da2/namespacejs.html#a57fe29ed5db728ac1d0dccca139555bd">Native</a>,
<a name="l02164"></a>02164     <a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02165"></a>02165     method: <span class="stringliteral">&#39;GET&#39;</span>,
<a name="l02166"></a>02166     async: <span class="keyword">true</span>,
<a name="l02167"></a>02167     waiting: <span class="keyword">false</span>,
<a name="l02168"></a>02168     <a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02169"></a>02169     password: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02170"></a>02170     <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02171"></a>02171     streaming: <span class="keyword">true</span>,
<a name="l02172"></a>02172     validateStatus: <span class="keyword">false</span>,
<a name="l02173"></a>02173 
<a name="l02174"></a>02174     <a class="code" href="../../da/d32/prio_8h.html#ae514094796205f27cbccab72be2e8826">headers</a>: {},
<a name="l02175"></a>02175     <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02176"></a>02176 
<a name="l02177"></a>02177     _serialize: <span class="keyword">function</span> _serialize() {
<a name="l02178"></a>02178       <span class="keywordflow">return</span> this.<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l02179"></a>02179     },
<a name="l02180"></a>02180 
<a name="l02186"></a>02186     _credentials: <span class="keyword">function</span>(<a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>, pass) {
<a name="l02187"></a>02187       <span class="comment">// this code should never run in nodejs.</span>
<a name="l02188"></a>02188       <span class="keywordflow">return</span> <span class="stringliteral">&#39;Basic &#39;</span> + <a class="code" href="../../dd/d64/apps_2email_2js_2ext_2mailapi_2worker-bootstrap_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>.btoa(
<a name="l02189"></a>02189         <a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a> + <span class="charliteral">&#39;:&#39;</span> + pass
<a name="l02190"></a>02190       );
<a name="l02191"></a>02191     },
<a name="l02192"></a>02192 
<a name="l02197"></a>02197     <a class="code" href="../../d6/da5/libpinyin_8js.html#a14987c2daddbcdc724afc8b8c0492b85">abort</a>: <span class="keyword">function</span>(<a class="code" href="../../d2/d7d/jsapi_8h.html#a9c0cec265243907d0da86b92bda26eca">cb</a>) {
<a name="l02198"></a>02198       <span class="keywordflow">if</span> (this.waiting) {
<a name="l02199"></a>02199         this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>.abort();
<a name="l02200"></a>02200         this.waiting = <span class="keyword">false</span>;
<a name="l02201"></a>02201       }
<a name="l02202"></a>02202 
<a name="l02203"></a>02203       <span class="keywordflow">if</span> (<a class="code" href="../../d2/d7d/jsapi_8h.html#a9c0cec265243907d0da86b92bda26eca">cb</a> !== undefined) {
<a name="l02204"></a>02204         <a class="code" href="../../d2/d7d/jsapi_8h.html#a9c0cec265243907d0da86b92bda26eca">cb</a>();
<a name="l02205"></a>02205       }
<a name="l02206"></a>02206     },
<a name="l02207"></a>02207 
<a name="l02208"></a>02208    _buildXHR: <span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02209"></a>02209       var <a class="code" href="../../d8/dbd/namespaceheader.html#aa5b53e6fddfb0e2e76fa4f5cf837317b">header</a>;
<a name="l02210"></a>02210 
<a name="l02211"></a>02211       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l02212"></a>02212         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a> = this.<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>;
<a name="l02213"></a>02213       }
<a name="l02214"></a>02214 
<a name="l02215"></a>02215       this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a> = <span class="keyword">new</span> this.xhrClass(
<a name="l02216"></a>02216           this.globalXhrOptions ? this.globalXhrOptions : undefined);
<a name="l02217"></a>02217 
<a name="l02218"></a>02218       <span class="comment">// This hack is in place due to some platform</span>
<a name="l02219"></a>02219       <span class="comment">// bug in gecko when using mozSystem xhr</span>
<a name="l02220"></a>02220       <span class="comment">// the credentials only seem to work as expected</span>
<a name="l02221"></a>02221       <span class="comment">// when constructing them manually.</span>
<a name="l02222"></a>02222       <span class="keywordflow">if</span> (!this.globalXhrOptions || !this.globalXhrOptions.mozSystem) {
<a name="l02223"></a>02223         this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>.open(
<a name="l02224"></a>02224             this.method, this.<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, this.async, this.<a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>, this.password);
<a name="l02225"></a>02225       } <span class="keywordflow">else</span> {
<a name="l02226"></a>02226         this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>.open(this.method, this.<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, this.async);
<a name="l02227"></a>02227         this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>.setRequestHeader(<span class="stringliteral">&#39;Authorization&#39;</span>, this._credentials(
<a name="l02228"></a>02228           this.<a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>,
<a name="l02229"></a>02229           this.password
<a name="l02230"></a>02230         ));
<a name="l02231"></a>02231       }
<a name="l02232"></a>02232 
<a name="l02233"></a>02233       var useMozChunkedText = <span class="keyword">false</span>;
<a name="l02234"></a>02234       <span class="keywordflow">if</span> (
<a name="l02235"></a>02235         this.streaming &amp;&amp;
<a name="l02236"></a>02236         this.globalXhrOptions &amp;&amp;
<a name="l02237"></a>02237         this.globalXhrOptions.useMozChunkedText
<a name="l02238"></a>02238       ) {
<a name="l02239"></a>02239         useMozChunkedText = <span class="keyword">true</span>;
<a name="l02240"></a>02240         this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>.responseType = <span class="stringliteral">&#39;moz-chunked-text&#39;</span>;
<a name="l02241"></a>02241       }
<a name="l02242"></a>02242 
<a name="l02243"></a>02243       <span class="keywordflow">for</span> (header in this.<a class="code" href="../../da/d32/prio_8h.html#ae514094796205f27cbccab72be2e8826">headers</a>) {
<a name="l02244"></a>02244         <span class="keywordflow">if</span> (Object.hasOwnProperty.call(<span class="keyword">this</span>.headers, header)) {
<a name="l02245"></a>02245           this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>.setRequestHeader(header, this.headers[header]);
<a name="l02246"></a>02246         }
<a name="l02247"></a>02247       }
<a name="l02248"></a>02248 
<a name="l02249"></a>02249 
<a name="l02250"></a>02250       var hasProgressEvents = <span class="keyword">false</span>;
<a name="l02251"></a>02251 
<a name="l02252"></a>02252       <span class="comment">// check for progress event support.</span>
<a name="l02253"></a>02253       <span class="keywordflow">if</span> (this.streaming) {
<a name="l02254"></a>02254         <span class="keywordflow">if</span> (<span class="stringliteral">&#39;onprogress&#39;</span> in this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>) {
<a name="l02255"></a>02255           hasProgressEvents = <span class="keyword">true</span>;
<a name="l02256"></a>02256           var last = 0;
<a name="l02257"></a>02257 
<a name="l02258"></a>02258           <span class="keywordflow">if</span> (useMozChunkedText) {
<a name="l02259"></a>02259             this.xhr.onprogress = (<span class="keyword">function</span> onChunkedProgress(event) {
<a name="l02260"></a>02260               <span class="keywordflow">if</span> (this.ondata) {
<a name="l02261"></a>02261                 this.ondata(this.xhr.responseText);
<a name="l02262"></a>02262               }
<a name="l02263"></a>02263             }.bind(<span class="keyword">this</span>));
<a name="l02264"></a>02264           } <span class="keywordflow">else</span> {
<a name="l02265"></a>02265             this.xhr.onprogress = (<span class="keyword">function</span> onProgress(event) {
<a name="l02266"></a>02266               var chunk = this.xhr.responseText.substr(last, event.loaded);
<a name="l02267"></a>02267               last = event.loaded;
<a name="l02268"></a>02268               <span class="keywordflow">if</span> (this.ondata) {
<a name="l02269"></a>02269                 this.ondata(chunk);
<a name="l02270"></a>02270               }
<a name="l02271"></a>02271             }.bind(<span class="keyword">this</span>));
<a name="l02272"></a>02272           }
<a name="l02273"></a>02273         }
<a name="l02274"></a>02274       }
<a name="l02275"></a>02275 
<a name="l02276"></a>02276       this.xhr.onreadystatechange = (<span class="keyword">function</span> onReadyStateChange() {
<a name="l02277"></a>02277         var <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l02278"></a>02278         <span class="keywordflow">if</span> (this.xhr.readyState === 4) {
<a name="l02279"></a>02279           data = this.xhr.responseText;
<a name="l02280"></a>02280 
<a name="l02281"></a>02281           <span class="comment">// emulate progress events for node...</span>
<a name="l02282"></a>02282           <span class="comment">// this really lame we should probably just</span>
<a name="l02283"></a>02283           <span class="comment">// use a real http request for node but this</span>
<a name="l02284"></a>02284           <span class="comment">// will let us do some testing via node for now.</span>
<a name="l02285"></a>02285           <span class="keywordflow">if</span> (!hasProgressEvents &amp;&amp; this.ondata) {
<a name="l02286"></a>02286             this.ondata(data);
<a name="l02287"></a>02287           }
<a name="l02288"></a>02288 
<a name="l02289"></a>02289           this.waiting = <span class="keyword">false</span>;
<a name="l02290"></a>02290 
<a name="l02291"></a>02291           <span class="keywordflow">if</span> (
<a name="l02292"></a>02292             !this.validateStatus ||
<a name="l02293"></a>02293             (
<a name="l02294"></a>02294               this.xhr.status &gt; 199 &amp;&amp;
<a name="l02295"></a>02295               <span class="keyword">this</span>.xhr.status &lt; 300
<a name="l02296"></a>02296             )
<a name="l02297"></a>02297           ) {
<a name="l02298"></a>02298             <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, this.xhr);
<a name="l02299"></a>02299           }
<a name="l02300"></a>02300 
<a name="l02301"></a>02301           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(determineHttpStatusError(this.xhr.status), <span class="keyword">this</span>.xhr);
<a name="l02302"></a>02302         }
<a name="l02303"></a>02303       }.bind(<span class="keyword">this</span>));
<a name="l02304"></a>02304 
<a name="l02305"></a>02305       this.waiting = <span class="keyword">true</span>;
<a name="l02306"></a>02306       <span class="keywordflow">return</span> this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>;
<a name="l02307"></a>02307     },
<a name="l02308"></a>02308 
<a name="l02314"></a>02314     <a class="code" href="../../df/d65/openaudio_8js.html#a4379e0d0aa0995d904faac29a324b51b">send</a>: <span class="keyword">function</span> <a class="code" href="../../df/d65/openaudio_8js.html#a4379e0d0aa0995d904faac29a324b51b">send</a>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02315"></a>02315       var xhr = this._buildXHR(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>);
<a name="l02316"></a>02316       xhr.send(this._serialize());
<a name="l02317"></a>02317       <span class="keywordflow">return</span> <a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>;
<a name="l02318"></a>02318     }
<a name="l02319"></a>02319   };
<a name="l02320"></a>02320 
<a name="l02321"></a>02321   module.exports = Xhr;
<a name="l02322"></a>02322 
<a name="l02323"></a>02323 }.apply(
<a name="l02324"></a>02324   <span class="keyword">this</span>,
<a name="l02325"></a>02325   (this.Caldav) ?
<a name="l02326"></a>02326     [Caldav(<span class="stringliteral">&#39;xhr&#39;</span>), Caldav] :
<a name="l02327"></a>02327     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l02328"></a>02328 ));
<a name="l02329"></a>02329 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02330"></a>02330 
<a name="l02331"></a>02331   var XHR = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l02332"></a>02332   var QueryString = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;querystring&#39;</span>);
<a name="l02333"></a>02333 
<a name="l02334"></a>02334   var REQUIRED_CREDENTIALS = [
<a name="l02335"></a>02335     <span class="stringliteral">&#39;client_secret&#39;</span>,
<a name="l02336"></a>02336     <span class="stringliteral">&#39;client_id&#39;</span>,
<a name="l02337"></a>02337     <span class="stringliteral">&#39;redirect_uri&#39;</span>,
<a name="l02338"></a>02338     <span class="stringliteral">&#39;url&#39;</span>
<a name="l02339"></a>02339   ];
<a name="l02340"></a>02340 
<a name="l02348"></a>02348   <span class="keyword">function</span> formatResponse(resp) {
<a name="l02349"></a>02349     resp = JSON.parse(resp);
<a name="l02350"></a>02350 
<a name="l02351"></a>02351     <span class="comment">// replace the oauth details</span>
<a name="l02352"></a>02352     <span class="keywordflow">if</span> (resp.access_token) {
<a name="l02353"></a>02353       resp.issued_at = Date.now();
<a name="l02354"></a>02354     }
<a name="l02355"></a>02355 
<a name="l02356"></a>02356     <span class="keywordflow">return</span> resp;
<a name="l02357"></a>02357   }
<a name="l02358"></a>02358 
<a name="l02362"></a>02362   <span class="keyword">function</span> sendRequest(xhr, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02363"></a>02363     <span class="keywordflow">return</span> xhr.send(<span class="keyword">function</span>(err, <a class="code" href="../../df/d44/permission__manager_8js.html#ad9abb423164fcb98d6ad9333893e4682">request</a>) {
<a name="l02364"></a>02364       <span class="keywordflow">if</span> (err) {
<a name="l02365"></a>02365         <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l02366"></a>02366       }
<a name="l02367"></a>02367 
<a name="l02368"></a>02368       var <a class="code" href="../../da/d7d/cook_8js.html#a65ab37df1aa3fe0eb3d8e51a835fb617">result</a>;
<a name="l02369"></a>02369       <span class="keywordflow">try</span> {
<a name="l02370"></a>02370         result = formatResponse(<a class="code" href="../../df/d44/permission__manager_8js.html#ad9abb423164fcb98d6ad9333893e4682">request</a>.responseText);
<a name="l02371"></a>02371       } <span class="keywordflow">catch</span> (<a class="code" href="../../d1/d04/app__install__manager_8js.html#ab5902775854a8b8440bcd25e0fe1c120">e</a>) {
<a name="l02372"></a>02372         err = <a class="code" href="../../d1/d04/app__install__manager_8js.html#ab5902775854a8b8440bcd25e0fe1c120">e</a>;
<a name="l02373"></a>02373       }
<a name="l02374"></a>02374 
<a name="l02375"></a>02375       <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err, result, <a class="code" href="../../df/d44/permission__manager_8js.html#ad9abb423164fcb98d6ad9333893e4682">request</a>);
<a name="l02376"></a>02376     });
<a name="l02377"></a>02377   }
<a name="l02378"></a>02378 
<a name="l02387"></a>02387   <span class="keyword">function</span> post(<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, requestData, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02388"></a>02388     var xhr = <span class="keyword">new</span> XHR({
<a name="l02389"></a>02389       <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>: <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>,
<a name="l02390"></a>02390       headers: { <span class="stringliteral">&#39;Content-Type&#39;</span>: <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span> },
<a name="l02391"></a>02391       data: QueryString.stringify(requestData),
<a name="l02392"></a>02392       method: <span class="stringliteral">&#39;POST&#39;</span>,
<a name="l02393"></a>02393       streaming: <span class="keyword">false</span>
<a name="l02394"></a>02394     });
<a name="l02395"></a>02395 
<a name="l02396"></a>02396     <span class="keywordflow">return</span> sendRequest(xhr, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>);
<a name="l02397"></a>02397   }
<a name="l02398"></a>02398 
<a name="l02420"></a>02420   <span class="keyword">function</span> <a class="code" href="../../db/d0b/showcase__apps_2twittershare_2js_2ext_2oauth_8js.html#a2b39e97b7403b3ed1a91dc547c12525c">OAuth</a>(credentials) {
<a name="l02421"></a>02421     this.apiCredentials = {};
<a name="l02422"></a>02422 
<a name="l02423"></a>02423     <span class="keywordflow">for</span> (var key in credentials) {
<a name="l02424"></a>02424       this.apiCredentials[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = credentials[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02425"></a>02425     }
<a name="l02426"></a>02426 
<a name="l02427"></a>02427     REQUIRED_CREDENTIALS.forEach(<span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>) {
<a name="l02428"></a>02428       <span class="keywordflow">if</span> (!(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a> in this.apiCredentials)) {
<a name="l02429"></a>02429         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;.apiCredentials.&#39;</span> + <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a> + <span class="stringliteral">&#39; : must be available.&#39;</span>);
<a name="l02430"></a>02430       }
<a name="l02431"></a>02431     }, <span class="keyword">this</span>);
<a name="l02432"></a>02432   }
<a name="l02433"></a>02433 
<a name="l02434"></a>02434   <a class="code" href="../../db/d0b/showcase__apps_2twittershare_2js_2ext_2oauth_8js.html#a2b39e97b7403b3ed1a91dc547c12525c">OAuth</a>.prototype = {
<a name="l02435"></a>02435 
<a name="l02448"></a>02448     apiCredentials: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02449"></a>02449 
<a name="l02463"></a>02463     _requestUserInfo: <span class="keyword">function</span>(oauth, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02464"></a>02464       var apiCredentials = this.apiCredentials;
<a name="l02465"></a>02465       var <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a> = apiCredentials.user_info.url;
<a name="l02466"></a>02466       var field = apiCredentials.user_info.field;
<a name="l02467"></a>02467       var authorization = oauth.token_type + <span class="charliteral">&#39; &#39;</span> + oauth.access_token;
<a name="l02468"></a>02468 
<a name="l02469"></a>02469       var xhr = <span class="keyword">new</span> XHR({
<a name="l02470"></a>02470         headers: {
<a name="l02471"></a>02471           Authorization: authorization
<a name="l02472"></a>02472         },
<a name="l02473"></a>02473         url: <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>,
<a name="l02474"></a>02474         streaming: <span class="keyword">false</span>
<a name="l02475"></a>02475       });
<a name="l02476"></a>02476 
<a name="l02477"></a>02477       sendRequest(xhr, <span class="keyword">function</span>(err, json) {
<a name="l02478"></a>02478         <span class="keywordflow">if</span> (err) {
<a name="l02479"></a>02479           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l02480"></a>02480         }
<a name="l02481"></a>02481 
<a name="l02482"></a>02482         <span class="comment">/* json is an object so this should not explode */</span>
<a name="l02483"></a>02483         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err, json[field]);
<a name="l02484"></a>02484       });
<a name="l02485"></a>02485     },
<a name="l02486"></a>02486 
<a name="l02491"></a>02491     authenticateCode: <span class="keyword">function</span>(<a class="code" href="../../d3/d4b/lockscreen_8js.html#a3bc1c2f8ec4ed34fc21f9f10eacbfa93">code</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02492"></a>02492       var apiCredentials = this.apiCredentials;
<a name="l02493"></a>02493 
<a name="l02494"></a>02494       <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d4b/lockscreen_8js.html#a3bc1c2f8ec4ed34fc21f9f10eacbfa93">code</a>) {
<a name="l02495"></a>02495         <span class="keywordflow">return</span> <a class="code" href="../../da/da1/timers_8js.html#a619d004395c481cc1032f1c3747a04b9">setTimeout</a>(<span class="keyword">function</span>() {
<a name="l02496"></a>02496           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;code must be given&#39;</span>));
<a name="l02497"></a>02497         });
<a name="l02498"></a>02498       }
<a name="l02499"></a>02499 
<a name="l02500"></a>02500       var <span class="keyword">self</span> = <span class="keyword">this</span>;
<a name="l02501"></a>02501       <span class="keyword">function</span> handleResponse(err, result) {
<a name="l02502"></a>02502         <span class="keywordflow">if</span> (err) {
<a name="l02503"></a>02503           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l02504"></a>02504         }
<a name="l02505"></a>02505 
<a name="l02506"></a>02506         <span class="keywordflow">if</span> (!apiCredentials.user_info) {
<a name="l02507"></a>02507           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, result);
<a name="l02508"></a>02508         }
<a name="l02509"></a>02509 
<a name="l02510"></a>02510         <span class="comment">// attempt fetching user details</span>
<a name="l02511"></a>02511         <span class="keyword">self</span>._requestUserInfo(result, <span class="keyword">function</span>(err, <a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>) {
<a name="l02512"></a>02512           <span class="keywordflow">if</span> (err) {
<a name="l02513"></a>02513             <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l02514"></a>02514           }
<a name="l02515"></a>02515           result.user = <a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>;
<a name="l02516"></a>02516           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, result);
<a name="l02517"></a>02517         });
<a name="l02518"></a>02518       }
<a name="l02519"></a>02519 
<a name="l02520"></a>02520       <span class="keywordflow">return</span> post(
<a name="l02521"></a>02521         apiCredentials.url,
<a name="l02522"></a>02522         {
<a name="l02523"></a>02523           <a class="code" href="../../d3/d4b/lockscreen_8js.html#a3bc1c2f8ec4ed34fc21f9f10eacbfa93">code</a>: <a class="code" href="../../d3/d4b/lockscreen_8js.html#a3bc1c2f8ec4ed34fc21f9f10eacbfa93">code</a>,
<a name="l02524"></a>02524           client_id: apiCredentials.client_id,
<a name="l02525"></a>02525           client_secret: apiCredentials.client_secret,
<a name="l02526"></a>02526           redirect_uri: apiCredentials.redirect_uri,
<a name="l02527"></a>02527           grant_type: <span class="stringliteral">&#39;authorization_code&#39;</span>
<a name="l02528"></a>02528         },
<a name="l02529"></a>02529         handleResponse
<a name="l02530"></a>02530       );
<a name="l02531"></a>02531     },
<a name="l02532"></a>02532 
<a name="l02539"></a>02539     refreshToken: <span class="keyword">function</span>(refreshToken, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02540"></a>02540       var apiCredentials = this.apiCredentials;
<a name="l02541"></a>02541 
<a name="l02542"></a>02542       <span class="keywordflow">if</span> (!refreshToken) {
<a name="l02543"></a>02543         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;invalid refresh token given: &quot;&#39;</span> + refreshToken + <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l02544"></a>02544       }
<a name="l02545"></a>02545 
<a name="l02546"></a>02546       <span class="keywordflow">return</span> post(
<a name="l02547"></a>02547         apiCredentials.url,
<a name="l02548"></a>02548         {
<a name="l02549"></a>02549           refresh_token: refreshToken,
<a name="l02550"></a>02550           client_id: apiCredentials.client_id,
<a name="l02551"></a>02551           client_secret: apiCredentials.client_secret,
<a name="l02552"></a>02552           grant_type: <span class="stringliteral">&#39;refresh_token&#39;</span>
<a name="l02553"></a>02553         },
<a name="l02554"></a>02554         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>
<a name="l02555"></a>02555       );
<a name="l02556"></a>02556     },
<a name="l02557"></a>02557 
<a name="l02565"></a>02565     accessTokenValid: <span class="keyword">function</span>(oauth) {
<a name="l02566"></a>02566       <span class="keywordflow">return</span> !!(
<a name="l02567"></a>02567         oauth &amp;&amp;
<a name="l02568"></a>02568         oauth.access_token &amp;&amp;
<a name="l02569"></a>02569         oauth.expires_in &amp;&amp;
<a name="l02570"></a>02570         oauth.issued_at &amp;&amp;
<a name="l02571"></a>02571         (Date.now() &lt; (oauth.issued_at + oauth.expires_in))
<a name="l02572"></a>02572       );
<a name="l02573"></a>02573     }
<a name="l02574"></a>02574 
<a name="l02575"></a>02575   };
<a name="l02576"></a>02576 
<a name="l02577"></a>02577 
<a name="l02578"></a>02578   module.exports = <a class="code" href="../../db/d0b/showcase__apps_2twittershare_2js_2ext_2oauth_8js.html#a2b39e97b7403b3ed1a91dc547c12525c">OAuth</a>;
<a name="l02579"></a>02579 
<a name="l02580"></a>02580 }.apply(
<a name="l02581"></a>02581   <span class="keyword">this</span>,
<a name="l02582"></a>02582   (this.Caldav) ?
<a name="l02583"></a>02583     [Caldav(<span class="stringliteral">&#39;oauth2&#39;</span>), Caldav] :
<a name="l02584"></a>02584     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l02585"></a>02585 ));
<a name="l02586"></a>02586 
<a name="l02587"></a>02587 
<a name="l02588"></a>02588 
<a name="l02589"></a>02589 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02590"></a>02590 
<a name="l02591"></a>02591   var XHR = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l02592"></a>02592 
<a name="l02593"></a>02593   <span class="keyword">function</span> BasicAuth(connection, options) {
<a name="l02594"></a>02594     <span class="comment">// create a clone of options</span>
<a name="l02595"></a>02595     var <a class="code" href="../../d3/d91/j3d_8js.html#a069c41f2a736def4f0798a9765e2e332">clone</a> = Object.create(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>);
<a name="l02596"></a>02596 
<a name="l02597"></a>02597     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) !== <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l02598"></a>02598       <span class="keywordflow">for</span> (var key in options) {
<a name="l02599"></a>02599         clone[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02600"></a>02600       }
<a name="l02601"></a>02601     }
<a name="l02602"></a>02602 
<a name="l02603"></a>02603     clone.password = connection.password || clone.password;
<a name="l02604"></a>02604     clone.user = connection.user || clone.user;
<a name="l02605"></a>02605 
<a name="l02606"></a>02606     XHR.call(<span class="keyword">this</span>, clone);
<a name="l02607"></a>02607   }
<a name="l02608"></a>02608 
<a name="l02609"></a>02609   BasicAuth.prototype = {
<a name="l02610"></a>02610     __proto__: XHR.prototype,
<a name="l02611"></a>02611     validateStatus: <span class="keyword">true</span>
<a name="l02612"></a>02612   };
<a name="l02613"></a>02613 
<a name="l02614"></a>02614 
<a name="l02615"></a>02615   module.exports = BasicAuth;
<a name="l02616"></a>02616 
<a name="l02617"></a>02617 }.apply(
<a name="l02618"></a>02618   <span class="keyword">this</span>,
<a name="l02619"></a>02619   (this.Caldav) ?
<a name="l02620"></a>02620     [Caldav(<span class="stringliteral">&#39;http/basic_auth&#39;</span>), Caldav] :
<a name="l02621"></a>02621     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l02622"></a>02622 ));
<a name="l02623"></a>02623 
<a name="l02624"></a>02624 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02625"></a>02625 
<a name="l02626"></a>02626   var XHR = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l02627"></a>02627   var QueryString = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;querystring&#39;</span>);
<a name="l02628"></a>02628   var Connection = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;connection&#39;</span>);
<a name="l02629"></a>02629   var <a class="code" href="../../db/d0b/showcase__apps_2twittershare_2js_2ext_2oauth_8js.html#a2b39e97b7403b3ed1a91dc547c12525c">OAuth</a> = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;oauth2&#39;</span>);
<a name="l02630"></a>02630 
<a name="l02638"></a>02638   <span class="keyword">function</span> Oauth2(connection, options) {
<a name="l02639"></a>02639     <span class="keywordflow">if</span> (
<a name="l02640"></a>02640       !connection ||
<a name="l02641"></a>02641       !connection.oauth ||
<a name="l02642"></a>02642       (
<a name="l02643"></a>02643         !connection.oauth.code &amp;&amp;
<a name="l02644"></a>02644         !connection.oauth.refresh_token
<a name="l02645"></a>02645       )
<a name="l02646"></a>02646     ) {
<a name="l02647"></a>02647       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;connection .oauth must have code or refresh_token&#39;</span>);
<a name="l02648"></a>02648     }
<a name="l02649"></a>02649 
<a name="l02650"></a>02650     this.connection = connection;
<a name="l02651"></a>02651 
<a name="l02652"></a>02652     this.oauth =
<a name="l02653"></a>02653       <span class="keyword">new</span> <a class="code" href="../../db/d0b/showcase__apps_2twittershare_2js_2ext_2oauth_8js.html#a2b39e97b7403b3ed1a91dc547c12525c">OAuth</a>(connection.apiCredentials);
<a name="l02654"></a>02654 
<a name="l02655"></a>02655     <span class="comment">// create a clone of options</span>
<a name="l02656"></a>02656     var clone = Object.create(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>);
<a name="l02657"></a>02657 
<a name="l02658"></a>02658     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) !== <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l02659"></a>02659       <span class="keywordflow">for</span> (var key in options) {
<a name="l02660"></a>02660         clone[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02661"></a>02661       }
<a name="l02662"></a>02662     }
<a name="l02663"></a>02663 
<a name="l02664"></a>02664     XHR.call(<span class="keyword">this</span>, clone);
<a name="l02665"></a>02665   }
<a name="l02666"></a>02666 
<a name="l02667"></a>02667   Oauth2.prototype = {
<a name="l02668"></a>02668     __proto__: XHR.prototype,
<a name="l02669"></a>02669 
<a name="l02670"></a>02670     validateStatus: <span class="keyword">true</span>,
<a name="l02671"></a>02671 
<a name="l02672"></a>02672     _sendXHR: <span class="keyword">function</span>(<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>) {
<a name="l02673"></a>02673       xhr.setRequestHeader(
<a name="l02674"></a>02674         <span class="stringliteral">&#39;Authorization&#39;</span>, <span class="stringliteral">&#39;Bearer &#39;</span> + this.connection.oauth.access_token
<a name="l02675"></a>02675       );
<a name="l02676"></a>02676 
<a name="l02677"></a>02677       xhr.send(this._serialize());
<a name="l02678"></a>02678       <span class="keywordflow">return</span> <a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>;
<a name="l02679"></a>02679     },
<a name="l02680"></a>02680 
<a name="l02681"></a>02681     _updateConnection: <span class="keyword">function</span>(credentials) {
<a name="l02682"></a>02682       var oauth = this.connection.oauth;
<a name="l02683"></a>02683       var <a class="code" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> = { oauth: credentials };
<a name="l02684"></a>02684 
<a name="l02685"></a>02685       <span class="keywordflow">if</span> (oauth.refresh_token &amp;&amp; !credentials.refresh_token)
<a name="l02686"></a>02686         credentials.refresh_token = oauth.refresh_token;
<a name="l02687"></a>02687 
<a name="l02688"></a>02688       <span class="keywordflow">if</span> (credentials.user) {
<a name="l02689"></a>02689         update.user = credentials.user;
<a name="l02690"></a>02690         <span class="keyword">delete</span> credentials.user;
<a name="l02691"></a>02691       }
<a name="l02692"></a>02692 
<a name="l02693"></a>02693       <span class="keywordflow">return</span> this.connection.update(update);
<a name="l02694"></a>02694     },
<a name="l02695"></a>02695 
<a name="l02696"></a>02696     <a class="code" href="../../df/d65/openaudio_8js.html#a4379e0d0aa0995d904faac29a324b51b">send</a>: <span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l02697"></a>02697       var xhr = this._buildXHR(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>);
<a name="l02698"></a>02698       var oauth = this.connection.oauth;
<a name="l02699"></a>02699 
<a name="l02700"></a>02700       <span class="comment">// everything is fine just send</span>
<a name="l02701"></a>02701       <span class="keywordflow">if</span> (this.oauth.accessTokenValid(oauth)) {
<a name="l02702"></a>02702         <span class="keywordflow">return</span> this._sendXHR(xhr);
<a name="l02703"></a>02703       }
<a name="l02704"></a>02704 
<a name="l02705"></a>02705       var handleTokenUpdates = (<span class="keyword">function</span> handleTokenUpdates(err, credentials) {
<a name="l02706"></a>02706         <span class="keywordflow">if</span> (err) {
<a name="l02707"></a>02707           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l02708"></a>02708         }
<a name="l02709"></a>02709         this._updateConnection(credentials);
<a name="l02710"></a>02710         <span class="keywordflow">return</span> this._sendXHR(xhr);
<a name="l02711"></a>02711       }.bind(<span class="keyword">this</span>));
<a name="l02712"></a>02712 
<a name="l02713"></a>02713       <span class="keywordflow">if</span> (oauth.code) {
<a name="l02714"></a>02714         this.oauth.authenticateCode(oauth.code, handleTokenUpdates);
<a name="l02715"></a>02715 
<a name="l02716"></a>02716         <span class="comment">// it should be impossible to have both code and refresh_token</span>
<a name="l02717"></a>02717         <span class="comment">// but we return as a guard</span>
<a name="l02718"></a>02718         <span class="keywordflow">return</span> <a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>;
<a name="l02719"></a>02719       }
<a name="l02720"></a>02720 
<a name="l02721"></a>02721       <span class="keywordflow">if</span> (oauth.refresh_token) {
<a name="l02722"></a>02722         this.oauth.refreshToken(oauth.refresh_token, handleTokenUpdates);
<a name="l02723"></a>02723         <span class="keywordflow">return</span> <a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>;
<a name="l02724"></a>02724       }
<a name="l02725"></a>02725     }
<a name="l02726"></a>02726 
<a name="l02727"></a>02727   };
<a name="l02728"></a>02728 
<a name="l02729"></a>02729 
<a name="l02730"></a>02730   module.exports = Oauth2;
<a name="l02731"></a>02731 
<a name="l02732"></a>02732 }.apply(
<a name="l02733"></a>02733   <span class="keyword">this</span>,
<a name="l02734"></a>02734   (this.Caldav) ?
<a name="l02735"></a>02735     [Caldav(<span class="stringliteral">&#39;http/oauth2&#39;</span>), Caldav] :
<a name="l02736"></a>02736     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l02737"></a>02737 ));
<a name="l02738"></a>02738 
<a name="l02739"></a>02739 
<a name="l02740"></a>02740 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02741"></a>02741 
<a name="l02742"></a>02742   var XHR = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l02743"></a>02743 
<a name="l02751"></a>02751   <span class="keyword">function</span> Connection(options) {
<a name="l02752"></a>02752     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l02753"></a>02753       options = {};
<a name="l02754"></a>02754     }
<a name="l02755"></a>02755 
<a name="l02756"></a>02756     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l02757"></a>02757 
<a name="l02758"></a>02758     <span class="keywordflow">for</span> (key in options) {
<a name="l02759"></a>02759       <span class="keywordflow">if</span> (Object.hasOwnProperty.call(options, key)) {
<a name="l02760"></a>02760         <span class="keyword">this</span>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02761"></a>02761       }
<a name="l02762"></a>02762     }
<a name="l02763"></a>02763 
<a name="l02764"></a>02764     var domain = options.domain;
<a name="l02765"></a>02765 
<a name="l02766"></a>02766     <span class="keywordflow">if</span> (domain) {
<a name="l02767"></a>02767       <span class="keywordflow">if</span> (domain.substr(-1) === <span class="charliteral">&#39;/&#39;</span>) {
<a name="l02768"></a>02768         this.domain = domain.substr(0, domain.length - 1);
<a name="l02769"></a>02769       }
<a name="l02770"></a>02770     }
<a name="l02771"></a>02771 
<a name="l02772"></a>02772     var httpHandler = this.httpHandler || <span class="stringliteral">&#39;basic_auth&#39;</span>;
<a name="l02773"></a>02773     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(httpHandler) !== <span class="stringliteral">&#39;object&#39;</span>) {
<a name="l02774"></a>02774       this.httpHandler = Caldav.require(<span class="stringliteral">&#39;http/&#39;</span> + httpHandler);
<a name="l02775"></a>02775     }
<a name="l02776"></a>02776   }
<a name="l02777"></a>02777 
<a name="l02778"></a>02778   Connection.prototype = {
<a name="l02782"></a>02782     <a class="code" href="../../de/d8f/jsdebug_8h.html#ad8babe1ecde8f9f6d224a06ea1a99480">user</a>: <span class="stringliteral">&#39;&#39;</span>,
<a name="l02783"></a>02783 
<a name="l02787"></a>02787     password: <span class="stringliteral">&#39;&#39;</span>,
<a name="l02788"></a>02788 
<a name="l02792"></a>02792     domain: <span class="stringliteral">&#39;&#39;</span>,
<a name="l02793"></a>02793 
<a name="l02800"></a>02800     <a class="code" href="../../df/d44/permission__manager_8js.html#ad9abb423164fcb98d6ad9333893e4682">request</a>: <span class="keyword">function</span>(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>) {
<a name="l02801"></a>02801       <span class="keywordflow">if</span> (options) {
<a name="l02802"></a>02802         <span class="keywordflow">if</span> (options.url &amp;&amp; options.url.indexOf(<span class="stringliteral">&#39;http&#39;</span>) !== 0) {
<a name="l02803"></a>02803           var url = options.url;
<a name="l02804"></a>02804           <span class="keywordflow">if</span> (url.substr(0, 1) !== <span class="charliteral">&#39;/&#39;</span>) {
<a name="l02805"></a>02805             url = <span class="charliteral">&#39;/&#39;</span> + <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>;
<a name="l02806"></a>02806           }
<a name="l02807"></a>02807           options.url = this.domain + <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>;
<a name="l02808"></a>02808         }
<a name="l02809"></a>02809       }
<a name="l02810"></a>02810 
<a name="l02811"></a>02811       <span class="keywordflow">return</span> <span class="keyword">new</span> this.httpHandler(<span class="keyword">this</span>, options);
<a name="l02812"></a>02812     },
<a name="l02813"></a>02813 
<a name="l02829"></a>02829     update: <span class="keyword">function</span>(newProperties) {
<a name="l02830"></a>02830       <span class="keywordflow">if</span> (newProperties) {
<a name="l02831"></a>02831         <span class="keywordflow">for</span> (var key in newProperties) {
<a name="l02832"></a>02832           <span class="keywordflow">if</span> (Object.prototype.hasOwnProperty.call(newProperties, key)) {
<a name="l02833"></a>02833             <span class="keyword">this</span>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = newProperties[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02834"></a>02834           }
<a name="l02835"></a>02835         }
<a name="l02836"></a>02836       }
<a name="l02837"></a>02837 
<a name="l02838"></a>02838       <span class="keywordflow">if</span> (this.onupdate) {
<a name="l02839"></a>02839         this.onupdate();
<a name="l02840"></a>02840       }
<a name="l02841"></a>02841 
<a name="l02842"></a>02842       <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l02843"></a>02843     },
<a name="l02844"></a>02844 
<a name="l02845"></a>02845   };
<a name="l02846"></a>02846 
<a name="l02847"></a>02847   module.exports = Connection;
<a name="l02848"></a>02848 
<a name="l02849"></a>02849 }.apply(
<a name="l02850"></a>02850   <span class="keyword">this</span>,
<a name="l02851"></a>02851   (this.Caldav) ?
<a name="l02852"></a>02852     [Caldav(<span class="stringliteral">&#39;connection&#39;</span>), Caldav] :
<a name="l02853"></a>02853     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l02854"></a>02854 ));
<a name="l02855"></a>02855 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02856"></a>02856 
<a name="l02857"></a>02857   var <a class="code" href="../../d3/d10/apps_2settings_2test_2marionette_2app_2app_8js.html#a9e9b777c6c201cee9f04395483bb677d">Base</a> = {
<a name="l02858"></a>02858 
<a name="l02859"></a>02859     name: <span class="stringliteral">&#39;base&#39;</span>,
<a name="l02860"></a>02860 
<a name="l02861"></a>02861     tagField: <span class="stringliteral">&#39;local&#39;</span>,
<a name="l02862"></a>02862 
<a name="l02871"></a>02871     <a class="code" href="../../d5/d46/server_8js.html#aec01d8b2ddaaf628b8b5a184b72aed40">create</a>: <span class="keyword">function</span>(<a class="code" href="../../d2/d7d/jsapi_8h.html#a2219cf9467e8547184b3cf2b051e8067">obj</a>) {
<a name="l02872"></a>02872       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l02873"></a>02873       var child = Object.create(<span class="keyword">this</span>);
<a name="l02874"></a>02874 
<a name="l02875"></a>02875       child._super = <span class="keyword">this</span>;
<a name="l02876"></a>02876 
<a name="l02877"></a>02877       <span class="keywordflow">for</span> (key in obj) {
<a name="l02878"></a>02878         <span class="keywordflow">if</span> (Object.hasOwnProperty.call(obj, key)) {
<a name="l02879"></a>02879           child[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = obj[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l02880"></a>02880         }
<a name="l02881"></a>02881       }
<a name="l02882"></a>02882 
<a name="l02883"></a>02883       <span class="keywordflow">return</span> child;
<a name="l02884"></a>02884     },
<a name="l02885"></a>02885 
<a name="l02886"></a>02886     onopentag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l02887"></a>02887       var current = this.current;
<a name="l02888"></a>02888       var name = data[handler.tagField];
<a name="l02889"></a>02889 
<a name="l02890"></a>02890       this.stack.push(this.current);
<a name="l02891"></a>02891 
<a name="l02892"></a>02892       <span class="keywordflow">if</span> (name in current) {
<a name="l02893"></a>02893         var next = {};
<a name="l02894"></a>02894 
<a name="l02895"></a>02895         <span class="keywordflow">if</span> (!(current[name] instanceof Array)) {
<a name="l02896"></a>02896           current[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>] = [current[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>]];
<a name="l02897"></a>02897         }
<a name="l02898"></a>02898 
<a name="l02899"></a>02899         current[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>].push(next);
<a name="l02900"></a>02900 
<a name="l02901"></a>02901         this.current = next;
<a name="l02902"></a>02902       } <span class="keywordflow">else</span> {
<a name="l02903"></a>02903         this.current = current[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>] = {};
<a name="l02904"></a>02904       }
<a name="l02905"></a>02905     },
<a name="l02906"></a>02906 
<a name="l02907"></a>02907     ontext: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l02908"></a>02908       this.current.value = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l02909"></a>02909     },
<a name="l02910"></a>02910 
<a name="l02911"></a>02911     onclosetag: <span class="keyword">function</span>() {
<a name="l02912"></a>02912       this.current = this.stack.pop();
<a name="l02913"></a>02913     },
<a name="l02914"></a>02914 
<a name="l02915"></a>02915     onend: <span class="keyword">function</span>() {
<a name="l02916"></a>02916       this.<a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(<span class="stringliteral">&#39;complete&#39;</span>, this.<a class="code" href="../../d1/df9/apps_2email_2js_2ext_2mailapi_2activesync_2configurator_8js.html#a11a10a6834f3c54a5380f4ff04d002a9">root</a>);
<a name="l02917"></a>02917     }
<a name="l02918"></a>02918   };
<a name="l02919"></a>02919 
<a name="l02920"></a>02920   module.exports = <a class="code" href="../../d3/d10/apps_2settings_2test_2marionette_2app_2app_8js.html#a9e9b777c6c201cee9f04395483bb677d">Base</a>;
<a name="l02921"></a>02921 
<a name="l02922"></a>02922 }.apply(
<a name="l02923"></a>02923   <span class="keyword">this</span>,
<a name="l02924"></a>02924   (this.Caldav) ?
<a name="l02925"></a>02925     [Caldav(<span class="stringliteral">&#39;sax/base&#39;</span>), Caldav] :
<a name="l02926"></a>02926     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l02927"></a>02927 ));
<a name="l02928"></a>02928 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02929"></a>02929 
<a name="l02930"></a>02930   var Base = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/base&#39;</span>);
<a name="l02931"></a>02931 
<a name="l02932"></a>02932   var CalendarDataHandler = Base.create({
<a name="l02933"></a>02933     name: <span class="stringliteral">&#39;calendar data&#39;</span>,
<a name="l02934"></a>02934 
<a name="l02935"></a>02935     <span class="comment">//don&#39;t add text only elements</span>
<a name="l02936"></a>02936     <span class="comment">//to the stack as objects</span>
<a name="l02937"></a>02937     onopentag: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02938"></a>02938     onclosetag: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02939"></a>02939 
<a name="l02940"></a>02940     <span class="comment">//add the value to the parent</span>
<a name="l02941"></a>02941     <span class="comment">//value where key is local tag name</span>
<a name="l02942"></a>02942     <span class="comment">//and value is the text.</span>
<a name="l02943"></a>02943     ontext: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l02944"></a>02944       var handler = this.<a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l02945"></a>02945       this.current[this.currentTag[handler.tagField]] =
<a name="l02946"></a>02946         CalendarDataHandler.parseICAL(data);
<a name="l02947"></a>02947     }
<a name="l02948"></a>02948   });
<a name="l02949"></a>02949 
<a name="l02955"></a>02955   CalendarDataHandler.parseICAL = <span class="keyword">function</span>(<a class="code" href="../../d6/da7/wire__format__lite_8h.html#a2965939d8d22ec60c89f74062f0c370c">input</a>) {
<a name="l02956"></a>02956     <span class="keywordflow">return</span> <a class="code" href="../../d6/da7/wire__format__lite_8h.html#a2965939d8d22ec60c89f74062f0c370c">input</a>;
<a name="l02957"></a>02957   };
<a name="l02958"></a>02958 
<a name="l02959"></a>02959   module.exports = CalendarDataHandler;
<a name="l02960"></a>02960 
<a name="l02961"></a>02961 }.apply(
<a name="l02962"></a>02962   <span class="keyword">this</span>,
<a name="l02963"></a>02963   (this.Caldav) ?
<a name="l02964"></a>02964     [Caldav(<span class="stringliteral">&#39;sax/calendar_data_handler&#39;</span>), Caldav] :
<a name="l02965"></a>02965     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l02966"></a>02966 ));
<a name="l02967"></a>02967 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l02968"></a>02968 
<a name="l02969"></a>02969   var HTTP_STATUS = /([0-9]{3,3})/;
<a name="l02970"></a>02970 
<a name="l02971"></a>02971   var Base = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/base&#39;</span>);
<a name="l02972"></a>02972   var CalendarDataHandler = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/calendar_data_handler&#39;</span>);
<a name="l02973"></a>02973 
<a name="l02974"></a>02974   var TextHandler = Base.create({
<a name="l02975"></a>02975     name: <span class="stringliteral">&#39;text&#39;</span>,
<a name="l02976"></a>02976 
<a name="l02977"></a>02977     <span class="comment">//don&#39;t add text only elements</span>
<a name="l02978"></a>02978     <span class="comment">//to the stack as objects</span>
<a name="l02979"></a>02979     onopentag: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02980"></a>02980     onclosetag: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l02981"></a>02981 
<a name="l02982"></a>02982     <span class="comment">//add the value to the parent</span>
<a name="l02983"></a>02983     <span class="comment">//value where key is local tag name</span>
<a name="l02984"></a>02984     <span class="comment">//and value is the text.</span>
<a name="l02985"></a>02985     ontext: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l02986"></a>02986       var handler = this.<a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l02987"></a>02987       this.current[this.currentTag[handler.tagField]] = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l02988"></a>02988     }
<a name="l02989"></a>02989   });
<a name="l02990"></a>02990 
<a name="l02991"></a>02991   var HrefHandler = Base.create({
<a name="l02992"></a>02992     name: <span class="stringliteral">&#39;href&#39;</span>,
<a name="l02993"></a>02993 
<a name="l02994"></a>02994     onopentag: <span class="keyword">function</span>() {
<a name="l02995"></a>02995       <span class="keywordflow">if</span> (this.currentTag.handler === <span class="keyword">this</span>.handler) {
<a name="l02996"></a>02996         this.stack.push(this.current);
<a name="l02997"></a>02997         this.current = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l02998"></a>02998       }
<a name="l02999"></a>02999     },
<a name="l03000"></a>03000 
<a name="l03001"></a>03001     onclosetag: <span class="keyword">function</span>() {
<a name="l03002"></a>03002       var current = this.currentTag;
<a name="l03003"></a>03003       var <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l03004"></a>03004 
<a name="l03005"></a>03005       <span class="keywordflow">if</span> (current.handler === <span class="keyword">this</span>.handler) {
<a name="l03006"></a>03006         data = this.current;
<a name="l03007"></a>03007 
<a name="l03008"></a>03008         this.current = this.stack.pop();
<a name="l03009"></a>03009         this.current[current.local] = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l03010"></a>03010       }
<a name="l03011"></a>03011     },
<a name="l03012"></a>03012 
<a name="l03013"></a>03013     ontext: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l03014"></a>03014       <span class="keywordflow">if</span> (this.currentTag.local === <span class="stringliteral">&#39;href&#39;</span>) {
<a name="l03015"></a>03015         this.current = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l03016"></a>03016       }
<a name="l03017"></a>03017     }
<a name="l03018"></a>03018 
<a name="l03019"></a>03019   });
<a name="l03020"></a>03020 
<a name="l03021"></a>03021   var HttpStatusHandler = TextHandler.create({
<a name="l03022"></a>03022     name: <span class="stringliteral">&#39;status&#39;</span>,
<a name="l03023"></a>03023 
<a name="l03024"></a>03024     ontext: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l03025"></a>03025       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a99e36b20cb6cf83fe7c1f4bff6902ab6">match</a> = data.match(HTTP_STATUS);
<a name="l03026"></a>03026 
<a name="l03027"></a>03027       <span class="keywordflow">if</span> (match) {
<a name="l03028"></a>03028         handler = this.<a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l03029"></a>03029         this.current[this.currentTag[handler.tagField]] = match[1];
<a name="l03030"></a>03030       } <span class="keywordflow">else</span> {
<a name="l03031"></a>03031         this._super.ontext.call(<span class="keyword">this</span>, data, handler);
<a name="l03032"></a>03032       }
<a name="l03033"></a>03033     }
<a name="l03034"></a>03034   });
<a name="l03035"></a>03035 
<a name="l03036"></a>03036   var PrivilegeSet = Base.create({
<a name="l03037"></a>03037     name: <span class="stringliteral">&#39;PrivilegeSet&#39;</span>,
<a name="l03038"></a>03038 
<a name="l03039"></a>03039     onopentag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l03040"></a>03040       <span class="keywordflow">if</span> (this.currentTag.handler === <span class="keyword">this</span>.handler) {
<a name="l03041"></a>03041         this.stack.push(this.current);
<a name="l03042"></a>03042         this.current = [];
<a name="l03043"></a>03043       } <span class="keywordflow">else</span> {
<a name="l03044"></a>03044         <span class="keywordflow">if</span> (data.tagSpec !== <span class="stringliteral">&#39;DAV:/privilege&#39;</span>) {
<a name="l03045"></a>03045           this.current.push(data.local);
<a name="l03046"></a>03046         }
<a name="l03047"></a>03047       }
<a name="l03048"></a>03048     },
<a name="l03049"></a>03049 
<a name="l03050"></a>03050     onclosetag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>) {
<a name="l03051"></a>03051       var current = this.currentTag;
<a name="l03052"></a>03052 
<a name="l03053"></a>03053       <span class="keywordflow">if</span> (current.handler === <span class="keyword">this</span>.handler) {
<a name="l03054"></a>03054         data = this.current;
<a name="l03055"></a>03055 
<a name="l03056"></a>03056         this.current = this.stack.pop();
<a name="l03057"></a>03057         this.current[current.local] = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l03058"></a>03058       }
<a name="l03059"></a>03059     },
<a name="l03060"></a>03060 
<a name="l03061"></a>03061     ontext: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>
<a name="l03062"></a>03062 
<a name="l03063"></a>03063   });
<a name="l03064"></a>03064 
<a name="l03065"></a>03065   var ArrayHandler = Base.create({
<a name="l03066"></a>03066     name: <span class="stringliteral">&#39;array&#39;</span>,
<a name="l03067"></a>03067 
<a name="l03068"></a>03068     handles: {
<a name="l03069"></a>03069       <span class="stringliteral">&#39;DAV:/href&#39;</span>: TextHandler
<a name="l03070"></a>03070     },
<a name="l03071"></a>03071 
<a name="l03072"></a>03072     onopentag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l03073"></a>03073       var last;
<a name="l03074"></a>03074       var tag = data[handler.tagField];
<a name="l03075"></a>03075       var last = this.tagStack[this.tagStack.length - 1];
<a name="l03076"></a>03076 
<a name="l03077"></a>03077       <span class="keywordflow">if</span> (last.handler &amp;&amp; last.handler === handler) {
<a name="l03078"></a>03078         this.stack.push(this.current);
<a name="l03079"></a>03079         this.current = this.current[tag] = [];
<a name="l03080"></a>03080       } <span class="keywordflow">else</span> {
<a name="l03081"></a>03081         this.current.push(tag);
<a name="l03082"></a>03082       }
<a name="l03083"></a>03083     },
<a name="l03084"></a>03084 
<a name="l03085"></a>03085     ontext: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03086"></a>03086     onclosetag: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03087"></a>03087 
<a name="l03088"></a>03088     oncomplete: <span class="keyword">function</span>() {
<a name="l03089"></a>03089       this.current = this.stack.pop();
<a name="l03090"></a>03090     }
<a name="l03091"></a>03091 
<a name="l03092"></a>03092   });
<a name="l03093"></a>03093 
<a name="l03094"></a>03094   var PropStatHandler = Base.create({
<a name="l03095"></a>03095     name: <span class="stringliteral">&#39;propstat&#39;</span>,
<a name="l03096"></a>03096 
<a name="l03097"></a>03097     handles: {
<a name="l03098"></a>03098       <span class="stringliteral">&#39;DAV:/href&#39;</span>: TextHandler,
<a name="l03099"></a>03099       <span class="stringliteral">&#39;http://calendarserver.org/ns//getctag&#39;</span>: TextHandler,
<a name="l03100"></a>03100       <span class="stringliteral">&#39;DAV:/status&#39;</span>: HttpStatusHandler,
<a name="l03101"></a>03101       <span class="stringliteral">&#39;DAV:/resourcetype&#39;</span>: ArrayHandler,
<a name="l03102"></a>03102       <span class="stringliteral">&#39;DAV:/current-user-privilege-set&#39;</span>: PrivilegeSet,
<a name="l03103"></a>03103       <span class="stringliteral">&#39;urn:ietf:params:xml:ns:caldav/calendar-data&#39;</span>: CalendarDataHandler,
<a name="l03104"></a>03104       <span class="stringliteral">&#39;DAV:/value&#39;</span>: TextHandler,
<a name="l03105"></a>03105       <span class="stringliteral">&#39;DAV:/owner&#39;</span>: HrefHandler,
<a name="l03106"></a>03106       <span class="stringliteral">&#39;DAV:/getetag&#39;</span>: TextHandler,
<a name="l03107"></a>03107       <span class="stringliteral">&#39;DAV:/displayname&#39;</span>: TextHandler,
<a name="l03108"></a>03108       <span class="stringliteral">&#39;urn:ietf:params:xml:ns:caldav/calendar-home-set&#39;</span>: HrefHandler,
<a name="l03109"></a>03109       <span class="stringliteral">&#39;urn:ietf:params:xml:ns:caldav/calendar-timezone&#39;</span>: TextHandler,
<a name="l03110"></a>03110       <span class="stringliteral">&#39;http://apple.com/ns/ical//calendar-color&#39;</span>: TextHandler,
<a name="l03111"></a>03111       <span class="stringliteral">&#39;urn:ietf:params:xml:ns:caldav/calendar-description&#39;</span>: TextHandler
<a name="l03112"></a>03112     },
<a name="l03113"></a>03113 
<a name="l03114"></a>03114     onopentag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l03115"></a>03115       <span class="comment">//orphan</span>
<a name="l03116"></a>03116       <span class="keywordflow">if</span> (data.tagSpec === <span class="stringliteral">&#39;DAV:/propstat&#39;</span>) {
<a name="l03117"></a>03117         <span class="comment">//blank slate propstat</span>
<a name="l03118"></a>03118         <span class="keywordflow">if</span> (!(<span class="stringliteral">&#39;propstat&#39;</span> in this.current)) {
<a name="l03119"></a>03119           this.current[<span class="stringliteral">&#39;propstat&#39;</span>] = {};
<a name="l03120"></a>03120         }
<a name="l03121"></a>03121 
<a name="l03122"></a>03122         this.stack.push(this.current);
<a name="l03123"></a>03123 
<a name="l03124"></a>03124         <span class="comment">//contents will be copied over later.</span>
<a name="l03125"></a>03125         <span class="keywordflow">return</span> this.current = {};
<a name="l03126"></a>03126       }
<a name="l03127"></a>03127 
<a name="l03128"></a>03128       handler._super.onopentag.call(<span class="keyword">this</span>, data, handler);
<a name="l03129"></a>03129       <span class="keywordflow">return</span> <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l03130"></a>03130     },
<a name="l03131"></a>03131 
<a name="l03132"></a>03132     oncomplete: <span class="keyword">function</span>() {
<a name="l03133"></a>03133       var propstat = this.stack[this.stack.length - 1];
<a name="l03134"></a>03134       propstat = propstat.propstat;
<a name="l03135"></a>03135       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l03136"></a>03136       var <a class="code" href="../../da/da1/communications_2contacts_2js_2utilities_2status_8js.html#a0818854fd36b9ae0fdfe5872464dae94">status</a> = this.current.status;
<a name="l03137"></a>03137       var props = this.current.prop;
<a name="l03138"></a>03138 
<a name="l03139"></a>03139       <span class="keyword">delete</span> this.current.status;
<a name="l03140"></a>03140       <span class="keyword">delete</span> this.current.prop;
<a name="l03141"></a>03141 
<a name="l03142"></a>03142       <span class="keywordflow">for</span> (key in props) {
<a name="l03143"></a>03143         <span class="keywordflow">if</span> (Object.hasOwnProperty.call(props, key)) {
<a name="l03144"></a>03144           propstat[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = {
<a name="l03145"></a>03145             status: <a class="code" href="../../da/da1/communications_2contacts_2js_2utilities_2status_8js.html#a0818854fd36b9ae0fdfe5872464dae94">status</a>,
<a name="l03146"></a>03146             value: props[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>]
<a name="l03147"></a>03147           };
<a name="l03148"></a>03148         }
<a name="l03149"></a>03149       }
<a name="l03150"></a>03150     }
<a name="l03151"></a>03151   });
<a name="l03152"></a>03152 
<a name="l03153"></a>03153   var Response = Base.create({
<a name="l03154"></a>03154     name: <span class="stringliteral">&#39;dav_response&#39;</span>,
<a name="l03155"></a>03155     handles: {
<a name="l03156"></a>03156       <span class="stringliteral">&#39;DAV:/href&#39;</span>: TextHandler,
<a name="l03157"></a>03157       <span class="stringliteral">&#39;DAV:/propstat&#39;</span>: PropStatHandler
<a name="l03158"></a>03158     },
<a name="l03159"></a>03159 
<a name="l03160"></a>03160     onopentag: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l03161"></a>03161       <span class="keywordflow">if</span> (data.tagSpec === <span class="stringliteral">&#39;DAV:/response&#39;</span>) {
<a name="l03162"></a>03162         this.stack.push(this.current);
<a name="l03163"></a>03163         <span class="keywordflow">return</span> this.current = {};
<a name="l03164"></a>03164       }
<a name="l03165"></a>03165 
<a name="l03166"></a>03166       handler._super.onopentag.call(<span class="keyword">this</span>, data, handler._super);
<a name="l03167"></a>03167       <span class="keywordflow">return</span> <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l03168"></a>03168     },
<a name="l03169"></a>03169 
<a name="l03170"></a>03170     oncomplete: <span class="keyword">function</span>() {
<a name="l03171"></a>03171       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a8a4058d98ae1bca3d5fa2d01726cf734">parent</a>;
<a name="l03172"></a>03172 
<a name="l03173"></a>03173       <span class="keywordflow">if</span> (this.current.href) {
<a name="l03174"></a>03174         this.<a class="code" href="../../d3/d4a/mock__recipients_8js.html#a1c233303d7d7013c8dc2390a2f264b43">emit</a>(
<a name="l03175"></a>03175           <span class="stringliteral">&#39;DAV:/response&#39;</span>,
<a name="l03176"></a>03176           this.current.href,
<a name="l03177"></a>03177           <span class="keyword">this</span>.current.propstat
<a name="l03178"></a>03178         );
<a name="l03179"></a>03179         parent = this.stack[this.stack.length - 1];
<a name="l03180"></a>03180         parent[this.current.href] = this.current.propstat;
<a name="l03181"></a>03181       }
<a name="l03182"></a>03182     }
<a name="l03183"></a>03183 
<a name="l03184"></a>03184   });
<a name="l03185"></a>03185 
<a name="l03186"></a>03186   module.exports = Response;
<a name="l03187"></a>03187 
<a name="l03188"></a>03188 }.apply(
<a name="l03189"></a>03189   <span class="keyword">this</span>,
<a name="l03190"></a>03190   (this.Caldav) ?
<a name="l03191"></a>03191     [Caldav(<span class="stringliteral">&#39;sax/dav_response&#39;</span>), Caldav] :
<a name="l03192"></a>03192     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03193"></a>03193 ));
<a name="l03194"></a>03194 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03195"></a>03195 
<a name="l03196"></a>03196   var SAX = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax&#39;</span>);
<a name="l03197"></a>03197   var XHR = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l03198"></a>03198 
<a name="l03205"></a>03205   <span class="keyword">function</span> Abstract(connection, options) {
<a name="l03206"></a>03206     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l03207"></a>03207       options = {};
<a name="l03208"></a>03208     }
<a name="l03209"></a>03209 
<a name="l03210"></a>03210     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l03211"></a>03211     var xhrOptions = {};
<a name="l03212"></a>03212 
<a name="l03213"></a>03213     this.sax = <span class="keyword">new</span> SAX();
<a name="l03214"></a>03214 
<a name="l03215"></a>03215     <span class="keywordflow">for</span> (key in options) {
<a name="l03216"></a>03216       <span class="keywordflow">if</span> (Object.hasOwnProperty.call(options, key)) {
<a name="l03217"></a>03217         <span class="keyword">this</span>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l03218"></a>03218       }
<a name="l03219"></a>03219     }
<a name="l03220"></a>03220 
<a name="l03221"></a>03221     <span class="keywordflow">if</span> (!connection) {
<a name="l03222"></a>03222       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;must pass connection object&#39;</span>);
<a name="l03223"></a>03223     }
<a name="l03224"></a>03224 
<a name="l03225"></a>03225     this.connection = connection;
<a name="l03226"></a>03226 
<a name="l03227"></a>03227     this.xhr = this.connection.request({
<a name="l03228"></a>03228       url: this.<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>,
<a name="l03229"></a>03229       headers: { <span class="stringliteral">&#39;Content-Type&#39;</span>: <span class="stringliteral">&#39;text/xml&#39;</span> }
<a name="l03230"></a>03230     });
<a name="l03231"></a>03231   }
<a name="l03232"></a>03232 
<a name="l03233"></a>03233   Abstract.prototype = {
<a name="l03234"></a>03234 
<a name="l03235"></a>03235     _createPayload: <span class="keyword">function</span>() {
<a name="l03236"></a>03236       <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l03237"></a>03237     },
<a name="l03238"></a>03238 
<a name="l03239"></a>03239     _processResult: <span class="keyword">function</span>(<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03240"></a>03240       <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>.call(<span class="keyword">this</span>, <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, this.sax.root, <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>);
<a name="l03241"></a>03241     },
<a name="l03242"></a>03242 
<a name="l03252"></a>03252     <a class="code" href="../../df/d65/openaudio_8js.html#a4379e0d0aa0995d904faac29a324b51b">send</a>: <span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03253"></a>03253       var <span class="keyword">self</span> = <span class="keyword">this</span>;
<a name="l03254"></a>03254       var <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a> = this.<a class="code" href="../../da/d84/openvideo_8js.html#a329f2008ea05312f90696aa4401250ed">xhr</a>;
<a name="l03255"></a>03255       req.data = this._createPayload();
<a name="l03256"></a>03256 
<a name="l03257"></a>03257       req.ondata = <span class="keyword">function</span> xhrOnData(chunk) {
<a name="l03258"></a>03258         <span class="keyword">self</span>.sax.write(chunk);
<a name="l03259"></a>03259       };
<a name="l03260"></a>03260 
<a name="l03261"></a>03261       <span class="comment">// in the future we may stream data somehow</span>
<a name="l03262"></a>03262       req.send(<span class="keyword">function</span> xhrResult(err, xhr) {
<a name="l03263"></a>03263         <span class="keywordflow">if</span> (err) {
<a name="l03264"></a>03264           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l03265"></a>03265         }
<a name="l03266"></a>03266 
<a name="l03267"></a>03267         <span class="keyword">self</span>.sax.close();
<a name="l03268"></a>03268         <span class="keywordflow">return</span> <span class="keyword">self</span>._processResult(req, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>);
<a name="l03269"></a>03269       });
<a name="l03270"></a>03270 
<a name="l03271"></a>03271       <span class="keywordflow">return</span> <a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>;
<a name="l03272"></a>03272     }
<a name="l03273"></a>03273   };
<a name="l03274"></a>03274 
<a name="l03275"></a>03275   module.exports = Abstract;
<a name="l03276"></a>03276 
<a name="l03277"></a>03277 }.apply(
<a name="l03278"></a>03278   <span class="keyword">this</span>,
<a name="l03279"></a>03279   (this.Caldav) ?
<a name="l03280"></a>03280     [Caldav(<span class="stringliteral">&#39;request/abstract&#39;</span>), Caldav] :
<a name="l03281"></a>03281     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03282"></a>03282 ));
<a name="l03283"></a>03283 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03284"></a>03284 
<a name="l03285"></a>03285   var XHR = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l03286"></a>03286 
<a name="l03311"></a>03311   <span class="keyword">function</span> Asset(connection, url) {
<a name="l03312"></a>03312     <span class="keywordflow">if</span> (!connection) {
<a name="l03313"></a>03313       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;must pass connection object&#39;</span>);
<a name="l03314"></a>03314     }
<a name="l03315"></a>03315     this.connection = connection;
<a name="l03316"></a>03316     this.url = <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>;
<a name="l03317"></a>03317   }
<a name="l03318"></a>03318 
<a name="l03319"></a>03319   Asset.prototype = {
<a name="l03320"></a>03320 
<a name="l03321"></a>03321     contentType: <span class="stringliteral">&#39;text/calendar&#39;</span>,
<a name="l03322"></a>03322 
<a name="l03323"></a>03323     _buildRequest: <span class="keyword">function</span>(method, <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>) {
<a name="l03324"></a>03324       var headers = {
<a name="l03325"></a>03325         <span class="stringliteral">&#39;Content-Type&#39;</span>: this.contentType
<a name="l03326"></a>03326       };
<a name="l03327"></a>03327 
<a name="l03328"></a>03328       <span class="keywordflow">if</span> (options &amp;&amp; options.contentType) {
<a name="l03329"></a>03329         headers[<span class="stringliteral">&#39;Content-Type&#39;</span>] = options.contentType;
<a name="l03330"></a>03330       }
<a name="l03331"></a>03331 
<a name="l03332"></a>03332       <span class="keywordflow">if</span> (options &amp;&amp; options.etag) {
<a name="l03333"></a>03333         headers[<span class="stringliteral">&#39;If-None-Match&#39;</span>] = options.etag;
<a name="l03334"></a>03334       }
<a name="l03335"></a>03335 
<a name="l03336"></a>03336       <span class="keywordflow">return</span> this.connection.request({
<a name="l03337"></a>03337         url: this.<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>,
<a name="l03338"></a>03338         headers: <a class="code" href="../../da/d32/prio_8h.html#ae514094796205f27cbccab72be2e8826">headers</a>,
<a name="l03339"></a>03339         method: method
<a name="l03340"></a>03340       });
<a name="l03341"></a>03341     },
<a name="l03342"></a>03342 
<a name="l03359"></a>03359     <span class="keyword">get</span>: <span class="keyword">function</span>(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03360"></a>03360       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;function&#39;</span>) {
<a name="l03361"></a>03361         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a> = <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>;
<a name="l03362"></a>03362         options = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l03363"></a>03363       }
<a name="l03364"></a>03364 
<a name="l03365"></a>03365       var req = this._buildRequest(<span class="stringliteral">&#39;GET&#39;</span>, options);
<a name="l03366"></a>03366 
<a name="l03367"></a>03367       <span class="keywordflow">return</span> req.send(<span class="keyword">function</span>(err, xhr) {
<a name="l03368"></a>03368         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err, xhr.responseText, xhr);
<a name="l03369"></a>03369       });
<a name="l03370"></a>03370     },
<a name="l03371"></a>03371 
<a name="l03381"></a>03381     put: <span class="keyword">function</span>(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>, <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03382"></a>03382       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;string&#39;</span>) {
<a name="l03383"></a>03383         data = <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>;
<a name="l03384"></a>03384         options = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l03385"></a>03385       }
<a name="l03386"></a>03386 
<a name="l03387"></a>03387       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(data) === <span class="stringliteral">&#39;function&#39;</span>) {
<a name="l03388"></a>03388         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a> = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l03389"></a>03389         data = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l03390"></a>03390       }
<a name="l03391"></a>03391 
<a name="l03392"></a>03392       var req = this._buildRequest(<span class="stringliteral">&#39;PUT&#39;</span>, options);
<a name="l03393"></a>03393       req.data = <a class="code" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>;
<a name="l03394"></a>03394 
<a name="l03395"></a>03395       <span class="keywordflow">return</span> req.send(<span class="keyword">function</span>(err, xhr) {
<a name="l03396"></a>03396         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err, xhr.responseText, xhr);
<a name="l03397"></a>03397       });
<a name="l03398"></a>03398     },
<a name="l03399"></a>03399 
<a name="l03408"></a>03408     <span class="keyword">delete</span>: <span class="keyword">function</span>(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03409"></a>03409       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;function&#39;</span>) {
<a name="l03410"></a>03410         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a> = <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>;
<a name="l03411"></a>03411         options = <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>;
<a name="l03412"></a>03412       }
<a name="l03413"></a>03413 
<a name="l03414"></a>03414       var req = this._buildRequest(<span class="stringliteral">&#39;DELETE&#39;</span>, options);
<a name="l03415"></a>03415 
<a name="l03416"></a>03416       <span class="keywordflow">return</span> req.send(<span class="keyword">function</span>(err, xhr) {
<a name="l03417"></a>03417         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err, xhr.responseText, xhr);
<a name="l03418"></a>03418       });
<a name="l03419"></a>03419     }
<a name="l03420"></a>03420   };
<a name="l03421"></a>03421 
<a name="l03422"></a>03422   module.exports = Asset;
<a name="l03423"></a>03423 
<a name="l03424"></a>03424 }.apply(
<a name="l03425"></a>03425   <span class="keyword">this</span>,
<a name="l03426"></a>03426   (this.Caldav) ?
<a name="l03427"></a>03427     [Caldav(<span class="stringliteral">&#39;request/asset&#39;</span>), Caldav] :
<a name="l03428"></a>03428     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03429"></a>03429 ));
<a name="l03430"></a>03430 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03431"></a>03431 
<a name="l03432"></a>03432   var Abstract = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/abstract&#39;</span>),
<a name="l03433"></a>03433       Template = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;template&#39;</span>),
<a name="l03434"></a>03434       DavResponse = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/dav_response&#39;</span>);
<a name="l03435"></a>03435 
<a name="l03442"></a>03442   <span class="keyword">function</span> Propfind(url, options) {
<a name="l03443"></a>03443     Abstract.apply(<span class="keyword">this</span>, arguments);
<a name="l03444"></a>03444 
<a name="l03445"></a>03445     this.<span class="keyword">template</span> = <span class="keyword">new</span> <a class="code" href="../../d6/d5f/build__stage_2email_2shared_2js_2template_8js.html#aab83dedcadf384ff4b12e9316e74d266">Template</a>(<span class="stringliteral">&#39;propfind&#39;</span>);
<a name="l03446"></a>03446     this._props = [];
<a name="l03447"></a>03447     this.sax.registerHandler(
<a name="l03448"></a>03448       <span class="stringliteral">&#39;DAV:/response&#39;</span>,
<a name="l03449"></a>03449       DavResponse
<a name="l03450"></a>03450     );
<a name="l03451"></a>03451 
<a name="l03452"></a>03452     this.xhr.headers[<span class="stringliteral">&#39;Depth&#39;</span>] = 0;
<a name="l03453"></a>03453     this.xhr.method = <span class="stringliteral">&#39;PROPFIND&#39;</span>;
<a name="l03454"></a>03454   }
<a name="l03455"></a>03455 
<a name="l03456"></a>03456   Propfind.prototype = {
<a name="l03457"></a>03457     __proto__: Abstract.prototype,
<a name="l03458"></a>03458 
<a name="l03459"></a>03459     <span class="keyword">get</span> depth() {
<a name="l03460"></a>03460       <span class="keywordflow">return</span> this.xhr.headers.Depth;
<a name="l03461"></a>03461     },
<a name="l03462"></a>03462 
<a name="l03463"></a>03463     <span class="keyword">set</span> depth(<a class="code" href="../../d7/d27/jpeglib_8h.html#abde23394a8cafaa525be2efd5c6d4b2e">val</a>) {
<a name="l03464"></a>03464       this.xhr.headers.Depth = <a class="code" href="../../d7/d27/jpeglib_8h.html#abde23394a8cafaa525be2efd5c6d4b2e">val</a>;
<a name="l03465"></a>03465     },
<a name="l03466"></a>03466 
<a name="l03474"></a>03474     prop: <span class="keyword">function</span>(tagDesc, <a class="code" href="../../d7/d0c/prproces_8h.html#a92970d085b25d95271a7bad519b87192">attr</a>, <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l03475"></a>03475       this._props.push(this.<span class="keyword">template</span>.tag(tagDesc, attr, content));
<a name="l03476"></a>03476     },
<a name="l03477"></a>03477 
<a name="l03486"></a>03486     removeProp: <span class="keyword">function</span>(tagDesc, <a class="code" href="../../d7/d0c/prproces_8h.html#a92970d085b25d95271a7bad519b87192">attr</a>, <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l03487"></a>03487       var prop = this.<span class="keyword">template</span>.tag(tagDesc, attr, content);
<a name="l03488"></a>03488       var idx = this._props.indexOf(prop);
<a name="l03489"></a>03489 
<a name="l03490"></a>03490       <span class="keywordflow">if</span> (idx !== -1) {
<a name="l03491"></a>03491         this._props.splice(idx, 1);
<a name="l03492"></a>03492         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03493"></a>03493       }
<a name="l03494"></a>03494       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03495"></a>03495     },
<a name="l03496"></a>03496 
<a name="l03504"></a>03504     hasProp: <span class="keyword">function</span>(tagDesc, <a class="code" href="../../d7/d0c/prproces_8h.html#a92970d085b25d95271a7bad519b87192">attr</a>, <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>) {
<a name="l03505"></a>03505       var prop = this.<span class="keyword">template</span>.tag(tagDesc, attr, content);
<a name="l03506"></a>03506       <span class="keywordflow">return</span> this._props.indexOf(prop) !== -1;
<a name="l03507"></a>03507     },
<a name="l03508"></a>03508 
<a name="l03509"></a>03509     _createPayload: <span class="keyword">function</span>() {
<a name="l03510"></a>03510       var content = this.<span class="keyword">template</span>.tag(<span class="stringliteral">&#39;prop&#39;</span>, this._props.join(<span class="stringliteral">&#39;&#39;</span>));
<a name="l03511"></a>03511       <span class="keywordflow">return</span> this.<span class="keyword">template</span>.render(content);
<a name="l03512"></a>03512     },
<a name="l03513"></a>03513 
<a name="l03514"></a>03514     _processResult: <span class="keyword">function</span>(<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03515"></a>03515       <span class="keywordflow">if</span> (<span class="stringliteral">&#39;multistatus&#39;</span> in this.sax.root) {
<a name="l03516"></a>03516         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, this.sax.root.multistatus, req);
<a name="l03517"></a>03517       } <span class="keywordflow">else</span> {
<a name="l03518"></a>03518         <span class="comment">//XXX: Improve error handling</span>
<a name="l03519"></a>03519         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(
<a name="l03520"></a>03520           <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;unexpected xml result&#39;</span>),
<a name="l03521"></a>03521           this.sax.root, req
<a name="l03522"></a>03522         );
<a name="l03523"></a>03523       }
<a name="l03524"></a>03524     }
<a name="l03525"></a>03525 
<a name="l03526"></a>03526   };
<a name="l03527"></a>03527 
<a name="l03528"></a>03528   module.exports = Propfind;
<a name="l03529"></a>03529 
<a name="l03530"></a>03530 }.apply(
<a name="l03531"></a>03531   <span class="keyword">this</span>,
<a name="l03532"></a>03532   (this.Caldav) ?
<a name="l03533"></a>03533     [Caldav(<span class="stringliteral">&#39;request/propfind&#39;</span>), Caldav] :
<a name="l03534"></a>03534     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03535"></a>03535 ));
<a name="l03536"></a>03536 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03537"></a>03537 
<a name="l03538"></a>03538   var Propfind = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/propfind&#39;</span>);
<a name="l03539"></a>03539   var Builder = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;query_builder&#39;</span>);
<a name="l03540"></a>03540 
<a name="l03549"></a>03549   <span class="keyword">function</span> CalendarQuery(connection, options) {
<a name="l03550"></a>03550     Propfind.apply(<span class="keyword">this</span>, arguments);
<a name="l03551"></a>03551 
<a name="l03552"></a>03552     this.xhr.headers[<span class="stringliteral">&#39;Depth&#39;</span>] = this.depth || 1;
<a name="l03553"></a>03553     this.xhr.method = <span class="stringliteral">&#39;REPORT&#39;</span>;
<a name="l03554"></a>03554 
<a name="l03555"></a>03555     this.<span class="keyword">template</span>.rootTag = [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;calendar-query&#39;</span>];
<a name="l03556"></a>03556 
<a name="l03557"></a>03557     this.data = <span class="keyword">new</span> Builder({
<a name="l03558"></a>03558       <span class="keyword">template</span>: this.<span class="keyword">template</span>
<a name="l03559"></a>03559     });
<a name="l03560"></a>03560 
<a name="l03561"></a>03561     this.<a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#ab628e67f85699825109c59795f6ece42">filter</a> = <span class="keyword">new</span> Builder({
<a name="l03562"></a>03562       <span class="keyword">template</span>: this.<span class="keyword">template</span>,
<a name="l03563"></a>03563       tag: [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;filter&#39;</span>],
<a name="l03564"></a>03564       propTag: [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;prop-filter&#39;</span>],
<a name="l03565"></a>03565       compTag: [<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;comp-filter&#39;</span>]
<a name="l03566"></a>03566     });
<a name="l03567"></a>03567   }
<a name="l03568"></a>03568 
<a name="l03569"></a>03569   CalendarQuery.prototype = {
<a name="l03570"></a>03570     __proto__: Propfind.prototype,
<a name="l03571"></a>03571 
<a name="l03572"></a>03572     _createPayload: <span class="keyword">function</span>() {
<a name="l03573"></a>03573       var <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a4a1b5640b674da15d6f1b87899e53789">content</a>;
<a name="l03574"></a>03574       var <a class="code" href="../../de/dc5/jsfriendapi_8h.html#a0c4e9efe1571ce3ef20a0baf42a47be9">props</a>;
<a name="l03575"></a>03575 
<a name="l03576"></a>03576       props = this._props.join(<span class="stringliteral">&#39;&#39;</span>);
<a name="l03577"></a>03577 
<a name="l03578"></a>03578       <span class="keywordflow">if</span> (this.data) {
<a name="l03579"></a>03579         props += this.data.toString();
<a name="l03580"></a>03580       }
<a name="l03581"></a>03581 
<a name="l03582"></a>03582       content = this.<span class="keyword">template</span>.tag(<span class="stringliteral">&#39;prop&#39;</span>, props);
<a name="l03583"></a>03583 
<a name="l03584"></a>03584       <span class="keywordflow">if</span> (this.filter) {
<a name="l03585"></a>03585         content += this.filter.toString();
<a name="l03586"></a>03586       }
<a name="l03587"></a>03587 
<a name="l03588"></a>03588       <span class="keywordflow">return</span> this.<span class="keyword">template</span>.render(content);
<a name="l03589"></a>03589     }
<a name="l03590"></a>03590 
<a name="l03591"></a>03591   };
<a name="l03592"></a>03592 
<a name="l03593"></a>03593   module.exports = CalendarQuery;
<a name="l03594"></a>03594 
<a name="l03595"></a>03595 }.apply(
<a name="l03596"></a>03596   <span class="keyword">this</span>,
<a name="l03597"></a>03597   (this.Caldav) ?
<a name="l03598"></a>03598     [Caldav(<span class="stringliteral">&#39;request/calendar_query&#39;</span>), Caldav] :
<a name="l03599"></a>03599     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03600"></a>03600 ));
<a name="l03601"></a>03601 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03602"></a>03602 
<a name="l03603"></a>03603   var RequestErrors = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;errors&#39;</span>);
<a name="l03604"></a>03604 
<a name="l03611"></a>03611   <span class="keyword">function</span> CalendarHome(connection, options) {
<a name="l03612"></a>03612     var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l03613"></a>03613 
<a name="l03614"></a>03614     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l03615"></a>03615       options = {};
<a name="l03616"></a>03616     }
<a name="l03617"></a>03617 
<a name="l03618"></a>03618     <span class="keywordflow">for</span> (key in options) {
<a name="l03619"></a>03619       <span class="keywordflow">if</span> (Object.hasOwnProperty.call(options, key)) {
<a name="l03620"></a>03620         <span class="keyword">this</span>[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>] = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l03621"></a>03621       }
<a name="l03622"></a>03622     }
<a name="l03623"></a>03623 
<a name="l03624"></a>03624     this.connection = connection;
<a name="l03625"></a>03625   }
<a name="l03626"></a>03626 
<a name="l03627"></a>03627   <span class="keyword">function</span> findProperty(name, data, single) {
<a name="l03628"></a>03628     var <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, <a class="code" href="../../de/d4d/ns_i_d_o_m_speech_recognition_event_8idl.html#a004e752a63561c4c9bfd98d2be668a5d">results</a> = [], prop;
<a name="l03629"></a>03629 
<a name="l03630"></a>03630     <span class="keywordflow">for</span> (url in data) {
<a name="l03631"></a>03631       <span class="keywordflow">if</span> (Object.hasOwnProperty.call(data, url)) {
<a name="l03632"></a>03632         <span class="keywordflow">if</span> (name in data[url]) {
<a name="l03633"></a>03633           prop = data[<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>][<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>];
<a name="l03634"></a>03634           <span class="keywordflow">if</span> (prop.status === <span class="stringliteral">&#39;200&#39;</span>) {
<a name="l03635"></a>03635             results.push(data[url][name].value);
<a name="l03636"></a>03636           }
<a name="l03637"></a>03637         }
<a name="l03638"></a>03638       }
<a name="l03639"></a>03639     }
<a name="l03640"></a>03640 
<a name="l03641"></a>03641     <span class="keywordflow">if</span> (!results.length)
<a name="l03642"></a>03642       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03643"></a>03643 
<a name="l03644"></a>03644     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(single) !== <span class="stringliteral">&#39;undefined&#39;</span> &amp;&amp; single) {
<a name="l03645"></a>03645       <span class="keywordflow">return</span> results[0];
<a name="l03646"></a>03646     }
<a name="l03647"></a>03647 
<a name="l03648"></a>03648     <span class="keywordflow">return</span> <a class="code" href="../../de/d4d/ns_i_d_o_m_speech_recognition_event_8idl.html#a004e752a63561c4c9bfd98d2be668a5d">results</a>;
<a name="l03649"></a>03649   }
<a name="l03650"></a>03650 
<a name="l03651"></a>03651   CalendarHome.prototype = {
<a name="l03652"></a>03652 
<a name="l03653"></a>03653     Propfind: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/propfind&#39;</span>),
<a name="l03654"></a>03654 
<a name="l03659"></a>03659     _findPrincipal: <span class="keyword">function</span>(<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03660"></a>03660       var <a class="code" href="../../d3/d91/j3d_8js.html#a839488d96d3a5a4d21231ab59d9c9995">find</a> = <span class="keyword">new</span> this.Propfind(this.connection, {
<a name="l03661"></a>03661         url: url
<a name="l03662"></a>03662       });
<a name="l03663"></a>03663 
<a name="l03664"></a>03664       find.prop(<span class="stringliteral">&#39;current-user-principal&#39;</span>);
<a name="l03665"></a>03665       find.prop(<span class="stringliteral">&#39;principal-URL&#39;</span>);
<a name="l03666"></a>03666 
<a name="l03667"></a>03667       <span class="keywordflow">return</span> find.send(<span class="keyword">function</span>(err, data) {
<a name="l03668"></a>03668         var principal;
<a name="l03669"></a>03669 
<a name="l03670"></a>03670         <span class="keywordflow">if</span> (err) {
<a name="l03671"></a>03671           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l03672"></a>03672           <span class="keywordflow">return</span>;
<a name="l03673"></a>03673         }
<a name="l03674"></a>03674 
<a name="l03675"></a>03675         <span class="comment">// some fairly dumb allowances</span>
<a name="l03676"></a>03676         principal =
<a name="l03677"></a>03677           findProperty(<span class="stringliteral">&#39;current-user-principal&#39;</span>, data, <span class="keyword">true</span>) ||
<a name="l03678"></a>03678           findProperty(<span class="stringliteral">&#39;principal-URL&#39;</span>, data, <span class="keyword">true</span>);
<a name="l03679"></a>03679 
<a name="l03680"></a>03680         <span class="keywordflow">if</span> (!principal) {
<a name="l03681"></a>03681           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<span class="keyword">new</span> Errors.InvalidEntrypoint(
<a name="l03682"></a>03682             <span class="stringliteral">&#39;both current-user-principal and principal-URL are missing&#39;</span>
<a name="l03683"></a>03683           ));
<a name="l03684"></a>03684         }
<a name="l03685"></a>03685 
<a name="l03686"></a>03686         <span class="comment">// per http://tools.ietf.org/html/rfc6638 we get unauthenticated</span>
<a name="l03687"></a>03687         <span class="keywordflow">if</span> (<span class="stringliteral">&#39;unauthenticated&#39;</span> in principal) {
<a name="l03688"></a>03688           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(
<a name="l03689"></a>03689             <span class="keyword">new</span> Errors.Authentication(<span class="stringliteral">&#39;caldav response is unauthenticated&#39;</span>)
<a name="l03690"></a>03690           );
<a name="l03691"></a>03691         }
<a name="l03692"></a>03692 
<a name="l03693"></a>03693         <span class="comment">// we might have both principal.href &amp; unauthenticated</span>
<a name="l03694"></a>03694         <span class="keywordflow">if</span> (principal.href) {
<a name="l03695"></a>03695           <span class="keywordflow">return</span> <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, principal.href);
<a name="l03696"></a>03696         }
<a name="l03697"></a>03697 
<a name="l03698"></a>03698         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(
<a name="l03699"></a>03699           <span class="keyword">new</span> Errors.InvalidEntrypoint(<span class="stringliteral">&#39;no useful location information found&#39;</span>)
<a name="l03700"></a>03700         );
<a name="l03701"></a>03701       });
<a name="l03702"></a>03702     },
<a name="l03703"></a>03703 
<a name="l03704"></a>03704     _findCalendarHome: <span class="keyword">function</span>(<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03705"></a>03705       var details = {};
<a name="l03706"></a>03706       var find = <span class="keyword">new</span> this.Propfind(this.connection, {
<a name="l03707"></a>03707         url: url
<a name="l03708"></a>03708       });
<a name="l03709"></a>03709 
<a name="l03710"></a>03710       find.prop([<span class="stringliteral">&#39;caldav&#39;</span>, <span class="stringliteral">&#39;calendar-home-set&#39;</span>]);
<a name="l03711"></a>03711 
<a name="l03712"></a>03712       <span class="keywordflow">return</span> find.send(<span class="keyword">function</span>(err, data) {
<a name="l03713"></a>03713         <span class="keywordflow">if</span> (err) {
<a name="l03714"></a>03714           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l03715"></a>03715           <span class="keywordflow">return</span>;
<a name="l03716"></a>03716         }
<a name="l03717"></a>03717 
<a name="l03718"></a>03718         details = {
<a name="l03719"></a>03719           url: findProperty(<span class="stringliteral">&#39;calendar-home-set&#39;</span>, data, <span class="keyword">true</span>)
<a name="l03720"></a>03720         };
<a name="l03721"></a>03721 
<a name="l03722"></a>03722         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, details);
<a name="l03723"></a>03723       });
<a name="l03724"></a>03724     },
<a name="l03725"></a>03725 
<a name="l03734"></a>03734     <a class="code" href="../../df/d65/openaudio_8js.html#a4379e0d0aa0995d904faac29a324b51b">send</a>: <span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03735"></a>03735       var <span class="keyword">self</span> = <span class="keyword">this</span>;
<a name="l03736"></a>03736       <span class="keywordflow">return</span> <span class="keyword">self</span>._findPrincipal(<span class="keyword">self</span>.url, <span class="keyword">function</span>(err, url) {
<a name="l03737"></a>03737 
<a name="l03738"></a>03738         <span class="keywordflow">if</span> (!url) {
<a name="l03739"></a>03739           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err);
<a name="l03740"></a>03740           <span class="keywordflow">return</span>;
<a name="l03741"></a>03741         }
<a name="l03742"></a>03742 
<a name="l03743"></a>03743         <span class="keyword">self</span>._findCalendarHome(url, <span class="keyword">function</span>(err, details) {
<a name="l03744"></a>03744           <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(err, details);
<a name="l03745"></a>03745         });
<a name="l03746"></a>03746       });
<a name="l03747"></a>03747     }
<a name="l03748"></a>03748 
<a name="l03749"></a>03749   };
<a name="l03750"></a>03750 
<a name="l03751"></a>03751   module.exports = CalendarHome;
<a name="l03752"></a>03752 
<a name="l03753"></a>03753 }.apply(
<a name="l03754"></a>03754   <span class="keyword">this</span>,
<a name="l03755"></a>03755   (this.Caldav) ?
<a name="l03756"></a>03756     [Caldav(<span class="stringliteral">&#39;request/calendar_home&#39;</span>), Caldav] :
<a name="l03757"></a>03757     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03758"></a>03758 ));
<a name="l03759"></a>03759 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03760"></a>03760 
<a name="l03761"></a>03761   var Propfind = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/propfind&#39;</span>);
<a name="l03762"></a>03762 
<a name="l03763"></a>03763   <span class="keyword">function</span> <a class="code" href="../../df/d4f/resources_8js.html#ae6a3f835c4f38818cd4bb115aeaad73f">Resources</a>(connection, options) {
<a name="l03764"></a>03764     Propfind.apply(<span class="keyword">this</span>, arguments);
<a name="l03765"></a>03765 
<a name="l03766"></a>03766     this._resources = {};
<a name="l03767"></a>03767     this.depth = 1;
<a name="l03768"></a>03768   }
<a name="l03769"></a>03769 
<a name="l03770"></a>03770   <a class="code" href="../../df/d4f/resources_8js.html#ae6a3f835c4f38818cd4bb115aeaad73f">Resources</a>.prototype = {
<a name="l03771"></a>03771     __proto__: Propfind.prototype,
<a name="l03772"></a>03772 
<a name="l03773"></a>03773     addResource: <span class="keyword">function</span>(<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>) {
<a name="l03774"></a>03774       this._resources[<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>] = <a class="code" href="../../de/deb/jsdbgapi_8h.html#a309e0bc04bd5e2de367147b08241aa6b">handler</a>;
<a name="l03775"></a>03775     },
<a name="l03776"></a>03776 
<a name="l03777"></a>03777     _processResult: <span class="keyword">function</span>(<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>, <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>) {
<a name="l03778"></a>03778       var results = {};
<a name="l03779"></a>03779       var <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>;
<a name="l03780"></a>03780       var <a class="code" href="../../d1/df9/apps_2email_2js_2ext_2mailapi_2activesync_2configurator_8js.html#a11a10a6834f3c54a5380f4ff04d002a9">root</a>;
<a name="l03781"></a>03781       var collection;
<a name="l03782"></a>03782       var <span class="keyword">self</span> = <span class="keyword">this</span>;
<a name="l03783"></a>03783       var resources;
<a name="l03784"></a>03784 
<a name="l03785"></a>03785       <span class="keywordflow">if</span> (<span class="stringliteral">&#39;multistatus&#39;</span> in this.sax.root) {
<a name="l03786"></a>03786         root = this.sax.root.multistatus;
<a name="l03787"></a>03787 
<a name="l03788"></a>03788         <span class="keywordflow">for</span> (url in root) {
<a name="l03789"></a>03789           collection = root[<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>];
<a name="l03790"></a>03790           resources = collection.resourcetype;
<a name="l03791"></a>03791           <span class="keywordflow">if</span> (resources.value.forEach) {
<a name="l03792"></a>03792 
<a name="l03793"></a>03793             resources.value.forEach(<span class="keyword">function</span>(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>) {
<a name="l03794"></a>03794               <span class="keywordflow">if</span> (<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a> in <span class="keyword">self</span>._resources) {
<a name="l03795"></a>03795 
<a name="l03796"></a>03796                 <span class="keywordflow">if</span> (!(<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a> in results)) {
<a name="l03797"></a>03797                   results[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>] = {};
<a name="l03798"></a>03798                 }
<a name="l03799"></a>03799 
<a name="l03800"></a>03800                 results[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>][<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>] = <span class="keyword">new</span> <span class="keyword">self</span>._resources[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>](
<a name="l03801"></a>03801                   <span class="keyword">self</span>.connection,
<a name="l03802"></a>03802                   collection
<a name="l03803"></a>03803                 );
<a name="l03804"></a>03804 
<a name="l03805"></a>03805                 results[<a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>][<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>].url = <a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>;
<a name="l03806"></a>03806               }
<a name="l03807"></a>03807             });
<a name="l03808"></a>03808           }
<a name="l03809"></a>03809         }
<a name="l03810"></a>03810 
<a name="l03811"></a>03811         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(<a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>, results, req);
<a name="l03812"></a>03812 
<a name="l03813"></a>03813       } <span class="keywordflow">else</span> {
<a name="l03814"></a>03814         <span class="comment">//XXX: Improve error handling</span>
<a name="l03815"></a>03815         <a class="code" href="../../df/d44/permission__manager_8js.html#ab95eebdb2a4acb8510417bf0bdabc3c5">callback</a>(
<a name="l03816"></a>03816           <span class="keyword">new</span> <a class="code" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>(<span class="stringliteral">&#39;unexpected xml result&#39;</span>),
<a name="l03817"></a>03817           this.sax.root, req
<a name="l03818"></a>03818         );
<a name="l03819"></a>03819       }
<a name="l03820"></a>03820     }
<a name="l03821"></a>03821 
<a name="l03822"></a>03822   };
<a name="l03823"></a>03823 
<a name="l03824"></a>03824   module.exports = <a class="code" href="../../df/d4f/resources_8js.html#ae6a3f835c4f38818cd4bb115aeaad73f">Resources</a>;
<a name="l03825"></a>03825 
<a name="l03826"></a>03826 }.apply(
<a name="l03827"></a>03827   <span class="keyword">this</span>,
<a name="l03828"></a>03828   (this.Caldav) ?
<a name="l03829"></a>03829     [Caldav(<span class="stringliteral">&#39;request/resources&#39;</span>), Caldav] :
<a name="l03830"></a>03830     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03831"></a>03831 ));
<a name="l03832"></a>03832 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03833"></a>03833 
<a name="l03834"></a>03834   module.exports = {
<a name="l03835"></a>03835     BasicAuth: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;http/basic_auth&#39;</span>),
<a name="l03836"></a>03836     OAuth2: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;http/oauth2&#39;</span>)
<a name="l03837"></a>03837   };
<a name="l03838"></a>03838 
<a name="l03839"></a>03839 }.apply(
<a name="l03840"></a>03840   <span class="keyword">this</span>,
<a name="l03841"></a>03841   (this.Caldav) ?
<a name="l03842"></a>03842     [Caldav(<span class="stringliteral">&#39;http&#39;</span>), Caldav] :
<a name="l03843"></a>03843     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03844"></a>03844 ));
<a name="l03845"></a>03845 
<a name="l03846"></a>03846 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03847"></a>03847 
<a name="l03848"></a>03848   module.exports = {
<a name="l03849"></a>03849     Abstract: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/abstract&#39;</span>),
<a name="l03850"></a>03850     CalendarQuery: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/calendar_query&#39;</span>),
<a name="l03851"></a>03851     Propfind: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/propfind&#39;</span>),
<a name="l03852"></a>03852     CalendarHome: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/calendar_home&#39;</span>),
<a name="l03853"></a>03853     <a class="code" href="../../df/d4f/resources_8js.html#ae6a3f835c4f38818cd4bb115aeaad73f">Resources</a>: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/resources&#39;</span>),
<a name="l03854"></a>03854     Asset: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/asset&#39;</span>)
<a name="l03855"></a>03855   };
<a name="l03856"></a>03856 
<a name="l03857"></a>03857 }.apply(
<a name="l03858"></a>03858   <span class="keyword">this</span>,
<a name="l03859"></a>03859   (this.Caldav) ?
<a name="l03860"></a>03860     [Caldav(<span class="stringliteral">&#39;request&#39;</span>), Caldav] :
<a name="l03861"></a>03861     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03862"></a>03862 ));
<a name="l03863"></a>03863 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03864"></a>03864 
<a name="l03865"></a>03865   module.exports = {
<a name="l03866"></a>03866     Base: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/base&#39;</span>),
<a name="l03867"></a>03867     CalendarDataHandler: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/calendar_data_handler&#39;</span>),
<a name="l03868"></a>03868     DavResponse: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax/dav_response&#39;</span>)
<a name="l03869"></a>03869   };
<a name="l03870"></a>03870 
<a name="l03871"></a>03871 }.apply(
<a name="l03872"></a>03872   <span class="keyword">this</span>,
<a name="l03873"></a>03873   (this.Caldav) ?
<a name="l03874"></a>03874     [Caldav(<span class="stringliteral">&#39;sax&#39;</span>), Caldav] :
<a name="l03875"></a>03875     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l03876"></a>03876 ));
<a name="l03877"></a>03877 
<a name="l03881"></a>03881 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l03882"></a>03882 
<a name="l03883"></a>03883   var CalendarQuery = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request/calendar_query&#39;</span>);
<a name="l03884"></a>03884 
<a name="l03891"></a>03891   <span class="keyword">function</span> <a class="code" href="../../d4/d99/create__event__test_8js.html#a4a0f6a3a1b73d50ac6e8a34fe754f79f">Calendar</a>(connection, options) {
<a name="l03892"></a>03892     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l03893"></a>03893       options = {};
<a name="l03894"></a>03894     }
<a name="l03895"></a>03895 
<a name="l03896"></a>03896     <span class="keywordflow">if</span> (options.url) {
<a name="l03897"></a>03897       this.url = options.url;
<a name="l03898"></a>03898     }
<a name="l03899"></a>03899 
<a name="l03900"></a>03900     this.connection = connection;
<a name="l03901"></a>03901     this.updateFromServer(options);
<a name="l03902"></a>03902   }
<a name="l03903"></a>03903 
<a name="l03904"></a>03904   <a class="code" href="../../d4/d99/create__event__test_8js.html#a4a0f6a3a1b73d50ac6e8a34fe754f79f">Calendar</a>.prototype = {
<a name="l03905"></a>03905 
<a name="l03906"></a>03906     _map: {
<a name="l03907"></a>03907       <span class="stringliteral">&#39;displayname&#39;</span>: <span class="stringliteral">&#39;name&#39;</span>,
<a name="l03908"></a>03908 
<a name="l03909"></a>03909       <span class="stringliteral">&#39;calendar-color&#39;</span>: <span class="stringliteral">&#39;color&#39;</span>,
<a name="l03910"></a>03910 
<a name="l03911"></a>03911       <span class="stringliteral">&#39;calendar-description&#39;</span>: <span class="stringliteral">&#39;description&#39;</span>,
<a name="l03912"></a>03912 
<a name="l03913"></a>03913       <span class="stringliteral">&#39;getctag&#39;</span>: <span class="stringliteral">&#39;ctag&#39;</span>,
<a name="l03914"></a>03914       <span class="stringliteral">&#39;getetag&#39;</span>: <span class="stringliteral">&#39;etag&#39;</span>,
<a name="l03915"></a>03915       <span class="stringliteral">&#39;getlastmodified&#39;</span>: <span class="stringliteral">&#39;lastmodified&#39;</span>,
<a name="l03916"></a>03916 
<a name="l03917"></a>03917       <span class="stringliteral">&#39;resourcetype&#39;</span>: {
<a name="l03918"></a>03918         field: <span class="stringliteral">&#39;resourcetype&#39;</span>,
<a name="l03919"></a>03919         defaults: []
<a name="l03920"></a>03920       },
<a name="l03921"></a>03921 
<a name="l03922"></a>03922       <span class="stringliteral">&#39;current-user-privilege-set&#39;</span>: {
<a name="l03923"></a>03923         field: <span class="stringliteral">&#39;privilegeSet&#39;</span>,
<a name="l03924"></a>03924         defaults: []
<a name="l03925"></a>03925       }
<a name="l03926"></a>03926 
<a name="l03927"></a>03927     },
<a name="l03928"></a>03928 
<a name="l03932"></a>03932     url: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03933"></a>03933 
<a name="l03938"></a>03938     name: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03939"></a>03939 
<a name="l03944"></a>03944     <a class="code" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#aacb3a46fbd7c29fc555a0260d22f938c">color</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03945"></a>03945 
<a name="l03950"></a>03950     <a class="code" href="../../dd/dc4/namespacesetup.html#a4ad612547892c74be7035043265eb65c">description</a>: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03951"></a>03951 
<a name="l03959"></a>03959     ctag: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03960"></a>03960 
<a name="l03969"></a>03969     resourcetype: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03970"></a>03970 
<a name="l03976"></a>03976     privilegeSet: <a class="code" href="../../d1/d04/app__install__manager_8js.html#a66d98f9009f0502b9a5ce70e907f8f27">null</a>,
<a name="l03977"></a>03977 
<a name="l03981"></a>03981     updateFromServer: <span class="keyword">function</span>(<a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>) {
<a name="l03982"></a>03982       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;
<a name="l03983"></a>03983       var defaultTo;
<a name="l03984"></a>03984       var mapName;
<a name="l03985"></a>03985       var <a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>;
<a name="l03986"></a>03986       var <a class="code" href="../../d2/d7d/jsapi_8h.html#a1207a417b47b08dec9e8da04d8b1e334">descriptor</a>;
<a name="l03987"></a>03987 
<a name="l03988"></a>03988       <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(options) === <span class="stringliteral">&#39;undefined&#39;</span>) {
<a name="l03989"></a>03989         options = {};
<a name="l03990"></a>03990       }
<a name="l03991"></a>03991 
<a name="l03992"></a>03992       <span class="keywordflow">for</span> (key in options) {
<a name="l03993"></a>03993         <span class="keywordflow">if</span> (Object.hasOwnProperty.call(options, key)) {
<a name="l03994"></a>03994           <span class="keywordflow">if</span> (key in this._map) {
<a name="l03995"></a>03995             descriptor = this._map[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l03996"></a>03996             value = options[<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];
<a name="l03997"></a>03997 
<a name="l03998"></a>03998             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d22/ical_8js.html#a6053319846c80bf9561a1958bb817380">typeof</a>(descriptor) === <span class="stringliteral">&#39;object&#39;</span>) {
<a name="l03999"></a>03999               defaultTo = descriptor.defaults;
<a name="l04000"></a>04000               mapName = descriptor.field;
<a name="l04001"></a>04001             } <span class="keywordflow">else</span> {
<a name="l04002"></a>04002               defaultTo = <span class="stringliteral">&#39;&#39;</span>;
<a name="l04003"></a>04003               mapName = <a class="code" href="../../d2/d7d/jsapi_8h.html#a1207a417b47b08dec9e8da04d8b1e334">descriptor</a>;
<a name="l04004"></a>04004             }
<a name="l04005"></a>04005 
<a name="l04006"></a>04006             <span class="keywordflow">if</span> (value.status !== <span class="stringliteral">&#39;200&#39;</span>) {
<a name="l04007"></a>04007               <span class="keyword">this</span>[mapName] = defaultTo;
<a name="l04008"></a>04008             } <span class="keywordflow">else</span> {
<a name="l04009"></a>04009               <span class="keyword">this</span>[mapName] = value.value;
<a name="l04010"></a>04010             }
<a name="l04011"></a>04011 
<a name="l04012"></a>04012           }
<a name="l04013"></a>04013         }
<a name="l04014"></a>04014       }
<a name="l04015"></a>04015     },
<a name="l04016"></a>04016 
<a name="l04022"></a>04022     createQuery: <span class="keyword">function</span>() {
<a name="l04023"></a>04023       <span class="keywordflow">return</span> <span class="keyword">new</span> CalendarQuery(this.connection, {
<a name="l04024"></a>04024         url: this.url
<a name="l04025"></a>04025       });
<a name="l04026"></a>04026     }
<a name="l04027"></a>04027 
<a name="l04028"></a>04028   };
<a name="l04029"></a>04029 
<a name="l04030"></a>04030   module.exports = <a class="code" href="../../d4/d99/create__event__test_8js.html#a4a0f6a3a1b73d50ac6e8a34fe754f79f">Calendar</a>;
<a name="l04031"></a>04031 
<a name="l04032"></a>04032 }.apply(
<a name="l04033"></a>04033   <span class="keyword">this</span>,
<a name="l04034"></a>04034   (this.Caldav) ?
<a name="l04035"></a>04035     [Caldav(<span class="stringliteral">&#39;resources/calendar&#39;</span>), Caldav] :
<a name="l04036"></a>04036     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l04037"></a>04037 ));
<a name="l04038"></a>04038 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l04039"></a>04039 
<a name="l04040"></a>04040   module.exports = {
<a name="l04041"></a>04041     <a class="code" href="../../d4/d99/create__event__test_8js.html#a4a0f6a3a1b73d50ac6e8a34fe754f79f">Calendar</a>: <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;resources/calendar&#39;</span>)
<a name="l04042"></a>04042   };
<a name="l04043"></a>04043 
<a name="l04044"></a>04044 }.apply(
<a name="l04045"></a>04045   <span class="keyword">this</span>,
<a name="l04046"></a>04046   (this.Caldav) ?
<a name="l04047"></a>04047     [Caldav(<span class="stringliteral">&#39;resources&#39;</span>), Caldav] :
<a name="l04048"></a>04048     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;../caldav&#39;</span>)]
<a name="l04049"></a>04049 ));
<a name="l04050"></a>04050 
<a name="l04051"></a>04051 (<span class="keyword">function</span>(<a class="code" href="../../dc/dd7/ext_2caldav_8js.html#a84770557f73663cbea2a9e12e7d45257">module</a>, <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>) {
<a name="l04052"></a>04052 
<a name="l04053"></a>04053   var <a class="code" href="../../d8/deb/test_2marionette_2lib_2browser_8js.html#aa4072ba4b6b56b0fb6f4801f17ab2b34">exports</a> = module.exports;
<a name="l04054"></a>04054 
<a name="l04055"></a>04055   exports.Responder = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;responder&#39;</span>);
<a name="l04056"></a>04056   exports.Sax = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;sax&#39;</span>);
<a name="l04057"></a>04057   exports.Template = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;template&#39;</span>);
<a name="l04058"></a>04058   exports.QueryBuilder = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;query_builder&#39;</span>);
<a name="l04059"></a>04059   exports.Xhr = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;xhr&#39;</span>);
<a name="l04060"></a>04060   exports.Request = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;request&#39;</span>);
<a name="l04061"></a>04061   exports.Connection = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;connection&#39;</span>);
<a name="l04062"></a>04062   exports.Resources = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;resources&#39;</span>);
<a name="l04063"></a>04063   exports.Http = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;http&#39;</span>);
<a name="l04064"></a>04064   exports.OAuth2 = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;oauth2&#39;</span>);
<a name="l04065"></a>04065   exports.Errors = <a class="code" href="../../d4/d21/calendar_2js_2controllers_2alarm_8js.html#a0416fc4d5e8ec4fd436369a406438e44">ns</a>.require(<span class="stringliteral">&#39;errors&#39;</span>);
<a name="l04066"></a>04066 
<a name="l04067"></a>04067 }.apply(
<a name="l04068"></a>04068   <span class="keyword">this</span>,
<a name="l04069"></a>04069   (this.Caldav) ?
<a name="l04070"></a>04070     [Caldav, Caldav] :
<a name="l04071"></a>04071     [module, <a class="code" href="../../d9/d2e/alameda_8js.html#a4b4eb847520ff4e45de16db801e26133">require</a>(<span class="stringliteral">&#39;./caldav&#39;</span>)]
<a name="l04072"></a>04072 ));
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../dc/dd7/ext_2caldav_8js.html">caldav.js</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:51:08に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
