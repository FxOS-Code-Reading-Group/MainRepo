<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: update_manager_test.js</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('df/d5d/update__manager__test_8js.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">関数</a> &#124;
<a href="#var-members">変数</a>  </div>
  <div class="headertitle">
<div class="title">update_manager_test.js</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="../../df/d5d/update__manager__test_8js_source.html">ソースコードを見る。</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
関数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5d/update__manager__test_8js.html#a15681e52ba688839d4e02aed01a9653d">requireApp</a> ('system/js/update_manager.js')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5d/update__manager__test_8js.html#a8f2ca85e6ce639457abe0a379420ff8b">suite</a> ('system/<a class="el" href="../../d8/dbd/update__manager_8js.html#a641473f3c9d189de642b3261d79fd1d0">UpdateManager</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a2aabcf5791ac4e05eb7c34d450848ae5">realL10n</a>;var realWifiManager;var realRequestWakeLock;var realNavigatorSettings;var realDispatchEvent;var apps;var updatableApps;var uAppWithDownloadAvailable;var appWithDownloadAvailable;var fakeNode;var fakeToaster;var fakeDialog;var fakeWarning;var tinyTimeout=10;var lastDispatchedEvent=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d9/db5/variant__test_8js.html#acb4b592588f242b9d11075d725257bc8">mocksForUpdateManager.attachTestHelpers</a>();suiteSetup(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){realNavigatorSettings=<a class="el" href="../../dc/da7/fm_8js.html#a46efbc9e28313d5603af4022d6352293">navigator.mozSettings</a>;<a class="el" href="../../dc/da7/fm_8js.html#a46efbc9e28313d5603af4022d6352293">navigator.mozSettings</a>=MockNavigatorSettings;<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a2aabcf5791ac4e05eb7c34d450848ae5">realL10n</a>=<a class="el" href="../../df/dc7/viewer_8js.html#abf8c988c23b2b2f5ec3f1149b44bd820">navigator.mozL10n</a>;<a class="el" href="../../df/dc7/viewer_8js.html#abf8c988c23b2b2f5ec3f1149b44bd820">navigator.mozL10n</a>=<a class="el" href="../../dd/daf/system_2test_2unit_2mock__l10n_8js.html#af9a9d6d42b9a7f8153f63783711f14c3">MockL10n</a>;realWifiManager=navigator.mozWifiManager;navigator.mozWifiManager={connection:{status: '<a class="el" href="../../d9/dc5/mock__handled__call_8js.html#a4dac86cd80b5b7d9bd4d930beafb08f1">connected</a>'}};realRequestWakeLock=navigator.requestWakeLock;navigator.requestWakeLock=MockNavigatorWakeLock.requestWakeLock;realDispatchEvent=<a class="el" href="../../d3/d44/updatable_8js.html#a9b9427d7bc55e9f10d0a779caa1a86a6">UpdateManager._dispatchEvent</a>;<a class="el" href="../../d3/d44/updatable_8js.html#a9b9427d7bc55e9f10d0a779caa1a86a6">UpdateManager._dispatchEvent</a>=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> fakeDispatch(<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){lastDispatchedEvent={type:type, value:value};};UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});suiteTeardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../dc/da7/fm_8js.html#a46efbc9e28313d5603af4022d6352293">navigator.mozSettings</a>=realNavigatorSettings;realNavigatorSettings=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../df/dc7/viewer_8js.html#abf8c988c23b2b2f5ec3f1149b44bd820">navigator.mozL10n</a>=<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a2aabcf5791ac4e05eb7c34d450848ae5">realL10n</a>;navigator.mozWifiManager=realWifiManager;navigator.requestWakeLock=realRequestWakeLock;realRequestWakeLock=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d3/d44/updatable_8js.html#a9b9427d7bc55e9f10d0a779caa1a86a6">UpdateManager._dispatchEvent</a>=realDispatchEvent;});<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._mgmt=<a class="el" href="../../dc/d05/system_2test_2unit_2mock__apps__mgmt_8js.html#a7d7129788c72b799533945793b622557">MockAppsMgmt</a>;apps=[new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>(), new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>(), new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>()];updatableApps=apps.map(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> new <a class="el" href="../../d3/d44/updatable_8js.html#aea31423b318d1ad16f260fc5ad8a64ba">AppUpdatable</a>(<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>);});MockAppsMgmt.mApps=apps;uAppWithDownloadAvailable=updatableApps[2];appWithDownloadAvailable=apps[2];appWithDownloadAvailable.downloadAvailable=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;fakeNode=document.createElement('div');<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">fakeNode.id</a>= '<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>-manager-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a88e6efb757b9907baa46a5755484f2bd">container</a>';<a class="el" href="../../d1/d04/app__install__manager_8js.html#acd145aedb51101ac15a526f73673b0b9">fakeNode.innerHTML</a>=[ '&lt; div class=&quot;icon&quot;&gt;', '&lt;/div &gt;', '&lt; div class=&quot;activity&quot;&gt;', '&lt;/div &gt;', '&lt; div class=&quot;message&quot;&gt;', '&lt;/div &gt;'].<a class="el" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>('');fakeToaster=document.createElement('div');<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">fakeToaster.id</a>= '<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>-manager-toaster';<a class="el" href="../../d1/d04/app__install__manager_8js.html#acd145aedb51101ac15a526f73673b0b9">fakeToaster.innerHTML</a>=[ '&lt; div class=&quot;icon&quot;&gt;', '&lt;/div &gt;', '&lt; div class=&quot;message&quot;&gt;', '&lt;/div &gt;'].<a class="el" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>('');fakeDialog=document.createElement('form');<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">fakeDialog.id</a>= 'updates-<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>-<a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>';<a class="el" href="../../d1/d04/app__install__manager_8js.html#acd145aedb51101ac15a526f73673b0b9">fakeDialog.innerHTML</a>=[ '&lt; <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a1df8504e63545f2e6c93c0cde966c060">section</a> &gt;', '&lt; h1 &gt;', 'Updates', '&lt;/h1 &gt;', '&lt; ul &gt;', '&lt;/ul &gt;', '&lt; menu &gt;', '&lt; <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>=&quot;updates-later-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>&quot;type=&quot;reset&quot;&gt;', 'Later', '&lt;/<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> &gt;', '&lt; <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>=&quot;updates-<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>&quot;type=&quot;submit&quot;&gt;', 'Download', '&lt;/<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> &gt;', '&lt;/menu &gt;', '&lt;/<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a1df8504e63545f2e6c93c0cde966c060">section</a> &gt;'].<a class="el" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>('');fakeWarning=document.createElement('form');<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">fakeWarning.id</a>= 'updates-viaDataConnection-<a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>';<a class="el" href="../../d1/d04/app__install__manager_8js.html#acd145aedb51101ac15a526f73673b0b9">fakeWarning.innerHTML</a>=[ '&lt; <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a1df8504e63545f2e6c93c0cde966c060">section</a> &gt;', '&lt; h1 &gt;', 'Updates', '&lt;/h1 &gt;', '&lt; <a class="el" href="../../dd/dc2/plarenas_8h.html#a117104b82864d3b23ec174af6d392709">p</a> &gt;', '&lt;/<a class="el" href="../../dd/dc2/plarenas_8h.html#a117104b82864d3b23ec174af6d392709">p</a> &gt;', '&lt; menu &gt;', '&lt; <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>=&quot;updates-viaDataConnection-notnow-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>&quot;type=&quot;reset&quot;&gt;', 'Not Now', '&lt;/<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> &gt;', '&lt; <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>=&quot;updates-viaDataConnection-<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>&quot; ', 'type=&quot;submit&quot;&gt;', 'Download', '&lt;/<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> &gt;', '&lt;/menu &gt;', '&lt;/<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a1df8504e63545f2e6c93c0cde966c060">section</a> &gt;'].<a class="el" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>('');document.body.appendChild(fakeNode);document.body.appendChild(fakeToaster);document.body.appendChild(fakeDialog);document.body.appendChild(fakeWarning);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#adf7ce41cd256eda7ce1f6adeea723bd3">setTimeout</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> <a class="el" href="../../d6/dec/mocha-bin_8js.html#a537e168ad693c5794e1977de944002a0">nextTick</a>(){UpdateManager.updatableApps=[];UpdateManager.systemUpdatable=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.updatesQueue=[];UpdateManager.downloadsQueue=[];UpdateManager._downloading=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;UpdateManager._uncompressing=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d3/d4b/lockscreen_8js.html#a88e6efb757b9907baa46a5755484f2bd">UpdateManager.container</a>=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d2/d7d/jsapi_8h.html#a254bf0858da09c96a48daf64404eb4f8">UpdateManager.message</a>=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.toaster=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.toasterMessage=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.laterButton=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.downloadButton=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.downloadDialog=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.downloadDialogTitle=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.downloadDialogList=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager.lastUpdatesAvailable=0;UpdateManager._notificationTimeout=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;UpdateManager._errorTimeout=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockAppsMgmt.mTeardown</a>();<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5ebdda199bee63b9cb8dc969a17d4a9e">fakeNode.parentNode.removeChild</a>(fakeNode);<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5ebdda199bee63b9cb8dc969a17d4a9e">fakeToaster.parentNode.removeChild</a>(fakeToaster);<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5ebdda199bee63b9cb8dc969a17d4a9e">fakeDialog.parentNode.removeChild</a>(fakeDialog);lastDispatchedEvent=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockNavigatorWakeLock.mTeardown</a>();<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockNavigatorSettings.mTeardown</a>();<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">init</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d4/d00/tools_2xpcwindow_2lib_2modules_2debug_8js.html#a18697261a961b9d0efde405b5a2b244f">get</a> all applications', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){MockAppsMgmt.mNext=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/dce/utils_81_83_8js.html#ab92647390e7481607cad94f9c4cf38f0">create</a> <a class="el" href="../../d3/d44/updatable_8js.html#aea31423b318d1ad16f260fc5ad8a64ba">AppUpdatable</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> <a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">init</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockAppUpdatable.mTeardown</a>();MockAppsMgmt.mNext=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d7/d13/mock__updatable_8js.html#abbcb12f502612a6901d1ce7c30886e37">MockAppUpdatable.mCount</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">apps.length</a>);<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#a1ad2f17c038f79ef240a44e21a46ef14">bind</a> <a class="el" href="../../dd/d85/video_8js.html#a017102f866db15b37d9657454efde4ff">dom</a> elements', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>-manager-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a88e6efb757b9907baa46a5755484f2bd">container</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.container.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('<a class="el" href="../../d2/d7d/jsapi_8h.html#a254bf0858da09c96a48daf64404eb4f8">message</a>', UpdateManager.message.className);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>-manager-toaster', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.toaster.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('<a class="el" href="../../d2/d7d/jsapi_8h.html#a254bf0858da09c96a48daf64404eb4f8">message</a>', UpdateManager.toasterMessage.className);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updates-later-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.laterButton.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updates-<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.downloadButton.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updates-<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>-<a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.downloadDialog.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updates-viaDataConnection-<a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.downloadViaDataConnectionDialog.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updates-viaDataConnection-notnow-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.notnowButton.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updates-viaDataConnection-<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">UpdateManager.downloadViaDataConnectionButton.id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('H1', UpdateManager.downloadDialogTitle.tagName);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('UL', UpdateManager.downloadDialogList.tagName);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#a1ad2f17c038f79ef240a44e21a46ef14">bind</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the click <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.containerClicked.name</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.container.onclick.name</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.requestDownloads.name</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.downloadButton.onclick.name</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.cancelPrompt.name</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.laterButton.onclick.name</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.cancelDataConnectionUpdatesPrompt.name</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.notnowButton.onclick.name</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.requestDownloads.name</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.downloadViaDataConnectionButton.onclick.name</a>);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('events', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> <a class="el" href="../../d0/dda/tools_2extensions_2httpd_2bootstrap_8js.html#a62c0c990db107f65eb2faf422eaea2c1">install</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var installedApp;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockAppUpdatable.mTeardown</a>();MockAppsMgmt.mApps=[];<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();installedApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>();installedApp.downloadAvailable=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;MockAppsMgmt.mTriggerOninstall(installedApp);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should instantiate an updatable <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d7/d13/mock__updatable_8js.html#abbcb12f502612a6901d1ce7c30886e37">MockAppUpdatable.mCount</a>, 1);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> <a class="el" href="../../d0/dda/tools_2extensions_2httpd_2bootstrap_8js.html#a7d65343d044ec164e6ea4a726b5adce5">uninstall</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var partialApp;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();UpdateManager.updatableApps=updatableApps;UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);partialApp={origin:appWithDownloadAvailable.origin, <a class="el" href="../../d1/d04/app__install__manager_8js.html#a5983b6d50c2fbf95ffe3907399e83a3c">manifestURL:appWithDownloadAvailable.manifestURL</a>};});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> the updatable <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatableApps.length</a>;MockAppsMgmt.mTriggerOnuninstall(partialApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatableApps.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> from the <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> queue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;MockAppsMgmt.mTriggerOnuninstall(partialApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> from the <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> queue even <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> no downloadavailable', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){uAppWithDownloadAvailable.app.downloadAvailable=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;MockAppsMgmt.mTriggerOnuninstall(partialApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a> <a class="el" href="../../d7/d13/mock__updatable_8js.html#a0a545f3fc3649048e3c5c41303a26cc3">uninit</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> the updatable', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var lastIndex=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>-1;var updatableApp=UpdateManager.updatesQueue[lastIndex];MockAppsMgmt.mTriggerOnuninstall(partialApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(updatableApp.mUninitCalled);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('system <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> available', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>=new <a class="el" href="../../d5/d3f/mock__chrome__event_8js.html#aacec9cd066c78ab4937d83ed9378f460">MockChromeEvent</a>({type: '<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>-available', size:42});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">UpdateManager.handleEvent</a>(<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> system updatable <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var lastIndex=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>-1;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(undefined, UpdateManager.updatesQueue[lastIndex].<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">init</a> the updatable with the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">size</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var lastIndex=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>-1;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(42, UpdateManager.updatesQueue[lastIndex].<a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">size</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> or instanciate <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> system updatable <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> there is one', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">UpdateManager.handleEvent</a>(<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>, initialLength);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d7/d13/mock__updatable_8js.html#a0609a2b1673784157eb50af422d13e37">MockSystemUpdatable.mInstancesCount</a>, 1);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should remember that <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> is available', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(UpdateManager.systemUpdatable.mKnownUpdate);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('no system <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> available', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not remember about the <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){assert.isUndefined(UpdateManager.systemUpdatable.mKnownUpdate);});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('UI', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){this.sinon.useFakeTimers();MockAppsMgmt.mApps=[];<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();UpdateManager.updatableApps=updatableApps;});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a19c66abfee1b46609f11c5320d6b0843">this.sinon.clock.restore</a>();});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('downloading <a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> the css class <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> downloading', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._downloading=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">UpdateManager.render</a>();var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('downloading'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> the css class <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> not downloading', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._downloading=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">UpdateManager.render</a>();UpdateManager._downloading=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">UpdateManager.render</a>();var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('downloading'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> the downloading progress <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> downloading', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._downloading=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">UpdateManager.render</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('downloadingUpdateMessage{&quot;progress&quot;:&quot;0.00 <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a>&quot;}', UpdateManager.message.textContent);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> downloading', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=tinyTimeout;UpdateManager.TOASTER_TIMEOUT=tinyTimeout;UpdateManager._downloading=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> the toaster', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.toaster.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('displayed'));});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> the available <a class="el" href="../../d2/d7d/jsapi_8h.html#a254bf0858da09c96a48daf64404eb4f8">message</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> not downloading', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.updatesQueue=updatableApps;<a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">UpdateManager.render</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:3}', UpdateManager.message.textContent);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('progress display', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.updatesQueue=[uAppWithDownloadAvailable];var evt=document.createEvent('MouseEvents');evt.initEvent('click', <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);UpdateManager.startDownloads(evt);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.downloadProgressed(1234);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('downloadedBytes should be <a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">reset</a> by startDownloads', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var evt=document.createEvent('MouseEvents');evt.initEvent('click', <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);UpdateManager.startDownloads(evt);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('downloadingUpdateMessage{&quot;progress&quot;:&quot;0.00 <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a>&quot;}', UpdateManager.message.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('downloadedBytes should be <a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">reset</a> when stopping the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.removeFromDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('downloadingUpdateMessage{&quot;progress&quot;:&quot;0.00 <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a>&quot;}', UpdateManager.message.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should increment the downloadedBytes', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.downloadProgressed(100);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('downloadingUpdateMessage{&quot;progress&quot;:&quot;1.30 kB&quot;}', UpdateManager.message.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a>&lt;=0', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.downloadProgressed(-100);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('downloadingUpdateMessage{&quot;progress&quot;:&quot;1.21 kB&quot;}', UpdateManager.message.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should display the notification', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(fakeNode.classList.contains('displayed'));});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dc/d4d/mozzconf_8h.html#a0a7eedf0dba136b3a92685a8f625b8e7">uncompress</a> display', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdatable;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){systemUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('when we only have the system <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToUpdatesQueue(systemUpdatable);UpdateManager.addToDownloadsQueue(systemUpdatable);UpdateManager.startedUncompressing();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a> in uncompressing <a class="el" href="../../db/da2/pripcsem_8h.html#a5ffbd19d0a0b87f9ff15e7d0c4410984">mode</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">UpdateManager.message.textContent</a>, 'uncompressingMessage');});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('when we have various ongoing updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToUpdatableApps(uAppWithDownloadAvailable);UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.addToUpdatesQueue(systemUpdatable);UpdateManager.addToDownloadsQueue(systemUpdatable);UpdateManager.startedUncompressing();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should stay in downloading <a class="el" href="../../db/da2/pripcsem_8h.html#a5ffbd19d0a0b87f9ff15e7d0c4410984">mode</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){assert.include(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">UpdateManager.message.textContent</a>, 'downloadingUpdateMessage');});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../de/dfc/events_8js.html#a801b0668ecf79a79c81f75dbbabb4ebf">once</a> the <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> updates are <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.removeFromDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.removeFromUpdatesQueue(uAppWithDownloadAvailable);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a> in uncompressing <a class="el" href="../../db/da2/pripcsem_8h.html#a5ffbd19d0a0b87f9ff15e7d0c4410984">mode</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">UpdateManager.message.textContent</a>, 'uncompressingMessage');});});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d3/d4b/lockscreen_8js.html#a88e6efb757b9907baa46a5755484f2bd">container</a> <a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#acc14a0c6668e68b49c91fb961cdfbf40">visibility</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){suiteSetup(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=tinyTimeout;UpdateManager.TOASTER_TIMEOUT=tinyTimeout;});suiteTeardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('notification behavior after addToDownloadsQueue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should be displayed only <a class="el" href="../../de/dfc/events_8js.html#a801b0668ecf79a79c81f75dbbabb4ebf">once</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('displayed'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockNotificationScreen.wasMethodCalled['<a class="el" href="../../d1/d04/app__install__manager_8js.html#a0d63fdff81f28acf6c6d745c96960c92">incExternalNotifications</a>'], 1);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not be displayed again after <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('displayed'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockNotificationScreen.wasMethodCalled['<a class="el" href="../../d1/d04/app__install__manager_8js.html#a0d63fdff81f28acf6c6d745c96960c92">incExternalNotifications</a>'], 1);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('notification behavior after addToDownloadsQueue after <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not increment the counter <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> already displayed', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('displayed'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockNotificationScreen.wasMethodCalled['<a class="el" href="../../d1/d04/app__install__manager_8js.html#a0d63fdff81f28acf6c6d745c96960c92">incExternalNotifications</a>'], 1);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('displaying the <a class="el" href="../../d3/d4b/lockscreen_8js.html#a88e6efb757b9907baa46a5755484f2bd">container</a> after <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('displayed'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should display after <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('displayed'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockNotificationScreen.wasMethodCalled['<a class="el" href="../../d1/d04/app__install__manager_8js.html#a0d63fdff81f28acf6c6d745c96960c92">incExternalNotifications</a>'], 1);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not display <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> there are no more updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d4/d00/tools_2xpcwindow_2lib_2modules_2debug_8js.html#aae3803cf3819ae1182550b783e1ea692">UpdateManager.updatesQueue.forEach</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(uApp){UpdateManager.removeFromUpdatesQueue(uApp);});<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('displayed'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should display an updated <a class="el" href="../../de/d8f/jsdebug_8h.html#af0b029640ba74e8a63ae0af6f51680ca">count</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToUpdatesQueue(updatableApps[1]);<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:2}', UpdateManager.message.textContent);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> toaster', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should display after <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('displayed'));<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);var css=UpdateManager.toaster.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('displayed'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.toasterMessage.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">reset</a> toaster <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a> when notification was activated', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);UpdateManager.addToUpdatesQueue(updatableApps[1]);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.toasterMessage.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> the <a class="el" href="../../d2/d7d/jsapi_8h.html#a06a61119547d88fbcdf5e877c6c9057e">right</a> <a class="el" href="../../d2/d7d/jsapi_8h.html#a254bf0858da09c96a48daf64404eb4f8">message</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.toasterMessage.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#abb32d825b52ef528b86b799b6247e79a">hide</a> after TOASTER_TIMEOUT', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToUpdatesQueue(updatableApps[1]);<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout *2);var css=UpdateManager.toaster.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('displayed'));});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> new statusbar notification', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);var method1= '<a class="el" href="../../d1/d04/app__install__manager_8js.html#a0d63fdff81f28acf6c6d745c96960c92">incExternalNotifications</a>';<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(MockNotificationScreen.wasMethodCalled[method1]);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('no more updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">UpdateManager.container.classList.add</a>('displayed');UpdateManager.updatesQueue=[uAppWithDownloadAvailable];UpdateManager.removeFromUpdatesQueue(uAppWithDownloadAvailable);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#abb32d825b52ef528b86b799b6247e79a">hide</a> the <a class="el" href="../../d3/d4b/lockscreen_8js.html#a88e6efb757b9907baa46a5755484f2bd">container</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('displayed'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should decrease the external notifications <a class="el" href="../../de/d8f/jsdebug_8h.html#af0b029640ba74e8a63ae0af6f51680ca">count</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var method1= '<a class="el" href="../../d1/d04/app__install__manager_8js.html#aacaeb84d68d8dc58526c48dde5cea636">decExternalNotifications</a>';<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(MockNotificationScreen.wasMethodCalled[method1]);});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('after downloads', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should check <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> new updates where found', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var uApp=updatableApps[0];UpdateManager.updatableApps=updatableApps;UpdateManager.downloadsQueue=[uApp];UpdateManager.removeFromDownloadsQueue(uApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(uAppWithDownloadAvailable.app.mId, UpdateManager.updatesQueue[0].app.mId);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../db/df4/geoloc_8js.html#ac3dbd5af3a73f4aa69249dd1c6b9c980">error</a> banner requests', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){suiteSetup(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=tinyTimeout;UpdateManager.TOASTER_TIMEOUT=tinyTimeout;});suiteTeardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();UpdateManager.requestErrorBanner();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should wait before showing the system banner', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(0, MockSystemBanner.mShowCount);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> after NOTIFICATION_BUFFERING_TIMEOUT', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(1, MockSystemBanner.mShowCount);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('downloadError', MockSystemBanner.mMessage);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> only <a class="el" href="../../de/dfc/events_8js.html#a801b0668ecf79a79c81f75dbbabb4ebf">once</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> called multiple <a class="el" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.requestErrorBanner();<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(tinyTimeout);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(1, MockSystemBanner.mShowCount);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('humanizeSize', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> 0', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('0.00 <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a>', UpdateManager._humanizeSize(0));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a> <a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">size</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('42.00 <a class="el" href="../../de/d81/xpt__struct_8h.html#adcc78999fdbb41052741a6e30b16fab5">bytes</a>', UpdateManager._humanizeSize(42));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> kilobytes <a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">size</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('1.00 kB', UpdateManager._humanizeSize(1024));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> megabytes <a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">size</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('4.67 MB', UpdateManager._humanizeSize(4901024));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> gigabytes <a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">size</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('3.73 GB', UpdateManager._humanizeSize(4000901024));});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('actions', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d6/d1b/pprthred_8h.html#a0798cf327c99b856b5ecf03e5f4deb4d">start</a> downloads', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdatable, appUpdatable, evt;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){systemUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();appUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>());<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">appUpdatable.name</a>= 'Angry birds';<a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">appUpdatable.size</a>= '423459';UpdateManager.addToUpdatableApps(appUpdatable);UpdateManager.addToUpdatesQueue(appUpdatable);UpdateManager.addToUpdatesQueue(systemUpdatable);UpdateManager.container.click();evt=document.createEvent('MouseEvents');evt.initEvent('click', <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> connection warning', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var downloadDialog;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){downloadDialog=UpdateManager.downloadDialog;});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#aba983438655021425112777c0e7ebbe8">switch</a> the online <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> attribute when online', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){downloadDialog.dataset.online=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5e67712f1e4602312c66bda052a6f6c4">window.dispatchEvent</a>(new CustomEvent('online'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(downloadDialog.dataset.online, '<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should leave the online <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> attribute <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a> when online', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){downloadDialog.dataset.online=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5e67712f1e4602312c66bda052a6f6c4">window.dispatchEvent</a>(new CustomEvent('online'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(downloadDialog.dataset.online, '<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#aba983438655021425112777c0e7ebbe8">switch</a> the nowifi <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> attribute when <a class="el" href="../../d9/dc5/mock__handled__call_8js.html#a4dac86cd80b5b7d9bd4d930beafb08f1">connected</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){downloadDialog.dataset.nowifi=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5e67712f1e4602312c66bda052a6f6c4">window.dispatchEvent</a>(new CustomEvent('wifi-statuschange'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(downloadDialog.dataset.nowifi, '<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#aba983438655021425112777c0e7ebbe8">switch</a> the nowifi <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> attribute when <a class="el" href="../../d9/dc5/mock__handled__call_8js.html#af872a565c388d56f3bc6c62a61d53a54">disconnected</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){downloadDialog.dataset.nowifi=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../de/d8f/jsdebug_8h.html#a0818854fd36b9ae0fdfe5872464dae94">navigator.mozWifiManager.connection.status</a>= '<a class="el" href="../../d9/dc5/mock__handled__call_8js.html#af872a565c388d56f3bc6c62a61d53a54">disconnected</a>';<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5e67712f1e4602312c66bda052a6f6c4">window.dispatchEvent</a>(new CustomEvent('wifi-statuschange'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(downloadDialog.dataset.nowifi, '<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>');});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a6fcb34890564d6e8b76a24e04c74e05f">enable</a> the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var downloadButton=UpdateManager.downloadButton;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(downloadButton.disabled);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('with all the checkboxes checked', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.startDownloads(evt);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> system updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(systemUpdatable.mDownloadCalled);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a> <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> checked <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> updatables', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(appUpdatable.mDownloadCalled);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('with no checkbox checked', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>=UpdateManager.downloadDialogList;var checkboxes=dialog.querySelectorAll('<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>[<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>=&quot;checkbox&quot;]');for(var <a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>=0;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>&lt; <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">checkboxes.length</a>;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>++){var checkbox=checkboxes[<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>];<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(checkbox.checked){checkbox.click();}}UpdateManager.startDownloads(evt);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> should be <a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#ad40d8437f6cf8675f077c4117119c8c0">enabled</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(UpdateManager.downloadButton.disabled);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should still <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> system updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(systemUpdatable.mDownloadCalled);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a> <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> unchecked <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> updatables', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(appUpdatable.mDownloadCalled);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('with only <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.removeFromUpdatesQueue(systemUpdatable);UpdateManager.container.click();});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('unchecking all the checkboxes', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>, downloadButton;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>=UpdateManager.downloadDialogList;var checkboxes=dialog.querySelectorAll('<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>[<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>=&quot;checkbox&quot;]');for(var <a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>=0;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>&lt; <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">checkboxes.length</a>;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>++){var checkbox=checkboxes[<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>];<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(checkbox.checked){checkboxes[<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>].click();}}downloadButton=UpdateManager.downloadButton;});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a2586704a2afad5dc4a8e398b7929bc98">disable</a> the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(downloadButton.disabled);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('then checking one back', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var checkbox=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">dialog.querySelector</a>('<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>[<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>=&quot;checkbox&quot;]');checkbox.click();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a6fcb34890564d6e8b76a24e04c74e05f">enable</a> the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> back', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(downloadButton.disabled);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dc/d35/inline-receiver_8js.html#a01de14b323a40639980004403daa8432">cancel</a> and reopen', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.cancelPrompt();UpdateManager.containerClicked();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should check all checkboxes', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var checkboxes=dialog.querySelectorAll( '<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>[<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>=&quot;checkbox&quot;]');for(var <a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>=0;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>&lt; <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">checkboxes.length</a>;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>++){var checkbox=checkboxes[<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>];<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(checkbox.checked);}});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a6fcb34890564d6e8b76a24e04c74e05f">enable</a> the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(downloadButton.disabled);});});});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dc/d35/inline-receiver_8js.html#a01de14b323a40639980004403daa8432">cancel</a> all downloads', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdatable;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){systemUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();UpdateManager.updatableApps=updatableApps;[systemUpdatable, uAppWithDownloadAvailable].<a class="el" href="../../d4/d00/tools_2xpcwindow_2lib_2modules_2debug_8js.html#aae3803cf3819ae1182550b783e1ea692">forEach</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(updatable){UpdateManager.addToUpdatesQueue(updatable);UpdateManager.addToDownloadsQueue(updatable);});UpdateManager.cancelAllDownloads();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a> <a class="el" href="../../d7/d13/mock__updatable_8js.html#ae4ffdf458c89bf681f32585d99947d8c">cancelDownload</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> the <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> updatables', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(uAppWithDownloadAvailable.mCancelCalled);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a> <a class="el" href="../../d7/d13/mock__updatable_8js.html#ae4ffdf458c89bf681f32585d99947d8c">cancelDownload</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> the system updatable', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(systemUpdatable.mCancelCalled);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should empty the downloads queue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>, 0);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should leave the updates available', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>, 2);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('_dataConnectionWarningEnabled should not be affected by'+ 'canceling downloads', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){let systemUpdatable;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){systemUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();UpdateManager.updatableApps=updatableApps;[systemUpdatable, uAppWithDownloadAvailable].<a class="el" href="../../d4/d00/tools_2xpcwindow_2lib_2modules_2debug_8js.html#aae3803cf3819ae1182550b783e1ea692">forEach</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(updatable){UpdateManager.addToUpdatesQueue(updatable);UpdateManager.addToDownloadsQueue(updatable);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('_dataConnectionWarningEnabled should be <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> it was <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._dataConnectionWarningEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;UpdateManager.cancelAllDownloads();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(UpdateManager._dataConnectionWarningEnabled);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('_dataConnectionWarningEnabled should be <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> it was <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._dataConnectionWarningEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;UpdateManager.cancelAllDownloads();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(UpdateManager._dataConnectionWarningEnabled);});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('downloaded', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp, downloadDialog;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();var installedApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>();updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(installedApp);UpdateManager.updatableApps=[updatableApp];downloadDialog=UpdateManager.downloadDialog;});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> downloaded when started using <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> connection', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._startedDownloadUsingDataConnection=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;UpdateManager.downloaded(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(UpdateManager._startedDownloadUsingDataConnection);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(UpdateManager._dataConnectionWarningEnabled);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(downloadDialog.dataset.dataConnectionInlineWarning, '<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> downloaded when started using wifi', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._startedDownloadUsingDataConnection=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;UpdateManager.downloaded(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(UpdateManager._startedDownloadUsingDataConnection);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(UpdateManager._dataConnectionWarningEnabled);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(downloadDialog.dataset.dataConnectionInlineWarning, '<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>');});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> prompt', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">MockUtilityTray.show</a>();var systemUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();<a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">systemUpdatable.size</a>=5296345;var appUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>());<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">appUpdatable.name</a>= 'Angry birds';appUpdatable.nameID= '';<a class="el" href="../../d0/da8/prrng_8h.html#a5c72e4e1ff78177bac89e7f0ddadda92">appUpdatable.size</a>= '423459';var hostedAppUpdatable=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>());<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">hostedAppUpdatable.name</a>= 'Twitter';hostedAppUpdatable.nameID= '';UpdateManager.updatesQueue=[hostedAppUpdatable, appUpdatable, systemUpdatable];UpdateManager.containerClicked();UpdateManager._dataConnectionWarningEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;UpdateManager._startedDownloadUsingDataConnection=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;UpdateManager.downloadDialog.dataset.nowifi=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> prompt', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#abb32d825b52ef528b86b799b6247e79a">hide</a> the utility tray', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockUtilityTray.mShown);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> the <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> <a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.downloadDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> the <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">fakeDialog.querySelector</a>('h1');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('numberOfUpdates{&quot;n&quot;:3}', title.textContent);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> <a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a> rendering', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/dce/utils_81_83_8js.html#ab92647390e7481607cad94f9c4cf38f0">create</a> an item <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> each <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(3, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadDialogList.children.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a> system <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> item <a class="el" href="../../d3/da1/shared_2resources_2apn_2_r_e_a_d_m_e_8md.html#aab9764d7f9e519400127ef5189844ed3">first</a> with required', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var item=UpdateManager.downloadDialogList.children[0];assert.include(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">item.textContent</a>, '5.05 MB');assert.include(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">item.textContent</a>, 'required');var <a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">item.querySelector</a>('<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">div.name</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">name.textContent</a>, 'System Update');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(name.dataset.l10nId, 'systemUpdate');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a> packaged <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> items alphabetically with checkbox', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var item=UpdateManager.downloadDialogList.children[1];assert.include(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">item.textContent</a>, '413.53 kB');var <a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">item.querySelector</a>('<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">div.name</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">name.textContent</a>, 'Angry birds');assert.isUndefined(name.dataset.l10nId);var checkbox=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">item.querySelector</a>('<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">checkbox.type</a>, 'checkbox');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(checkbox.checked);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#acd1cdae9d6d8493a6f34d308f8259f55">checkbox.dataset.position</a>, '1');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a> hosted <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> items alphabetically with checkbox', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var item=UpdateManager.downloadDialogList.children[2];var <a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">item.querySelector</a>('<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">div.name</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">name.textContent</a>, 'Twitter');assert.isUndefined(name.dataset.l10nId);var checkbox=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">item.querySelector</a>('<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">checkbox.type</a>, 'checkbox');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(checkbox.checked);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#acd1cdae9d6d8493a6f34d308f8259f55">checkbox.dataset.position</a>, '2');});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> clicking <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> in'+ 'the <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> connection warning <a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.downloadDialog.dataset.nowifi=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;var evt={preventDefault:function(){}, type: 'click', target:UpdateManager.downloadViaDataConnectionButton};UpdateManager.requestDownloads(evt);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(UpdateManager._startedDownloadUsingDataConnection);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> clicking <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> when using <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> connection '+ 'in the <a class="el" href="../../d3/da1/shared_2resources_2apn_2_r_e_a_d_m_e_8md.html#aab9764d7f9e519400127ef5189844ed3">first</a> <a class="el" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.downloadDialog.dataset.nowifi=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;var evt=document.createEvent('MouseEvents');evt.initEvent('click', <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);UpdateManager.requestDownloads(evt);var css=UpdateManager.downloadViaDataConnectionDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> clicking <a class="el" href="../../d7/d13/mock__updatable_8js.html#ab9b84e146e6d762e377175efdca01924">download</a> when using wifi', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._isDataConnectionWarningDialogEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;var calledToMockStartDownloads=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;var realStartDownloadsFunc=UpdateManager.startDownloads;UpdateManager.startDownloads=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){calledToMockStartDownloads=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;};var evt=document.createEvent('MouseEvents');evt.initEvent('click', <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);UpdateManager.requestDownloads(evt);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(calledToMockStartDownloads);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(UpdateManager._startedDownloadUsingDataConnection);UpdateManager.startDownloads=realStartDownloadsFunc;});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> cancellation <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> the <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a> connection warning <a class="el" href="../../d1/d04/app__install__manager_8js.html#a888e6068bf00699dfddf2b6ee25e6c7a">dialog</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.cancelDataConnectionUpdatesPrompt();var css=UpdateManager.downloadViaDataConnectionDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));css=UpdateManager.downloadDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> cancellation', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.cancelPrompt();var css=UpdateManager.downloadDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> confirmation', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._isDataConnectionWarningDialogEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;var evt=document.createEvent('MouseEvents');evt.initEvent('click', <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);UpdateManager.requestDownloads(evt);var css=UpdateManager.downloadDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));css=UpdateManager.downloadViaDataConnectionDialog.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('<a class="el" href="../../d3/d4a/mock__recipients_8js.html#a6d342aea8f30c5f641ed5ff6e0f4de13">visible</a>'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(MockUtilityTray.mShown);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(evt.defaultPrevented);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dc/d35/inline-receiver_8js.html#a01de14b323a40639980004403daa8432">cancel</a> prompt', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._downloading=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">MockUtilityTray.show</a>();UpdateManager.containerClicked();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a> the <a class="el" href="../../dc/d35/inline-receiver_8js.html#a01de14b323a40639980004403daa8432">cancel</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(MockCustomDialog.mShown);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockUtilityTray.mShown);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('cancelAllDownloads', MockCustomDialog.mShowedTitle);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('wantToCancelAll', MockCustomDialog.mShowedMsg);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('no', <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">MockCustomDialog.mShowedCancel.title</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('yes', <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">MockCustomDialog.mShowedConfirm.title</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> cancellation', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('um_cancelPrompt', <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">MockCustomDialog.mShowedCancel.callback.name</a>);UpdateManager.cancelPrompt();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockCustomDialog.mShown);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a> confirmation', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('um_cancelAllDownloads', <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">MockCustomDialog.mShowedConfirm.callback.name</a>);UpdateManager.cancelAllDownloads();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockCustomDialog.mShown);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('check <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d9/d6e/ttlview_8js.html#aab157f1dc1e984fa6ce7c5b7670324ef">observe</a> the setting', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('gaia.system.checkForUpdates', MockSettingsListener.mName);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>, MockSettingsListener.mDefaultValue);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">UpdateManager.checkForUpdates.name</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">MockSettingsListener.mCallback.name</a>);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('when asked <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> check', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.checkForUpdates(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should dispatch force <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> asked <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('force-<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>-check', <a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">lastDispatchedEvent.type</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> the setting back <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var setting= 'gaia.system.checkForUpdates';<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockNavigatorSettings.mSettings[setting]);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not dispatch force <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> not asked', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.checkForUpdates(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);assert.isNull(lastDispatchedEvent);});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('queues support', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('updates queue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('addToUpdatesQueue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();var installedApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>();var updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(installedApp);var pendingApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>({installState: 'pending'}), uPendingApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(pendingApp);UpdateManager.updatableApps=[updatableApp, uPendingApp];});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> the updatable <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp=UpdateManager.updatableApps[0];var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength+1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp=UpdateManager.updatableApps[0];UpdateManager.addToUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.message.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> not in updatableApps <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>);var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> system <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdate=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(systemUpdate);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength+1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> more than one system <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdate=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();<a class="el" href="../../d5/da4/preferences_8js.html#a04cdfd02512383b1feea0e6fa7f5d3a3">UpdateManager.updatesQueue.push</a>(new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>());var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(systemUpdate);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> already in the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp=UpdateManager.updatableApps[0];UpdateManager.addToUpdatesQueue(updatableApp);var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> downloading', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager._downloading=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;var updatableApp=UpdateManager.updatableApps[0];var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> pending <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp=UpdateManager.updatableApps[1];var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.addToUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>, initialLength);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('removeFromUpdatesQueue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();var installedApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>();updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(installedApp);UpdateManager.updatableApps=[updatableApp];UpdateManager.updatesQueue=[updatableApp];});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> in updatesQueue <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.removeFromUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">render</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.removeFromUpdatesQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('updateAvailableInfo{&quot;n&quot;:0}', UpdateManager.message.textContent);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> system updates too', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdate=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();<a class="el" href="../../d5/da4/preferences_8js.html#a04cdfd02512383b1feea0e6fa7f5d3a3">UpdateManager.updatesQueue.push</a>(systemUpdate);var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>;UpdateManager.removeFromUpdatesQueue(systemUpdate);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.updatesQueue.length</a>);});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('downloads queue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('addToDownloadsQueue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();var installedApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>();updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(installedApp);UpdateManager.updatableApps=[updatableApp];});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> the updatable <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.addToDownloadsQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength+1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> system updates too', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.addToDownloadsQueue(new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>());<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength+1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> more than one system updates', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.addToDownloadsQueue(new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>());UpdateManager.addToDownloadsQueue(new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>());<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength+1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('switching <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> downloading <a class="el" href="../../db/da2/pripcsem_8h.html#a5ffbd19d0a0b87f9ff15e7d0c4410984">mode</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> <a class="el" href="../../d3/da1/shared_2resources_2apn_2_r_e_a_d_m_e_8md.html#aab9764d7f9e519400127ef5189844ed3">first</a> <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToDownloadsQueue(updatableApp);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> css class', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(css.contains('downloading'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should ask <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> statusbar indicator', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var incMethod= 'incSystemDownloads';<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(MockStatusBar.wasMethodCalled[incMethod]);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d44/permission__manager_8js.html#ad9abb423164fcb98d6ad9333893e4682">request</a> wifi wake <a class="el" href="../../df/d6d/prpdce_8h.html#a3a0acaef79170339a71bc1c4c54ad225">lock</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('wifi', MockNavigatorWakeLock.mLastWakeLock.topic);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockNavigatorWakeLock.mLastWakeLock.released);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> not in updatableApps <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>);var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.addToDownloadsQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> already in the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.addToDownloadsQueue(updatableApp);var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.addToDownloadsQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('removeFromDownloadsQueue', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var updatableApp;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">UpdateManager.init</a>();var installedApp=new <a class="el" href="../../de/d66/system_2test_2unit_2mock__app_8js.html#a1421952544f7eb7f0a1e8b18d7317125">MockApp</a>();updatableApp=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#a907a77894df54758ad228ec9e63fd7c0">MockAppUpdatable</a>(installedApp);UpdateManager.addToUpdatableApps(updatableApp);UpdateManager.addToDownloadsQueue(updatableApp);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> in downloadsQueue <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ad02ced9aca42ac6266a47ec4bf01d9c6">array</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.removeFromDownloadsQueue(updatableApp);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('should <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#aba983438655021425112777c0e7ebbe8">switch</a> <a class="el" href="../../d3/d4a/mock__recipients_8js.html#a8f93e3d7a5d6496d4ad3a9c2efd07229">off</a> downloading <a class="el" href="../../db/da2/pripcsem_8h.html#a5ffbd19d0a0b87f9ff15e7d0c4410984">mode</a> <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> last <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){UpdateManager.removeFromDownloadsQueue(updatableApp);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> css class', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var css=UpdateManager.container.classList;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(css.contains('downloading'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> statusbar indicator', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var decMethod= 'decSystemDownloads';<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(MockStatusBar.wasMethodCalled[decMethod]);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a170fe99e732335290145d391f9ca24dd">release</a> the wifi wake <a class="el" href="../../df/d6d/prpdce_8h.html#a3a0acaef79170339a71bc1c4c54ad225">lock</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>('wifi', MockNavigatorWakeLock.mLastWakeLock.topic);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(MockNavigatorWakeLock.mLastWakeLock.released);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should not <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a> <a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> wifi <a class="el" href="../../d3/d4b/lockscreen_8js.html#a5fcc87d72af0776c43f03559fd828d16">unlock</a> throws an exception', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){MockNavigatorWakeLock.mThrowAtNextUnlock();UpdateManager.removeFromDownloadsQueue(updatableApp);<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> system updates too', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var systemUpdate=new <a class="el" href="../../d7/d13/mock__updatable_8js.html#afcbc674056c8bf7f7d26b783d25b8073">MockSystemUpdatable</a>();<a class="el" href="../../d5/da4/preferences_8js.html#a04cdfd02512383b1feea0e6fa7f5d3a3">UpdateManager.downloadsQueue.push</a>(systemUpdate);var initialLength=<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>;UpdateManager.removeFromDownloadsQueue(systemUpdate);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(initialLength-1, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">UpdateManager.downloadsQueue.length</a>);});});});});})</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d1b/test-agent-server_8js.html#aab71dcc804ca4aa3ed2bf7ba887635db">use</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5d/update__manager__test_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5d/update__manager__test_8js.html#a643b2f3443ea4b83bdfe2a3191dcb279">mocksForUpdateManager</a></td></tr>
</table>
<hr/><h2>関数</h2>
<a class="anchor" id="a15681e52ba688839d4e02aed01a9653d"></a><!-- doxytag: member="update_manager_test.js::requireApp" ref="a15681e52ba688839d4e02aed01a9653d" args="('system/js/update_manager.js')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d16/shared_2test_2unit_2mocks_2mock__settings__listener_8js.html#ada5f8f0f77028802cd46c92cb1ce8fce">requireApp</a> </td>
          <td>(</td>
          <td class="paramtype">'system/js/update_manager.js'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a8f2ca85e6ce639457abe0a379420ff8b"></a><!-- doxytag: member="update_manager_test.js::suite" ref="a8f2ca85e6ce639457abe0a379420ff8b" args="('system/UpdateManager', function(){var realL10n;var realWifiManager;var realRequestWakeLock;var realNavigatorSettings;var realDispatchEvent;var apps;var updatableApps;var uAppWithDownloadAvailable;var appWithDownloadAvailable;var fakeNode;var fakeToaster;var fakeDialog;var fakeWarning;var tinyTimeout=10;var lastDispatchedEvent=null;mocksForUpdateManager.attachTestHelpers();suiteSetup(function(){realNavigatorSettings=navigator.mozSettings;navigator.mozSettings=MockNavigatorSettings;realL10n=navigator.mozL10n;navigator.mozL10n=MockL10n;realWifiManager=navigator.mozWifiManager;navigator.mozWifiManager={connection:{status: 'connected'}};realRequestWakeLock=navigator.requestWakeLock;navigator.requestWakeLock=MockNavigatorWakeLock.requestWakeLock;realDispatchEvent=UpdateManager._dispatchEvent;UpdateManager._dispatchEvent=function fakeDispatch(type, value){lastDispatchedEvent={type:type, value:value};};UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});suiteTeardown(function(){navigator.mozSettings=realNavigatorSettings;realNavigatorSettings=null;navigator.mozL10n=realL10n;navigator.mozWifiManager=realWifiManager;navigator.requestWakeLock=realRequestWakeLock;realRequestWakeLock=null;UpdateManager._dispatchEvent=realDispatchEvent;});setup(function(){UpdateManager._mgmt=MockAppsMgmt;apps=[new MockApp(), new MockApp(), new MockApp()];updatableApps=apps.map(function(app){return new AppUpdatable(app);});MockAppsMgmt.mApps=apps;uAppWithDownloadAvailable=updatableApps[2];appWithDownloadAvailable=apps[2];appWithDownloadAvailable.downloadAvailable=true;fakeNode=document.createElement('div');fakeNode.id= 'update&#45;manager&#45;container';fakeNode.innerHTML=[ '&lt; div class=&quot;icon&quot;&gt;', '&lt;/div &gt;', '&lt; div class=&quot;activity&quot;&gt;', '&lt;/div &gt;', '&lt; div class=&quot;message&quot;&gt;', '&lt;/div &gt;'].join('');fakeToaster=document.createElement('div');fakeToaster.id= 'update&#45;manager&#45;toaster';fakeToaster.innerHTML=[ '&lt; div class=&quot;icon&quot;&gt;', '&lt;/div &gt;', '&lt; div class=&quot;message&quot;&gt;', '&lt;/div &gt;'].join('');fakeDialog=document.createElement('form');fakeDialog.id= 'updates&#45;download&#45;dialog';fakeDialog.innerHTML=[ '&lt; section &gt;', '&lt; h1 &gt;', 'Updates', '&lt;/h1 &gt;', '&lt; ul &gt;', '&lt;/ul &gt;', '&lt; menu &gt;', '&lt; button id=&quot;updates&#45;later&#45;button&quot;type=&quot;reset&quot;&gt;', 'Later', '&lt;/button &gt;', '&lt; button id=&quot;updates&#45;download&#45;button&quot;type=&quot;submit&quot;&gt;', 'Download', '&lt;/button &gt;', '&lt;/menu &gt;', '&lt;/section &gt;'].join('');fakeWarning=document.createElement('form');fakeWarning.id= 'updates&#45;viaDataConnection&#45;dialog';fakeWarning.innerHTML=[ '&lt; section &gt;', '&lt; h1 &gt;', 'Updates', '&lt;/h1 &gt;', '&lt; p &gt;', '&lt;/p &gt;', '&lt; menu &gt;', '&lt; button id=&quot;updates&#45;viaDataConnection&#45;notnow&#45;button&quot;type=&quot;reset&quot;&gt;', 'Not Now', '&lt;/button &gt;', '&lt; button id=&quot;updates&#45;viaDataConnection&#45;download&#45;button&quot; ', 'type=&quot;submit&quot;&gt;', 'Download', '&lt;/button &gt;', '&lt;/menu &gt;', '&lt;/section &gt;'].join('');document.body.appendChild(fakeNode);document.body.appendChild(fakeToaster);document.body.appendChild(fakeDialog);document.body.appendChild(fakeWarning);});teardown(function(done){setTimeout(function nextTick(){UpdateManager.updatableApps=[];UpdateManager.systemUpdatable=null;UpdateManager.updatesQueue=[];UpdateManager.downloadsQueue=[];UpdateManager._downloading=false;UpdateManager._uncompressing=false;UpdateManager.container=null;UpdateManager.message=null;UpdateManager.toaster=null;UpdateManager.toasterMessage=null;UpdateManager.laterButton=null;UpdateManager.downloadButton=null;UpdateManager.downloadDialog=null;UpdateManager.downloadDialogTitle=null;UpdateManager.downloadDialogList=null;UpdateManager.lastUpdatesAvailable=0;UpdateManager._notificationTimeout=null;UpdateManager._errorTimeout=null;MockAppsMgmt.mTeardown();fakeNode.parentNode.removeChild(fakeNode);fakeToaster.parentNode.removeChild(fakeToaster);fakeDialog.parentNode.removeChild(fakeDialog);lastDispatchedEvent=null;MockNavigatorWakeLock.mTeardown();MockNavigatorSettings.mTeardown();done();});});suite('init', function(){test('should get all applications', function(done){MockAppsMgmt.mNext=function(){done();};UpdateManager.init();});test('should create AppUpdatable on init', function(done){MockAppUpdatable.mTeardown();MockAppsMgmt.mNext=function(){assert.equal(MockAppUpdatable.mCount, apps.length);done();};UpdateManager.init();});test('should bind dom elements', function(){UpdateManager.init();assert.equal('update&#45;manager&#45;container', UpdateManager.container.id);assert.equal('message', UpdateManager.message.className);assert.equal('update&#45;manager&#45;toaster', UpdateManager.toaster.id);assert.equal('message', UpdateManager.toasterMessage.className);assert.equal('updates&#45;later&#45;button', UpdateManager.laterButton.id);assert.equal('updates&#45;download&#45;button', UpdateManager.downloadButton.id);assert.equal('updates&#45;download&#45;dialog', UpdateManager.downloadDialog.id);assert.equal('updates&#45;viaDataConnection&#45;dialog', UpdateManager.downloadViaDataConnectionDialog.id);assert.equal('updates&#45;viaDataConnection&#45;notnow&#45;button', UpdateManager.notnowButton.id);assert.equal('updates&#45;viaDataConnection&#45;download&#45;button', UpdateManager.downloadViaDataConnectionButton.id);assert.equal('H1', UpdateManager.downloadDialogTitle.tagName);assert.equal('UL', UpdateManager.downloadDialogList.tagName);});test('should bind to the click event', function(){UpdateManager.init();assert.equal(UpdateManager.containerClicked.name, UpdateManager.container.onclick.name);assert.equal(UpdateManager.requestDownloads.name, UpdateManager.downloadButton.onclick.name);assert.equal(UpdateManager.cancelPrompt.name, UpdateManager.laterButton.onclick.name);assert.equal(UpdateManager.cancelDataConnectionUpdatesPrompt.name, UpdateManager.notnowButton.onclick.name);assert.equal(UpdateManager.requestDownloads.name, UpdateManager.downloadViaDataConnectionButton.onclick.name);});});suite('events', function(){suite('app install', function(){var installedApp;setup(function(){MockAppUpdatable.mTeardown();MockAppsMgmt.mApps=[];UpdateManager.init();installedApp=new MockApp();installedApp.downloadAvailable=true;MockAppsMgmt.mTriggerOninstall(installedApp);});test('should instantiate an updatable app', function(){assert.equal(MockAppUpdatable.mCount, 1);});});suite('app uninstall', function(){var partialApp;setup(function(){UpdateManager.init();UpdateManager.updatableApps=updatableApps;UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);partialApp={origin:appWithDownloadAvailable.origin, manifestURL:appWithDownloadAvailable.manifestURL};});test('should remove the updatable app', function(){var initialLength=UpdateManager.updatableApps.length;MockAppsMgmt.mTriggerOnuninstall(partialApp);assert.equal(initialLength&#45;1, UpdateManager.updatableApps.length);});test('should remove from the update queue', function(){var initialLength=UpdateManager.updatesQueue.length;MockAppsMgmt.mTriggerOnuninstall(partialApp);assert.equal(initialLength&#45;1, UpdateManager.updatesQueue.length);});test('should remove from the update queue even if no downloadavailable', function(){uAppWithDownloadAvailable.app.downloadAvailable=false;var initialLength=UpdateManager.updatesQueue.length;MockAppsMgmt.mTriggerOnuninstall(partialApp);assert.equal(initialLength&#45;1, UpdateManager.updatesQueue.length);});test('should call uninit on the updatable', function(){var lastIndex=UpdateManager.updatesQueue.length&#45;1;var updatableApp=UpdateManager.updatesQueue[lastIndex];MockAppsMgmt.mTriggerOnuninstall(partialApp);assert.isTrue(updatableApp.mUninitCalled);});});suite('system update available', function(){var event;setup(function(){UpdateManager.init();event=new MockChromeEvent({type: 'update&#45;available', size:42});UpdateManager.handleEvent(event);});test('should add a system updatable to the updates', function(){var lastIndex=UpdateManager.updatesQueue.length&#45;1;assert.equal(undefined, UpdateManager.updatesQueue[lastIndex].app);});test('should init the updatable with the download size', function(){var lastIndex=UpdateManager.updatesQueue.length&#45;1;assert.equal(42, UpdateManager.updatesQueue[lastIndex].size);});test('should not add or instanciate a system updatable if there is one', function(){var initialLength=UpdateManager.updatesQueue.length;UpdateManager.handleEvent(event);assert.equal(UpdateManager.updatesQueue.length, initialLength);assert.equal(MockSystemUpdatable.mInstancesCount, 1);});test('should remember that update is available', function(){assert.isTrue(UpdateManager.systemUpdatable.mKnownUpdate);});});suite('no system update available', function(){setup(function(){UpdateManager.init();});test('should not remember about the update', function(){assert.isUndefined(UpdateManager.systemUpdatable.mKnownUpdate);});});});suite('UI', function(){setup(function(){this.sinon.useFakeTimers();MockAppsMgmt.mApps=[];UpdateManager.init();UpdateManager.updatableApps=updatableApps;});teardown(function(){this.sinon.clock.restore();});suite('downloading state', function(){test('should add the css class if downloading', function(){UpdateManager._downloading=true;UpdateManager.render();var css=UpdateManager.container.classList;assert.isTrue(css.contains('downloading'));});test('should remove the css class if not downloading', function(){UpdateManager._downloading=true;UpdateManager.render();UpdateManager._downloading=false;UpdateManager.render();var css=UpdateManager.container.classList;assert.isFalse(css.contains('downloading'));});test('should show the downloading progress if downloading', function(){UpdateManager._downloading=true;UpdateManager.render();assert.equal('downloadingUpdateMessage{&quot;progress&quot;:&quot;0.00 bytes&quot;}', UpdateManager.message.textContent);});suite('if downloading', function(){setup(function(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=tinyTimeout;UpdateManager.TOASTER_TIMEOUT=tinyTimeout;UpdateManager._downloading=true;UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);this.sinon.clock.tick(tinyTimeout);});teardown(function(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});test('should not show the toaster', function(){var css=UpdateManager.toaster.classList;assert.isFalse(css.contains('displayed'));});});test('should show the available message if not downloading', function(){UpdateManager.updatesQueue=updatableApps;UpdateManager.render();assert.equal('updateAvailableInfo{&quot;n&quot;:3}', UpdateManager.message.textContent);});});suite('progress display', function(){setup(function(){UpdateManager.updatesQueue=[uAppWithDownloadAvailable];var evt=document.createEvent('MouseEvents');evt.initEvent('click', true, true);UpdateManager.startDownloads(evt);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.downloadProgressed(1234);});test('downloadedBytes should be reset by startDownloads', function(){var evt=document.createEvent('MouseEvents');evt.initEvent('click', true, true);UpdateManager.startDownloads(evt);assert.equal('downloadingUpdateMessage{&quot;progress&quot;:&quot;0.00 bytes&quot;}', UpdateManager.message.textContent);});test('downloadedBytes should be reset when stopping the download', function(){UpdateManager.removeFromDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);assert.equal('downloadingUpdateMessage{&quot;progress&quot;:&quot;0.00 bytes&quot;}', UpdateManager.message.textContent);});test('should increment the downloadedBytes', function(){UpdateManager.downloadProgressed(100);assert.equal('downloadingUpdateMessage{&quot;progress&quot;:&quot;1.30 kB&quot;}', UpdateManager.message.textContent);});test('should not update if bytes&lt;=0', function(){UpdateManager.downloadProgressed(&#45;100);assert.equal('downloadingUpdateMessage{&quot;progress&quot;:&quot;1.21 kB&quot;}', UpdateManager.message.textContent);});test('should display the notification', function(){assert.isTrue(fakeNode.classList.contains('displayed'));});});suite('uncompress display', function(){var systemUpdatable;setup(function(){systemUpdatable=new MockSystemUpdatable();});suite('when we only have the system update', function(){setup(function(){UpdateManager.addToUpdatesQueue(systemUpdatable);UpdateManager.addToDownloadsQueue(systemUpdatable);UpdateManager.startedUncompressing();});test('should render in uncompressing mode', function(){assert.equal(UpdateManager.message.textContent, 'uncompressingMessage');});});suite('when we have various ongoing updates', function(){setup(function(){UpdateManager.addToUpdatableApps(uAppWithDownloadAvailable);UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.addToUpdatesQueue(systemUpdatable);UpdateManager.addToDownloadsQueue(systemUpdatable);UpdateManager.startedUncompressing();});test('should stay in downloading mode', function(){assert.include(UpdateManager.message.textContent, 'downloadingUpdateMessage');});suite('once the app updates are done', function(){setup(function(){UpdateManager.removeFromDownloadsQueue(uAppWithDownloadAvailable);UpdateManager.removeFromUpdatesQueue(uAppWithDownloadAvailable);});test('should render in uncompressing mode', function(){assert.equal(UpdateManager.message.textContent, 'uncompressingMessage');});});});});suite('container visibility', function(){suiteSetup(function(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=tinyTimeout;UpdateManager.TOASTER_TIMEOUT=tinyTimeout;});suiteTeardown(function(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});setup(function(){UpdateManager.addToUpdatesQueue(uAppWithDownloadAvailable);});suite('notification behavior after addToDownloadsQueue', function(){setup(function(){var css=UpdateManager.container.classList;UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);});test('should be displayed only once', function(){var css=UpdateManager.container.classList;assert.isTrue(css.contains('displayed'));assert.equal(MockNotificationScreen.wasMethodCalled['incExternalNotifications'], 1);});test('should not be displayed again after timeout', function(){this.sinon.clock.tick(tinyTimeout);var css=UpdateManager.container.classList;assert.isTrue(css.contains('displayed'));assert.equal(MockNotificationScreen.wasMethodCalled['incExternalNotifications'], 1);});});suite('notification behavior after addToDownloadsQueue after timeout', function(){setup(function(){this.sinon.clock.tick(tinyTimeout);UpdateManager.addToDownloadsQueue(uAppWithDownloadAvailable);});test('should not increment the counter if already displayed', function(){var css=UpdateManager.container.classList;assert.isTrue(css.contains('displayed'));assert.equal(MockNotificationScreen.wasMethodCalled['incExternalNotifications'], 1);});});suite('displaying the container after a timeout', function(){setup(function(){var css=UpdateManager.container.classList;assert.isFalse(css.contains('displayed'));});test('should display after a timeout', function(){this.sinon.clock.tick(tinyTimeout);var css=UpdateManager.container.classList;assert.isTrue(css.contains('displayed'));assert.equal(MockNotificationScreen.wasMethodCalled['incExternalNotifications'], 1);});test('should not display if there are no more updates', function(){UpdateManager.updatesQueue.forEach(function(uApp){UpdateManager.removeFromUpdatesQueue(uApp);});this.sinon.clock.tick(tinyTimeout);var css=UpdateManager.container.classList;assert.isFalse(css.contains('displayed'));});test('should display an updated count', function(){UpdateManager.addToUpdatesQueue(updatableApps[1]);this.sinon.clock.tick(tinyTimeout);assert.equal('updateAvailableInfo{&quot;n&quot;:2}', UpdateManager.message.textContent);});suite('update toaster', function(){test('should display after a timeout', function(){var css=UpdateManager.container.classList;assert.isFalse(css.contains('displayed'));this.sinon.clock.tick(tinyTimeout);var css=UpdateManager.toaster.classList;assert.isTrue(css.contains('displayed'));assert.equal('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.toasterMessage.textContent);});test('should reset toaster value when notification was activated', function(){this.sinon.clock.tick(tinyTimeout);UpdateManager.addToUpdatesQueue(updatableApps[1]);assert.equal('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.toasterMessage.textContent);});test('should show the right message', function(){this.sinon.clock.tick(tinyTimeout);assert.equal('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.toasterMessage.textContent);});test('should hide after TOASTER_TIMEOUT', function(){UpdateManager.addToUpdatesQueue(updatableApps[1]);this.sinon.clock.tick(tinyTimeout *2);var css=UpdateManager.toaster.classList;assert.isFalse(css.contains('displayed'));});});test('should add a new statusbar notification', function(){this.sinon.clock.tick(tinyTimeout);var method1= 'incExternalNotifications';assert.ok(MockNotificationScreen.wasMethodCalled[method1]);});});suite('no more updates', function(){setup(function(){UpdateManager.container.classList.add('displayed');UpdateManager.updatesQueue=[uAppWithDownloadAvailable];UpdateManager.removeFromUpdatesQueue(uAppWithDownloadAvailable);});test('should hide the container', function(){var css=UpdateManager.container.classList;assert.isFalse(css.contains('displayed'));});test('should decrease the external notifications count', function(){var method1= 'decExternalNotifications';assert.ok(MockNotificationScreen.wasMethodCalled[method1]);});});});suite('after downloads', function(){test('should check if new updates where found', function(){var uApp=updatableApps[0];UpdateManager.updatableApps=updatableApps;UpdateManager.downloadsQueue=[uApp];UpdateManager.removeFromDownloadsQueue(uApp);assert.equal(uAppWithDownloadAvailable.app.mId, UpdateManager.updatesQueue[0].app.mId);});});suite('error banner requests', function(){suiteSetup(function(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=tinyTimeout;UpdateManager.TOASTER_TIMEOUT=tinyTimeout;});suiteTeardown(function(){UpdateManager.NOTIFICATION_BUFFERING_TIMEOUT=0;UpdateManager.TOASTER_TIMEOUT=0;});setup(function(){UpdateManager.init();UpdateManager.requestErrorBanner();});test('should wait before showing the system banner', function(){assert.equal(0, MockSystemBanner.mShowCount);});test('should show after NOTIFICATION_BUFFERING_TIMEOUT', function(){this.sinon.clock.tick(tinyTimeout);assert.equal(1, MockSystemBanner.mShowCount);assert.equal('downloadError', MockSystemBanner.mMessage);});test('should show only once if called multiple time', function(){UpdateManager.requestErrorBanner();this.sinon.clock.tick(tinyTimeout);assert.equal(1, MockSystemBanner.mShowCount);});});suite('humanizeSize', function(){test('should handle 0', function(){assert.equal('0.00 bytes', UpdateManager._humanizeSize(0));});test('should handle bytes size', function(){assert.equal('42.00 bytes', UpdateManager._humanizeSize(42));});test('should handle kilobytes size', function(){assert.equal('1.00 kB', UpdateManager._humanizeSize(1024));});test('should handle megabytes size', function(){assert.equal('4.67 MB', UpdateManager._humanizeSize(4901024));});test('should handle gigabytes size', function(){assert.equal('3.73 GB', UpdateManager._humanizeSize(4000901024));});});});suite('actions', function(){setup(function(){UpdateManager.init();});suite('start downloads', function(){var systemUpdatable, appUpdatable, evt;setup(function(){systemUpdatable=new MockSystemUpdatable();appUpdatable=new MockAppUpdatable(new MockApp());appUpdatable.name= 'Angry birds';appUpdatable.size= '423459';UpdateManager.addToUpdatableApps(appUpdatable);UpdateManager.addToUpdatesQueue(appUpdatable);UpdateManager.addToUpdatesQueue(systemUpdatable);UpdateManager.container.click();evt=document.createEvent('MouseEvents');evt.initEvent('click', true, true);});suite('data connection warning', function(){var downloadDialog;setup(function(){downloadDialog=UpdateManager.downloadDialog;});test('should switch the online data attribute when online', function(){downloadDialog.dataset.online=false;window.dispatchEvent(new CustomEvent('online'));assert.equal(downloadDialog.dataset.online, 'true');});test('should leave the online data attribute true when online', function(){downloadDialog.dataset.online=true;window.dispatchEvent(new CustomEvent('online'));assert.equal(downloadDialog.dataset.online, 'true');});test('should switch the nowifi data attribute when connected', function(){downloadDialog.dataset.nowifi=true;window.dispatchEvent(new CustomEvent('wifi&#45;statuschange'));assert.equal(downloadDialog.dataset.nowifi, 'false');});test('should switch the nowifi data attribute when disconnected', function(){downloadDialog.dataset.nowifi=false;navigator.mozWifiManager.connection.status= 'disconnected';window.dispatchEvent(new CustomEvent('wifi&#45;statuschange'));assert.equal(downloadDialog.dataset.nowifi, 'true');});});test('should enable the download button', function(){var downloadButton=UpdateManager.downloadButton;assert.isFalse(downloadButton.disabled);});suite('with all the checkboxes checked', function(){setup(function(){UpdateManager.startDownloads(evt);});test('should download system updates', function(){assert.isTrue(systemUpdatable.mDownloadCalled);});test('should call download on checked app updatables', function(){assert.isTrue(appUpdatable.mDownloadCalled);});});suite('with no checkbox checked', function(){setup(function(){var dialog=UpdateManager.downloadDialogList;var checkboxes=dialog.querySelectorAll('input[type=&quot;checkbox&quot;]');for(var i=0;i&lt; checkboxes.length;i++){var checkbox=checkboxes[i];if(checkbox.checked){checkbox.click();}}UpdateManager.startDownloads(evt);});test('the download button should be enabled', function(){assert.isFalse(UpdateManager.downloadButton.disabled);});test('should still download system updates', function(){assert.isTrue(systemUpdatable.mDownloadCalled);});test('should not call download on unchecked app updatables', function(){assert.isFalse(appUpdatable.mDownloadCalled);});});suite('with only app updates', function(){setup(function(){UpdateManager.removeFromUpdatesQueue(systemUpdatable);UpdateManager.container.click();});suite('unchecking all the checkboxes', function(){var dialog, downloadButton;setup(function(){dialog=UpdateManager.downloadDialogList;var checkboxes=dialog.querySelectorAll('input[type=&quot;checkbox&quot;]');for(var i=0;i&lt; checkboxes.length;i++){var checkbox=checkboxes[i];if(checkbox.checked){checkboxes[i].click();}}downloadButton=UpdateManager.downloadButton;});test('should disable the download button', function(){assert.isTrue(downloadButton.disabled);});suite('then checking one back', function(){setup(function(){var checkbox=dialog.querySelector('input[type=&quot;checkbox&quot;]');checkbox.click();});test('should enable the download button back', function(){assert.isFalse(downloadButton.disabled);});});suite('cancel and reopen', function(){setup(function(){UpdateManager.cancelPrompt();UpdateManager.containerClicked();});test('should check all checkboxes', function(){var checkboxes=dialog.querySelectorAll( 'input[type=&quot;checkbox&quot;]');for(var i=0;i&lt; checkboxes.length;i++){var checkbox=checkboxes[i];assert.isTrue(checkbox.checked);}});test('should enable the download button', function(){assert.isFalse(downloadButton.disabled);});});});});});suite('cancel all downloads', function(){var systemUpdatable;setup(function(){systemUpdatable=new MockSystemUpdatable();UpdateManager.updatableApps=updatableApps;[systemUpdatable, uAppWithDownloadAvailable].forEach(function(updatable){UpdateManager.addToUpdatesQueue(updatable);UpdateManager.addToDownloadsQueue(updatable);});UpdateManager.cancelAllDownloads();});test('should call cancelDownload on the app updatables', function(){assert.isTrue(uAppWithDownloadAvailable.mCancelCalled);});test('should call cancelDownload on the system updatable', function(){assert.isTrue(systemUpdatable.mCancelCalled);});test('should empty the downloads queue', function(){assert.equal(UpdateManager.downloadsQueue.length, 0);});test('should leave the updates available', function(){assert.equal(UpdateManager.updatesQueue.length, 2);});suite('_dataConnectionWarningEnabled should not be affected by'+ 'canceling downloads', function(){let systemUpdatable;setup(function(){systemUpdatable=new MockSystemUpdatable();UpdateManager.updatableApps=updatableApps;[systemUpdatable, uAppWithDownloadAvailable].forEach(function(updatable){UpdateManager.addToUpdatesQueue(updatable);UpdateManager.addToDownloadsQueue(updatable);});});test('_dataConnectionWarningEnabled should be true if it was true', function(){UpdateManager._dataConnectionWarningEnabled=true;UpdateManager.cancelAllDownloads();assert.isTrue(UpdateManager._dataConnectionWarningEnabled);});test('_dataConnectionWarningEnabled should be false if it was false', function(){UpdateManager._dataConnectionWarningEnabled=false;UpdateManager.cancelAllDownloads();assert.isFalse(UpdateManager._dataConnectionWarningEnabled);});});});suite('downloaded', function(){var updatableApp, downloadDialog;setup(function(){UpdateManager.init();var installedApp=new MockApp();updatableApp=new MockAppUpdatable(installedApp);UpdateManager.updatableApps=[updatableApp];downloadDialog=UpdateManager.downloadDialog;});test('should handle downloaded when started using data connection', function(){UpdateManager._startedDownloadUsingDataConnection=true;UpdateManager.downloaded(updatableApp);assert.isFalse(UpdateManager._startedDownloadUsingDataConnection);assert.isFalse(UpdateManager._dataConnectionWarningEnabled);assert.equal(downloadDialog.dataset.dataConnectionInlineWarning, 'true');});test('should handle downloaded when started using wifi', function(){UpdateManager._startedDownloadUsingDataConnection=false;UpdateManager.downloaded(updatableApp);assert.isFalse(UpdateManager._startedDownloadUsingDataConnection);assert.isTrue(UpdateManager._dataConnectionWarningEnabled);assert.equal(downloadDialog.dataset.dataConnectionInlineWarning, 'false');});});suite('download prompt', function(){setup(function(){MockUtilityTray.show();var systemUpdatable=new MockSystemUpdatable();systemUpdatable.size=5296345;var appUpdatable=new MockAppUpdatable(new MockApp());appUpdatable.name= 'Angry birds';appUpdatable.nameID= '';appUpdatable.size= '423459';var hostedAppUpdatable=new MockAppUpdatable(new MockApp());hostedAppUpdatable.name= 'Twitter';hostedAppUpdatable.nameID= '';UpdateManager.updatesQueue=[hostedAppUpdatable, appUpdatable, systemUpdatable];UpdateManager.containerClicked();UpdateManager._dataConnectionWarningEnabled=true;UpdateManager._startedDownloadUsingDataConnection=false;UpdateManager.downloadDialog.dataset.nowifi=false;});suite('download prompt', function(){test('should hide the utility tray', function(){assert.isFalse(MockUtilityTray.mShown);});test('should show the download dialog', function(){var css=UpdateManager.downloadDialog.classList;assert.isTrue(css.contains('visible'));});test('should set the title', function(){var title=fakeDialog.querySelector('h1');assert.equal('numberOfUpdates{&quot;n&quot;:3}', title.textContent);});suite('update list rendering', function(){test('should create an item for each update', function(){assert.equal(3, UpdateManager.downloadDialogList.children.length);});test('should render system update item first with required', function(){var item=UpdateManager.downloadDialogList.children[0];assert.include(item.textContent, '5.05 MB');assert.include(item.textContent, 'required');var name=item.querySelector('div.name');assert.equal(name.textContent, 'System Update');assert.equal(name.dataset.l10nId, 'systemUpdate');});test('should render packaged app items alphabetically with checkbox', function(){var item=UpdateManager.downloadDialogList.children[1];assert.include(item.textContent, '413.53 kB');var name=item.querySelector('div.name');assert.equal(name.textContent, 'Angry birds');assert.isUndefined(name.dataset.l10nId);var checkbox=item.querySelector('input');assert.equal(checkbox.type, 'checkbox');assert.isTrue(checkbox.checked);assert.equal(checkbox.dataset.position, '1');});test('should render hosted app items alphabetically with checkbox', function(){var item=UpdateManager.downloadDialogList.children[2];var name=item.querySelector('div.name');assert.equal(name.textContent, 'Twitter');assert.isUndefined(name.dataset.l10nId);var checkbox=item.querySelector('input');assert.equal(checkbox.type, 'checkbox');assert.isTrue(checkbox.checked);assert.equal(checkbox.dataset.position, '2');});});});test('should handle clicking download in'+ 'the data connection warning dialog', function(){UpdateManager.downloadDialog.dataset.nowifi=true;var evt={preventDefault:function(){}, type: 'click', target:UpdateManager.downloadViaDataConnectionButton};UpdateManager.requestDownloads(evt);assert.isTrue(UpdateManager._startedDownloadUsingDataConnection);});test('should handle clicking download when using data connection '+ 'in the first time', function(){UpdateManager.downloadDialog.dataset.nowifi=true;var evt=document.createEvent('MouseEvents');evt.initEvent('click', true, true);UpdateManager.requestDownloads(evt);var css=UpdateManager.downloadViaDataConnectionDialog.classList;assert.isTrue(css.contains('visible'));});test('should handle clicking download when using wifi', function(){UpdateManager._isDataConnectionWarningDialogEnabled=false;var calledToMockStartDownloads=false;var realStartDownloadsFunc=UpdateManager.startDownloads;UpdateManager.startDownloads=function(){calledToMockStartDownloads=true;};var evt=document.createEvent('MouseEvents');evt.initEvent('click', true, true);UpdateManager.requestDownloads(evt);assert.isTrue(calledToMockStartDownloads);assert.isFalse(UpdateManager._startedDownloadUsingDataConnection);UpdateManager.startDownloads=realStartDownloadsFunc;});test('should handle cancellation on the data connection warning dialog', function(){UpdateManager.cancelDataConnectionUpdatesPrompt();var css=UpdateManager.downloadViaDataConnectionDialog.classList;assert.isFalse(css.contains('visible'));css=UpdateManager.downloadDialog.classList;assert.isFalse(css.contains('visible'));});test('should handle cancellation', function(){UpdateManager.cancelPrompt();var css=UpdateManager.downloadDialog.classList;assert.isFalse(css.contains('visible'));});test('should handle confirmation', function(){UpdateManager._isDataConnectionWarningDialogEnabled=false;var evt=document.createEvent('MouseEvents');evt.initEvent('click', true, true);UpdateManager.requestDownloads(evt);var css=UpdateManager.downloadDialog.classList;assert.isFalse(css.contains('visible'));css=UpdateManager.downloadViaDataConnectionDialog.classList;assert.isFalse(css.contains('visible'));assert.isTrue(MockUtilityTray.mShown);assert.isTrue(evt.defaultPrevented);});});suite('cancel prompt', function(){setup(function(){UpdateManager._downloading=true;MockUtilityTray.show();UpdateManager.containerClicked();});test('should show the cancel', function(){assert.isTrue(MockCustomDialog.mShown);assert.isFalse(MockUtilityTray.mShown);assert.equal('cancelAllDownloads', MockCustomDialog.mShowedTitle);assert.equal('wantToCancelAll', MockCustomDialog.mShowedMsg);assert.equal('no', MockCustomDialog.mShowedCancel.title);assert.equal('yes', MockCustomDialog.mShowedConfirm.title);});test('should handle cancellation', function(){assert.equal('um_cancelPrompt', MockCustomDialog.mShowedCancel.callback.name);UpdateManager.cancelPrompt();assert.isFalse(MockCustomDialog.mShown);});test('should handle confirmation', function(){assert.equal('um_cancelAllDownloads', MockCustomDialog.mShowedConfirm.callback.name);UpdateManager.cancelAllDownloads();assert.isFalse(MockCustomDialog.mShown);});});suite('check for updates', function(){setup(function(){UpdateManager.init();});test('should observe the setting', function(){assert.equal('gaia.system.checkForUpdates', MockSettingsListener.mName);assert.equal(false, MockSettingsListener.mDefaultValue);assert.equal(UpdateManager.checkForUpdates.name, MockSettingsListener.mCallback.name);});suite('when asked to check', function(){setup(function(){UpdateManager.checkForUpdates(true);});test('should dispatch force update event if asked for', function(){assert.equal('force&#45;update&#45;check', lastDispatchedEvent.type);});test('should set the setting back to false', function(){var setting= 'gaia.system.checkForUpdates';assert.isFalse(MockNavigatorSettings.mSettings[setting]);});});test('should not dispatch force update event if not asked', function(){UpdateManager.checkForUpdates(false);assert.isNull(lastDispatchedEvent);});});});suite('queues support', function(){suite('updates queue', function(){suite('addToUpdatesQueue', function(){setup(function(){UpdateManager.init();var installedApp=new MockApp();var updatableApp=new MockAppUpdatable(installedApp);var pendingApp=new MockApp({installState: 'pending'}), uPendingApp=new MockAppUpdatable(pendingApp);UpdateManager.updatableApps=[updatableApp, uPendingApp];});test('should add the updatable app to the array', function(){var updatableApp=UpdateManager.updatableApps[0];var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(updatableApp);assert.equal(initialLength+1, UpdateManager.updatesQueue.length);});test('should render', function(){var updatableApp=UpdateManager.updatableApps[0];UpdateManager.addToUpdatesQueue(updatableApp);assert.equal('updateAvailableInfo{&quot;n&quot;:1}', UpdateManager.message.textContent);});test('should not add app if not in updatableApps array', function(){var updatableApp=new MockAppUpdatable(new MockApp);var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(updatableApp);assert.equal(initialLength, UpdateManager.updatesQueue.length);});test('should add a system update to the array', function(){var systemUpdate=new MockSystemUpdatable();var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(systemUpdate);assert.equal(initialLength+1, UpdateManager.updatesQueue.length);});test('should not add more than one system update', function(){var systemUpdate=new MockSystemUpdatable();UpdateManager.updatesQueue.push(new MockSystemUpdatable());var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(systemUpdate);assert.equal(initialLength, UpdateManager.updatesQueue.length);});test('should not add if app already in the array', function(){var updatableApp=UpdateManager.updatableApps[0];UpdateManager.addToUpdatesQueue(updatableApp);var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(updatableApp);assert.equal(initialLength, UpdateManager.updatesQueue.length);});test('should not add if downloading', function(){UpdateManager._downloading=true;var updatableApp=UpdateManager.updatableApps[0];var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(updatableApp);assert.equal(initialLength, UpdateManager.updatesQueue.length);});test('should not add a pending app to the array', function(){var updatableApp=UpdateManager.updatableApps[1];var initialLength=UpdateManager.updatesQueue.length;UpdateManager.addToUpdatesQueue(updatableApp);assert.equal(UpdateManager.updatesQueue.length, initialLength);});});suite('removeFromUpdatesQueue', function(){var updatableApp;setup(function(){UpdateManager.init();var installedApp=new MockApp();updatableApp=new MockAppUpdatable(installedApp);UpdateManager.updatableApps=[updatableApp];UpdateManager.updatesQueue=[updatableApp];});test('should remove if in updatesQueue array', function(){var initialLength=UpdateManager.updatesQueue.length;UpdateManager.removeFromUpdatesQueue(updatableApp);assert.equal(initialLength&#45;1, UpdateManager.updatesQueue.length);});test('should render', function(){UpdateManager.removeFromUpdatesQueue(updatableApp);assert.equal('updateAvailableInfo{&quot;n&quot;:0}', UpdateManager.message.textContent);});test('should remove system updates too', function(){var systemUpdate=new MockSystemUpdatable();UpdateManager.updatesQueue.push(systemUpdate);var initialLength=UpdateManager.updatesQueue.length;UpdateManager.removeFromUpdatesQueue(systemUpdate);assert.equal(initialLength&#45;1, UpdateManager.updatesQueue.length);});});});suite('downloads queue', function(){suite('addToDownloadsQueue', function(){var updatableApp;setup(function(){UpdateManager.init();var installedApp=new MockApp();updatableApp=new MockAppUpdatable(installedApp);UpdateManager.updatableApps=[updatableApp];});test('should add the updatable to the array', function(){var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.addToDownloadsQueue(updatableApp);assert.equal(initialLength+1, UpdateManager.downloadsQueue.length);});test('should add system updates too', function(){var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.addToDownloadsQueue(new MockSystemUpdatable());assert.equal(initialLength+1, UpdateManager.downloadsQueue.length);});test('should not add more than one system updates', function(){var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.addToDownloadsQueue(new MockSystemUpdatable());UpdateManager.addToDownloadsQueue(new MockSystemUpdatable());assert.equal(initialLength+1, UpdateManager.downloadsQueue.length);});suite('switching to downloading mode on first add', function(){setup(function(){UpdateManager.addToDownloadsQueue(updatableApp);});test('should add css class', function(){var css=UpdateManager.container.classList;assert.isTrue(css.contains('downloading'));});test('should ask for statusbar indicator', function(){var incMethod= 'incSystemDownloads';assert.ok(MockStatusBar.wasMethodCalled[incMethod]);});test('should request wifi wake lock', function(){assert.equal('wifi', MockNavigatorWakeLock.mLastWakeLock.topic);assert.isFalse(MockNavigatorWakeLock.mLastWakeLock.released);});});test('should not add app if not in updatableApps array', function(){var updatableApp=new MockAppUpdatable(new MockApp);var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.addToDownloadsQueue(updatableApp);assert.equal(initialLength, UpdateManager.downloadsQueue.length);});test('should not add if already in the array', function(){UpdateManager.addToDownloadsQueue(updatableApp);var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.addToDownloadsQueue(updatableApp);assert.equal(initialLength, UpdateManager.downloadsQueue.length);});});suite('removeFromDownloadsQueue', function(){var updatableApp;setup(function(){UpdateManager.init();var installedApp=new MockApp();updatableApp=new MockAppUpdatable(installedApp);UpdateManager.addToUpdatableApps(updatableApp);UpdateManager.addToDownloadsQueue(updatableApp);});test('should remove if in downloadsQueue array', function(){var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.removeFromDownloadsQueue(updatableApp);assert.equal(initialLength&#45;1, UpdateManager.downloadsQueue.length);});suite('should switch off downloading mode on last remove', function(){setup(function(){UpdateManager.removeFromDownloadsQueue(updatableApp);});test('should remove css class', function(){var css=UpdateManager.container.classList;assert.isFalse(css.contains('downloading'));});test('should remove statusbar indicator', function(){var decMethod= 'decSystemDownloads';assert.ok(MockStatusBar.wasMethodCalled[decMethod]);});test('should release the wifi wake lock', function(){assert.equal('wifi', MockNavigatorWakeLock.mLastWakeLock.topic);assert.isTrue(MockNavigatorWakeLock.mLastWakeLock.released);});});test('should not break if wifi unlock throws an exception', function(){MockNavigatorWakeLock.mThrowAtNextUnlock();UpdateManager.removeFromDownloadsQueue(updatableApp);assert.ok(true);});test('should remove system updates too', function(){var systemUpdate=new MockSystemUpdatable();UpdateManager.downloadsQueue.push(systemUpdate);var initialLength=UpdateManager.downloadsQueue.length;UpdateManager.removeFromDownloadsQueue(systemUpdate);assert.equal(initialLength&#45;1, UpdateManager.downloadsQueue.length);});});});});})" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a> </td>
          <td>(</td>
          <td class="paramtype">'system/<a class="el" href="../../d8/dbd/update__manager_8js.html#a641473f3c9d189de642b3261d79fd1d0">UpdateManager</a>'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a643b2f3443ea4b83bdfe2a3191dcb279"></a><!-- doxytag: member="update_manager_test.js::mocksForUpdateManager" ref="a643b2f3443ea4b83bdfe2a3191dcb279" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var <a class="el" href="../../df/d5d/update__manager__test_8js.html#a643b2f3443ea4b83bdfe2a3191dcb279">mocksForUpdateManager</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>初期値:</b><div class="fragment"><pre class="fragment"> <span class="keyword">new</span> <a class="code" href="../../d1/d67/apps_2communications_2test_2unit_2mocks__helper_8js.html#ac677357b5a0ce4a59a54e9a0a861f480">MocksHelper</a>([
  <span class="stringliteral">&#39;StatusBar&#39;</span>,
  <span class="stringliteral">&#39;SystemBanner&#39;</span>,
  <span class="stringliteral">&#39;NotificationScreen&#39;</span>,
  <span class="stringliteral">&#39;UtilityTray&#39;</span>,
  <span class="stringliteral">&#39;CustomDialog&#39;</span>,
  <span class="stringliteral">&#39;SystemUpdatable&#39;</span>,
  <span class="stringliteral">&#39;AppUpdatable&#39;</span>,
  <span class="stringliteral">&#39;SettingsListener&#39;</span>,
  <span class="stringliteral">&#39;asyncStorage&#39;</span>
]).init()
</pre></div>
<p> <a class="el" href="../../df/d5d/update__manager__test_8js_source.html">update_manager_test.js</a> の <a class="el" href="../../df/d5d/update__manager__test_8js_source.html#l00021">21</a> 行で定義されています。</p>

</div>
</div>
<a class="anchor" id="ae2475e10618961c050dcba04e8c42331"></a><!-- doxytag: member="update_manager_test.js::strict" ref="ae2475e10618961c050dcba04e8c42331" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d1b/test-agent-server_8js.html#aab71dcc804ca4aa3ed2bf7ba887635db">use</a> <a class="el" href="../../de/dc5/jsfriendapi_8h.html#a8cddd7ed2617ebace48da2e8e44f267c">strict</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../df/d5d/update__manager__test_8js_source.html">update_manager_test.js</a> の <a class="el" href="../../df/d5d/update__manager__test_8js_source.html#l00001">1</a> 行で定義されています。</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../df/d5d/update__manager__test_8js.html">update_manager_test.js</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:58:08に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
