<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: cert.h ソースファイル</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d7/d4a/cert_8h.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">cert.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d7/d4a/cert_8h.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a name="l00002"></a>00002 <span class="comment"> * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a name="l00003"></a>00003 <span class="comment"> * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">/*</span>
<a name="l00006"></a>00006 <span class="comment"> * cert.h - public data structures and prototypes for the certificate library</span>
<a name="l00007"></a>00007 <span class="comment"> */</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef _CERT_H_</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define _CERT_H_</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="../../d3/da9/utilrename_8h.html">utilrename.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d70/plarena_8h.html">plarena.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="../../d1/d0e/plhash_8h.html">plhash.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="../../d0/d1c/prlong_8h.html">prlong.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="../../db/d6e/prlog_8h.html">prlog.h</a>&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d39/seccomon_8h.html">seccomon.h</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="../../da/dca/secdert_8h.html">secdert.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/secoidt_8h.html">secoidt.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d2e/keyt_8h.html">keyt.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/da5/certt_8h.html">certt.h</a>&quot;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <a class="code" href="../../dc/d39/seccomon_8h.html#a9121b5ae18500cfab6add192c955730f">SEC_BEGIN_PROTOS</a>
<a name="l00025"></a>00025    
<a name="l00026"></a>00026 <span class="comment">/****************************************************************************</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * RFC1485 ascii to/from X.? RelativeDistinguishedName (aka CERTName)</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> ****************************************************************************/</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment">** Convert an ascii RFC1485 encoded name into its CERTName equivalent.</span>
<a name="l00034"></a>00034 <span class="comment">*/</span>
<a name="l00035"></a>00035 <span class="keyword">extern</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a672cedc2c92b70dc2ee8d4911ed74ec6">CERT_AsciiToName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">/*</span>
<a name="l00038"></a>00038 <span class="comment">** Convert an CERTName into its RFC1485 encoded equivalent.</span>
<a name="l00039"></a>00039 <span class="comment">** Returns a string that must be freed with PORT_Free().</span>
<a name="l00040"></a>00040 <span class="comment">** This version produces a string for maximum human readability,</span>
<a name="l00041"></a>00041 <span class="comment">** not for strict RFC compliance.</span>
<a name="l00042"></a>00042 <span class="comment">*/</span>
<a name="l00043"></a>00043 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a655f71c67dbfccef67a369b97c789c63">CERT_NameToAscii</a>(<a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">/*</span>
<a name="l00046"></a>00046 <span class="comment">** Convert an CERTName into its RFC1485 encoded equivalent.</span>
<a name="l00047"></a>00047 <span class="comment">** Returns a string that must be freed with PORT_Free().</span>
<a name="l00048"></a>00048 <span class="comment">** Caller chooses encoding rules.</span>
<a name="l00049"></a>00049 <span class="comment">*/</span>
<a name="l00050"></a>00050 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a32731f30c62b68b9f3d0ff26dbd1d6f4">CERT_NameToAsciiInvertible</a>(<a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, 
<a name="l00051"></a>00051                                         <a class="code" href="../../d6/da5/certt_8h.html#a469f35f2b2f9c7eda07b69676349ea95">CertStrictnessLevel</a> <a class="code" href="../../dc/d42/device_list_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a>);
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="keyword">extern</span> <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a65004ad398de675257f47b130227edcf">CERT_CopyAVA</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *src);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/* convert an OID to dotted-decimal representation */</span>
<a name="l00056"></a>00056 <span class="comment">/* Returns a string that must be freed with PR_smprintf_free(). */</span>
<a name="l00057"></a>00057 <span class="keyword">extern</span> <span class="keywordtype">char</span> * <a class="code" href="../../d7/d4a/cert_8h.html#a5849a59b58ee239d5c01efc4bb97fcc6">CERT_GetOidString</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *oid);
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">/*</span>
<a name="l00060"></a>00060 <span class="comment">** Examine an AVA and return the tag that refers to it. The AVA tags are</span>
<a name="l00061"></a>00061 <span class="comment">** defined as SEC_OID_AVA*.</span>
<a name="l00062"></a>00062 <span class="comment">*/</span>
<a name="l00063"></a>00063 <span class="keyword">extern</span> <a class="code" href="../../de/d47/secoidt_8h.html#a12df3d414e7f1d49862a0ceb68fce9d0">SECOidTag</a> <a class="code" href="../../d7/d4a/cert_8h.html#a6b751b57c39dbd0a4c8928cb3e2d5f7b">CERT_GetAVATag</a>(<a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *ava);
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">/*</span>
<a name="l00066"></a>00066 <span class="comment">** Compare two AVA&#39;s, returning the difference between them.</span>
<a name="l00067"></a>00067 <span class="comment">*/</span>
<a name="l00068"></a>00068 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#aed05e726b40d2c6afb8c4e80c5f54fde">SECComparison</a> <a class="code" href="../../d7/d4a/cert_8h.html#abb6efcf0b710ab6609fb6ac7f7367483">CERT_CompareAVA</a>(<span class="keyword">const</span> <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *<a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>, <span class="keyword">const</span> <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *<a class="code" href="../../da/ded/jpegint_8h.html#af320905358fa78701e4cc60b6135601f">b</a>);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">/*</span>
<a name="l00071"></a>00071 <span class="comment">** Create an RDN (relative-distinguished-name). The argument list is a</span>
<a name="l00072"></a>00072 <span class="comment">** NULL terminated list of AVA&#39;s.</span>
<a name="l00073"></a>00073 <span class="comment">*/</span>
<a name="l00074"></a>00074 <span class="keyword">extern</span> <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a9ae3c329be7ac8d1ecb856930b146e2d">CERT_CreateRDN</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *avas, ...);
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="comment">/*</span>
<a name="l00077"></a>00077 <span class="comment">** Make a copy of &quot;src&quot; storing it in &quot;dest&quot;.</span>
<a name="l00078"></a>00078 <span class="comment">*/</span>
<a name="l00079"></a>00079 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a958f60d60e455fbc727b7e624fdc8a17">CERT_CopyRDN</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *dest, <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *src);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/*</span>
<a name="l00082"></a>00082 <span class="comment">** Destory an RDN object.</span>
<a name="l00083"></a>00083 <span class="comment">**  &quot;rdn&quot; the RDN to destroy</span>
<a name="l00084"></a>00084 <span class="comment">**  &quot;freeit&quot; if PR_TRUE then free the object as well as its sub-objects</span>
<a name="l00085"></a>00085 <span class="comment">*/</span>
<a name="l00086"></a>00086 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a5aa0266f3d183dca3ce54ba27f84c747">CERT_DestroyRDN</a>(<a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *rdn, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> freeit);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="comment">/*</span>
<a name="l00089"></a>00089 <span class="comment">** Add an AVA to an RDN.</span>
<a name="l00090"></a>00090 <span class="comment">**  &quot;rdn&quot; the RDN to add to</span>
<a name="l00091"></a>00091 <span class="comment">**  &quot;ava&quot; the AVA to add</span>
<a name="l00092"></a>00092 <span class="comment">*/</span>
<a name="l00093"></a>00093 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a18860f92fc5c25964cae46dd123b7fb3">CERT_AddAVA</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *rdn, <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *ava);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="comment">/*</span>
<a name="l00096"></a>00096 <span class="comment">** Compare two RDN&#39;s, returning the difference between them.</span>
<a name="l00097"></a>00097 <span class="comment">*/</span>
<a name="l00098"></a>00098 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#aed05e726b40d2c6afb8c4e80c5f54fde">SECComparison</a> <a class="code" href="../../d7/d4a/cert_8h.html#a15d07a4085670be63772c935f9214a3b">CERT_CompareRDN</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *<a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>, <span class="keyword">const</span> <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *<a class="code" href="../../da/ded/jpegint_8h.html#af320905358fa78701e4cc60b6135601f">b</a>);
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">/*</span>
<a name="l00101"></a>00101 <span class="comment">** Create an X.500 style name using a NULL terminated list of RDN&#39;s.</span>
<a name="l00102"></a>00102 <span class="comment">*/</span>
<a name="l00103"></a>00103 <span class="keyword">extern</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a1856f671f2c94ed5ee4c6f3485b169e1">CERT_CreateName</a>(<a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *rdn, ...);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">/*</span>
<a name="l00106"></a>00106 <span class="comment">** Make a copy of &quot;src&quot; storing it in &quot;dest&quot;. Memory is allocated in</span>
<a name="l00107"></a>00107 <span class="comment">** &quot;dest&quot; for each of the appropriate sub objects. Memory is not freed in</span>
<a name="l00108"></a>00108 <span class="comment">** &quot;dest&quot; before allocation is done (use CERT_DestroyName(dest, PR_FALSE) to</span>
<a name="l00109"></a>00109 <span class="comment">** do that).</span>
<a name="l00110"></a>00110 <span class="comment">*/</span>
<a name="l00111"></a>00111 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a60c71f1a84ed5796995e0a74ce0aeffb">CERT_CopyName</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *dest,
<a name="l00112"></a>00112                                <span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *src);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">/*</span>
<a name="l00115"></a>00115 <span class="comment">** Destroy a Name object.</span>
<a name="l00116"></a>00116 <span class="comment">**  &quot;name&quot; the CERTName to destroy</span>
<a name="l00117"></a>00117 <span class="comment">**  &quot;freeit&quot; if PR_TRUE then free the object as well as its sub-objects</span>
<a name="l00118"></a>00118 <span class="comment">*/</span>
<a name="l00119"></a>00119 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a1e0696780c2314be34bbb6ce87e655e7">CERT_DestroyName</a>(<a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="comment">/*</span>
<a name="l00122"></a>00122 <span class="comment">** Add an RDN to a name.</span>
<a name="l00123"></a>00123 <span class="comment">**  &quot;name&quot; the name to add the RDN to</span>
<a name="l00124"></a>00124 <span class="comment">**  &quot;rdn&quot; the RDN to add to name</span>
<a name="l00125"></a>00125 <span class="comment">*/</span>
<a name="l00126"></a>00126 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a46ab720b269a6a0b14d442b0c0e1bd37">CERT_AddRDN</a>(<a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, <a class="code" href="../../d8/d53/struct_c_e_r_t_r_d_n_str.html">CERTRDN</a> *rdn);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/*</span>
<a name="l00129"></a>00129 <span class="comment">** Compare two names, returning the difference between them.</span>
<a name="l00130"></a>00130 <span class="comment">*/</span>
<a name="l00131"></a>00131 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#aed05e726b40d2c6afb8c4e80c5f54fde">SECComparison</a> <a class="code" href="../../d7/d4a/cert_8h.html#a160e8fce5fee705d38d4130d44d705aa">CERT_CompareName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>, <span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../da/ded/jpegint_8h.html#af320905358fa78701e4cc60b6135601f">b</a>);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="comment">/*</span>
<a name="l00134"></a>00134 <span class="comment">** Convert a CERTName into something readable</span>
<a name="l00135"></a>00135 <span class="comment">*/</span>
<a name="l00136"></a>00136 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#acb31894bccb1f44f37615aa84f210c0e">CERT_FormatName</a> (<a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="comment">/*</span>
<a name="l00139"></a>00139 <span class="comment">** Convert a der-encoded integer to a hex printable string form.</span>
<a name="l00140"></a>00140 <span class="comment">** Perhaps this should be a SEC function but it&#39;s only used for certs.</span>
<a name="l00141"></a>00141 <span class="comment">*/</span>
<a name="l00142"></a>00142 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#ac5853de117d4aa94c9ff541fb73f67a1">CERT_Hexify</a> (<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>, <span class="keywordtype">int</span> do_colon);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="comment">/*</span>
<a name="l00145"></a>00145 <span class="comment">** Converts DER string (with explicit length) into zString, if destination </span>
<a name="l00146"></a>00146 <span class="comment">** buffer is big enough to receive it.  Does quoting and/or escaping as </span>
<a name="l00147"></a>00147 <span class="comment">** specified in RFC 1485.  Input string must be single or multi-byte DER</span>
<a name="l00148"></a>00148 <span class="comment">** character set, (ASCII, UTF8, or ISO 8851-x) not a wide character set.</span>
<a name="l00149"></a>00149 <span class="comment">** Returns SECSuccess or SECFailure with error code set. If output buffer</span>
<a name="l00150"></a>00150 <span class="comment">** is too small, sets error code SEC_ERROR_OUTPUT_LEN.</span>
<a name="l00151"></a>00151 <span class="comment">*/</span>
<a name="l00152"></a>00152 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00153"></a>00153 <a class="code" href="../../d7/d4a/cert_8h.html#ac53b8308e59ccbcaf78f88eaa9c22dba">CERT_RFC1485_EscapeAndQuote</a>(<span class="keywordtype">char</span> *dst, <span class="keywordtype">int</span> dstlen, <span class="keywordtype">char</span> *src, <span class="keywordtype">int</span> srclen);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">/******************************************************************************</span>
<a name="l00156"></a>00156 <span class="comment"> *</span>
<a name="l00157"></a>00157 <span class="comment"> * Certificate handling operations</span>
<a name="l00158"></a>00158 <span class="comment"> *</span>
<a name="l00159"></a>00159 <span class="comment"> *****************************************************************************/</span>
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">/*</span>
<a name="l00162"></a>00162 <span class="comment">** Create a new validity object given two unix time values.</span>
<a name="l00163"></a>00163 <span class="comment">**  &quot;notBefore&quot; the time before which the validity is not valid</span>
<a name="l00164"></a>00164 <span class="comment">**  &quot;notAfter&quot; the time after which the validity is not valid</span>
<a name="l00165"></a>00165 <span class="comment">*/</span>
<a name="l00166"></a>00166 <span class="keyword">extern</span> <a class="code" href="../../df/d93/struct_c_e_r_t_validity_str.html">CERTValidity</a> *<a class="code" href="../../d7/d4a/cert_8h.html#abc277abc64dece0551a7437c824f357f">CERT_CreateValidity</a>(<a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> notBefore, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> notAfter);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">/*</span>
<a name="l00169"></a>00169 <span class="comment">** Destroy a validity object.</span>
<a name="l00170"></a>00170 <span class="comment">**  &quot;v&quot; the validity to destroy</span>
<a name="l00171"></a>00171 <span class="comment">**  &quot;freeit&quot; if PR_TRUE then free the object as well as its sub-objects</span>
<a name="l00172"></a>00172 <span class="comment">*/</span>
<a name="l00173"></a>00173 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a6a2e7c817a3a2e734a6a14dbaafbb628">CERT_DestroyValidity</a>(<a class="code" href="../../df/d93/struct_c_e_r_t_validity_str.html">CERTValidity</a> *<a class="code" href="../../db/db1/namespace_j_s_1_1detail.html#a5d38b5ed0e5a6c44c34f95302820c4d7">v</a>);
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">/*</span>
<a name="l00176"></a>00176 <span class="comment">** Copy the &quot;src&quot; object to &quot;dest&quot;. Memory is allocated in &quot;dest&quot; for</span>
<a name="l00177"></a>00177 <span class="comment">** each of the appropriate sub-objects. Memory in &quot;dest&quot; is not freed</span>
<a name="l00178"></a>00178 <span class="comment">** before memory is allocated (use CERT_DestroyValidity(v, PR_FALSE) to do</span>
<a name="l00179"></a>00179 <span class="comment">** that).</span>
<a name="l00180"></a>00180 <span class="comment">*/</span>
<a name="l00181"></a>00181 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a8ed90c0200f0a38545172192fdc609d6">CERT_CopyValidity</a>
<a name="l00182"></a>00182    (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../df/d93/struct_c_e_r_t_validity_str.html">CERTValidity</a> *dest, <a class="code" href="../../df/d93/struct_c_e_r_t_validity_str.html">CERTValidity</a> *src);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">/*</span>
<a name="l00185"></a>00185 <span class="comment">** The cert lib considers a cert or CRL valid if the &quot;notBefore&quot; time is</span>
<a name="l00186"></a>00186 <span class="comment">** in the not-too-distant future, e.g. within the next 24 hours. This </span>
<a name="l00187"></a>00187 <span class="comment">** prevents freshly issued certificates from being considered invalid</span>
<a name="l00188"></a>00188 <span class="comment">** because the local system&#39;s time zone is incorrectly set.  </span>
<a name="l00189"></a>00189 <span class="comment">** The amount of &quot;pending slop time&quot; is adjustable by the application.</span>
<a name="l00190"></a>00190 <span class="comment">** Units of SlopTime are seconds.  Default is 86400  (24 hours).</span>
<a name="l00191"></a>00191 <span class="comment">** Negative SlopTime values are not allowed.</span>
<a name="l00192"></a>00192 <span class="comment">*/</span>
<a name="l00193"></a>00193 <a class="code" href="../../da/d32/prio_8h.html#aa2da33fd2457c50652acc2d806dcac1c">PRInt32</a> <a class="code" href="../../d7/d4a/cert_8h.html#a6eab72fe6ca74a47a9c709ad00647ecd">CERT_GetSlopTime</a>(<span class="keywordtype">void</span>);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#aaa88f18ebbb7e9b6c1e601f9b2a1c210">CERT_SetSlopTime</a>(<a class="code" href="../../da/d32/prio_8h.html#aa2da33fd2457c50652acc2d806dcac1c">PRInt32</a> slop);
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="comment">/*</span>
<a name="l00198"></a>00198 <span class="comment">** Create a new certificate object. The result must be wrapped with an</span>
<a name="l00199"></a>00199 <span class="comment">** CERTSignedData to create a signed certificate.</span>
<a name="l00200"></a>00200 <span class="comment">**  &quot;serialNumber&quot; the serial number</span>
<a name="l00201"></a>00201 <span class="comment">**  &quot;issuer&quot; the name of the certificate issuer</span>
<a name="l00202"></a>00202 <span class="comment">**  &quot;validity&quot; the validity period of the certificate</span>
<a name="l00203"></a>00203 <span class="comment">**  &quot;req&quot; the certificate request that prompted the certificate issuance</span>
<a name="l00204"></a>00204 <span class="comment">*/</span>
<a name="l00205"></a>00205 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00206"></a>00206 <a class="code" href="../../d7/d4a/cert_8h.html#a545ccf92d750f97a7b285699882ab253">CERT_CreateCertificate</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> serialNumber, <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *issuer,
<a name="l00207"></a>00207             <a class="code" href="../../df/d93/struct_c_e_r_t_validity_str.html">CERTValidity</a> *validity, <a class="code" href="../../d0/d8a/struct_c_e_r_t_certificate_request_str.html">CERTCertificateRequest</a> *<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">/*</span>
<a name="l00210"></a>00210 <span class="comment">** Destroy a certificate object</span>
<a name="l00211"></a>00211 <span class="comment">**  &quot;cert&quot; the certificate to destroy</span>
<a name="l00212"></a>00212 <span class="comment">** NOTE: certificate&#39;s are reference counted. This call decrements the</span>
<a name="l00213"></a>00213 <span class="comment">** reference count, and if the result is zero, then the object is destroyed</span>
<a name="l00214"></a>00214 <span class="comment">** and optionally freed.</span>
<a name="l00215"></a>00215 <span class="comment">*/</span>
<a name="l00216"></a>00216 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a631315af58d6b382e6eb940830acff0f">CERT_DestroyCertificate</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">/*</span>
<a name="l00219"></a>00219 <span class="comment">** Make a shallow copy of a certificate &quot;c&quot;. Just increments the</span>
<a name="l00220"></a>00220 <span class="comment">** reference count on &quot;c&quot;.</span>
<a name="l00221"></a>00221 <span class="comment">*/</span>
<a name="l00222"></a>00222 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a2d8167a5d4b5e24732404f6823553139">CERT_DupCertificate</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>);
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="comment">/*</span>
<a name="l00225"></a>00225 <span class="comment">** Create a new certificate request. This result must be wrapped with an</span>
<a name="l00226"></a>00226 <span class="comment">** CERTSignedData to create a signed certificate request.</span>
<a name="l00227"></a>00227 <span class="comment">**  &quot;name&quot; the subject name (who the certificate request is from)</span>
<a name="l00228"></a>00228 <span class="comment">**  &quot;spki&quot; describes/defines the public key the certificate is for</span>
<a name="l00229"></a>00229 <span class="comment">**  &quot;attributes&quot; if non-zero, some optional attribute data</span>
<a name="l00230"></a>00230 <span class="comment">*/</span>
<a name="l00231"></a>00231 <span class="keyword">extern</span> <a class="code" href="../../d0/d8a/struct_c_e_r_t_certificate_request_str.html">CERTCertificateRequest</a> *
<a name="l00232"></a>00232 <a class="code" href="../../d7/d4a/cert_8h.html#a96c223845038e71ea521b488945c7cd0">CERT_CreateCertificateRequest</a> (<a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, <a class="code" href="../../d3/d07/struct_c_e_r_t_subject_public_key_info_str.html">CERTSubjectPublicKeyInfo</a> *spki,
<a name="l00233"></a>00233                    <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **attributes);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 <span class="comment">/*</span>
<a name="l00236"></a>00236 <span class="comment">** Destroy a certificate-request object</span>
<a name="l00237"></a>00237 <span class="comment">**  &quot;r&quot; the certificate-request to destroy</span>
<a name="l00238"></a>00238 <span class="comment">**  &quot;freeit&quot; if PR_TRUE then free the object as well as its sub-objects</span>
<a name="l00239"></a>00239 <span class="comment">*/</span>
<a name="l00240"></a>00240 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a95aaa8b9354a6fdf62334b7e29b79b9b">CERT_DestroyCertificateRequest</a>(<a class="code" href="../../d0/d8a/struct_c_e_r_t_certificate_request_str.html">CERTCertificateRequest</a> *r);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="comment">/*</span>
<a name="l00243"></a>00243 <span class="comment">** Start adding extensions to a certificate request.</span>
<a name="l00244"></a>00244 <span class="comment">*/</span>
<a name="l00245"></a>00245 <span class="keywordtype">void</span> *
<a name="l00246"></a>00246 <a class="code" href="../../d7/d4a/cert_8h.html#a79e9b0fe58caa7ecf261bca2309d52a4">CERT_StartCertificateRequestAttributes</a>(<a class="code" href="../../d0/d8a/struct_c_e_r_t_certificate_request_str.html">CERTCertificateRequest</a> *<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="comment">/*</span>
<a name="l00249"></a>00249 <span class="comment">** Reformat the certificate extension list into a CertificateRequest</span>
<a name="l00250"></a>00250 <span class="comment">** attribute list.</span>
<a name="l00251"></a>00251 <span class="comment">*/</span>
<a name="l00252"></a>00252 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00253"></a>00253 <a class="code" href="../../d7/d4a/cert_8h.html#a6828e78dcda8f5b870811161141c0131">CERT_FinishCertificateRequestAttributes</a>(<a class="code" href="../../d0/d8a/struct_c_e_r_t_certificate_request_str.html">CERTCertificateRequest</a> *<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="comment">/*</span>
<a name="l00256"></a>00256 <span class="comment">** Extract the Extension Requests from a DER CertRequest attribute list.</span>
<a name="l00257"></a>00257 <span class="comment">*/</span>
<a name="l00258"></a>00258 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00259"></a>00259 <a class="code" href="../../d7/d4a/cert_8h.html#a18786403a13d5aa5c3f11244c3d5ec43">CERT_GetCertificateRequestExtensions</a>(<a class="code" href="../../d0/d8a/struct_c_e_r_t_certificate_request_str.html">CERTCertificateRequest</a> *<a class="code" href="../../d5/dbd/camera_2js_2camera_8js.html#a42c43c76081a7df8ae2954f16ee9338b">req</a>,
<a name="l00260"></a>00260                                      <a class="code" href="../../dd/d02/struct_c_e_r_t_cert_extension_str.html">CERTCertExtension</a> ***exts);
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="comment">/*</span>
<a name="l00263"></a>00263 <span class="comment">** Extract a public key object from a certificate</span>
<a name="l00264"></a>00264 <span class="comment">*/</span>
<a name="l00265"></a>00265 <span class="keyword">extern</span> <a class="code" href="../../d6/d1a/struct_s_e_c_k_e_y_public_key_str.html">SECKEYPublicKey</a> *<a class="code" href="../../d7/d4a/cert_8h.html#acda828975bbb9abeb624ac6b99683724">CERT_ExtractPublicKey</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">/*</span>
<a name="l00268"></a>00268 <span class="comment">** Retrieve the Key Type associated with the cert we&#39;re dealing with</span>
<a name="l00269"></a>00269 <span class="comment">*/</span>
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 <span class="keyword">extern</span> <a class="code" href="../../d7/da9/keythi_8h.html#aab0feaba617470cb4aa830dc5935238c">KeyType</a> <a class="code" href="../../d7/d4a/cert_8h.html#a068ae0f7a8b17be940c5c81b1662bef7">CERT_GetCertKeyType</a> (<a class="code" href="../../d3/d07/struct_c_e_r_t_subject_public_key_info_str.html">CERTSubjectPublicKeyInfo</a> *spki);
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 <span class="comment">/*</span>
<a name="l00274"></a>00274 <span class="comment">** Initialize the certificate database.  This is called to create</span>
<a name="l00275"></a>00275 <span class="comment">**  the initial list of certificates in the database.</span>
<a name="l00276"></a>00276 <span class="comment">*/</span>
<a name="l00277"></a>00277 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a5b64eff7a207d3e0db6bb974047fdbbf">CERT_InitCertDB</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d4a/cert_8h.html#a96f72c72c4cf0be716714a43f67c54f3">CERT_GetDBContentVersion</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">/*</span>
<a name="l00282"></a>00282 <span class="comment">** Default certificate database routines</span>
<a name="l00283"></a>00283 <span class="comment">*/</span>
<a name="l00284"></a>00284 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a655949aacc9fd1880d7d4b2484ab2f54">CERT_SetDefaultCertDB</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="keyword">extern</span> <a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a305c295949ad98f6213e8580c79f8020">CERT_GetDefaultCertDB</a>(<span class="keywordtype">void</span>);
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 <span class="keyword">extern</span> <a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a22279a552e5e0e02fd6c64c71cc0140d">CERT_GetCertChainFromCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, 
<a name="l00289"></a>00289                            <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> <a class="code" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a>, 
<a name="l00290"></a>00290                            <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage);
<a name="l00291"></a>00291 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00292"></a>00292 <a class="code" href="../../d7/d4a/cert_8h.html#a21ef6a53b1077a21be7aacae0f3715fe">CERT_NewTempCertificate</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert,
<a name="l00293"></a>00293                          <span class="keywordtype">char</span> *nickname, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> isperm, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> copyDER);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 <span class="comment">/******************************************************************************</span>
<a name="l00297"></a>00297 <span class="comment"> *</span>
<a name="l00298"></a>00298 <span class="comment"> * X.500 Name handling operations</span>
<a name="l00299"></a>00299 <span class="comment"> *</span>
<a name="l00300"></a>00300 <span class="comment"> *****************************************************************************/</span>
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="comment">/*</span>
<a name="l00303"></a>00303 <span class="comment">** Create an AVA (attribute-value-assertion)</span>
<a name="l00304"></a>00304 <span class="comment">**  &quot;arena&quot; the memory arena to alloc from</span>
<a name="l00305"></a>00305 <span class="comment">**  &quot;kind&quot; is one of SEC_OID_AVA_*</span>
<a name="l00306"></a>00306 <span class="comment">**  &quot;valueType&quot; is one of DER_PRINTABLE_STRING, DER_IA5_STRING, or</span>
<a name="l00307"></a>00307 <span class="comment">**     DER_T61_STRING</span>
<a name="l00308"></a>00308 <span class="comment">**  &quot;value&quot; is the null terminated string containing the value</span>
<a name="l00309"></a>00309 <span class="comment">*/</span>
<a name="l00310"></a>00310 <span class="keyword">extern</span> <a class="code" href="../../df/db0/struct_c_e_r_t_a_v_a_str.html">CERTAVA</a> *<a class="code" href="../../d7/d4a/cert_8h.html#aba681248ad2f2c9396b3aa1c4f9f8c9f">CERT_CreateAVA</a>
<a name="l00311"></a>00311    (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../de/d47/secoidt_8h.html#a12df3d414e7f1d49862a0ceb68fce9d0">SECOidTag</a> <a class="code" href="../../d2/d7d/jsapi_8h.html#a21b86a570102717f58e91d7c7ddce179">kind</a>, <span class="keywordtype">int</span> valueType, <span class="keywordtype">char</span> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 <span class="comment">/*</span>
<a name="l00314"></a>00314 <span class="comment">** Extract the Distinguished Name from a DER encoded certificate</span>
<a name="l00315"></a>00315 <span class="comment">**  &quot;derCert&quot; is the DER encoded certificate</span>
<a name="l00316"></a>00316 <span class="comment">**  &quot;derName&quot; is the SECItem that the name is returned in</span>
<a name="l00317"></a>00317 <span class="comment">*/</span>
<a name="l00318"></a>00318 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#af2b2c4b258d5faf2654a4167c65948a6">CERT_NameFromDERCert</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derName);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="comment">/*</span>
<a name="l00321"></a>00321 <span class="comment">** Extract the Issuers Distinguished Name from a DER encoded certificate</span>
<a name="l00322"></a>00322 <span class="comment">**  &quot;derCert&quot; is the DER encoded certificate</span>
<a name="l00323"></a>00323 <span class="comment">**  &quot;derName&quot; is the SECItem that the name is returned in</span>
<a name="l00324"></a>00324 <span class="comment">*/</span>
<a name="l00325"></a>00325 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a2b614cb7d100206a52ff6df9651caf20">CERT_IssuerNameFromDERCert</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert, 
<a name="l00326"></a>00326                         <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derName);
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="keyword">extern</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *
<a name="l00329"></a>00329 <a class="code" href="../../d7/d4a/cert_8h.html#a78504fb32c6bc81e2cbe6ab79f267c9d">CERT_EncodeGeneralName</a>(<a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *genName, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest,
<a name="l00330"></a>00330                <a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">extern</span> <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l00333"></a>00333 <a class="code" href="../../d7/d4a/cert_8h.html#a0d46e953ad14c15ef81181cbffc6647a">CERT_DecodeGeneralName</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *reqArena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedName,
<a name="l00334"></a>00334                <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a>  *genName);
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="comment">/*</span>
<a name="l00339"></a>00339 <span class="comment">** Generate a database search key for a certificate, based on the</span>
<a name="l00340"></a>00340 <span class="comment">** issuer and serial number.</span>
<a name="l00341"></a>00341 <span class="comment">**  &quot;arena&quot; the memory arena to alloc from</span>
<a name="l00342"></a>00342 <span class="comment">**  &quot;derCert&quot; the DER encoded certificate</span>
<a name="l00343"></a>00343 <span class="comment">**  &quot;key&quot; the returned key</span>
<a name="l00344"></a>00344 <span class="comment">*/</span>
<a name="l00345"></a>00345 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ad749786058ab5aec29dc17e16ac2bf86">CERT_KeyFromDERCert</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *reqArena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert,
<a name="l00346"></a>00346                                      <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#aac91f912c642abdf91083d3ad65637be">CERT_KeyFromIssuerAndSN</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *issuer,
<a name="l00349"></a>00349                      <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *sn, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#afdc5933f96e691961fee6944a1ee46c7">CERT_SerialNumberFromDERCert</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert, 
<a name="l00352"></a>00352                         <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derName);
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">/*</span>
<a name="l00356"></a>00356 <span class="comment">** Generate a database search key for a crl, based on the</span>
<a name="l00357"></a>00357 <span class="comment">** issuer.</span>
<a name="l00358"></a>00358 <span class="comment">**  &quot;arena&quot; the memory arena to alloc from</span>
<a name="l00359"></a>00359 <span class="comment">**  &quot;derCrl&quot; the DER encoded crl</span>
<a name="l00360"></a>00360 <span class="comment">**  &quot;key&quot; the returned key</span>
<a name="l00361"></a>00361 <span class="comment">*/</span>
<a name="l00362"></a>00362 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ab6fe75939454c369ed466738828365bd">CERT_KeyFromDERCrl</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCrl, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>);
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 <span class="comment">/*</span>
<a name="l00365"></a>00365 <span class="comment">** Open the certificate database.  Use callback to get name of database.</span>
<a name="l00366"></a>00366 <span class="comment">*/</span>
<a name="l00367"></a>00367 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a4e239bae2953d5c06b7a3422ff9ae4a2">CERT_OpenCertDB</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> readOnly,
<a name="l00368"></a>00368                  <a class="code" href="../../d6/da5/certt_8h.html#a276b9c56a4063036e4c9ee9de3929432">CERTDBNameFunc</a> namecb, <span class="keywordtype">void</span> *cbarg);
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="comment">/* Open the certificate database.  Use given filename for database. */</span>
<a name="l00371"></a>00371 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a5fa768b07067bfc7b4b43d3bd8d23e91">CERT_OpenCertDBFilename</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l00372"></a>00372                      <span class="keywordtype">char</span> *certdbname, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> readOnly);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374 <span class="comment">/*</span>
<a name="l00375"></a>00375 <span class="comment">** Open and initialize a cert database that is entirely in memory.  This</span>
<a name="l00376"></a>00376 <span class="comment">** can be used when the permanent database can not be opened or created.</span>
<a name="l00377"></a>00377 <span class="comment">*/</span>
<a name="l00378"></a>00378 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a309f43cd3db9488e3ba23f94b1104ddf">CERT_OpenVolatileCertDB</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">/*</span>
<a name="l00381"></a>00381 <span class="comment">** Extract the list of host names, host name patters, IP address strings</span>
<a name="l00382"></a>00382 <span class="comment">** this cert is valid for.</span>
<a name="l00383"></a>00383 <span class="comment">** This function does NOT return nicknames.</span>
<a name="l00384"></a>00384 <span class="comment">** Type CERTCertNicknames is being used because it&#39;s a convenient </span>
<a name="l00385"></a>00385 <span class="comment">** data structure to carry a list of strings and its count.</span>
<a name="l00386"></a>00386 <span class="comment">*/</span>
<a name="l00387"></a>00387 <span class="keyword">extern</span> <a class="code" href="../../df/dec/struct_c_e_r_t_cert_nicknames_str.html">CERTCertNicknames</a> *
<a name="l00388"></a>00388   <a class="code" href="../../d7/d4a/cert_8h.html#a60f4aef2808c81cb8ef8841874dc37e3">CERT_GetValidDNSPatternsFromCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="comment">/*</span>
<a name="l00391"></a>00391 <span class="comment">** Check the hostname to make sure that it matches the shexp that</span>
<a name="l00392"></a>00392 <span class="comment">** is given in the common name of the certificate.</span>
<a name="l00393"></a>00393 <span class="comment">*/</span>
<a name="l00394"></a>00394 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a1eb1363b3511b3b3fb50ac40cc675eea">CERT_VerifyCertName</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00395"></a>00395                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *hostname);
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">/*</span>
<a name="l00398"></a>00398 <span class="comment">** Add a domain name to the list of names that the user has explicitly</span>
<a name="l00399"></a>00399 <span class="comment">** allowed (despite cert name mismatches) for use with a server cert.</span>
<a name="l00400"></a>00400 <span class="comment">*/</span>
<a name="l00401"></a>00401 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ac89ccb1469ae85f406248356f31aa615">CERT_AddOKDomainName</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *hostname);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 <span class="comment">/*</span>
<a name="l00404"></a>00404 <span class="comment">** Decode a DER encoded certificate into an CERTCertificate structure</span>
<a name="l00405"></a>00405 <span class="comment">**  &quot;derSignedCert&quot; is the DER encoded signed certificate</span>
<a name="l00406"></a>00406 <span class="comment">**  &quot;copyDER&quot; is true if the DER should be copied, false if the</span>
<a name="l00407"></a>00407 <span class="comment">**      existing copy should be referenced</span>
<a name="l00408"></a>00408 <span class="comment">**  &quot;nickname&quot; is the nickname to use in the database.  If it is NULL</span>
<a name="l00409"></a>00409 <span class="comment">**      then a temporary nickname is generated.</span>
<a name="l00410"></a>00410 <span class="comment">*/</span>
<a name="l00411"></a>00411 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00412"></a>00412 <a class="code" href="../../d7/d4a/cert_8h.html#aacd2fabeb7e91876af44dd5384ff0fb5">CERT_DecodeDERCertificate</a> (<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derSignedCert, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> copyDER, <span class="keywordtype">char</span> *nickname);
<a name="l00413"></a>00413 <span class="comment">/*</span>
<a name="l00414"></a>00414 <span class="comment">** Decode a DER encoded CRL into a CERTSignedCrl structure</span>
<a name="l00415"></a>00415 <span class="comment">**  &quot;derSignedCrl&quot; is the DER encoded signed CRL.</span>
<a name="l00416"></a>00416 <span class="comment">**  &quot;type&quot; must be SEC_CRL_TYPE.</span>
<a name="l00417"></a>00417 <span class="comment">*/</span>
<a name="l00418"></a><a class="code" href="../../d7/d4a/cert_8h.html#af354dd3cb9e18cfbae2ad6f613f77dd0">00418</a> <span class="preprocessor">#define SEC_CRL_TYPE    1</span>
<a name="l00419"></a><a class="code" href="../../d7/d4a/cert_8h.html#a3d519ebfae74fbfb13114828b34723fd">00419</a> <span class="preprocessor"></span><span class="preprocessor">#define SEC_KRL_TYPE    0 </span><span class="comment">/* deprecated */</span>
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 <span class="keyword">extern</span> <a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a> *
<a name="l00422"></a>00422 <a class="code" href="../../d7/d4a/cert_8h.html#a4fd984a9c87928b0692cd21a8f5cbf72">CERT_DecodeDERCrl</a> (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derSignedCrl,<span class="keywordtype">int</span> <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="comment">/*</span>
<a name="l00425"></a>00425 <span class="comment"> * same as CERT_DecodeDERCrl, plus allow options to be passed in</span>
<a name="l00426"></a>00426 <span class="comment"> */</span>
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 <span class="keyword">extern</span> <a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a> *
<a name="l00429"></a>00429 <a class="code" href="../../d7/d4a/cert_8h.html#af33cc5f05c3a2ee3c066aa2d7dc924d7">CERT_DecodeDERCrlWithFlags</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *narena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derSignedCrl,
<a name="l00430"></a>00430                           <span class="keywordtype">int</span> <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, <a class="code" href="../../da/d32/prio_8h.html#aa2da33fd2457c50652acc2d806dcac1c">PRInt32</a> <a class="code" href="../../d6/d46/system_2js_2icc_8js.html#a77e4041f4236c111378c64001ea99114">options</a>);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="comment">/* CRL options to pass */</span>
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="../../d7/d4a/cert_8h.html#a3bff14b64817c42deb03df1080293138">00434</a> <span class="preprocessor">#define CRL_DECODE_DEFAULT_OPTIONS          0x00000000</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span>
<a name="l00436"></a>00436 <span class="comment">/* when CRL_DECODE_DONT_COPY_DER is set, the DER is not copied . The</span>
<a name="l00437"></a>00437 <span class="comment">   application must then keep derSignedCrl until it destroys the</span>
<a name="l00438"></a>00438 <span class="comment">   CRL . Ideally, it should allocate derSignedCrl in an arena</span>
<a name="l00439"></a>00439 <span class="comment">   and pass that arena in as the first argument to</span>
<a name="l00440"></a>00440 <span class="comment">   CERT_DecodeDERCrlWithFlags */</span>
<a name="l00441"></a>00441 
<a name="l00442"></a><a class="code" href="../../d7/d4a/cert_8h.html#a758324ef1154b56e2c24d4988584d8ed">00442</a> <span class="preprocessor">#define CRL_DECODE_DONT_COPY_DER            0x00000001</span>
<a name="l00443"></a><a class="code" href="../../d7/d4a/cert_8h.html#ae85bf630503055071b18d8389a48e8c8">00443</a> <span class="preprocessor"></span><span class="preprocessor">#define CRL_DECODE_SKIP_ENTRIES             0x00000002</span>
<a name="l00444"></a><a class="code" href="../../d7/d4a/cert_8h.html#a480a0ec70cb355be714d09be66c1432b">00444</a> <span class="preprocessor"></span><span class="preprocessor">#define CRL_DECODE_KEEP_BAD_CRL             0x00000004</span>
<a name="l00445"></a><a class="code" href="../../d7/d4a/cert_8h.html#a2d089a3e7bdac357fe14c142596e8c89">00445</a> <span class="preprocessor"></span><span class="preprocessor">#define CRL_DECODE_ADOPT_HEAP_DER           0x00000008</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span>
<a name="l00447"></a>00447 <span class="comment">/* complete the decoding of a partially decoded CRL, ie. decode the</span>
<a name="l00448"></a>00448 <span class="comment">   entries. Note that entries is an optional field in a CRL, so the</span>
<a name="l00449"></a>00449 <span class="comment">   &quot;entries&quot; pointer in CERTCrlStr may still be NULL even after</span>
<a name="l00450"></a>00450 <span class="comment">   function returns SECSuccess */</span>
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a9a0994acf597fae76159cf608a1f5236">CERT_CompleteCRLDecodeEntries</a>(<a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a>* crl);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="comment">/* Validate CRL then import it to the dbase.  If there is already a CRL with the</span>
<a name="l00455"></a>00455 <span class="comment"> * same CA in the dbase, it will be replaced if derCRL is more up to date.  </span>
<a name="l00456"></a>00456 <span class="comment"> * If the process successes, a CRL will be returned.  Otherwise, a NULL will </span>
<a name="l00457"></a>00457 <span class="comment"> * be returned. The caller should call PORT_GetError() for the exactly error </span>
<a name="l00458"></a>00458 <span class="comment"> * code.</span>
<a name="l00459"></a>00459 <span class="comment"> */</span>
<a name="l00460"></a>00460 <span class="keyword">extern</span> <a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a> *
<a name="l00461"></a>00461 <a class="code" href="../../d7/d4a/cert_8h.html#a4eeb7f420005dbc61136f113f90b96b0">CERT_ImportCRL</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCRL, <span class="keywordtype">char</span> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#a85c9a955e7da65bfd5fc9b87158c3570">url</a>, 
<a name="l00462"></a>00462                         <span class="keywordtype">int</span> <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, <span class="keywordtype">void</span> * wincx);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#adcc1da648719c48651237935a8bf3f6c">CERT_DestroyCrl</a> (<a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a> *crl);
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <span class="comment">/* this is a hint to flush the CRL cache. crlKey is the DER subject of</span>
<a name="l00467"></a>00467 <span class="comment">   the issuer (CA). */</span>
<a name="l00468"></a>00468 <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#ae712131e627b340e708b557c682243c8">CERT_CRLCacheRefreshIssuer</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a>* dbhandle, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>* crlKey);
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="comment">/* add the specified DER CRL object to the CRL cache. Doing so will allow</span>
<a name="l00471"></a>00471 <span class="comment">   certificate verification functions (such as CERT_VerifyCertificate)</span>
<a name="l00472"></a>00472 <span class="comment">   to automatically find and make use of this CRL object.</span>
<a name="l00473"></a>00473 <span class="comment">   Once a CRL is added to the CRL cache, the application must hold on to</span>
<a name="l00474"></a>00474 <span class="comment">   the object&#39;s memory, because the cache will reference it directly. The</span>
<a name="l00475"></a>00475 <span class="comment">   application can only free the object after it calls CERT_UncacheCRL to</span>
<a name="l00476"></a>00476 <span class="comment">   remove it from the CRL cache.</span>
<a name="l00477"></a>00477 <span class="comment">*/</span>
<a name="l00478"></a>00478 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a4aa8dd3db3c12c5fc51831dad41a87a0">CERT_CacheCRL</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a>* dbhandle, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>* newcrl);
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="comment">/* remove a previously added CRL object from the CRL cache. It is OK</span>
<a name="l00481"></a>00481 <span class="comment">   for the application to free the memory after a successful removal</span>
<a name="l00482"></a>00482 <span class="comment">*/</span>
<a name="l00483"></a>00483 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a66f07f1383511e8491ff561d15f260c7">CERT_UncacheCRL</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a>* dbhandle, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>* oldcrl);
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 <span class="comment">/*</span>
<a name="l00486"></a>00486 <span class="comment">** Find a certificate in the database</span>
<a name="l00487"></a>00487 <span class="comment">**  &quot;key&quot; is the database key to look for</span>
<a name="l00488"></a>00488 <span class="comment">*/</span>
<a name="l00489"></a>00489 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d7/d4a/cert_8h.html#ae6e76c39e9ea42c734e62b080ba2d119">CERT_FindCertByKey</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>);
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="comment">/*</span>
<a name="l00492"></a>00492 <span class="comment">** Find a certificate in the database by name</span>
<a name="l00493"></a>00493 <span class="comment">**  &quot;name&quot; is the distinguished name to look up</span>
<a name="l00494"></a>00494 <span class="comment">*/</span>
<a name="l00495"></a>00495 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00496"></a>00496 <a class="code" href="../../d7/d4a/cert_8h.html#ab583aeccdd4567a0732a59b4b652e545">CERT_FindCertByName</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="comment">/*</span>
<a name="l00499"></a>00499 <span class="comment">** Find a certificate in the database by name</span>
<a name="l00500"></a>00500 <span class="comment">**  &quot;name&quot; is the distinguished name to look up (in ascii)</span>
<a name="l00501"></a>00501 <span class="comment">*/</span>
<a name="l00502"></a>00502 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00503"></a>00503 <a class="code" href="../../d7/d4a/cert_8h.html#af63f8fc5322da016c3043e91df1a301b">CERT_FindCertByNameString</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <span class="keywordtype">char</span> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 <span class="comment">/*</span>
<a name="l00506"></a>00506 <span class="comment">** Find a certificate in the database by name and keyid</span>
<a name="l00507"></a>00507 <span class="comment">**  &quot;name&quot; is the distinguished name to look up</span>
<a name="l00508"></a>00508 <span class="comment">**  &quot;keyID&quot; is the value of the subjectKeyID to match</span>
<a name="l00509"></a>00509 <span class="comment">*/</span>
<a name="l00510"></a>00510 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00511"></a>00511 <a class="code" href="../../d7/d4a/cert_8h.html#a499bc65199ebe2b3a9af4287e9531ce5">CERT_FindCertByKeyID</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *keyID);
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 <span class="comment">/*</span>
<a name="l00514"></a>00514 <span class="comment">** Generate a certificate key from the issuer and serialnumber, then look it</span>
<a name="l00515"></a>00515 <span class="comment">** up in the database.  Return the cert if found.</span>
<a name="l00516"></a>00516 <span class="comment">**  &quot;issuerAndSN&quot; is the issuer and serial number to look for</span>
<a name="l00517"></a>00517 <span class="comment">*/</span>
<a name="l00518"></a>00518 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00519"></a>00519 <a class="code" href="../../d7/d4a/cert_8h.html#ad8b152eadbe8767ae7acd648552e87f6">CERT_FindCertByIssuerAndSN</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../db/de1/struct_c_e_r_t_issuer_and_s_n_str.html">CERTIssuerAndSN</a> *issuerAndSN);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="comment">/*</span>
<a name="l00522"></a>00522 <span class="comment">** Find a certificate in the database by a subject key ID</span>
<a name="l00523"></a>00523 <span class="comment">**  &quot;subjKeyID&quot; is the subject Key ID to look for</span>
<a name="l00524"></a>00524 <span class="comment">*/</span>
<a name="l00525"></a>00525 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00526"></a>00526 <a class="code" href="../../d7/d4a/cert_8h.html#a43470a80221c7c6aacd7ca1e4bdc61ba">CERT_FindCertBySubjectKeyID</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *subjKeyID);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528 <span class="comment">/*</span>
<a name="l00529"></a>00529 <span class="comment">** Encode Certificate SKID (Subject Key ID) extension.</span>
<a name="l00530"></a>00530 <span class="comment">**</span>
<a name="l00531"></a>00531 <span class="comment">*/</span>
<a name="l00532"></a>00532 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> 
<a name="l00533"></a>00533 <a class="code" href="../../d7/d4a/cert_8h.html#a9212f5a5ecdde5d1dc72126ab466f240">CERT_EncodeSubjectKeyID</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>* srcString,
<a name="l00534"></a>00534                         <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="comment">/*</span>
<a name="l00537"></a>00537 <span class="comment">** Find a certificate in the database by a nickname</span>
<a name="l00538"></a>00538 <span class="comment">**  &quot;nickname&quot; is the ascii string nickname to look for</span>
<a name="l00539"></a>00539 <span class="comment">*/</span>
<a name="l00540"></a>00540 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00541"></a>00541 <a class="code" href="../../d7/d4a/cert_8h.html#abf1b912718a7c8704149530d0af8816c">CERT_FindCertByNickname</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *nickname);
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">/*</span>
<a name="l00544"></a>00544 <span class="comment">** Find a certificate in the database by a DER encoded certificate</span>
<a name="l00545"></a>00545 <span class="comment">**  &quot;derCert&quot; is the DER encoded certificate</span>
<a name="l00546"></a>00546 <span class="comment">*/</span>
<a name="l00547"></a>00547 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00548"></a>00548 <a class="code" href="../../d7/d4a/cert_8h.html#ad180cb0ed5a7b75217f691948ad67c54">CERT_FindCertByDERCert</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="comment">/*</span>
<a name="l00551"></a>00551 <span class="comment">** Find a certificate in the database by a email address</span>
<a name="l00552"></a>00552 <span class="comment">**  &quot;emailAddr&quot; is the email address to look up</span>
<a name="l00553"></a>00553 <span class="comment">*/</span>
<a name="l00554"></a>00554 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00555"></a>00555 <a class="code" href="../../d7/d4a/cert_8h.html#adf8e9b4cb37eb4e25272bb6216f9b3cd">CERT_FindCertByEmailAddr</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <span class="keywordtype">char</span> *emailAddr);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557 <span class="comment">/*</span>
<a name="l00558"></a>00558 <span class="comment">** Find a certificate in the database by a email address or nickname</span>
<a name="l00559"></a>00559 <span class="comment">**  &quot;name&quot; is the email address or nickname to look up</span>
<a name="l00560"></a>00560 <span class="comment">*/</span>
<a name="l00561"></a>00561 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00562"></a>00562 <a class="code" href="../../d7/d4a/cert_8h.html#ae6f57c9099d21b6b2f6e64abcb726a60">CERT_FindCertByNicknameOrEmailAddr</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 <span class="comment">/*</span>
<a name="l00565"></a>00565 <span class="comment">** Find a certificate in the database by a email address or nickname</span>
<a name="l00566"></a>00566 <span class="comment">** and require it to have the given usage.</span>
<a name="l00567"></a>00567 <span class="comment">**      &quot;name&quot; is the email address or nickname to look up</span>
<a name="l00568"></a>00568 <span class="comment">*/</span>
<a name="l00569"></a>00569 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00570"></a>00570 <a class="code" href="../../d7/d4a/cert_8h.html#a11a4fe67295a8c627786935da1684b2d">CERT_FindCertByNicknameOrEmailAddrForUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l00571"></a>00571                                            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, 
<a name="l00572"></a>00572                                            <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> lookingForUsage);
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <span class="comment">/*</span>
<a name="l00575"></a>00575 <span class="comment">** Find a certificate in the database by a digest of a subject public key</span>
<a name="l00576"></a>00576 <span class="comment">**  &quot;spkDigest&quot; is the digest to look up</span>
<a name="l00577"></a>00577 <span class="comment">*/</span>
<a name="l00578"></a>00578 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00579"></a>00579 <a class="code" href="../../d7/d4a/cert_8h.html#a49468d16c22c8bc5a2e69f656bcc2c18">CERT_FindCertBySPKDigest</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *spkDigest);
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 <span class="comment">/*</span>
<a name="l00582"></a>00582 <span class="comment"> * Find the issuer of a cert</span>
<a name="l00583"></a>00583 <span class="comment"> */</span>
<a name="l00584"></a>00584 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l00585"></a>00585 <a class="code" href="../../d7/d4a/cert_8h.html#ab4e546a6e4c4df798e41ee45e27252ea">CERT_FindCertIssuer</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> validTime, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage);
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 <span class="comment">/*</span>
<a name="l00588"></a>00588 <span class="comment">** Check the validity times of a certificate vs. time &#39;t&#39;, allowing</span>
<a name="l00589"></a>00589 <span class="comment">** some slop for broken clocks and stuff.</span>
<a name="l00590"></a>00590 <span class="comment">**  &quot;cert&quot; is the certificate to be checked</span>
<a name="l00591"></a>00591 <span class="comment">**  &quot;t&quot; is the time to check against</span>
<a name="l00592"></a>00592 <span class="comment">**  &quot;allowOverride&quot; if true then check to see if the invalidity has</span>
<a name="l00593"></a>00593 <span class="comment">**      been overridden by the user.</span>
<a name="l00594"></a>00594 <span class="comment">*/</span>
<a name="l00595"></a>00595 <span class="keyword">extern</span> <a class="code" href="../../d6/da5/certt_8h.html#ab1e0b92e1ce9d43ebc39d0d925cb2baf">SECCertTimeValidity</a> <a class="code" href="../../d7/d4a/cert_8h.html#a5e7fccbd4679131acf4faa0404a23bb1">CERT_CheckCertValidTimes</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00596"></a>00596                             <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t,
<a name="l00597"></a>00597                             <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> allowOverride);
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 <span class="comment">/*</span>
<a name="l00600"></a>00600 <span class="comment">** WARNING - this function is deprecated, and will either go away or have</span>
<a name="l00601"></a>00601 <span class="comment">**      a new API in the near future.</span>
<a name="l00602"></a>00602 <span class="comment">**</span>
<a name="l00603"></a>00603 <span class="comment">** Check the validity times of a certificate vs. the current time, allowing</span>
<a name="l00604"></a>00604 <span class="comment">** some slop for broken clocks and stuff.</span>
<a name="l00605"></a>00605 <span class="comment">**  &quot;cert&quot; is the certificate to be checked</span>
<a name="l00606"></a>00606 <span class="comment">*/</span>
<a name="l00607"></a>00607 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a8ed75bfba2b3885c0fd608bd80106666">CERT_CertTimesValid</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="comment">/*</span>
<a name="l00610"></a>00610 <span class="comment">** Extract the validity times from a certificate</span>
<a name="l00611"></a>00611 <span class="comment">**  &quot;c&quot; is the certificate</span>
<a name="l00612"></a>00612 <span class="comment">**  &quot;notBefore&quot; is the start of the validity period</span>
<a name="l00613"></a>00613 <span class="comment">**  &quot;notAfter&quot; is the end of the validity period</span>
<a name="l00614"></a>00614 <span class="comment">*/</span>
<a name="l00615"></a>00615 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00616"></a>00616 <a class="code" href="../../d7/d4a/cert_8h.html#a10cc1bc67f16f6d74ac2b7a7138f8071">CERT_GetCertTimes</a> (<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d2/d7d/jsapi_8h.html#a348d5281ca0f01adebb262bee8baf788">c</a>, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> *notBefore,
<a name="l00617"></a>00617            <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> *notAfter);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 <span class="comment">/*</span>
<a name="l00620"></a>00620 <span class="comment">** Extract the issuer and serial number from a certificate</span>
<a name="l00621"></a>00621 <span class="comment">*/</span>
<a name="l00622"></a>00622 <span class="keyword">extern</span> <a class="code" href="../../db/de1/struct_c_e_r_t_issuer_and_s_n_str.html">CERTIssuerAndSN</a> *<a class="code" href="../../d7/d4a/cert_8h.html#ad2df9444b1a0a9f7ac1a4ebb2328ffdc">CERT_GetCertIssuerAndSN</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *, 
<a name="l00623"></a>00623                             <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *);
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="comment">/*</span>
<a name="l00626"></a>00626 <span class="comment">** verify the signature of a signed data object with a given certificate</span>
<a name="l00627"></a>00627 <span class="comment">**  &quot;sd&quot; the signed data object to be verified</span>
<a name="l00628"></a>00628 <span class="comment">**  &quot;cert&quot; the certificate to use to check the signature</span>
<a name="l00629"></a>00629 <span class="comment">*/</span>
<a name="l00630"></a>00630 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ae3313c33e7221d5fe1c1e3b777de03ba">CERT_VerifySignedData</a>(<a class="code" href="../../da/d7f/struct_c_e_r_t_signed_data_str.html">CERTSignedData</a> *sd,
<a name="l00631"></a>00631                        <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00632"></a>00632                        <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t,
<a name="l00633"></a>00633                        <span class="keywordtype">void</span> *wincx);
<a name="l00634"></a>00634 <span class="comment">/*</span>
<a name="l00635"></a>00635 <span class="comment">** verify the signature of a signed data object with the given DER publickey</span>
<a name="l00636"></a>00636 <span class="comment">*/</span>
<a name="l00637"></a>00637 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00638"></a>00638 <a class="code" href="../../d7/d4a/cert_8h.html#ab5736a9171b9c7d2ee5445d8e26442d6">CERT_VerifySignedDataWithPublicKeyInfo</a>(<a class="code" href="../../da/d7f/struct_c_e_r_t_signed_data_str.html">CERTSignedData</a> *sd,
<a name="l00639"></a>00639                                        <a class="code" href="../../d3/d07/struct_c_e_r_t_subject_public_key_info_str.html">CERTSubjectPublicKeyInfo</a> *pubKeyInfo,
<a name="l00640"></a>00640                                        <span class="keywordtype">void</span> *wincx);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 <span class="comment">/*</span>
<a name="l00643"></a>00643 <span class="comment">** verify the signature of a signed data object with a SECKEYPublicKey.</span>
<a name="l00644"></a>00644 <span class="comment">*/</span>
<a name="l00645"></a>00645 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00646"></a>00646 <a class="code" href="../../d7/d4a/cert_8h.html#a2b0d325d2a80827538082af5886232d6">CERT_VerifySignedDataWithPublicKey</a>(<span class="keyword">const</span> <a class="code" href="../../da/d7f/struct_c_e_r_t_signed_data_str.html">CERTSignedData</a> *sd,
<a name="l00647"></a>00647                                    <a class="code" href="../../d6/d1a/struct_s_e_c_k_e_y_public_key_str.html">SECKEYPublicKey</a> *pubKey, <span class="keywordtype">void</span> *wincx);
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 <span class="comment">/*</span>
<a name="l00650"></a>00650 <span class="comment">** NEW FUNCTIONS with new bit-field-FIELD SECCertificateUsage - please use</span>
<a name="l00651"></a>00651 <span class="comment">** verify a certificate by checking validity times against a certain time,</span>
<a name="l00652"></a>00652 <span class="comment">** that we trust the issuer, and that the signature on the certificate is</span>
<a name="l00653"></a>00653 <span class="comment">** valid.</span>
<a name="l00654"></a>00654 <span class="comment">**  &quot;cert&quot; the certificate to verify</span>
<a name="l00655"></a>00655 <span class="comment">**  &quot;checkSig&quot; only check signatures if true</span>
<a name="l00656"></a>00656 <span class="comment">*/</span>
<a name="l00657"></a>00657 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00658"></a>00658 <a class="code" href="../../d7/d4a/cert_8h.html#a9d5468b53ae35d7af21b133c0f77946b">CERT_VerifyCertificate</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00659"></a>00659         <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> checkSig, <a class="code" href="../../d6/da5/certt_8h.html#aaacbfa750aba50da2e373e1187c79a16">SECCertificateUsage</a> requiredUsages,
<a name="l00660"></a>00660                 <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t, <span class="keywordtype">void</span> *wincx, <a class="code" href="../../dc/d6f/struct_c_e_r_t_verify_log_str.html">CERTVerifyLog</a> *<a class="code" href="../../d8/dfa/init_8js.html#aad81d14d4c8eea114056d7dc1f18f9b7">log</a>,
<a name="l00661"></a>00661                 <a class="code" href="../../d6/da5/certt_8h.html#aaacbfa750aba50da2e373e1187c79a16">SECCertificateUsage</a>* returnedUsages);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 <span class="comment">/* same as above, but uses current time */</span>
<a name="l00664"></a>00664 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00665"></a>00665 <a class="code" href="../../d7/d4a/cert_8h.html#af83806582388cbbd18f4319eb5ac432e">CERT_VerifyCertificateNow</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00666"></a>00666            <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> checkSig, <a class="code" href="../../d6/da5/certt_8h.html#aaacbfa750aba50da2e373e1187c79a16">SECCertificateUsage</a> requiredUsages,
<a name="l00667"></a>00667                    <span class="keywordtype">void</span> *wincx, <a class="code" href="../../d6/da5/certt_8h.html#aaacbfa750aba50da2e373e1187c79a16">SECCertificateUsage</a>* returnedUsages);
<a name="l00668"></a>00668 
<a name="l00669"></a>00669 <span class="comment">/*</span>
<a name="l00670"></a>00670 <span class="comment">** Verify that a CA cert can certify some (unspecified) leaf cert for a given</span>
<a name="l00671"></a>00671 <span class="comment">** purpose. This is used by UI code to help identify where a chain may be</span>
<a name="l00672"></a>00672 <span class="comment">** broken and why. This takes identical parameters to CERT_VerifyCert</span>
<a name="l00673"></a>00673 <span class="comment">*/</span>
<a name="l00674"></a>00674 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00675"></a>00675 <a class="code" href="../../d7/d4a/cert_8h.html#a4c72bc6dd8d5469fbc0a924821425e80">CERT_VerifyCACertForUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00676"></a>00676         <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> checkSig, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> certUsage, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t,
<a name="l00677"></a>00677         <span class="keywordtype">void</span> *wincx, <a class="code" href="../../dc/d6f/struct_c_e_r_t_verify_log_str.html">CERTVerifyLog</a> *<a class="code" href="../../d8/dfa/init_8js.html#aad81d14d4c8eea114056d7dc1f18f9b7">log</a>);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679 <span class="comment">/*</span>
<a name="l00680"></a>00680 <span class="comment">** OLD OBSOLETE FUNCTIONS with enum SECCertUsage - DO NOT USE FOR NEW CODE</span>
<a name="l00681"></a>00681 <span class="comment">** verify a certificate by checking validity times against a certain time,</span>
<a name="l00682"></a>00682 <span class="comment">** that we trust the issuer, and that the signature on the certificate is</span>
<a name="l00683"></a>00683 <span class="comment">** valid.</span>
<a name="l00684"></a>00684 <span class="comment">**  &quot;cert&quot; the certificate to verify</span>
<a name="l00685"></a>00685 <span class="comment">**  &quot;checkSig&quot; only check signatures if true</span>
<a name="l00686"></a>00686 <span class="comment">*/</span>
<a name="l00687"></a>00687 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00688"></a>00688 <a class="code" href="../../d7/d4a/cert_8h.html#a18aef3fa0955097115cacee5101b63cf">CERT_VerifyCert</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00689"></a>00689         <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> checkSig, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> certUsage, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t,
<a name="l00690"></a>00690         <span class="keywordtype">void</span> *wincx, <a class="code" href="../../dc/d6f/struct_c_e_r_t_verify_log_str.html">CERTVerifyLog</a> *<a class="code" href="../../d8/dfa/init_8js.html#aad81d14d4c8eea114056d7dc1f18f9b7">log</a>);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 <span class="comment">/* same as above, but uses current time */</span>
<a name="l00693"></a>00693 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00694"></a>00694 <a class="code" href="../../d7/d4a/cert_8h.html#ac41539caf46723fb6fbe202e2ab50aaf">CERT_VerifyCertNow</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00695"></a>00695            <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> checkSig, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> certUsage, <span class="keywordtype">void</span> *wincx);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00698"></a>00698 <a class="code" href="../../d7/d4a/cert_8h.html#aedce1be8f233a2caa3a4bc57725a67c5">CERT_VerifyCertChain</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00699"></a>00699              <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> checkSig, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> certUsage, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t,
<a name="l00700"></a>00700              <span class="keywordtype">void</span> *wincx, <a class="code" href="../../dc/d6f/struct_c_e_r_t_verify_log_str.html">CERTVerifyLog</a> *<a class="code" href="../../d8/dfa/init_8js.html#aad81d14d4c8eea114056d7dc1f18f9b7">log</a>);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="comment">/*</span>
<a name="l00703"></a>00703 <span class="comment">** Read a base64 ascii encoded DER certificate and convert it to our</span>
<a name="l00704"></a>00704 <span class="comment">** internal format.</span>
<a name="l00705"></a>00705 <span class="comment">**  &quot;certstr&quot; is a null-terminated string containing the certificate</span>
<a name="l00706"></a>00706 <span class="comment">*/</span>
<a name="l00707"></a>00707 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a2f66185a916a6052e26933da4cc7fd04">CERT_ConvertAndDecodeCertificate</a>(<span class="keywordtype">char</span> *certstr);
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 <span class="comment">/*</span>
<a name="l00710"></a>00710 <span class="comment">** Read a certificate in some foreign format, and convert it to our</span>
<a name="l00711"></a>00711 <span class="comment">** internal format.</span>
<a name="l00712"></a>00712 <span class="comment">**  &quot;certbuf&quot; is the buffer containing the certificate</span>
<a name="l00713"></a>00713 <span class="comment">**  &quot;certlen&quot; is the length of the buffer</span>
<a name="l00714"></a>00714 <span class="comment">** NOTE - currently supports netscape base64 ascii encoded raw certs</span>
<a name="l00715"></a>00715 <span class="comment">**  and netscape binary DER typed files.</span>
<a name="l00716"></a>00716 <span class="comment">*/</span>
<a name="l00717"></a>00717 <span class="keyword">extern</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d7/d4a/cert_8h.html#ab2cadf7dcfe83585e7ce3de2abafbbd5">CERT_DecodeCertFromPackage</a>(<span class="keywordtype">char</span> *certbuf, <span class="keywordtype">int</span> certlen);
<a name="l00718"></a>00718 
<a name="l00719"></a>00719 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00720"></a>00720 <a class="code" href="../../d7/d4a/cert_8h.html#a3b7609b5a4c38d31af3c8047c90325ba">CERT_ImportCAChain</a> (<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/d4a/cert_8h.html#aa1a020a61e6e49bbbd55a574a9b38921">numcerts</a>, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> certUsage);
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00723"></a>00723 <a class="code" href="../../d7/d4a/cert_8h.html#aa39ab580bb9e6045a02d7eae22fbfc55">CERT_ImportCAChainTrusted</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/d4a/cert_8h.html#aa1a020a61e6e49bbbd55a574a9b38921">numcerts</a>, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> certUsage);
<a name="l00724"></a>00724 
<a name="l00725"></a>00725 <span class="comment">/*</span>
<a name="l00726"></a>00726 <span class="comment">** Read a certificate chain in some foreign format, and pass it to a </span>
<a name="l00727"></a>00727 <span class="comment">** callback function.</span>
<a name="l00728"></a>00728 <span class="comment">**  &quot;certbuf&quot; is the buffer containing the certificate</span>
<a name="l00729"></a>00729 <span class="comment">**  &quot;certlen&quot; is the length of the buffer</span>
<a name="l00730"></a>00730 <span class="comment">**  &quot;f&quot; is the callback function</span>
<a name="l00731"></a>00731 <span class="comment">**  &quot;arg&quot; is the callback argument</span>
<a name="l00732"></a>00732 <span class="comment">*/</span>
<a name="l00733"></a>00733 <span class="keyword">typedef</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> (<a class="code" href="../../dc/d23/prtypes_8h.html#a77fca05eea6fd4357f2083ff290a578a">PR_CALLBACK</a> *CERTImportCertificateFunc)
<a name="l00734"></a><a class="code" href="../../d7/d4a/cert_8h.html#aa1a020a61e6e49bbbd55a574a9b38921">00734</a>    (<span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **<a class="code" href="../../d7/d4a/cert_8h.html#aa1b730d991c5b345807a7eaeca526756">certs</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/d4a/cert_8h.html#aa1a020a61e6e49bbbd55a574a9b38921">numcerts</a>);
<a name="l00735"></a>00735 
<a name="l00736"></a>00736 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00737"></a>00737 <a class="code" href="../../d7/d4a/cert_8h.html#ae0a19366f0a51a504b2b8453d6fe387d">CERT_DecodeCertPackage</a>(<span class="keywordtype">char</span> *certbuf, <span class="keywordtype">int</span> certlen, CERTImportCertificateFunc <a class="code" href="../../d3/d4b/lockscreen_8js.html#a9cf09a2972472098a4c689fd988f4dfc">f</a>,
<a name="l00738"></a>00738                <span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>);
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 <span class="comment">/* </span>
<a name="l00741"></a>00741 <span class="comment">** Returns the value of an AVA.  This was a formerly static </span>
<a name="l00742"></a>00742 <span class="comment">** function that has been exposed due to the need to decode</span>
<a name="l00743"></a>00743 <span class="comment">** and convert unicode strings to UTF8.  </span>
<a name="l00744"></a>00744 <span class="comment">**</span>
<a name="l00745"></a>00745 <span class="comment">** XXX This function resides in certhtml.c, should it be</span>
<a name="l00746"></a>00746 <span class="comment">** moved elsewhere?</span>
<a name="l00747"></a>00747 <span class="comment">*/</span>
<a name="l00748"></a>00748 <span class="keyword">extern</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d7/d4a/cert_8h.html#acded006666e2261d60f315718edb66df">CERT_DecodeAVAValue</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derAVAValue);
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="comment">/*</span>
<a name="l00753"></a>00753 <span class="comment">** extract various element strings from a distinguished name.</span>
<a name="l00754"></a>00754 <span class="comment">**  &quot;name&quot; the distinguished name</span>
<a name="l00755"></a>00755 <span class="comment">*/</span>
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a05c00f1bf6bec29604b497ddcc0730e4">CERT_GetCertificateEmailAddress</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#af465e3ce67acf308cff8ea6a8ff0dbeb">CERT_GetCertEmailAddress</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="../../d7/d4a/cert_8h.html#a153675a5bd49e7c180c022890e5176a2">CERT_GetFirstEmailAddress</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> * <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="../../d7/d4a/cert_8h.html#aa36c22ed361e4522add1d7d13d4245a3">CERT_GetNextEmailAddress</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> * <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, 
<a name="l00764"></a>00764                                              <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="../../d4/d00/tools_2xpcwindow_2lib_2modules_2debug_8js.html#aa8ce26f0d9a701e8f80cbff3ed272d85">prev</a>);
<a name="l00765"></a>00765 
<a name="l00766"></a>00766 <span class="comment">/* The return value must be freed with PORT_Free. */</span>
<a name="l00767"></a>00767 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#ac5c7d3d6bfca63e8b0d8af16fe2335ce">CERT_GetCommonName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00768"></a>00768 
<a name="l00769"></a>00769 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#aeb45cebd407b615d44a1eaae140e5934">CERT_GetCountryName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#ab29630cc336432869d682f183046074c">CERT_GetLocalityName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a2684f889371db9935fb4da99acbd865e">CERT_GetStateName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00774"></a>00774 
<a name="l00775"></a>00775 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a87ea3ea5254f391b3a2a73684ddbb96c">CERT_GetOrgName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a7441821ca51db75b4425bae78f17714b">CERT_GetOrgUnitName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00778"></a>00778 
<a name="l00779"></a>00779 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a44c038b9398a3b05ba7efd7e62e03c9f">CERT_GetDomainComponentName</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00780"></a>00780 
<a name="l00781"></a>00781 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#ab57cdd9c5a378d3a18e8880f6061d660">CERT_GetCertUid</a>(<span class="keyword">const</span> <a class="code" href="../../dd/d11/struct_c_e_r_t_name_str.html">CERTName</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783 <span class="comment">/* manipulate the trust parameters of a certificate */</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a4c77e9ca4c0421a6c6bc6549d45d5bc7">CERT_GetCertTrust</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00786"></a>00786                                    <a class="code" href="../../d5/d52/struct_c_e_r_t_cert_trust_str.html">CERTCertTrust</a> *trust);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00789"></a>00789 <a class="code" href="../../d7/d4a/cert_8h.html#a5576f742d6434ea740df4cbbd95824e5">CERT_ChangeCertTrust</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00790"></a>00790               <a class="code" href="../../d5/d52/struct_c_e_r_t_cert_trust_str.html">CERTCertTrust</a> *trust);
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00793"></a>00793 <a class="code" href="../../d7/d4a/cert_8h.html#ae994ab52a03e37a2c7f9f3e02676e0ba">CERT_ChangeCertTrustByUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *certdb, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l00794"></a>00794                 <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage);
<a name="l00795"></a>00795 
<a name="l00796"></a>00796 <span class="comment">/*************************************************************************</span>
<a name="l00797"></a>00797 <span class="comment"> *</span>
<a name="l00798"></a>00798 <span class="comment"> * manipulate the extensions of a certificate</span>
<a name="l00799"></a>00799 <span class="comment"> *</span>
<a name="l00800"></a>00800 <span class="comment"> ************************************************************************/</span>
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 <span class="comment">/*</span>
<a name="l00803"></a>00803 <span class="comment">** Set up a cert for adding X509v3 extensions.  Returns an opaque handle</span>
<a name="l00804"></a>00804 <span class="comment">** used by the next two routines.</span>
<a name="l00805"></a>00805 <span class="comment">**  &quot;cert&quot; is the certificate we are adding extensions to</span>
<a name="l00806"></a>00806 <span class="comment">*/</span>
<a name="l00807"></a>00807 <span class="keyword">extern</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a99580b443ccc196c50c6bbb71958b80a">CERT_StartCertExtensions</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">/*</span>
<a name="l00810"></a>00810 <span class="comment">** Add an extension to a certificate.</span>
<a name="l00811"></a>00811 <span class="comment">**  &quot;exthandle&quot; is the handle returned by the previous function</span>
<a name="l00812"></a>00812 <span class="comment">**  &quot;idtag&quot; is the integer tag for the OID that should ID this extension</span>
<a name="l00813"></a>00813 <span class="comment">**  &quot;value&quot; is the value of the extension</span>
<a name="l00814"></a>00814 <span class="comment">**  &quot;critical&quot; is the critical extension flag</span>
<a name="l00815"></a>00815 <span class="comment">**  &quot;copyData&quot; is a flag indicating whether the value data should be</span>
<a name="l00816"></a>00816 <span class="comment">**      copied.</span>
<a name="l00817"></a>00817 <span class="comment">*/</span>
<a name="l00818"></a>00818 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#aa3551e81101d09672530dd21ba5c517b">CERT_AddExtension</a> (<span class="keywordtype">void</span> *exthandle, <span class="keywordtype">int</span> idtag, 
<a name="l00819"></a>00819             <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> critical, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> copyData);
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a7df3009752fab43a97830016734f9927">CERT_AddExtensionByOID</a> (<span class="keywordtype">void</span> *exthandle, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *oid,
<a name="l00822"></a>00822              <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> critical, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> copyData);
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ab38137da868aca7475fa4028d0516e6b">CERT_EncodeAndAddExtension</a>
<a name="l00825"></a>00825    (<span class="keywordtype">void</span> *exthandle, <span class="keywordtype">int</span> idtag, <span class="keywordtype">void</span> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> critical,
<a name="l00826"></a>00826     <span class="keyword">const</span> <a class="code" href="../../dc/ddf/structsec___a_s_n1_template__struct.html">SEC_ASN1Template</a> *atemplate);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a373d565f56d8d3ce442c31a4c1ab5ff6">CERT_EncodeAndAddBitStrExtension</a>
<a name="l00829"></a>00829    (<span class="keywordtype">void</span> *exthandle, <span class="keywordtype">int</span> idtag, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> critical);
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 
<a name="l00832"></a>00832 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00833"></a>00833 <a class="code" href="../../d7/d4a/cert_8h.html#aa2d2849b2445867f059a2f5be81d9459">CERT_EncodeAltNameExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,  <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a>  *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l00834"></a>00834 
<a name="l00835"></a>00835 
<a name="l00836"></a>00836 <span class="comment">/*</span>
<a name="l00837"></a>00837 <span class="comment">** Finish adding cert extensions.  Does final processing on extension</span>
<a name="l00838"></a>00838 <span class="comment">** data, putting it in the right format, and freeing any temporary</span>
<a name="l00839"></a>00839 <span class="comment">** storage.</span>
<a name="l00840"></a>00840 <span class="comment">**  &quot;exthandle&quot; is the handle used to add extensions to a certificate</span>
<a name="l00841"></a>00841 <span class="comment">*/</span>
<a name="l00842"></a>00842 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a1701100ba6cfce9d86d4378f191b1aee">CERT_FinishExtensions</a>(<span class="keywordtype">void</span> *exthandle);
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 <span class="comment">/*</span>
<a name="l00845"></a>00845 <span class="comment">** Merge an external list of extensions into a cert&#39;s extension list, adding one</span>
<a name="l00846"></a>00846 <span class="comment">** only when its OID matches none of the cert&#39;s existing extensions. Call this</span>
<a name="l00847"></a>00847 <span class="comment">** immediately before calling CERT_FinishExtensions().</span>
<a name="l00848"></a>00848 <span class="comment">*/</span>
<a name="l00849"></a>00849 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l00850"></a>00850 <a class="code" href="../../d7/d4a/cert_8h.html#a274238f59c21fcca789039e76cf42e5f">CERT_MergeExtensions</a>(<span class="keywordtype">void</span> *exthandle, <a class="code" href="../../dd/d02/struct_c_e_r_t_cert_extension_str.html">CERTCertExtension</a> **exts);
<a name="l00851"></a>00851 
<a name="l00852"></a>00852 <span class="comment">/* If the extension is found, return its criticality and value.</span>
<a name="l00853"></a>00853 <span class="comment">** This allocate storage for the returning extension value.</span>
<a name="l00854"></a>00854 <span class="comment">*/</span>
<a name="l00855"></a>00855 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ab9393af4a2641c0ec7bde99f0764f6c0">CERT_GetExtenCriticality</a>
<a name="l00856"></a>00856    (<a class="code" href="../../dd/d02/struct_c_e_r_t_cert_extension_str.html">CERTCertExtension</a> **extensions, <span class="keywordtype">int</span> tag, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> *isCritical);
<a name="l00857"></a>00857 
<a name="l00858"></a>00858 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00859"></a>00859 <a class="code" href="../../d7/d4a/cert_8h.html#ad8bcd97230b7c909652abf303d34ee25">CERT_DestroyOidSequence</a>(<a class="code" href="../../dc/dbc/struct_c_e_r_t_oid_sequence.html">CERTOidSequence</a> *oidSeq);
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 <span class="comment">/****************************************************************************</span>
<a name="l00862"></a>00862 <span class="comment"> *</span>
<a name="l00863"></a>00863 <span class="comment"> * DER encode and decode extension values</span>
<a name="l00864"></a>00864 <span class="comment"> *</span>
<a name="l00865"></a>00865 <span class="comment"> ****************************************************************************/</span>
<a name="l00866"></a>00866 
<a name="l00867"></a>00867 <span class="comment">/* Encode the value of the basicConstraint extension.</span>
<a name="l00868"></a>00868 <span class="comment">**  arena - where to allocate memory for the encoded value.</span>
<a name="l00869"></a>00869 <span class="comment">**  value - extension value to encode</span>
<a name="l00870"></a>00870 <span class="comment">**  encodedValue - output encoded value</span>
<a name="l00871"></a>00871 <span class="comment">*/</span>
<a name="l00872"></a>00872 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ae4031274ac4734b39e1aff6c5f0348a5">CERT_EncodeBasicConstraintValue</a>
<a name="l00873"></a>00873    (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../da/d2b/struct_c_e_r_t_basic_constraints_str.html">CERTBasicConstraints</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l00874"></a>00874 
<a name="l00875"></a>00875 <span class="comment">/*</span>
<a name="l00876"></a>00876 <span class="comment">** Encode the value of the authorityKeyIdentifier extension.</span>
<a name="l00877"></a>00877 <span class="comment">*/</span>
<a name="l00878"></a>00878 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a2246148ef2016948a28ab37498ced56e">CERT_EncodeAuthKeyID</a>
<a name="l00879"></a>00879    (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d2/da9/struct_c_e_r_t_auth_key_i_d_str.html">CERTAuthKeyID</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l00880"></a>00880 
<a name="l00881"></a>00881 <span class="comment">/*</span>
<a name="l00882"></a>00882 <span class="comment">** Encode the value of the crlDistributionPoints extension.</span>
<a name="l00883"></a>00883 <span class="comment">*/</span>
<a name="l00884"></a>00884 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ae75f0c34ebf3737921f0f609eb9fe4d0">CERT_EncodeCRLDistributionPoints</a>
<a name="l00885"></a>00885    (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../da/d2f/struct_c_e_r_t_crl_distribution_points_str.html">CERTCrlDistributionPoints</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>,<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derValue);
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 <span class="comment">/*</span>
<a name="l00888"></a>00888 <span class="comment">** Decodes a DER encoded basicConstaint extension value into a readable format</span>
<a name="l00889"></a>00889 <span class="comment">**  value - decoded value</span>
<a name="l00890"></a>00890 <span class="comment">**  encodedValue - value to decoded</span>
<a name="l00891"></a>00891 <span class="comment">*/</span>
<a name="l00892"></a>00892 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a3d6aed8c1c5c0c92dc929efc733c4f88">CERT_DecodeBasicConstraintValue</a>
<a name="l00893"></a>00893    (<a class="code" href="../../da/d2b/struct_c_e_r_t_basic_constraints_str.html">CERTBasicConstraints</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 <span class="comment">/* Decodes a DER encoded authorityKeyIdentifier extension value into a</span>
<a name="l00896"></a>00896 <span class="comment">** readable format.</span>
<a name="l00897"></a>00897 <span class="comment">**  arena - where to allocate memory for the decoded value</span>
<a name="l00898"></a>00898 <span class="comment">**  encodedValue - value to be decoded</span>
<a name="l00899"></a>00899 <span class="comment">**  Returns a CERTAuthKeyID structure which contains the decoded value</span>
<a name="l00900"></a>00900 <span class="comment">*/</span>
<a name="l00901"></a>00901 <span class="keyword">extern</span> <a class="code" href="../../d2/da9/struct_c_e_r_t_auth_key_i_d_str.html">CERTAuthKeyID</a> *<a class="code" href="../../d7/d4a/cert_8h.html#ab9e249285dd6bd5b4ad0319e209efb05">CERT_DecodeAuthKeyID</a> 
<a name="l00902"></a>00902             (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="comment">/* Decodes a DER encoded crlDistributionPoints extension value into a </span>
<a name="l00905"></a>00905 <span class="comment">** readable format.</span>
<a name="l00906"></a>00906 <span class="comment">**  arena - where to allocate memory for the decoded value</span>
<a name="l00907"></a>00907 <span class="comment">**  der - value to be decoded</span>
<a name="l00908"></a>00908 <span class="comment">**  Returns a CERTCrlDistributionPoints structure which contains the </span>
<a name="l00909"></a>00909 <span class="comment">**          decoded value</span>
<a name="l00910"></a>00910 <span class="comment">*/</span>
<a name="l00911"></a>00911 <span class="keyword">extern</span> <a class="code" href="../../da/d2f/struct_c_e_r_t_crl_distribution_points_str.html">CERTCrlDistributionPoints</a> * <a class="code" href="../../d7/d4a/cert_8h.html#aba828200ad1d5af7923495fef97753e4">CERT_DecodeCRLDistributionPoints</a>
<a name="l00912"></a>00912    (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *der);
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <span class="comment">/* Extract certain name type from a generalName */</span>
<a name="l00915"></a>00915 <span class="keyword">extern</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a99451e61750c7b8f0579b8f3165e60d9">CERT_GetGeneralNameByType</a>
<a name="l00916"></a>00916    (<a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *genNames, <a class="code" href="../../d6/da5/certt_8h.html#a826bef441efb1f291d7f6d6e9f04a54f">CERTGeneralNameType</a> <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> derFormat);
<a name="l00917"></a>00917 
<a name="l00918"></a>00918 
<a name="l00919"></a>00919 <span class="keyword">extern</span> <a class="code" href="../../dc/dbc/struct_c_e_r_t_oid_sequence.html">CERTOidSequence</a> *
<a name="l00920"></a>00920 <a class="code" href="../../d7/d4a/cert_8h.html#ac1bf094931eaf6934135d54661b06731">CERT_DecodeOidSequence</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *seqItem);
<a name="l00921"></a>00921 
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 
<a name="l00924"></a>00924 
<a name="l00925"></a>00925 <span class="comment">/****************************************************************************</span>
<a name="l00926"></a>00926 <span class="comment"> *</span>
<a name="l00927"></a>00927 <span class="comment"> * Find extension values of a certificate </span>
<a name="l00928"></a>00928 <span class="comment"> *</span>
<a name="l00929"></a>00929 <span class="comment"> ***************************************************************************/</span>
<a name="l00930"></a>00930 
<a name="l00931"></a>00931 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ac0bd2a00db5a35cbd5b82044a1e936c7">CERT_FindCertExtension</a>
<a name="l00932"></a>00932    (<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">int</span> tag, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00933"></a>00933 
<a name="l00934"></a>00934 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a2d329c7c2445f26a85af7e0a8cfee221">CERT_FindNSCertTypeExtension</a>
<a name="l00935"></a>00935    (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00936"></a>00936 
<a name="l00937"></a>00937 <span class="keyword">extern</span> <span class="keywordtype">char</span> * <a class="code" href="../../d7/d4a/cert_8h.html#a4ac158e6c1d93335ee1535d2a76b76a8">CERT_FindNSStringExtension</a> (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">int</span> oidtag);
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a54693dd58ae1933edd49e738f041fbf2">CERT_FindIssuerCertExtension</a>
<a name="l00940"></a>00940    (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">int</span> tag, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ab5c7fd13d594b8761740ec982f34c3e9">CERT_FindCertExtensionByOID</a>
<a name="l00943"></a>00943    (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *oid, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00944"></a>00944 
<a name="l00945"></a>00945 <span class="keyword">extern</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#af6adc5a082750572522fd13e31a6c2d6">CERT_FindCertURLExtension</a> (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">int</span> tag, 
<a name="l00946"></a>00946                                 <span class="keywordtype">int</span> catag);
<a name="l00947"></a>00947 
<a name="l00948"></a>00948 <span class="comment">/* Returns the decoded value of the authKeyID extension.</span>
<a name="l00949"></a>00949 <span class="comment">**   Note that this uses passed in the arena to allocate storage for the result</span>
<a name="l00950"></a>00950 <span class="comment">*/</span>
<a name="l00951"></a>00951 <span class="keyword">extern</span> <a class="code" href="../../d2/da9/struct_c_e_r_t_auth_key_i_d_str.html">CERTAuthKeyID</a> * <a class="code" href="../../d7/d4a/cert_8h.html#a74194856721b56b28814836d18525cd2">CERT_FindAuthKeyIDExten</a> (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00952"></a>00952 
<a name="l00953"></a>00953 <span class="comment">/* Returns the decoded value of the basicConstraint extension.</span>
<a name="l00954"></a>00954 <span class="comment"> */</span>
<a name="l00955"></a>00955 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a60b75e19f5ecaed9e18bc6e74206f8d4">CERT_FindBasicConstraintExten</a>
<a name="l00956"></a>00956    (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../da/d2b/struct_c_e_r_t_basic_constraints_str.html">CERTBasicConstraints</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00957"></a>00957 
<a name="l00958"></a>00958 <span class="comment">/* Returns the decoded value of the crlDistributionPoints extension.</span>
<a name="l00959"></a>00959 <span class="comment">**  Note that the arena in cert is used to allocate storage for the result</span>
<a name="l00960"></a>00960 <span class="comment">*/</span>
<a name="l00961"></a>00961 <span class="keyword">extern</span> <a class="code" href="../../da/d2f/struct_c_e_r_t_crl_distribution_points_str.html">CERTCrlDistributionPoints</a> * <a class="code" href="../../d7/d4a/cert_8h.html#a6764864b9a88b663cfb12d6b96560b1e">CERT_FindCRLDistributionPoints</a>
<a name="l00962"></a>00962    (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 <span class="comment">/* Returns value of the keyUsage extension.  This uses PR_Alloc to allocate </span>
<a name="l00965"></a>00965 <span class="comment">** buffer for the decoded value. The caller should free up the storage </span>
<a name="l00966"></a>00966 <span class="comment">** allocated in value-&gt;data.</span>
<a name="l00967"></a>00967 <span class="comment">*/</span>
<a name="l00968"></a>00968 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a3919ffc9f6f261858e7cc64eb7bd9d4a">CERT_FindKeyUsageExtension</a> (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, 
<a name="l00969"></a>00969                             <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00970"></a>00970 
<a name="l00971"></a>00971 <span class="comment">/* Return the decoded value of the subjectKeyID extension. The caller should </span>
<a name="l00972"></a>00972 <span class="comment">** free up the storage allocated in retItem-&gt;data.</span>
<a name="l00973"></a>00973 <span class="comment">*/</span>
<a name="l00974"></a>00974 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a2a10c36acb53a125c30b2dacd61e3982">CERT_FindSubjectKeyIDExtension</a> (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, 
<a name="l00975"></a>00975                                <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *retItem);
<a name="l00976"></a>00976 
<a name="l00977"></a>00977 <span class="comment">/*</span>
<a name="l00978"></a>00978 <span class="comment">** If cert is a v3 certificate, and a critical keyUsage extension is included,</span>
<a name="l00979"></a>00979 <span class="comment">** then check the usage against the extension value.  If a non-critical </span>
<a name="l00980"></a>00980 <span class="comment">** keyUsage extension is included, this will return SECSuccess without </span>
<a name="l00981"></a>00981 <span class="comment">** checking, since the extension is an advisory field, not a restriction.  </span>
<a name="l00982"></a>00982 <span class="comment">** If cert is not a v3 certificate, this will return SECSuccess.</span>
<a name="l00983"></a>00983 <span class="comment">**  cert - certificate</span>
<a name="l00984"></a>00984 <span class="comment">**  usage - one of the x.509 v3 the Key Usage Extension flags</span>
<a name="l00985"></a>00985 <span class="comment">*/</span>
<a name="l00986"></a>00986 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a1ccb21b2ae68b5b14b90daa61f022d7f">CERT_CheckCertUsage</a> (<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, 
<a name="l00987"></a>00987                             <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> usage);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="comment">/****************************************************************************</span>
<a name="l00990"></a>00990 <span class="comment"> *</span>
<a name="l00991"></a>00991 <span class="comment"> *  CRL v2 Extensions supported routines</span>
<a name="l00992"></a>00992 <span class="comment"> *</span>
<a name="l00993"></a>00993 <span class="comment"> ****************************************************************************/</span>
<a name="l00994"></a>00994 
<a name="l00995"></a>00995 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ad4403cb8c9e4765f4019e0b0731a08d3">CERT_FindCRLExtensionByOID</a>
<a name="l00996"></a>00996    (<a class="code" href="../../d6/d9f/struct_c_e_r_t_crl_str.html">CERTCrl</a> *crl, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *oid, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a5158899c433749f6a8fe5ccf19c5702d">CERT_FindCRLExtension</a>
<a name="l00999"></a>00999    (<a class="code" href="../../d6/d9f/struct_c_e_r_t_crl_str.html">CERTCrl</a> *crl, <span class="keywordtype">int</span> tag, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l01000"></a>01000 
<a name="l01001"></a>01001 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01002"></a>01002    <a class="code" href="../../d7/d4a/cert_8h.html#a71dadc12aca97912703017fc79b75938">CERT_FindInvalidDateExten</a> (<a class="code" href="../../d6/d9f/struct_c_e_r_t_crl_str.html">CERTCrl</a> *crl, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l01003"></a>01003 
<a name="l01004"></a>01004 <span class="comment">/*</span>
<a name="l01005"></a>01005 <span class="comment">** Set up a crl for adding X509v3 extensions.  Returns an opaque handle</span>
<a name="l01006"></a>01006 <span class="comment">** used by routines that take an exthandle (void*) argument .</span>
<a name="l01007"></a>01007 <span class="comment">**  &quot;crl&quot; is the CRL we are adding extensions to</span>
<a name="l01008"></a>01008 <span class="comment">*/</span>
<a name="l01009"></a>01009 <span class="keyword">extern</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a2135026f701a6e13635b093f41347a3c">CERT_StartCRLExtensions</a>(<a class="code" href="../../d6/d9f/struct_c_e_r_t_crl_str.html">CERTCrl</a> *crl);
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 <span class="comment">/*</span>
<a name="l01012"></a>01012 <span class="comment">** Set up a crl entry for adding X509v3 extensions.  Returns an opaque handle</span>
<a name="l01013"></a>01013 <span class="comment">** used by routines that take an exthandle (void*) argument .</span>
<a name="l01014"></a>01014 <span class="comment">**  &quot;crl&quot; is the crl we are adding certs entries to</span>
<a name="l01015"></a>01015 <span class="comment">**      &quot;entry&quot; is the crl entry we are adding extensions to</span>
<a name="l01016"></a>01016 <span class="comment">*/</span>
<a name="l01017"></a>01017 <span class="keyword">extern</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a0c987d7a5df65177c6c4daf3789fc0d3">CERT_StartCRLEntryExtensions</a>(<a class="code" href="../../d6/d9f/struct_c_e_r_t_crl_str.html">CERTCrl</a> *crl, <a class="code" href="../../db/d9e/struct_c_e_r_t_crl_entry_str.html">CERTCrlEntry</a> *entry);
<a name="l01018"></a>01018 
<a name="l01019"></a>01019 <span class="keyword">extern</span> <a class="code" href="../../df/dec/struct_c_e_r_t_cert_nicknames_str.html">CERTCertNicknames</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a963f6298434a8337fc0b680e1aecd720">CERT_GetCertNicknames</a> (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l01020"></a>01020                          <span class="keywordtype">int</span> what, <span class="keywordtype">void</span> *wincx);
<a name="l01021"></a>01021 
<a name="l01022"></a>01022 <span class="comment">/*</span>
<a name="l01023"></a>01023 <span class="comment">** Finds the crlNumber extension and decodes its value into &#39;value&#39;</span>
<a name="l01024"></a>01024 <span class="comment">*/</span>
<a name="l01025"></a>01025 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#aa90985491b351ca92ef54463ce1d1dff">CERT_FindCRLNumberExten</a> (<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d6/d9f/struct_c_e_r_t_crl_str.html">CERTCrl</a> *crl,
<a name="l01026"></a>01026                                           <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l01027"></a>01027 
<a name="l01028"></a>01028 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a4f9a52e2341902d59ab4be9b6bf1f08e">CERT_FindCRLEntryReasonExten</a> (<a class="code" href="../../db/d9e/struct_c_e_r_t_crl_entry_str.html">CERTCrlEntry</a> *crlEntry,
<a name="l01029"></a>01029                            <a class="code" href="../../d6/da5/certt_8h.html#a336ef0d66b9a10c37862fdb086991deb">CERTCRLEntryReasonCode</a> *<a class="code" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a597f1ce80d2b2fd1f20e8383d449a842">CERT_FreeNicknames</a>(<a class="code" href="../../df/dec/struct_c_e_r_t_cert_nicknames_str.html">CERTCertNicknames</a> *nicknames);
<a name="l01032"></a>01032 
<a name="l01033"></a>01033 <span class="keyword">extern</span> <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> <a class="code" href="../../d7/d4a/cert_8h.html#a5fd187d8d4ef05f72eb47f79a8878c0a">CERT_CompareCerts</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *c1,
<a name="l01034"></a>01034                                 <span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *c2);
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 <span class="keyword">extern</span> <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> <a class="code" href="../../d7/d4a/cert_8h.html#a300bccbb6cb7be9b64c7c43a16794998">CERT_CompareCertsForRedirection</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *c1,
<a name="l01037"></a>01037                              <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *c2);
<a name="l01038"></a>01038 
<a name="l01039"></a>01039 <span class="comment">/*</span>
<a name="l01040"></a>01040 <span class="comment">** Generate an array of the Distinguished Names that the given cert database</span>
<a name="l01041"></a>01041 <span class="comment">** &quot;trusts&quot;</span>
<a name="l01042"></a>01042 <span class="comment">*/</span>
<a name="l01043"></a>01043 <span class="keyword">extern</span> <a class="code" href="../../d8/d91/struct_c_e_r_t_dist_names_str.html">CERTDistNames</a> *<a class="code" href="../../d7/d4a/cert_8h.html#aef279e3305017c2497a665ecfc603a16">CERT_GetSSLCACerts</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l01044"></a>01044 
<a name="l01045"></a>01045 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a31bbdf39c8b7643336a152d578d65f41">CERT_FreeDistNames</a>(<a class="code" href="../../d8/d91/struct_c_e_r_t_dist_names_str.html">CERTDistNames</a> *<a class="code" href="../../d4/d00/tools_2xpcwindow_2lib_2modules_2debug_8js.html#ae76808cc87130a0f45031b8fdc26ea2b">names</a>);
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 <span class="comment">/* Duplicate distinguished name array */</span>
<a name="l01048"></a>01048 <span class="keyword">extern</span> <a class="code" href="../../d8/d91/struct_c_e_r_t_dist_names_str.html">CERTDistNames</a> *<a class="code" href="../../d7/d4a/cert_8h.html#ab3b212d2e83b3d2f28a1f42779727705">CERT_DupDistNames</a>(<a class="code" href="../../d8/d91/struct_c_e_r_t_dist_names_str.html">CERTDistNames</a> *orig);
<a name="l01049"></a>01049 
<a name="l01050"></a>01050 <span class="comment">/*</span>
<a name="l01051"></a>01051 <span class="comment">** Generate an array of Distinguished names from an array of nicknames</span>
<a name="l01052"></a>01052 <span class="comment">*/</span>
<a name="l01053"></a>01053 <span class="keyword">extern</span> <a class="code" href="../../d8/d91/struct_c_e_r_t_dist_names_str.html">CERTDistNames</a> *<a class="code" href="../../d7/d4a/cert_8h.html#aa7b43415cfc8b0cdfe7ddb58e2dc06bc">CERT_DistNamesFromNicknames</a>
<a name="l01054"></a>01054    (<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <span class="keywordtype">char</span> **nicknames, <span class="keywordtype">int</span> nnames);
<a name="l01055"></a>01055 
<a name="l01056"></a>01056 <span class="comment">/*</span>
<a name="l01057"></a>01057 <span class="comment">** Generate an array of Distinguished names from a list of certs.</span>
<a name="l01058"></a>01058 <span class="comment">*/</span>
<a name="l01059"></a>01059 <span class="keyword">extern</span> <a class="code" href="../../d8/d91/struct_c_e_r_t_dist_names_str.html">CERTDistNames</a> *<a class="code" href="../../d7/d4a/cert_8h.html#a6628c92307a76437bd110d12735a5a21">CERT_DistNamesFromCertList</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>);
<a name="l01060"></a>01060 
<a name="l01061"></a>01061 <span class="comment">/*</span>
<a name="l01062"></a>01062 <span class="comment">** Generate a certificate chain from a certificate.</span>
<a name="l01063"></a>01063 <span class="comment">*/</span>
<a name="l01064"></a>01064 <span class="keyword">extern</span> <a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> *
<a name="l01065"></a>01065 <a class="code" href="../../d7/d4a/cert_8h.html#a1fe31c3e1e9b06acd8402b3ced6e523c">CERT_CertChainFromCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01066"></a>01066                <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> includeRoot);
<a name="l01067"></a>01067 
<a name="l01068"></a>01068 <span class="keyword">extern</span> <a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> *
<a name="l01069"></a>01069 <a class="code" href="../../d7/d4a/cert_8h.html#a88be9f6546523bba8e9c52d55073e732">CERT_CertListFromCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01070"></a>01070 
<a name="l01071"></a>01071 <span class="keyword">extern</span> <a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> *
<a name="l01072"></a>01072 <a class="code" href="../../d7/d4a/cert_8h.html#a6098d3a292270f8a4bdd7e9e5b9427a5">CERT_DupCertList</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> * oldList);
<a name="l01073"></a>01073 
<a name="l01074"></a>01074 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/d4a/cert_8h.html#a273621b0345860ce66b31c2b3bb24263">CERT_DestroyCertificateList</a>(<a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> *<a class="code" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>);
<a name="l01075"></a>01075 
<a name="l01076"></a>01076 <span class="comment">/*</span>
<a name="l01077"></a>01077 <span class="comment">** is cert a user cert? i.e. does it have CERTDB_USER trust,</span>
<a name="l01078"></a>01078 <span class="comment">** i.e. a private key?</span>
<a name="l01079"></a>01079 <span class="comment">*/</span>
<a name="l01080"></a>01080 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> <a class="code" href="../../d7/d4a/cert_8h.html#a0293e21c191c4e94541e7856dae18bbc">CERT_IsUserCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a>* <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01081"></a>01081 
<a name="l01082"></a>01082 <span class="comment">/* is cert a newer than cert b? */</span>
<a name="l01083"></a>01083 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> <a class="code" href="../../d7/d4a/cert_8h.html#add561bfaa11eab47d1338f1dffb4af24">CERT_IsNewer</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *certa, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *certb);
<a name="l01084"></a>01084 
<a name="l01085"></a>01085 <span class="comment">/* currently a stub for address book */</span>
<a name="l01086"></a>01086 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>
<a name="l01087"></a>01087 <a class="code" href="../../d7/d4a/cert_8h.html#ab88de2a44b429e5a1c7e45df22f454ea">CERT_IsCertRevoked</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01088"></a>01088 
<a name="l01089"></a>01089 <span class="keywordtype">void</span>
<a name="l01090"></a>01090 <a class="code" href="../../d7/d4a/cert_8h.html#a50143e54fd32499a3dd9a06009aaf728">CERT_DestroyCertArray</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> **<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ncerts);
<a name="l01091"></a>01091 
<a name="l01092"></a>01092 <span class="comment">/* convert an email address to lower case */</span>
<a name="l01093"></a>01093 <span class="keywordtype">char</span> *<a class="code" href="../../d7/d4a/cert_8h.html#a69613e9ac79d2e317efc87a4eafd7014">CERT_FixupEmailAddr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *emailAddr);
<a name="l01094"></a>01094 
<a name="l01095"></a>01095 <span class="comment">/* decode string representation of trust flags into trust struct */</span>
<a name="l01096"></a>01096 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01097"></a>01097 <a class="code" href="../../d7/d4a/cert_8h.html#ad26e8a55d75f48451383e54dd9f8ab50">CERT_DecodeTrustString</a>(<a class="code" href="../../d5/d52/struct_c_e_r_t_cert_trust_str.html">CERTCertTrust</a> *trust, <span class="keyword">const</span> <span class="keywordtype">char</span> *trusts);
<a name="l01098"></a>01098 
<a name="l01099"></a>01099 <span class="comment">/* encode trust struct into string representation of trust flags */</span>
<a name="l01100"></a>01100 <span class="keywordtype">char</span> *
<a name="l01101"></a>01101 <a class="code" href="../../d7/d4a/cert_8h.html#a417f3de562068a9aa1479660ba097bad">CERT_EncodeTrustString</a>(<a class="code" href="../../d5/d52/struct_c_e_r_t_cert_trust_str.html">CERTCertTrust</a> *trust);
<a name="l01102"></a>01102 
<a name="l01103"></a>01103 <span class="comment">/* find the next or prev cert in a subject list */</span>
<a name="l01104"></a>01104 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l01105"></a>01105 <a class="code" href="../../d7/d4a/cert_8h.html#aa7b9a2fae58b1af224add2782202ffd8">CERT_PrevSubjectCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01106"></a>01106 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l01107"></a>01107 <a class="code" href="../../d7/d4a/cert_8h.html#a3b80db7e5a12b5583b959f4a45137acc">CERT_NextSubjectCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 <span class="comment">/*</span>
<a name="l01110"></a>01110 <span class="comment"> * import a collection of certs into the temporary or permanent cert</span>
<a name="l01111"></a>01111 <span class="comment"> * database</span>
<a name="l01112"></a>01112 <span class="comment"> */</span>
<a name="l01113"></a>01113 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01114"></a>01114 <a class="code" href="../../d7/d4a/cert_8h.html#ae7c9738ee6749c3ecbcf2f57eaa8a7b8">CERT_ImportCerts</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *certdb, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01115"></a>01115          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ncerts, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **derCerts,
<a name="l01116"></a>01116          <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> ***retCerts, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> keepCerts,
<a name="l01117"></a>01117          <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> caOnly, <span class="keywordtype">char</span> *nickname);
<a name="l01118"></a>01118 
<a name="l01119"></a>01119 <span class="keywordtype">char</span> *
<a name="l01120"></a>01120 <a class="code" href="../../d7/d4a/cert_8h.html#ae878e22ba84d4a1bb691c6e5979be92b">CERT_MakeCANickname</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01121"></a>01121 
<a name="l01122"></a>01122 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>
<a name="l01123"></a>01123 <a class="code" href="../../d7/d4a/cert_8h.html#a9ebaaa2d93fb72a35293812ba25d95d2">CERT_IsCACert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *rettype);
<a name="l01124"></a>01124 
<a name="l01125"></a>01125 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>
<a name="l01126"></a>01126 <a class="code" href="../../d7/d4a/cert_8h.html#a22b1a46f39fd2dff4eb55eae55ce6f24">CERT_IsCADERCert</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *rettype);
<a name="l01127"></a>01127 
<a name="l01128"></a>01128 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>
<a name="l01129"></a>01129 <a class="code" href="../../d7/d4a/cert_8h.html#aeeb1eb9dd70569580862873af3091488">CERT_IsRootDERCert</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derCert);
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01132"></a>01132 <a class="code" href="../../d7/d4a/cert_8h.html#a2ad8959516e7bb6e541421e0240bff5f">CERT_SaveSMimeProfile</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *emailProfile,
<a name="l01133"></a>01133               <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *profileTime);
<a name="l01134"></a>01134 
<a name="l01135"></a>01135 <span class="comment">/*</span>
<a name="l01136"></a>01136 <span class="comment"> * find the smime symmetric capabilities profile for a given cert</span>
<a name="l01137"></a>01137 <span class="comment"> */</span>
<a name="l01138"></a>01138 <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *
<a name="l01139"></a>01139 <a class="code" href="../../d7/d4a/cert_8h.html#a33179fb5b76ddb44add5cc89e468b219">CERT_FindSMimeProfile</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01142"></a>01142 <a class="code" href="../../d7/d4a/cert_8h.html#a878886517e7c15bbe8eb2c01e2b42a58">CERT_AddNewCerts</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l01143"></a>01143 
<a name="l01144"></a>01144 <a class="code" href="../../da/dc1/struct_c_e_r_t_certificate_policies.html">CERTCertificatePolicies</a> *
<a name="l01145"></a>01145 <a class="code" href="../../d7/d4a/cert_8h.html#a6d6206b57a0f8bd2c50cf59343d8a8f8">CERT_DecodeCertificatePoliciesExtension</a>(<span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *extnValue);
<a name="l01146"></a>01146 
<a name="l01147"></a>01147 <span class="keywordtype">void</span>
<a name="l01148"></a>01148 <a class="code" href="../../d7/d4a/cert_8h.html#a1d10bb35c72e6929a640ee07d17a4f92">CERT_DestroyCertificatePoliciesExtension</a>(<a class="code" href="../../da/dc1/struct_c_e_r_t_certificate_policies.html">CERTCertificatePolicies</a> *policies);
<a name="l01149"></a>01149 
<a name="l01150"></a>01150 <a class="code" href="../../d5/d19/struct_c_e_r_t_certificate_policy_mappings.html">CERTCertificatePolicyMappings</a> *
<a name="l01151"></a>01151 <a class="code" href="../../d7/d4a/cert_8h.html#aaf915f899571e3077fcb11cfae14691b">CERT_DecodePolicyMappingsExtension</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedCertPolicyMaps);
<a name="l01152"></a>01152 
<a name="l01153"></a>01153 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01154"></a>01154 <a class="code" href="../../d7/d4a/cert_8h.html#a697276d9b4b61cf5ddd9f71b71faf597">CERT_DestroyPolicyMappingsExtension</a>(<a class="code" href="../../d5/d19/struct_c_e_r_t_certificate_policy_mappings.html">CERTCertificatePolicyMappings</a> *mappings);
<a name="l01155"></a>01155 
<a name="l01156"></a>01156 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01157"></a>01157 <a class="code" href="../../d7/d4a/cert_8h.html#a50fadba42ced67b53884a28de475c368">CERT_DecodePolicyConstraintsExtension</a>(
<a name="l01158"></a>01158     <a class="code" href="../../da/d53/struct_c_e_r_t_certificate_policy_constraints.html">CERTCertificatePolicyConstraints</a> *decodedValue,
<a name="l01159"></a>01159     <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedValue);
<a name="l01160"></a>01160 
<a name="l01161"></a>01161 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ac3d07bcbd0bb232edefcd6b44eb940c6">CERT_DecodeInhibitAnyExtension</a>
<a name="l01162"></a>01162     (<a class="code" href="../../d6/dd1/struct_c_e_r_t_certificate_inhibit_any.html">CERTCertificateInhibitAny</a> *decodedValue, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *extnValue);
<a name="l01163"></a>01163 
<a name="l01164"></a>01164 <a class="code" href="../../d4/dbc/struct_c_e_r_t_user_notice.html">CERTUserNotice</a> *
<a name="l01165"></a>01165 <a class="code" href="../../d7/d4a/cert_8h.html#aaf245fdbbf1ea3c1241d35b6869732fd">CERT_DecodeUserNotice</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *noticeItem);
<a name="l01166"></a>01166 
<a name="l01167"></a>01167 <span class="keyword">extern</span> <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l01168"></a>01168 <a class="code" href="../../d7/d4a/cert_8h.html#a00a1b600648950a26173ac15f4e4f77c">CERT_DecodeAltNameExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *reqArena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *EncodedAltName);
<a name="l01169"></a>01169 
<a name="l01170"></a>01170 <span class="keyword">extern</span> <a class="code" href="../../d5/d43/struct_c_e_r_t_name_constraints_str.html">CERTNameConstraints</a> *
<a name="l01171"></a>01171 <a class="code" href="../../d7/d4a/cert_8h.html#a09e10c22f39df3b2a20a5771aa693f30">CERT_DecodeNameConstraintsExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, 
<a name="l01172"></a>01172                                     <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *encodedConstraints);
<a name="l01173"></a>01173 
<a name="l01174"></a>01174 <span class="comment">/* returns addr of a NULL termainated array of pointers to CERTAuthInfoAccess */</span>
<a name="l01175"></a>01175 <span class="keyword">extern</span> <a class="code" href="../../d3/d23/struct_c_e_r_t_auth_info_access_str.html">CERTAuthInfoAccess</a> **
<a name="l01176"></a>01176 <a class="code" href="../../d7/d4a/cert_8h.html#ad820a5718d4c607f2bee44a151979198">CERT_DecodeAuthInfoAccessExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *reqArena,
<a name="l01177"></a>01177                    <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>     *encodedExtension);
<a name="l01178"></a>01178 
<a name="l01179"></a>01179 <span class="keyword">extern</span> <a class="code" href="../../d2/d82/struct_c_e_r_t_priv_key_usage_period_str.html">CERTPrivKeyUsagePeriod</a> *
<a name="l01180"></a>01180 <a class="code" href="../../d7/d4a/cert_8h.html#a98d0c441ffc1a6398c33324ad078c4c2">CERT_DecodePrivKeyUsagePeriodExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *extnValue);
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 <span class="keyword">extern</span> <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l01183"></a>01183 <a class="code" href="../../d7/d4a/cert_8h.html#aa5807b9aa7bc8910afa14d541f7baca0">CERT_GetNextGeneralName</a>(<a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *current);
<a name="l01184"></a>01184 
<a name="l01185"></a>01185 <span class="keyword">extern</span> <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l01186"></a>01186 <a class="code" href="../../d7/d4a/cert_8h.html#adc0d71cb8fb819d2f1811237bda908f6">CERT_GetPrevGeneralName</a>(<a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *current);
<a name="l01187"></a>01187 
<a name="l01188"></a>01188 <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *
<a name="l01189"></a>01189 <a class="code" href="../../d7/d4a/cert_8h.html#af4d955e33f59f2fddf34086cbc5184b9">CERT_GetNextNameConstraint</a>(<a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *current);
<a name="l01190"></a>01190 
<a name="l01191"></a>01191 <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *
<a name="l01192"></a>01192 <a class="code" href="../../d7/d4a/cert_8h.html#a5ef576b4251ffc300d52e4d64e637896">CERT_GetPrevNameConstraint</a>(<a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *current);
<a name="l01193"></a>01193 
<a name="l01194"></a>01194 <span class="keywordtype">void</span>
<a name="l01195"></a>01195 <a class="code" href="../../d7/d4a/cert_8h.html#a0583126e4ca8d8e5b84b4f10f78fa420">CERT_DestroyUserNotice</a>(<a class="code" href="../../d4/dbc/struct_c_e_r_t_user_notice.html">CERTUserNotice</a> *userNotice);
<a name="l01196"></a>01196 
<a name="l01197"></a><a class="code" href="../../d7/d4a/cert_8h.html#af050d8c13bc030d5a9a30c526e575560">01197</a> <span class="keyword">typedef</span> <span class="keywordtype">char</span> * (* CERTPolicyStringCallback)(<span class="keywordtype">char</span> *org,
<a name="l01198"></a>01198                            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> noticeNumber,
<a name="l01199"></a>01199                            <span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>);
<a name="l01200"></a>01200 <span class="keywordtype">void</span>
<a name="l01201"></a>01201 <a class="code" href="../../d7/d4a/cert_8h.html#a2b6c64b2942edfb988b858df651c297e">CERT_SetCAPolicyStringCallback</a>(<a class="code" href="../../d7/d4a/cert_8h.html#af050d8c13bc030d5a9a30c526e575560">CERTPolicyStringCallback</a> <a class="code" href="../../d2/d7d/jsapi_8h.html#a9c0cec265243907d0da86b92bda26eca">cb</a>, <span class="keywordtype">void</span> *cbarg);
<a name="l01202"></a>01202 
<a name="l01203"></a>01203 <span class="keywordtype">char</span> *
<a name="l01204"></a>01204 <a class="code" href="../../d7/d4a/cert_8h.html#aedf8a3a4225ee91107f73c3a9dec8a0e">CERT_GetCertCommentString</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01205"></a>01205 
<a name="l01206"></a>01206 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>
<a name="l01207"></a>01207 <a class="code" href="../../d7/d4a/cert_8h.html#a50c5963050b1ed7a8a1b45f508db7fe1">CERT_GovtApprovedBitSet</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01208"></a>01208 
<a name="l01209"></a>01209 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01210"></a>01210 <a class="code" href="../../d7/d4a/cert_8h.html#a5eefc5294dd5bcdf195af729f6d05cd3">CERT_AddPermNickname</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">char</span> *nickname);
<a name="l01211"></a>01211 
<a name="l01212"></a>01212 <a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *
<a name="l01213"></a>01213 <a class="code" href="../../d7/d4a/cert_8h.html#ad9956428b96dbf6352075ce282778898">CERT_MatchUserCert</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l01214"></a>01214            <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01215"></a>01215            <span class="keywordtype">int</span> nCANames, <span class="keywordtype">char</span> **caNames,
<a name="l01216"></a>01216            <span class="keywordtype">void</span> *proto_win);
<a name="l01217"></a>01217 
<a name="l01218"></a>01218 <a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *
<a name="l01219"></a>01219 <a class="code" href="../../d7/d4a/cert_8h.html#a49ba94030cea9753063b54bf4b34c0e2">CERT_NewCertList</a>(<span class="keywordtype">void</span>);
<a name="l01220"></a>01220 
<a name="l01221"></a>01221 <span class="keywordtype">void</span>
<a name="l01222"></a>01222 <a class="code" href="../../d7/d4a/cert_8h.html#af981697eec4ba91b345b78a6f11a8a56">CERT_DestroyCertList</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>);
<a name="l01223"></a>01223 
<a name="l01224"></a>01224 <span class="comment">/* remove the node and free the cert */</span>
<a name="l01225"></a>01225 <span class="keywordtype">void</span>
<a name="l01226"></a>01226 <a class="code" href="../../d7/d4a/cert_8h.html#a27d8f258b8eb2fc4753275f0735e3c1f">CERT_RemoveCertListNode</a>(<a class="code" href="../../d3/d55/struct_c_e_r_t_cert_list_node_str.html">CERTCertListNode</a> *<a class="code" href="../../d1/d04/app__install__manager_8js.html#a9ed71aaefba3c241c5255080e6a99884">node</a>);
<a name="l01227"></a>01227 
<a name="l01228"></a>01228 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01229"></a>01229 <a class="code" href="../../d7/d4a/cert_8h.html#ad4685d5f9c14ad93056b96a3df7e2570">CERT_AddCertToListTail</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01230"></a>01230 
<a name="l01231"></a>01231 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01232"></a>01232 <a class="code" href="../../d7/d4a/cert_8h.html#a75e399dabc38113cebbf9f380c1c5d9a">CERT_AddCertToListHead</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01233"></a>01233 
<a name="l01234"></a>01234 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01235"></a>01235 <a class="code" href="../../d7/d4a/cert_8h.html#afce8374dc7f61abf72e27e9687b786c0">CERT_AddCertToListTailWithData</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01236"></a>01236                              <span class="keywordtype">void</span> *appData);
<a name="l01237"></a>01237 
<a name="l01238"></a>01238 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01239"></a>01239 <a class="code" href="../../d7/d4a/cert_8h.html#a649dee7d815d547d27c66b90117d496e">CERT_AddCertToListHeadWithData</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01240"></a>01240                              <span class="keywordtype">void</span> *appData);
<a name="l01241"></a>01241 
<a name="l01242"></a><a class="code" href="../../d7/d4a/cert_8h.html#a18b278339605a409a9a831bd964d42b2">01242</a> <span class="keyword">typedef</span> <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> (* <a class="code" href="../../d7/d4a/cert_8h.html#a18b278339605a409a9a831bd964d42b2">CERTSortCallback</a>)(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *certa,
<a name="l01243"></a>01243                     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *certb,
<a name="l01244"></a>01244                     <span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>);
<a name="l01245"></a>01245 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01246"></a>01246 <a class="code" href="../../d7/d4a/cert_8h.html#a64c5e549ee3b4057d49836d4109e7635">CERT_AddCertToListSorted</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">certs</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01247"></a>01247              <a class="code" href="../../d7/d4a/cert_8h.html#a18b278339605a409a9a831bd964d42b2">CERTSortCallback</a> <a class="code" href="../../d3/d4b/lockscreen_8js.html#a9cf09a2972472098a4c689fd988f4dfc">f</a>, <span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>);
<a name="l01248"></a>01248 
<a name="l01249"></a>01249 <span class="comment">/* callback for CERT_AddCertToListSorted that sorts based on validity</span>
<a name="l01250"></a>01250 <span class="comment"> * period and a given time.</span>
<a name="l01251"></a>01251 <span class="comment"> */</span>
<a name="l01252"></a>01252 <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>
<a name="l01253"></a>01253 <a class="code" href="../../d7/d4a/cert_8h.html#a57275967638583eb081de66673ef9ba0">CERT_SortCBValidity</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *certa,
<a name="l01254"></a>01254             <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *certb,
<a name="l01255"></a>01255             <span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>);
<a name="l01256"></a>01256 
<a name="l01257"></a>01257 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01258"></a>01258 <a class="code" href="../../d7/d4a/cert_8h.html#a1b449a10a2ddff99af3891f92edaeccf">CERT_CheckForEvilCert</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01259"></a>01259 
<a name="l01260"></a>01260 <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l01261"></a>01261 <a class="code" href="../../d7/d4a/cert_8h.html#aa9dba63669b62d5cafd749c9b6eaf2d2">CERT_GetCertificateNames</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena);
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l01264"></a>01264 <a class="code" href="../../d7/d4a/cert_8h.html#a23bd70515d9e378353ea12081453b2c1">CERT_GetConstrainedCertificateNames</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01265"></a>01265                                     <a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01266"></a>01266                                     <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> includeSubjectCommonName);
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 <span class="comment">/*</span>
<a name="l01269"></a>01269 <span class="comment"> * Creates or adds to a list of all certs with a give subject name, sorted by</span>
<a name="l01270"></a>01270 <span class="comment"> * validity time, newest first.  Invalid certs are considered older than</span>
<a name="l01271"></a>01271 <span class="comment"> * valid certs. If validOnly is set, do not include invalid certs on list.</span>
<a name="l01272"></a>01272 <span class="comment"> */</span>
<a name="l01273"></a>01273 <a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *
<a name="l01274"></a>01274 <a class="code" href="../../d7/d4a/cert_8h.html#a60024d94347b74c471adf97a6a78fd5a">CERT_CreateSubjectCertList</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *certList, <a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l01275"></a>01275                <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> sorttime,
<a name="l01276"></a>01276                <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> validOnly);
<a name="l01277"></a>01277 
<a name="l01278"></a>01278 <span class="comment">/*</span>
<a name="l01279"></a>01279 <span class="comment"> * remove certs from a list that don&#39;t have keyUsage and certType</span>
<a name="l01280"></a>01280 <span class="comment"> * that match the given usage.</span>
<a name="l01281"></a>01281 <span class="comment"> */</span>
<a name="l01282"></a>01282 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01283"></a>01283 <a class="code" href="../../d7/d4a/cert_8h.html#a9eb0e039c53cc1732e3c3ba41eb7c7fd">CERT_FilterCertListByUsage</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *certList, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01284"></a>01284                <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> ca);
<a name="l01285"></a>01285 
<a name="l01286"></a>01286 <span class="comment">/*</span>
<a name="l01287"></a>01287 <span class="comment"> * check the key usage of a cert against a set of required values</span>
<a name="l01288"></a>01288 <span class="comment"> */</span>
<a name="l01289"></a>01289 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01290"></a>01290 <a class="code" href="../../d7/d4a/cert_8h.html#a437045d5dbedac55c1822df42b9b3c33">CERT_CheckKeyUsage</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> requiredUsage);
<a name="l01291"></a>01291 
<a name="l01292"></a>01292 <span class="comment">/*</span>
<a name="l01293"></a>01293 <span class="comment"> * return required key usage and cert type based on cert usage</span>
<a name="l01294"></a>01294 <span class="comment"> */</span>
<a name="l01295"></a>01295 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01296"></a>01296 <a class="code" href="../../d7/d4a/cert_8h.html#a009153536757646ca79b21a45125b5bb">CERT_KeyUsageAndTypeForCertUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01297"></a>01297                  <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> ca,
<a name="l01298"></a>01298                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *retKeyUsage,
<a name="l01299"></a>01299                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *retCertType);
<a name="l01300"></a>01300 <span class="comment">/*</span>
<a name="l01301"></a>01301 <span class="comment"> * return required trust flags for various cert usages for CAs</span>
<a name="l01302"></a>01302 <span class="comment"> */</span>
<a name="l01303"></a>01303 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01304"></a>01304 <a class="code" href="../../d7/d4a/cert_8h.html#a39eb34484e76dbc9919aac70f26fe956">CERT_TrustFlagsForCACertUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01305"></a>01305                   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *retFlags,
<a name="l01306"></a>01306                   <a class="code" href="../../d6/da5/certt_8h.html#a60a00d15c3d659400b7acfaf7d71938e">SECTrustType</a> *retTrustType);
<a name="l01307"></a>01307 
<a name="l01308"></a>01308 <span class="comment">/*</span>
<a name="l01309"></a>01309 <span class="comment"> * Find all user certificates that match the given criteria.</span>
<a name="l01310"></a>01310 <span class="comment"> * </span>
<a name="l01311"></a>01311 <span class="comment"> *  &quot;handle&quot; - database to search</span>
<a name="l01312"></a>01312 <span class="comment"> *  &quot;usage&quot; - certificate usage to match</span>
<a name="l01313"></a>01313 <span class="comment"> *  &quot;oneCertPerName&quot; - if set then only return the &quot;best&quot; cert per</span>
<a name="l01314"></a>01314 <span class="comment"> *          name</span>
<a name="l01315"></a>01315 <span class="comment"> *  &quot;validOnly&quot; - only return certs that are curently valid</span>
<a name="l01316"></a>01316 <span class="comment"> *  &quot;proto_win&quot; - window handle passed to pkcs11</span>
<a name="l01317"></a>01317 <span class="comment"> */</span>
<a name="l01318"></a>01318 <a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *
<a name="l01319"></a>01319 <a class="code" href="../../d7/d4a/cert_8h.html#aaf03d67400d5385c8e5e5043f79b81b1">CERT_FindUserCertsByUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l01320"></a>01320               <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01321"></a>01321               <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> oneCertPerName,
<a name="l01322"></a>01322               <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> validOnly,
<a name="l01323"></a>01323               <span class="keywordtype">void</span> *proto_win);
<a name="l01324"></a>01324 
<a name="l01325"></a>01325 <span class="comment">/*</span>
<a name="l01326"></a>01326 <span class="comment"> * Find a user certificate that matchs the given criteria.</span>
<a name="l01327"></a>01327 <span class="comment"> * </span>
<a name="l01328"></a>01328 <span class="comment"> *  &quot;handle&quot; - database to search</span>
<a name="l01329"></a>01329 <span class="comment"> *  &quot;nickname&quot; - nickname to match</span>
<a name="l01330"></a>01330 <span class="comment"> *  &quot;usage&quot; - certificate usage to match</span>
<a name="l01331"></a>01331 <span class="comment"> *  &quot;validOnly&quot; - only return certs that are curently valid</span>
<a name="l01332"></a>01332 <span class="comment"> *  &quot;proto_win&quot; - window handle passed to pkcs11</span>
<a name="l01333"></a>01333 <span class="comment"> */</span>
<a name="l01334"></a>01334 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l01335"></a>01335 <a class="code" href="../../d7/d4a/cert_8h.html#a9ae776c63093800bf8e86277f54b77e4">CERT_FindUserCertByUsage</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>,
<a name="l01336"></a>01336              <span class="keyword">const</span> <span class="keywordtype">char</span> *nickname,
<a name="l01337"></a>01337              <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01338"></a>01338              <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> validOnly,
<a name="l01339"></a>01339              <span class="keywordtype">void</span> *proto_win);
<a name="l01340"></a>01340 
<a name="l01341"></a>01341 <span class="comment">/*</span>
<a name="l01342"></a>01342 <span class="comment"> * Filter a list of certificates, removing those certs that do not have</span>
<a name="l01343"></a>01343 <span class="comment"> * one of the named CA certs somewhere in their cert chain.</span>
<a name="l01344"></a>01344 <span class="comment"> *</span>
<a name="l01345"></a>01345 <span class="comment"> *  &quot;certList&quot; - the list of certificates to filter</span>
<a name="l01346"></a>01346 <span class="comment"> *  &quot;nCANames&quot; - number of CA names</span>
<a name="l01347"></a>01347 <span class="comment"> *  &quot;caNames&quot; - array of CA names in string(rfc 1485) form</span>
<a name="l01348"></a>01348 <span class="comment"> *  &quot;usage&quot; - what use the certs are for, this is used when</span>
<a name="l01349"></a>01349 <span class="comment"> *      selecting CA certs</span>
<a name="l01350"></a>01350 <span class="comment"> */</span>
<a name="l01351"></a>01351 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01352"></a>01352 <a class="code" href="../../d7/d4a/cert_8h.html#abe084fc73c7fb0ca88e90b74469135de">CERT_FilterCertListByCANames</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *certList, <span class="keywordtype">int</span> nCANames,
<a name="l01353"></a>01353                  <span class="keywordtype">char</span> **caNames, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage);
<a name="l01354"></a>01354 
<a name="l01355"></a>01355 <span class="comment">/*</span>
<a name="l01356"></a>01356 <span class="comment"> * Filter a list of certificates, removing those certs that aren&#39;t user certs</span>
<a name="l01357"></a>01357 <span class="comment"> */</span>
<a name="l01358"></a>01358 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01359"></a>01359 <a class="code" href="../../d7/d4a/cert_8h.html#a35701c7985e368b37280866bb8ccd63b">CERT_FilterCertListForUserCerts</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *certList);
<a name="l01360"></a>01360 
<a name="l01361"></a>01361 <span class="comment">/*</span>
<a name="l01362"></a>01362 <span class="comment"> * Collect the nicknames from all certs in a CertList.  If the cert is not</span>
<a name="l01363"></a>01363 <span class="comment"> * valid, append a string to that nickname.</span>
<a name="l01364"></a>01364 <span class="comment"> *</span>
<a name="l01365"></a>01365 <span class="comment"> * &quot;certList&quot; - the list of certificates</span>
<a name="l01366"></a>01366 <span class="comment"> * &quot;expiredString&quot; - the string to append to the nickname of any expired cert</span>
<a name="l01367"></a>01367 <span class="comment"> * &quot;notYetGoodString&quot; - the string to append to the nickname of any cert</span>
<a name="l01368"></a>01368 <span class="comment"> *      that is not yet valid</span>
<a name="l01369"></a>01369 <span class="comment"> */</span>
<a name="l01370"></a>01370 <a class="code" href="../../df/dec/struct_c_e_r_t_cert_nicknames_str.html">CERTCertNicknames</a> *
<a name="l01371"></a>01371 <a class="code" href="../../d7/d4a/cert_8h.html#a1da41a873b409da37a10d5a4a52f1b0c">CERT_NicknameStringsFromCertList</a>(<a class="code" href="../../d9/d4b/struct_c_e_r_t_cert_list_str.html">CERTCertList</a> *certList, <span class="keywordtype">char</span> *expiredString,
<a name="l01372"></a>01372                  <span class="keywordtype">char</span> *notYetGoodString);
<a name="l01373"></a>01373 
<a name="l01374"></a>01374 <span class="comment">/*</span>
<a name="l01375"></a>01375 <span class="comment"> * Extract the nickname from a nickmake string that may have either</span>
<a name="l01376"></a>01376 <span class="comment"> * expiredString or notYetGoodString appended.</span>
<a name="l01377"></a>01377 <span class="comment"> *</span>
<a name="l01378"></a>01378 <span class="comment"> * Args:</span>
<a name="l01379"></a>01379 <span class="comment"> *  &quot;namestring&quot; - the string containing the nickname, and possibly</span>
<a name="l01380"></a>01380 <span class="comment"> *      one of the validity label strings</span>
<a name="l01381"></a>01381 <span class="comment"> *  &quot;expiredString&quot; - the expired validity label string</span>
<a name="l01382"></a>01382 <span class="comment"> *  &quot;notYetGoodString&quot; - the not yet good validity label string</span>
<a name="l01383"></a>01383 <span class="comment"> *</span>
<a name="l01384"></a>01384 <span class="comment"> * Returns the raw nickname</span>
<a name="l01385"></a>01385 <span class="comment"> */</span>
<a name="l01386"></a>01386 <span class="keywordtype">char</span> *
<a name="l01387"></a>01387 <a class="code" href="../../d7/d4a/cert_8h.html#aa7985bba1f04b8f20734d19d02dabce0">CERT_ExtractNicknameString</a>(<span class="keywordtype">char</span> *namestring, <span class="keywordtype">char</span> *expiredString,
<a name="l01388"></a>01388                <span class="keywordtype">char</span> *notYetGoodString);
<a name="l01389"></a>01389 
<a name="l01390"></a>01390 <span class="comment">/*</span>
<a name="l01391"></a>01391 <span class="comment"> * Given a certificate, return a string containing the nickname, and possibly</span>
<a name="l01392"></a>01392 <span class="comment"> * one of the validity strings, based on the current validity state of the</span>
<a name="l01393"></a>01393 <span class="comment"> * certificate.</span>
<a name="l01394"></a>01394 <span class="comment"> *</span>
<a name="l01395"></a>01395 <span class="comment"> * &quot;arena&quot; - arena to allocate returned string from.  If NULL, then heap</span>
<a name="l01396"></a>01396 <span class="comment"> *  is used.</span>
<a name="l01397"></a>01397 <span class="comment"> * &quot;cert&quot; - the cert to get nickname from</span>
<a name="l01398"></a>01398 <span class="comment"> * &quot;expiredString&quot; - the string to append to the nickname if the cert is</span>
<a name="l01399"></a>01399 <span class="comment"> *      expired.</span>
<a name="l01400"></a>01400 <span class="comment"> * &quot;notYetGoodString&quot; - the string to append to the nickname if the cert is</span>
<a name="l01401"></a>01401 <span class="comment"> *      not yet good.</span>
<a name="l01402"></a>01402 <span class="comment"> */</span>
<a name="l01403"></a>01403 <span class="keywordtype">char</span> *
<a name="l01404"></a>01404 <a class="code" href="../../d7/d4a/cert_8h.html#aa09c5b66e6b83277face9e31793e5f30">CERT_GetCertNicknameWithValidity</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01405"></a>01405                  <span class="keywordtype">char</span> *expiredString, <span class="keywordtype">char</span> *notYetGoodString);
<a name="l01406"></a>01406 
<a name="l01407"></a>01407 <span class="comment">/*</span>
<a name="l01408"></a>01408 <span class="comment"> * Return the string representation of a DER encoded distinguished name</span>
<a name="l01409"></a>01409 <span class="comment"> * &quot;dername&quot; - The DER encoded name to convert</span>
<a name="l01410"></a>01410 <span class="comment"> */</span>
<a name="l01411"></a>01411 <span class="keywordtype">char</span> *
<a name="l01412"></a>01412 <a class="code" href="../../d7/d4a/cert_8h.html#afd4e5281696395cf2f58fa69441605b3">CERT_DerNameToAscii</a>(<a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dername);
<a name="l01413"></a>01413 
<a name="l01414"></a>01414 <span class="comment">/*</span>
<a name="l01415"></a>01415 <span class="comment"> * Supported usage values and types:</span>
<a name="l01416"></a>01416 <span class="comment"> *  certUsageSSLClient</span>
<a name="l01417"></a>01417 <span class="comment"> *  certUsageSSLServer</span>
<a name="l01418"></a>01418 <span class="comment"> *  certUsageSSLServerWithStepUp</span>
<a name="l01419"></a>01419 <span class="comment"> *  certUsageEmailSigner</span>
<a name="l01420"></a>01420 <span class="comment"> *  certUsageEmailRecipient</span>
<a name="l01421"></a>01421 <span class="comment"> *  certUsageObjectSigner</span>
<a name="l01422"></a>01422 <span class="comment"> */</span>
<a name="l01423"></a>01423 
<a name="l01424"></a>01424 <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *
<a name="l01425"></a>01425 <a class="code" href="../../d7/d4a/cert_8h.html#a1cc75a942a9d37eb7a36c66054e578e0">CERT_FindMatchingCert</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *derName,
<a name="l01426"></a>01426               <a class="code" href="../../d6/da5/certt_8h.html#aeda7891d29f2b6e7d18c27d6465eedcb">CERTCertOwner</a> owner, <a class="code" href="../../d6/da5/certt_8h.html#a7d5b69d8df3e11c4d59eb60bd8b85630">SECCertUsage</a> usage,
<a name="l01427"></a>01427               <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> preferTrusted, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> validTime, <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> validOnly);
<a name="l01428"></a>01428 
<a name="l01429"></a>01429 <span class="comment">/*</span>
<a name="l01430"></a>01430 <span class="comment"> * Acquire the global lock on the cert database.</span>
<a name="l01431"></a>01431 <span class="comment"> * This lock is currently used for the following operations:</span>
<a name="l01432"></a>01432 <span class="comment"> *  adding or deleting a cert to either the temp or perm databases</span>
<a name="l01433"></a>01433 <span class="comment"> *  converting a temp to perm or perm to temp</span>
<a name="l01434"></a>01434 <span class="comment"> *  changing(maybe just adding?) the trust of a cert</span>
<a name="l01435"></a>01435 <span class="comment"> *  adjusting the reference count of a cert</span>
<a name="l01436"></a>01436 <span class="comment"> */</span>
<a name="l01437"></a>01437 <span class="keywordtype">void</span>
<a name="l01438"></a>01438 <a class="code" href="../../d7/d4a/cert_8h.html#acd1d914b3393931e5177f87fa022faf6">CERT_LockDB</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l01439"></a>01439 
<a name="l01440"></a>01440 <span class="comment">/*</span>
<a name="l01441"></a>01441 <span class="comment"> * Free the global cert database lock.</span>
<a name="l01442"></a>01442 <span class="comment"> */</span>
<a name="l01443"></a>01443 <span class="keywordtype">void</span>
<a name="l01444"></a>01444 <a class="code" href="../../d7/d4a/cert_8h.html#a8fcf491ecfe4506c2885021017099c96">CERT_UnlockDB</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l01445"></a>01445 
<a name="l01446"></a>01446 <span class="comment">/*</span>
<a name="l01447"></a>01447 <span class="comment"> * Get the certificate status checking configuratino data for</span>
<a name="l01448"></a>01448 <span class="comment"> * the certificate database</span>
<a name="l01449"></a>01449 <span class="comment"> */</span>
<a name="l01450"></a>01450 <a class="code" href="../../df/d51/struct_c_e_r_t_status_config_str.html">CERTStatusConfig</a> *
<a name="l01451"></a>01451 <a class="code" href="../../d7/d4a/cert_8h.html#a4a4895f3d4c40e87aa01eb893f780297">CERT_GetStatusConfig</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>);
<a name="l01452"></a>01452 
<a name="l01453"></a>01453 <span class="comment">/*</span>
<a name="l01454"></a>01454 <span class="comment"> * Set the certificate status checking information for the</span>
<a name="l01455"></a>01455 <span class="comment"> * database.  The input structure becomes part of the certificate</span>
<a name="l01456"></a>01456 <span class="comment"> * database and will be freed by calling the &#39;Destroy&#39; function in</span>
<a name="l01457"></a>01457 <span class="comment"> * the configuration object.</span>
<a name="l01458"></a>01458 <span class="comment"> */</span>
<a name="l01459"></a>01459 <span class="keywordtype">void</span>
<a name="l01460"></a>01460 <a class="code" href="../../d7/d4a/cert_8h.html#a2066becf90449da9b22ab2ba1face7a8">CERT_SetStatusConfig</a>(<a class="code" href="../../d6/da5/certt_8h.html#a2d9edb13f667da37205d81f3a0e33786">CERTCertDBHandle</a> *<a class="code" href="../../d3/d4b/lockscreen_8js.html#af91fa9dd7bcc99f1ac5d9727c6cdc8cc">handle</a>, <a class="code" href="../../df/d51/struct_c_e_r_t_status_config_str.html">CERTStatusConfig</a> *<a class="code" href="../../d1/d0b/fb__init_8js.html#aeac120c9ce32d189166215752b0b1a76">config</a>);
<a name="l01461"></a>01461 
<a name="l01462"></a>01462 
<a name="l01463"></a>01463 
<a name="l01464"></a>01464 <span class="comment">/*</span>
<a name="l01465"></a>01465 <span class="comment"> * Acquire the cert reference count lock</span>
<a name="l01466"></a>01466 <span class="comment"> * There is currently one global lock for all certs, but I&#39;m putting a cert</span>
<a name="l01467"></a>01467 <span class="comment"> * arg here so that it will be easy to make it per-cert in the future if</span>
<a name="l01468"></a>01468 <span class="comment"> * that turns out to be necessary.</span>
<a name="l01469"></a>01469 <span class="comment"> */</span>
<a name="l01470"></a>01470 <span class="keywordtype">void</span>
<a name="l01471"></a>01471 <a class="code" href="../../d7/d4a/cert_8h.html#a93f6afcc1a62329159b9a3bdf4e8d9fd">CERT_LockCertRefCount</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01472"></a>01472 
<a name="l01473"></a>01473 <span class="comment">/*</span>
<a name="l01474"></a>01474 <span class="comment"> * Free the cert reference count lock</span>
<a name="l01475"></a>01475 <span class="comment"> */</span>
<a name="l01476"></a>01476 <span class="keywordtype">void</span>
<a name="l01477"></a>01477 <a class="code" href="../../d7/d4a/cert_8h.html#a1dc931f6a84330cfe044bd3e752027a5">CERT_UnlockCertRefCount</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01478"></a>01478 
<a name="l01479"></a>01479 <span class="comment">/*</span>
<a name="l01480"></a>01480 <span class="comment"> * Acquire the cert trust lock</span>
<a name="l01481"></a>01481 <span class="comment"> * There is currently one global lock for all certs, but I&#39;m putting a cert</span>
<a name="l01482"></a>01482 <span class="comment"> * arg here so that it will be easy to make it per-cert in the future if</span>
<a name="l01483"></a>01483 <span class="comment"> * that turns out to be necessary.</span>
<a name="l01484"></a>01484 <span class="comment"> */</span>
<a name="l01485"></a>01485 <span class="keywordtype">void</span>
<a name="l01486"></a>01486 <a class="code" href="../../d7/d4a/cert_8h.html#a3eb9b6a1c182ce1f83be153941a40ff6">CERT_LockCertTrust</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01487"></a>01487 
<a name="l01488"></a>01488 <span class="comment">/*</span>
<a name="l01489"></a>01489 <span class="comment"> * Free the cert trust lock</span>
<a name="l01490"></a>01490 <span class="comment"> */</span>
<a name="l01491"></a>01491 <span class="keywordtype">void</span>
<a name="l01492"></a>01492 <a class="code" href="../../d7/d4a/cert_8h.html#a606e09ff0b217fbdea7662e489bb4397">CERT_UnlockCertTrust</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>);
<a name="l01493"></a>01493 
<a name="l01494"></a>01494 <span class="comment">/*</span>
<a name="l01495"></a>01495 <span class="comment"> * Digest the cert&#39;s subject public key using the specified algorithm.</span>
<a name="l01496"></a>01496 <span class="comment"> * The necessary storage for the digest data is allocated.  If &quot;fill&quot; is</span>
<a name="l01497"></a>01497 <span class="comment"> * non-null, the data is put there, otherwise a SECItem is allocated.</span>
<a name="l01498"></a>01498 <span class="comment"> * Allocation from &quot;arena&quot; if it is non-null, heap otherwise.  Any problem</span>
<a name="l01499"></a>01499 <span class="comment"> * results in a NULL being returned (and an appropriate error set).</span>
<a name="l01500"></a>01500 <span class="comment"> */</span> 
<a name="l01501"></a>01501 <span class="keyword">extern</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *
<a name="l01502"></a>01502 <a class="code" href="../../d7/d4a/cert_8h.html#a0b4a9b3142e6cb5cdfbb49f672f2798a">CERT_GetSPKIDigest</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <span class="keyword">const</span> <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01503"></a>01503                    <a class="code" href="../../de/d47/secoidt_8h.html#a12df3d414e7f1d49862a0ceb68fce9d0">SECOidTag</a> digestAlg, <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *fill);
<a name="l01504"></a>01504 
<a name="l01505"></a>01505 
<a name="l01506"></a>01506 <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ab374931d47d41b32ff5d29fe6cbfb591">CERT_CheckCRL</a>(<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a>* <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>, <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a>* issuer,
<a name="l01507"></a>01507                         <span class="keyword">const</span> <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>* <a class="code" href="../../d2/d7d/jsapi_8h.html#a085bad33ac8d4f0e9b04432e2f2e796b">dp</a>, <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a> t, <span class="keywordtype">void</span>* wincx);
<a name="l01508"></a>01508 
<a name="l01509"></a>01509 
<a name="l01510"></a>01510 <span class="comment">/*</span>
<a name="l01511"></a>01511 <span class="comment"> * Add a CERTNameConstraint to the CERTNameConstraint list</span>
<a name="l01512"></a>01512 <span class="comment"> */</span>
<a name="l01513"></a>01513 <span class="keyword">extern</span> <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *
<a name="l01514"></a>01514 <a class="code" href="../../d7/d4a/cert_8h.html#a18ff6f9c65650a8d3435ec8217bfd0b2">CERT_AddNameConstraint</a>(<a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *<a class="code" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>, 
<a name="l01515"></a>01515                <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *constraint);
<a name="l01516"></a>01516 
<a name="l01517"></a>01517 <span class="comment">/*</span>
<a name="l01518"></a>01518 <span class="comment"> * Allocate space and copy CERTNameConstraint from src to dest.</span>
<a name="l01519"></a>01519 <span class="comment"> * Arena is used to allocate result(if dest eq NULL) and its members</span>
<a name="l01520"></a>01520 <span class="comment"> * SECItem data.</span>
<a name="l01521"></a>01521 <span class="comment"> */</span>
<a name="l01522"></a>01522 <span class="keyword">extern</span> <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a> *
<a name="l01523"></a>01523 <a class="code" href="../../d7/d4a/cert_8h.html#af7784318c59d093e92d41bf99662c66a">CERT_CopyNameConstraint</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a>         *arena, 
<a name="l01524"></a>01524             <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a>  *dest, 
<a name="l01525"></a>01525             <a class="code" href="../../de/daf/struct_c_e_r_t_name_constraint_str.html">CERTNameConstraint</a>  *src);
<a name="l01526"></a>01526 
<a name="l01527"></a>01527 <span class="comment">/*</span>
<a name="l01528"></a>01528 <span class="comment"> * Verify name against all the constraints relevant to that type of</span>
<a name="l01529"></a>01529 <span class="comment"> * the name.</span>
<a name="l01530"></a>01530 <span class="comment"> */</span>
<a name="l01531"></a>01531 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01532"></a>01532 <a class="code" href="../../d7/d4a/cert_8h.html#a454ac70a62a8aad015f6843f3a0f5fa7">CERT_CheckNameSpace</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a>          *arena,
<a name="l01533"></a>01533             <span class="keyword">const</span> <a class="code" href="../../d5/d43/struct_c_e_r_t_name_constraints_str.html">CERTNameConstraints</a> *constraints,
<a name="l01534"></a>01534             <span class="keyword">const</span> <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *currentName);
<a name="l01535"></a>01535 
<a name="l01536"></a>01536 <span class="comment">/*</span>
<a name="l01537"></a>01537 <span class="comment"> * Extract and allocate the name constraints extension from the CA cert.</span>
<a name="l01538"></a>01538 <span class="comment"> */</span>
<a name="l01539"></a>01539 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01540"></a>01540 <a class="code" href="../../d7/d4a/cert_8h.html#a384d7ca7ee52787b64f4921934d23051">CERT_FindNameConstraintsExten</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a>      *arena,
<a name="l01541"></a>01541                   <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a>  *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01542"></a>01542                   <a class="code" href="../../d5/d43/struct_c_e_r_t_name_constraints_str.html">CERTNameConstraints</a> **constraints);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544 <span class="comment">/*</span>
<a name="l01545"></a>01545 <span class="comment"> * Initialize a new GERTGeneralName fields (link)</span>
<a name="l01546"></a>01546 <span class="comment"> */</span>
<a name="l01547"></a>01547 <span class="keyword">extern</span> <a class="code" href="../../d7/db0/struct_c_e_r_t_general_name_str.html">CERTGeneralName</a> *
<a name="l01548"></a>01548 <a class="code" href="../../d7/d4a/cert_8h.html#a1f6c74f5ea91ff724e0b4441b2f898c6">CERT_NewGeneralName</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena, <a class="code" href="../../d6/da5/certt_8h.html#a826bef441efb1f291d7f6d6e9f04a54f">CERTGeneralNameType</a> <a class="code" href="../../df/d44/permission__manager_8js.html#a5996578fe734dff3d2912807ee458e83">type</a>);
<a name="l01549"></a>01549 
<a name="l01550"></a>01550 <span class="comment">/*</span>
<a name="l01551"></a>01551 <span class="comment"> * PKIX extension encoding routines</span>
<a name="l01552"></a>01552 <span class="comment"> */</span>
<a name="l01553"></a>01553 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01554"></a>01554 <a class="code" href="../../d7/d4a/cert_8h.html#a3927e823a4806818b0652d2a0d4232e8">CERT_EncodePolicyConstraintsExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01555"></a>01555                                       <a class="code" href="../../da/d53/struct_c_e_r_t_certificate_policy_constraints.html">CERTCertificatePolicyConstraints</a> *constr,
<a name="l01556"></a>01556                                       <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01557"></a>01557 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01558"></a>01558 <a class="code" href="../../d7/d4a/cert_8h.html#af7f25cdc1fba57fba49692db82904a41">CERT_EncodeInhibitAnyExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01559"></a>01559                                <a class="code" href="../../d6/dd1/struct_c_e_r_t_certificate_inhibit_any.html">CERTCertificateInhibitAny</a> *inhibitAny,
<a name="l01560"></a>01560                                <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01561"></a>01561 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01562"></a>01562 <a class="code" href="../../d7/d4a/cert_8h.html#ac97e063d9bfae3303579425382d7d2e9">CERT_EncodePolicyMappingExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01563"></a>01563                                   <a class="code" href="../../d5/d19/struct_c_e_r_t_certificate_policy_mappings.html">CERTCertificatePolicyMappings</a> *maps,
<a name="l01564"></a>01564                                   <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01565"></a>01565 
<a name="l01566"></a>01566 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a49c539e2259ea846dfa9f767c6b9055e">CERT_EncodeInfoAccessExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01567"></a>01567                                                     <a class="code" href="../../d3/d23/struct_c_e_r_t_auth_info_access_str.html">CERTAuthInfoAccess</a> **<a class="code" href="../../d9/d04/expat_8h.html#ad737df79bb5419e4bac72f823f6fdec9">info</a>,
<a name="l01568"></a>01568                                                     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01569"></a>01569 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01570"></a>01570 <a class="code" href="../../d7/d4a/cert_8h.html#ae8cdde38f8873138e6110acc1ab67472">CERT_EncodeUserNotice</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01571"></a>01571                       <a class="code" href="../../d4/dbc/struct_c_e_r_t_user_notice.html">CERTUserNotice</a> *notice,
<a name="l01572"></a>01572                       <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01573"></a>01573 
<a name="l01574"></a>01574 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01575"></a>01575 <a class="code" href="../../d7/d4a/cert_8h.html#adff780d2dc8d5f8cb0d5aeaf4cc285be">CERT_EncodeDisplayText</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01576"></a>01576                        <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../dd/dfa/classtext.html">text</a>,
<a name="l01577"></a>01577                        <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01578"></a>01578 
<a name="l01579"></a>01579 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01580"></a>01580 <a class="code" href="../../d7/d4a/cert_8h.html#a7c783851d7c72031a26583b05785edc0">CERT_EncodeCertPoliciesExtension</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01581"></a>01581                                  <a class="code" href="../../db/d59/struct_c_e_r_t_policy_info.html">CERTPolicyInfo</a> **<a class="code" href="../../d9/d04/expat_8h.html#ad737df79bb5419e4bac72f823f6fdec9">info</a>,
<a name="l01582"></a>01582                                  <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01583"></a>01583 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a>
<a name="l01584"></a>01584 <a class="code" href="../../d7/d4a/cert_8h.html#a29385869c4cad23470b72d97d2de7ae0">CERT_EncodeNoticeReference</a>(<a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *arena,
<a name="l01585"></a>01585                            <a class="code" href="../../d2/ddb/struct_c_e_r_t_notice_reference.html">CERTNoticeReference</a> *reference,
<a name="l01586"></a>01586                            <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *dest);
<a name="l01587"></a>01587 
<a name="l01588"></a>01588 <span class="comment">/*</span>
<a name="l01589"></a>01589 <span class="comment"> * Returns a pointer to a static structure.</span>
<a name="l01590"></a>01590 <span class="comment"> */</span>
<a name="l01591"></a>01591 <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="../../dd/df8/struct_c_e_r_t_revocation_flags.html">CERTRevocationFlags</a>*
<a name="l01592"></a>01592 <a class="code" href="../../d7/d4a/cert_8h.html#a3446b21649323b7f4842b44ccbde0ee0">CERT_GetPKIXVerifyNistRevocationPolicy</a>(<span class="keywordtype">void</span>);
<a name="l01593"></a>01593 
<a name="l01594"></a>01594 <span class="comment">/*</span>
<a name="l01595"></a>01595 <span class="comment"> * Returns a pointer to a static structure.</span>
<a name="l01596"></a>01596 <span class="comment"> */</span>
<a name="l01597"></a>01597 <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="../../dd/df8/struct_c_e_r_t_revocation_flags.html">CERTRevocationFlags</a>*
<a name="l01598"></a>01598 <a class="code" href="../../d7/d4a/cert_8h.html#a7d6a987679713b9629af084bffc1e12d">CERT_GetClassicOCSPEnabledSoftFailurePolicy</a>(<span class="keywordtype">void</span>);
<a name="l01599"></a>01599 
<a name="l01600"></a>01600 <span class="comment">/*</span>
<a name="l01601"></a>01601 <span class="comment"> * Returns a pointer to a static structure.</span>
<a name="l01602"></a>01602 <span class="comment"> */</span>
<a name="l01603"></a>01603 <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="../../dd/df8/struct_c_e_r_t_revocation_flags.html">CERTRevocationFlags</a>*
<a name="l01604"></a>01604 <a class="code" href="../../d7/d4a/cert_8h.html#ae4239cd5d012f13067943807a5890094">CERT_GetClassicOCSPEnabledHardFailurePolicy</a>(<span class="keywordtype">void</span>);
<a name="l01605"></a>01605 
<a name="l01606"></a>01606 <span class="comment">/*</span>
<a name="l01607"></a>01607 <span class="comment"> * Returns a pointer to a static structure.</span>
<a name="l01608"></a>01608 <span class="comment"> */</span>
<a name="l01609"></a>01609 <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="../../dd/df8/struct_c_e_r_t_revocation_flags.html">CERTRevocationFlags</a>*
<a name="l01610"></a>01610 <a class="code" href="../../d7/d4a/cert_8h.html#acec61807e4013d0cfc2c5e8ccf479a64">CERT_GetClassicOCSPDisabledPolicy</a>(<span class="keywordtype">void</span>);
<a name="l01611"></a>01611 
<a name="l01612"></a>01612 <span class="comment">/*</span>
<a name="l01613"></a>01613 <span class="comment"> * Verify a Cert with libpkix</span>
<a name="l01614"></a>01614 <span class="comment"> *  paramsIn control the verification options. If a value isn&#39;t specified</span>
<a name="l01615"></a>01615 <span class="comment"> *   in paramsIn, it reverts to the application default.</span>
<a name="l01616"></a>01616 <span class="comment"> *  paramsOut specifies the parameters the caller would like to get back.</span>
<a name="l01617"></a>01617 <span class="comment"> *   the caller may pass NULL, in which case no parameters are returned.</span>
<a name="l01618"></a>01618 <span class="comment"> */</span>
<a name="l01619"></a>01619 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#a3aa237260d78c5e191ac48b3362bae44">CERT_PKIXVerifyCert</a>(
<a name="l01620"></a>01620     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *<a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">cert</a>,
<a name="l01621"></a>01621     <a class="code" href="../../d6/da5/certt_8h.html#aaacbfa750aba50da2e373e1187c79a16">SECCertificateUsage</a> usages,
<a name="l01622"></a>01622     <a class="code" href="../../df/d38/struct_c_e_r_t_val_in_param.html">CERTValInParam</a> *paramsIn,
<a name="l01623"></a>01623     <a class="code" href="../../db/de4/struct_c_e_r_t_val_out_param.html">CERTValOutParam</a> *paramsOut,
<a name="l01624"></a>01624     <span class="keywordtype">void</span> *wincx);
<a name="l01625"></a>01625 
<a name="l01626"></a>01626 <span class="comment">/* Makes old cert validation APIs(CERT_VerifyCert, CERT_VerifyCertificate)</span>
<a name="l01627"></a>01627 <span class="comment"> * to use libpkix validation engine. The function should be called ones at</span>
<a name="l01628"></a>01628 <span class="comment"> * application initialization time.</span>
<a name="l01629"></a>01629 <span class="comment"> * Function is not thread safe.*/</span>
<a name="l01630"></a>01630 <span class="keyword">extern</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> <a class="code" href="../../d7/d4a/cert_8h.html#ae0a26558156f63f4fdf7ef8b903c6233">CERT_SetUsePKIXForValidation</a>(<a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> <a class="code" href="../../dc/d5e/apps_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a2a4446f5372ecee1fc4c166220222130">enable</a>);
<a name="l01631"></a>01631 
<a name="l01632"></a>01632 <span class="comment">/* The function return PR_TRUE if cert validation should use</span>
<a name="l01633"></a>01633 <span class="comment"> * libpkix cert validation engine. */</span>
<a name="l01634"></a>01634 <span class="keyword">extern</span> <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a> <a class="code" href="../../d7/d4a/cert_8h.html#a6070441ead5ccbf05d237c90072faa87">CERT_GetUsePKIXForValidation</a>(<span class="keywordtype">void</span>);
<a name="l01635"></a>01635 
<a name="l01636"></a>01636 <span class="comment">/*</span>
<a name="l01637"></a>01637 <span class="comment"> * Allocate a parameter container of type CERTRevocationFlags,</span>
<a name="l01638"></a>01638 <span class="comment"> * and allocate the inner arrays of the given sizes.</span>
<a name="l01639"></a>01639 <span class="comment"> * To cleanup call CERT_DestroyCERTRevocationFlags.</span>
<a name="l01640"></a>01640 <span class="comment"> */</span>
<a name="l01641"></a>01641 <span class="keyword">extern</span> <a class="code" href="../../dd/df8/struct_c_e_r_t_revocation_flags.html">CERTRevocationFlags</a> *
<a name="l01642"></a>01642 <a class="code" href="../../d7/d4a/cert_8h.html#a419ec62d87648f2c43c49fb4102a79af">CERT_AllocCERTRevocationFlags</a>(
<a name="l01643"></a>01643     PRUint32 number_leaf_methods, PRUint32 number_leaf_pref_methods,
<a name="l01644"></a>01644     PRUint32 number_chain_methods, PRUint32 number_chain_pref_methods);
<a name="l01645"></a>01645 
<a name="l01646"></a>01646 <span class="comment">/*</span>
<a name="l01647"></a>01647 <span class="comment"> * Destroy the arrays inside flags,</span>
<a name="l01648"></a>01648 <span class="comment"> * and destroy the object pointed to by flags, too.</span>
<a name="l01649"></a>01649 <span class="comment"> */</span>
<a name="l01650"></a>01650 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l01651"></a>01651 <a class="code" href="../../d7/d4a/cert_8h.html#afc0eaaaac81858b718a452415ef5723d">CERT_DestroyCERTRevocationFlags</a>(<a class="code" href="../../dd/df8/struct_c_e_r_t_revocation_flags.html">CERTRevocationFlags</a> *<a class="code" href="../../da/d32/prio_8h.html#aa2585d779da0ab21273a8d92de9a0ebe">flags</a>);
<a name="l01652"></a>01652 
<a name="l01653"></a>01653 <a class="code" href="../../dc/d39/seccomon_8h.html#a0555b6f1e03b11506c9ef2d9803df396">SEC_END_PROTOS</a>
<a name="l01654"></a>01654 
<a name="l01655"></a>01655 <span class="preprocessor">#endif </span><span class="comment">/* _CERT_H_ */</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d7/d4a/cert_8h.html">cert.h</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:51:12に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
