<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: header.py ソースファイル</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('da/d64/header_8py.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">header.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d64/header_8py.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="../../d8/dbd/namespaceheader.html">00001</a> <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment"># header.py - Generate C++ header files from IDL.</span>
<a name="l00003"></a>00003 <span class="comment">#</span>
<a name="l00004"></a>00004 <span class="comment"># This Source Code Form is subject to the terms of the Mozilla Public</span>
<a name="l00005"></a>00005 <span class="comment"># License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a name="l00006"></a>00006 <span class="comment"># file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="stringliteral">&quot;&quot;&quot;Print a C++ header file for the IDL files specified on the command line&quot;&quot;&quot;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">import</span> sys, os.path, re, xpidl, itertools, glob
<a name="l00011"></a>00011 
<a name="l00012"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a174e62a0bd4dd70cb5c5a800154e711d">00012</a> printdoccomments = <span class="keyword">False</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keywordflow">if</span> printdoccomments:
<a name="l00015"></a><a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">00015</a>     <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, clist, indent):
<a name="l00016"></a>00016         <span class="keywordflow">for</span> c <span class="keywordflow">in</span> clist:
<a name="l00017"></a>00017             fd.write(<span class="stringliteral">&quot;%s%s\n&quot;</span> % (indent, c))
<a name="l00018"></a>00018 <span class="keywordflow">else</span>:
<a name="l00019"></a>00019     <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, clist, indent):
<a name="l00020"></a>00020         <span class="keywordflow">pass</span>
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aeb8363795535ab43b4fa02a35de5f3b1">00022</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#aeb8363795535ab43b4fa02a35de5f3b1">firstCap</a>(str):
<a name="l00023"></a>00023     <span class="keywordflow">return</span> str[0].upper() + str[1:]
<a name="l00024"></a>00024 
<a name="l00025"></a><a class="code" href="../../d8/dbd/namespaceheader.html#ab6928b01594ab380deabe36e6d5c05ce">00025</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#ab6928b01594ab380deabe36e6d5c05ce">attributeParamName</a>(a):
<a name="l00026"></a>00026     <span class="keywordflow">return</span> <span class="stringliteral">&quot;a&quot;</span> + <a class="code" href="../../d8/dbd/namespaceheader.html#aeb8363795535ab43b4fa02a35de5f3b1">firstCap</a>(a.name)
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a93b3cc402bb488f296f0991a24c00806">00028</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a93b3cc402bb488f296f0991a24c00806">attributeParamNames</a>(a):
<a name="l00029"></a>00029     l = [<a class="code" href="../../d8/dbd/namespaceheader.html#ab6928b01594ab380deabe36e6d5c05ce">attributeParamName</a>(a)]
<a name="l00030"></a>00030     <span class="keywordflow">if</span> a.implicit_jscontext:
<a name="l00031"></a>00031         l.insert(0, <span class="stringliteral">&quot;cx&quot;</span>)
<a name="l00032"></a>00032     <span class="keywordflow">return</span> <span class="stringliteral">&quot;, &quot;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(l)
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">00034</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(a, getter):
<a name="l00035"></a>00035     binaryname = a.binaryname <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> a.binaryname <span class="keywordflow">or</span> <a class="code" href="../../d8/dbd/namespaceheader.html#aeb8363795535ab43b4fa02a35de5f3b1">firstCap</a>(a.name)
<a name="l00036"></a>00036     <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s%s&quot;</span> % (getter <span class="keywordflow">and</span> <span class="stringliteral">&#39;Get&#39;</span> <span class="keywordflow">or</span> <span class="stringliteral">&#39;Set&#39;</span>, binaryname)
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a0e6fcdad58f5b0df8ed3e2b363c4baa0">00038</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a0e6fcdad58f5b0df8ed3e2b363c4baa0">attributeReturnType</a>(a, macro):
<a name="l00039"></a>00039     <span class="stringliteral">&quot;&quot;&quot;macro should be NS_IMETHOD or NS_IMETHODIMP&quot;&quot;&quot;</span>
<a name="l00040"></a>00040     <span class="keywordflow">if</span> (a.nostdcall):
<a name="l00041"></a>00041         <span class="keywordflow">return</span> macro == <span class="stringliteral">&quot;NS_IMETHOD&quot;</span> <span class="keywordflow">and</span> <span class="stringliteral">&quot;virtual nsresult&quot;</span> <span class="keywordflow">or</span> <span class="stringliteral">&quot;nsresult&quot;</span>
<a name="l00042"></a>00042     <span class="keywordflow">else</span>:
<a name="l00043"></a>00043         <span class="keywordflow">return</span> macro
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a9cb1934051471b880282d8d227517e34">00045</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a9cb1934051471b880282d8d227517e34">attributeParamlist</a>(a, getter):
<a name="l00046"></a>00046     l = [<span class="stringliteral">&quot;%s%s&quot;</span> % (a.realtype.nativeType(getter <span class="keywordflow">and</span> <span class="stringliteral">&#39;out&#39;</span> <span class="keywordflow">or</span> <span class="stringliteral">&#39;in&#39;</span>),
<a name="l00047"></a>00047                    <a class="code" href="../../d8/dbd/namespaceheader.html#ab6928b01594ab380deabe36e6d5c05ce">attributeParamName</a>(a))]
<a name="l00048"></a>00048     <span class="keywordflow">if</span> a.implicit_jscontext:
<a name="l00049"></a>00049         l.insert(0, <span class="stringliteral">&quot;JSContext* cx&quot;</span>)
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <span class="keywordflow">return</span> <span class="stringliteral">&quot;, &quot;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(l)
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">00053</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(a, getter):
<a name="l00054"></a>00054         deprecated = a.deprecated <span class="keywordflow">and</span> <span class="stringliteral">&quot;NS_DEPRECATED &quot;</span> <span class="keywordflow">or</span> <span class="stringliteral">&quot;&quot;</span>
<a name="l00055"></a>00055         params = {<span class="stringliteral">&#39;deprecated&#39;</span>: deprecated,
<a name="l00056"></a>00056                   <span class="stringliteral">&#39;returntype&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a0e6fcdad58f5b0df8ed3e2b363c4baa0">attributeReturnType</a>(a, <span class="stringliteral">&#39;NS_IMETHOD&#39;</span>),
<a name="l00057"></a>00057                   <span class="stringliteral">&#39;binaryname&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(a, getter),
<a name="l00058"></a>00058                   <span class="stringliteral">&#39;paramlist&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a9cb1934051471b880282d8d227517e34">attributeParamlist</a>(a, getter)}
<a name="l00059"></a>00059         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%(deprecated)s%(returntype)s %(binaryname)s(%(paramlist)s)&quot;</span> % params
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aa39b1e958c028c54bd2615eefd3b5bcd">00061</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#aa39b1e958c028c54bd2615eefd3b5bcd">methodNativeName</a>(m):
<a name="l00062"></a>00062     <span class="keywordflow">return</span> m.binaryname <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> m.binaryname <span class="keywordflow">or</span> <a class="code" href="../../d8/dbd/namespaceheader.html#aeb8363795535ab43b4fa02a35de5f3b1">firstCap</a>(m.name)
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a18d3ec0b7a86d3c987a3097199d92fc1">00064</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a18d3ec0b7a86d3c987a3097199d92fc1">methodReturnType</a>(m, macro):
<a name="l00065"></a>00065     <span class="stringliteral">&quot;&quot;&quot;macro should be NS_IMETHOD or NS_IMETHODIMP&quot;&quot;&quot;</span>
<a name="l00066"></a>00066     <span class="keywordflow">if</span> m.nostdcall <span class="keywordflow">and</span> m.notxpcom:
<a name="l00067"></a>00067         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s%s&quot;</span> % (macro == <span class="stringliteral">&quot;NS_IMETHOD&quot;</span> <span class="keywordflow">and</span> <span class="stringliteral">&quot;virtual &quot;</span> <span class="keywordflow">or</span> <span class="stringliteral">&quot;&quot;</span>,
<a name="l00068"></a>00068                          m.realtype.nativeType(<span class="stringliteral">&#39;in&#39;</span>).strip())
<a name="l00069"></a>00069     <span class="keywordflow">elif</span> m.nostdcall:
<a name="l00070"></a>00070         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%snsresult&quot;</span> % (macro == <span class="stringliteral">&quot;NS_IMETHOD&quot;</span> <span class="keywordflow">and</span> <span class="stringliteral">&quot;virtual &quot;</span> <span class="keywordflow">or</span> <span class="stringliteral">&quot;&quot;</span>)
<a name="l00071"></a>00071     <span class="keywordflow">elif</span> m.notxpcom:
<a name="l00072"></a>00072         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s_(%s)&quot;</span> % (macro, m.realtype.nativeType(<span class="stringliteral">&#39;in&#39;</span>).strip())
<a name="l00073"></a>00073     <span class="keywordflow">else</span>:
<a name="l00074"></a>00074         <span class="keywordflow">return</span> macro
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a6e5c039a96d9f39b239c5c8232ac9bae">00076</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a6e5c039a96d9f39b239c5c8232ac9bae">methodAsNative</a>(m):
<a name="l00077"></a>00077     <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s %s(%s)&quot;</span> % (<a class="code" href="../../d8/dbd/namespaceheader.html#a18d3ec0b7a86d3c987a3097199d92fc1">methodReturnType</a>(m, <span class="stringliteral">&#39;NS_IMETHOD&#39;</span>),
<a name="l00078"></a>00078                           <a class="code" href="../../d8/dbd/namespaceheader.html#aa39b1e958c028c54bd2615eefd3b5bcd">methodNativeName</a>(m),
<a name="l00079"></a>00079                           <a class="code" href="../../d8/dbd/namespaceheader.html#a8c6b443ae6a79936a552e56afc805fae">paramlistAsNative</a>(m))
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a8c6b443ae6a79936a552e56afc805fae">00081</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a8c6b443ae6a79936a552e56afc805fae">paramlistAsNative</a>(m, empty=&#39;void&#39;):
<a name="l00082"></a>00082     l = [<a class="code" href="../../d8/dbd/namespaceheader.html#ad8ad1e2f22235e17fcc2a9e2d17f1fcd">paramAsNative</a>(p) <span class="keywordflow">for</span> p <span class="keywordflow">in</span> m.params]
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     <span class="keywordflow">if</span> m.implicit_jscontext:
<a name="l00085"></a>00085         l.append(<span class="stringliteral">&quot;JSContext* cx&quot;</span>)
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     <span class="keywordflow">if</span> m.optional_argc:
<a name="l00088"></a>00088         l.append(<span class="stringliteral">&#39;uint8_t _argc&#39;</span>)
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="keywordflow">if</span> <span class="keywordflow">not</span> m.notxpcom <span class="keywordflow">and</span> m.realtype.name != <span class="stringliteral">&#39;void&#39;</span>:
<a name="l00091"></a>00091         l.append(<a class="code" href="../../d8/dbd/namespaceheader.html#ad8ad1e2f22235e17fcc2a9e2d17f1fcd">paramAsNative</a>(xpidl.Param(paramtype=<span class="stringliteral">&#39;out&#39;</span>,
<a name="l00092"></a>00092                                            type=<span class="keywordtype">None</span>,
<a name="l00093"></a>00093                                            name=<span class="stringliteral">&#39;_retval&#39;</span>,
<a name="l00094"></a>00094                                            attlist=[],
<a name="l00095"></a>00095                                            location=<span class="keywordtype">None</span>,
<a name="l00096"></a>00096                                            realtype=m.realtype)))
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <span class="keywordflow">if</span> len(l) == 0:
<a name="l00099"></a>00099         <span class="keywordflow">return</span> empty
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <span class="keywordflow">return</span> <span class="stringliteral">&quot;, &quot;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(l)
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="../../d8/dbd/namespaceheader.html#ad8ad1e2f22235e17fcc2a9e2d17f1fcd">00103</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#ad8ad1e2f22235e17fcc2a9e2d17f1fcd">paramAsNative</a>(p):
<a name="l00104"></a>00104     <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s%s&quot;</span> % (p.nativeType(),
<a name="l00105"></a>00105                      p.name)
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a159a961a36b524ce4b54fa1c31ba6dcb">00107</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a159a961a36b524ce4b54fa1c31ba6dcb">paramlistNames</a>(m):
<a name="l00108"></a>00108     names = [p.name <span class="keywordflow">for</span> p <span class="keywordflow">in</span> m.params]
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="keywordflow">if</span> m.implicit_jscontext:
<a name="l00111"></a>00111         names.append(<span class="stringliteral">&#39;cx&#39;</span>)
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     <span class="keywordflow">if</span> m.optional_argc:
<a name="l00114"></a>00114         names.append(<span class="stringliteral">&#39;_argc&#39;</span>)
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="keywordflow">if</span> <span class="keywordflow">not</span> m.notxpcom <span class="keywordflow">and</span> m.realtype.name != <span class="stringliteral">&#39;void&#39;</span>:
<a name="l00117"></a>00117         names.append(<span class="stringliteral">&#39;_retval&#39;</span>)
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="keywordflow">if</span> len(names) == 0:
<a name="l00120"></a>00120         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>
<a name="l00121"></a>00121     <span class="keywordflow">return</span> <span class="stringliteral">&#39;, &#39;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(names)
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aa5b53e6fddfb0e2e76fa4f5cf837317b">00123</a> header = <span class="stringliteral">&quot;&quot;&quot;/*</span>
<a name="l00124"></a>00124 <span class="stringliteral"> * DO NOT EDIT.  THIS FILE IS GENERATED FROM %(filename)s</span>
<a name="l00125"></a>00125 <span class="stringliteral"> */</span>
<a name="l00126"></a>00126 <span class="stringliteral"></span>
<a name="l00127"></a>00127 <span class="stringliteral">#ifndef __gen_%(basename)s_h__</span>
<a name="l00128"></a>00128 <span class="stringliteral">#define __gen_%(basename)s_h__</span>
<a name="l00129"></a>00129 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a6f9ec483f4e1742b19181c9e9950f70b">00131</a> include = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00132"></a>00132 <span class="stringliteral">#ifndef __gen_%(basename)s_h__</span>
<a name="l00133"></a>00133 <span class="stringliteral">#include &quot;%(basename)s.h&quot;</span>
<a name="l00134"></a>00134 <span class="stringliteral">#endif</span>
<a name="l00135"></a>00135 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="../../d8/dbd/namespaceheader.html#affd0bed51708adb5349048a5e5754ccf">00137</a> jspubtd_include = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00138"></a>00138 <span class="stringliteral">#include &quot;jspubtd.h&quot;</span>
<a name="l00139"></a>00139 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a334894b91d7823297fed0dbc253f65cc">00141</a> infallible_includes = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00142"></a>00142 <span class="stringliteral">#include &quot;mozilla/Assertions.h&quot;</span>
<a name="l00143"></a>00143 <span class="stringliteral">#include &quot;mozilla/DebugOnly.h&quot;</span>
<a name="l00144"></a>00144 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a9000ca4cc2f5c378756be576384cc2ec">00146</a> header_end = <span class="stringliteral">&quot;&quot;&quot;/* For IDL files that don&#39;t want to include root IDL files. */</span>
<a name="l00147"></a>00147 <span class="stringliteral">#ifndef NS_NO_VTABLE</span>
<a name="l00148"></a>00148 <span class="stringliteral">#define NS_NO_VTABLE</span>
<a name="l00149"></a>00149 <span class="stringliteral">#endif</span>
<a name="l00150"></a>00150 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="../../d8/dbd/namespaceheader.html#afe00376f18b4e60020189cf2be959497">00152</a> footer = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00153"></a>00153 <span class="stringliteral">#endif /* __gen_%(basename)s_h__ */</span>
<a name="l00154"></a>00154 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a65f88116ddd52e08b20307ffb2d1d388">00156</a> forward_decl = <span class="stringliteral">&quot;&quot;&quot;class %(name)s; /* forward declaration */</span>
<a name="l00157"></a>00157 <span class="stringliteral"></span>
<a name="l00158"></a>00158 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a6a789118cd3ccf4816b8b4e273eff46e">00160</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a6a789118cd3ccf4816b8b4e273eff46e">idl_basename</a>(f):
<a name="l00161"></a>00161     <span class="stringliteral">&quot;&quot;&quot;returns the base name of a file with the last extension stripped&quot;&quot;&quot;</span>
<a name="l00162"></a>00162     <span class="keywordflow">return</span> os.path.basename(f).rpartition(<span class="stringliteral">&#39;.&#39;</span>)[0]
<a name="l00163"></a>00163 
<a name="l00164"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a9b6d35c5d78b3e938143567111d9a5ef">00164</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#a9b6d35c5d78b3e938143567111d9a5ef">print_header</a>(idl, fd, filename):
<a name="l00165"></a>00165     fd.write(header % {<span class="stringliteral">&#39;filename&#39;</span>: filename,
<a name="l00166"></a>00166                        <span class="stringliteral">&#39;basename&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a6a789118cd3ccf4816b8b4e273eff46e">idl_basename</a>(filename)})
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     foundinc = <span class="keyword">False</span>
<a name="l00169"></a>00169     <span class="keywordflow">for</span> inc <span class="keywordflow">in</span> idl.includes():
<a name="l00170"></a>00170         <span class="keywordflow">if</span> <span class="keywordflow">not</span> foundinc:
<a name="l00171"></a>00171             foundinc = <span class="keyword">True</span>
<a name="l00172"></a>00172             fd.write(<span class="stringliteral">&#39;\n&#39;</span>)
<a name="l00173"></a>00173         fd.write(include % {<span class="stringliteral">&#39;basename&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a6a789118cd3ccf4816b8b4e273eff46e">idl_basename</a>(inc.filename)})
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="keywordflow">if</span> idl.needsJSTypes():
<a name="l00176"></a>00176         fd.write(jspubtd_include)
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="comment"># Include some extra files if any attributes are infallible.</span>
<a name="l00179"></a>00179     <span class="keywordflow">for</span> iface <span class="keywordflow">in</span> [p <span class="keywordflow">for</span> p <span class="keywordflow">in</span> idl.productions <span class="keywordflow">if</span> p.kind == <span class="stringliteral">&#39;interface&#39;</span>]:
<a name="l00180"></a>00180         <span class="keywordflow">for</span> attr <span class="keywordflow">in</span> [m <span class="keywordflow">for</span> m <span class="keywordflow">in</span> iface.members <span class="keywordflow">if</span> isinstance(m, xpidl.Attribute)]:
<a name="l00181"></a>00181             <span class="keywordflow">if</span> attr.infallible:
<a name="l00182"></a>00182                 fd.write(infallible_includes)
<a name="l00183"></a>00183                 <span class="keywordflow">break</span>
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     fd.write(<span class="stringliteral">&#39;\n&#39;</span>)
<a name="l00186"></a>00186     fd.write(header_end)
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="keywordflow">for</span> p <span class="keywordflow">in</span> idl.productions:
<a name="l00189"></a>00189         <span class="keywordflow">if</span> p.kind == <span class="stringliteral">&#39;include&#39;</span>: <span class="keywordflow">continue</span>
<a name="l00190"></a>00190         <span class="keywordflow">if</span> p.kind == <span class="stringliteral">&#39;cdata&#39;</span>:
<a name="l00191"></a>00191             fd.write(p.data)
<a name="l00192"></a>00192             <span class="keywordflow">continue</span>
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         <span class="keywordflow">if</span> p.kind == <span class="stringliteral">&#39;forward&#39;</span>:
<a name="l00195"></a>00195             fd.write(forward_decl % {<span class="stringliteral">&#39;name&#39;</span>: p.name})
<a name="l00196"></a>00196             <span class="keywordflow">continue</span>
<a name="l00197"></a>00197         <span class="keywordflow">if</span> p.kind == <span class="stringliteral">&#39;interface&#39;</span>:
<a name="l00198"></a>00198             <a class="code" href="../../d8/dbd/namespaceheader.html#aa9fde647882ba441282df5e442e6e51f">write_interface</a>(p, fd)
<a name="l00199"></a>00199             <span class="keywordflow">continue</span>
<a name="l00200"></a>00200         <span class="keywordflow">if</span> p.kind == <span class="stringliteral">&#39;typedef&#39;</span>:
<a name="l00201"></a>00201             <a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, p.doccomments, <span class="stringliteral">&#39;&#39;</span>)
<a name="l00202"></a>00202             fd.write(<span class="stringliteral">&quot;typedef %s %s;\n\n&quot;</span> % (p.realtype.nativeType(<span class="stringliteral">&#39;in&#39;</span>),
<a name="l00203"></a>00203                                              p.name))
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     fd.write(footer % {<span class="stringliteral">&#39;basename&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a6a789118cd3ccf4816b8b4e273eff46e">idl_basename</a>(filename)})
<a name="l00206"></a>00206 
<a name="l00207"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aed9860d3c0f9709d8a6a5254943cfde3">00207</a> iface_header = <span class="stringliteral">r&quot;&quot;&quot;</span>
<a name="l00208"></a>00208 <span class="stringliteral">/* starting interface:    %(name)s */</span>
<a name="l00209"></a>00209 <span class="stringliteral">#define %(defname)s_IID_STR &quot;%(iid)s&quot;</span>
<a name="l00210"></a>00210 <span class="stringliteral"></span>
<a name="l00211"></a>00211 <span class="stringliteral">#define %(defname)s_IID \</span>
<a name="l00212"></a>00212 <span class="stringliteral">  {0x%(m0)s, 0x%(m1)s, 0x%(m2)s, \</span>
<a name="l00213"></a>00213 <span class="stringliteral">    { %(m3joined)s }}</span>
<a name="l00214"></a>00214 <span class="stringliteral"></span>
<a name="l00215"></a>00215 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00216"></a>00216 
<a name="l00217"></a><a class="code" href="../../d8/dbd/namespaceheader.html#ac67cde15f38a6316d4ec38217d5519b2">00217</a> uuid_decoder = re.compile(<span class="stringliteral">r&quot;&quot;&quot;(?P&lt;m0&gt;[a-f0-9]{8})-</span>
<a name="l00218"></a>00218 <span class="stringliteral">                              (?P&lt;m1&gt;[a-f0-9]{4})-</span>
<a name="l00219"></a>00219 <span class="stringliteral">                              (?P&lt;m2&gt;[a-f0-9]{4})-</span>
<a name="l00220"></a>00220 <span class="stringliteral">                              (?P&lt;m3&gt;[a-f0-9]{4})-</span>
<a name="l00221"></a>00221 <span class="stringliteral">                              (?P&lt;m4&gt;[a-f0-9]{12})$&quot;&quot;&quot;</span>, re.X)
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a631a2ec38d81c816f123962ae9e97f03">00223</a> iface_prolog = <span class="stringliteral">&quot;&quot;&quot; {</span>
<a name="l00224"></a>00224 <span class="stringliteral"> public: </span>
<a name="l00225"></a>00225 <span class="stringliteral"></span>
<a name="l00226"></a>00226 <span class="stringliteral">  NS_DECLARE_STATIC_IID_ACCESSOR(%(defname)s_IID)</span>
<a name="l00227"></a>00227 <span class="stringliteral"></span>
<a name="l00228"></a>00228 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a6023e663add5a9e044fea89700ca8dea">00230</a> iface_epilog = <span class="stringliteral">&quot;&quot;&quot;};</span>
<a name="l00231"></a>00231 <span class="stringliteral"></span>
<a name="l00232"></a>00232 <span class="stringliteral">  NS_DEFINE_STATIC_IID_ACCESSOR(%(name)s, %(defname)s_IID)</span>
<a name="l00233"></a>00233 <span class="stringliteral"></span>
<a name="l00234"></a>00234 <span class="stringliteral">/* Use this macro when declaring classes that implement this interface. */</span>
<a name="l00235"></a>00235 <span class="stringliteral">#define NS_DECL_%(macroname)s &quot;&quot;&quot;</span>
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a4adae0847164545d27ba90cddfc9ed7b">00238</a> iface_forward = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00239"></a>00239 <span class="stringliteral"></span>
<a name="l00240"></a>00240 <span class="stringliteral">/* Use this macro to declare functions that forward the behavior of this interface to another object. */</span>
<a name="l00241"></a>00241 <span class="stringliteral">#define NS_FORWARD_%(macroname)s(_to) &quot;&quot;&quot;</span>
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="../../d8/dbd/namespaceheader.html#ae17b7437ef6072f46eacbf91e2fb82b0">00243</a> iface_forward_safe = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00244"></a>00244 <span class="stringliteral"></span>
<a name="l00245"></a>00245 <span class="stringliteral">/* Use this macro to declare functions that forward the behavior of this interface to another object in a safe way. */</span>
<a name="l00246"></a>00246 <span class="stringliteral">#define NS_FORWARD_SAFE_%(macroname)s(_to) &quot;&quot;&quot;</span>
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a1374a24b24763a98cb877c452e6ba289">00248</a> iface_template_prolog = <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00249"></a>00249 <span class="stringliteral"></span>
<a name="l00250"></a>00250 <span class="stringliteral">#if 0</span>
<a name="l00251"></a>00251 <span class="stringliteral">/* Use the code below as a template for the implementation class for this interface. */</span>
<a name="l00252"></a>00252 <span class="stringliteral"></span>
<a name="l00253"></a>00253 <span class="stringliteral">/* Header file */</span>
<a name="l00254"></a>00254 <span class="stringliteral">class %(implclass)s : public %(name)s</span>
<a name="l00255"></a>00255 <span class="stringliteral">{</span>
<a name="l00256"></a>00256 <span class="stringliteral">public:</span>
<a name="l00257"></a>00257 <span class="stringliteral">  NS_DECL_ISUPPORTS</span>
<a name="l00258"></a>00258 <span class="stringliteral">  NS_DECL_%(macroname)s</span>
<a name="l00259"></a>00259 <span class="stringliteral"></span>
<a name="l00260"></a>00260 <span class="stringliteral">  %(implclass)s();</span>
<a name="l00261"></a>00261 <span class="stringliteral"></span>
<a name="l00262"></a>00262 <span class="stringliteral">private:</span>
<a name="l00263"></a>00263 <span class="stringliteral">  ~%(implclass)s();</span>
<a name="l00264"></a>00264 <span class="stringliteral"></span>
<a name="l00265"></a>00265 <span class="stringliteral">protected:</span>
<a name="l00266"></a>00266 <span class="stringliteral">  /* additional members */</span>
<a name="l00267"></a>00267 <span class="stringliteral">};</span>
<a name="l00268"></a>00268 <span class="stringliteral"></span>
<a name="l00269"></a>00269 <span class="stringliteral">/* Implementation file */</span>
<a name="l00270"></a>00270 <span class="stringliteral">NS_IMPL_ISUPPORTS1(%(implclass)s, %(name)s)</span>
<a name="l00271"></a>00271 <span class="stringliteral"></span>
<a name="l00272"></a>00272 <span class="stringliteral">%(implclass)s::%(implclass)s()</span>
<a name="l00273"></a>00273 <span class="stringliteral">{</span>
<a name="l00274"></a>00274 <span class="stringliteral">  /* member initializers and constructor code */</span>
<a name="l00275"></a>00275 <span class="stringliteral">}</span>
<a name="l00276"></a>00276 <span class="stringliteral"></span>
<a name="l00277"></a>00277 <span class="stringliteral">%(implclass)s::~%(implclass)s()</span>
<a name="l00278"></a>00278 <span class="stringliteral">{</span>
<a name="l00279"></a>00279 <span class="stringliteral">  /* destructor code */</span>
<a name="l00280"></a>00280 <span class="stringliteral">}</span>
<a name="l00281"></a>00281 <span class="stringliteral"></span>
<a name="l00282"></a>00282 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00283"></a>00283 
<a name="l00284"></a><a class="code" href="../../d8/dbd/namespaceheader.html#ac9e0ed58e76f77bc7b801cda383c8430">00284</a> example_tmpl = <span class="stringliteral">&quot;&quot;&quot;%(returntype)s %(implclass)s::%(nativeName)s(%(paramList)s)</span>
<a name="l00285"></a>00285 <span class="stringliteral">{</span>
<a name="l00286"></a>00286 <span class="stringliteral">    return NS_ERROR_NOT_IMPLEMENTED;</span>
<a name="l00287"></a>00287 <span class="stringliteral">}</span>
<a name="l00288"></a>00288 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00289"></a>00289 
<a name="l00290"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a5402d583f604d20dd6aeb60530725dde">00290</a> iface_template_epilog = <span class="stringliteral">&quot;&quot;&quot;/* End of implementation class template. */</span>
<a name="l00291"></a>00291 <span class="stringliteral">#endif</span>
<a name="l00292"></a>00292 <span class="stringliteral"></span>
<a name="l00293"></a>00293 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a8e07a1a736701643fae3b8fd70395814">00295</a> attr_infallible_tmpl = <span class="stringliteral">&quot;&quot;&quot;\</span>
<a name="l00296"></a>00296 <span class="stringliteral">  inline %(realtype)s%(nativename)s(%(args)s)</span>
<a name="l00297"></a>00297 <span class="stringliteral">  {</span>
<a name="l00298"></a>00298 <span class="stringliteral">    %(realtype)sresult;</span>
<a name="l00299"></a>00299 <span class="stringliteral">    mozilla::DebugOnly&lt;nsresult&gt; rv = %(nativename)s(%(argnames)s&amp;result);</span>
<a name="l00300"></a>00300 <span class="stringliteral">    MOZ_ASSERT(NS_SUCCEEDED(rv));</span>
<a name="l00301"></a>00301 <span class="stringliteral">    return result;</span>
<a name="l00302"></a>00302 <span class="stringliteral">  }</span>
<a name="l00303"></a>00303 <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00304"></a>00304 
<a name="l00305"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aa9fde647882ba441282df5e442e6e51f">00305</a> <span class="keyword">def </span><a class="code" href="../../d8/dbd/namespaceheader.html#aa9fde647882ba441282df5e442e6e51f">write_interface</a>(iface, fd):
<a name="l00306"></a>00306     <span class="keywordflow">if</span> iface.namemap <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l00307"></a>00307         <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Interface was not resolved.&quot;</span>)
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     <span class="keyword">def </span>write_const_decls(g):
<a name="l00310"></a>00310         fd.write(<span class="stringliteral">&quot;  enum {\n&quot;</span>)
<a name="l00311"></a>00311         enums = []
<a name="l00312"></a>00312         <span class="keywordflow">for</span> c <span class="keywordflow">in</span> g:
<a name="l00313"></a>00313             <a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, c.doccomments, <span class="stringliteral">&#39;  &#39;</span>)
<a name="l00314"></a>00314             basetype = c.basetype
<a name="l00315"></a>00315             value = c.getValue()
<a name="l00316"></a>00316             enums.append(<span class="stringliteral">&quot;    %(name)s = %(value)s%(signed)s&quot;</span> % {
<a name="l00317"></a>00317                          <span class="stringliteral">&#39;name&#39;</span>: c.name,
<a name="l00318"></a>00318                          <span class="stringliteral">&#39;value&#39;</span>: value,
<a name="l00319"></a>00319                          <span class="stringliteral">&#39;signed&#39;</span>: (<span class="keywordflow">not</span> basetype.signed) <span class="keywordflow">and</span> <span class="stringliteral">&#39;</span><span class="stringliteral">U&#39; or &#39;</span>&#39;})
<a name="l00320"></a>00320         fd.write(<span class="stringliteral">&quot;,\n&quot;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(enums))
<a name="l00321"></a>00321         fd.write(<span class="stringliteral">&quot;\n  };\n\n&quot;</span>)
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="keyword">def </span>write_method_decl(m):
<a name="l00324"></a>00324         <a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, m.doccomments, <span class="stringliteral">&#39;  &#39;</span>)
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         fd.write(<span class="stringliteral">&quot;  /* %s */\n&quot;</span> % m.toIDL())
<a name="l00327"></a>00327         fd.write(<span class="stringliteral">&quot;  %s = 0;\n\n&quot;</span> % <a class="code" href="../../d8/dbd/namespaceheader.html#a6e5c039a96d9f39b239c5c8232ac9bae">methodAsNative</a>(m))
<a name="l00328"></a>00328                                                                            
<a name="l00329"></a>00329     <span class="keyword">def </span>write_attr_decl(a):
<a name="l00330"></a>00330         <a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, a.doccomments, <span class="stringliteral">&#39;  &#39;</span>)
<a name="l00331"></a>00331 
<a name="l00332"></a>00332         fd.write(<span class="stringliteral">&quot;  /* %s */\n&quot;</span> % a.toIDL());
<a name="l00333"></a>00333 
<a name="l00334"></a>00334         fd.write(<span class="stringliteral">&quot;  %s = 0;\n&quot;</span> % <a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(a, <span class="keyword">True</span>))
<a name="l00335"></a>00335         <span class="keywordflow">if</span> a.infallible:
<a name="l00336"></a>00336             fd.write(attr_infallible_tmpl %
<a name="l00337"></a>00337                      {<span class="stringliteral">&#39;realtype&#39;</span>: a.realtype.nativeType(<span class="stringliteral">&#39;in&#39;</span>),
<a name="l00338"></a>00338                       <span class="stringliteral">&#39;nativename&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(a, getter=<span class="keyword">True</span>),
<a name="l00339"></a>00339                       <span class="stringliteral">&#39;args&#39;</span>: <span class="stringliteral">&#39;&#39;</span> <span class="keywordflow">if</span> <span class="keywordflow">not</span> a.implicit_jscontext <span class="keywordflow">else</span> <span class="stringliteral">&#39;JSContext* cx&#39;</span>,
<a name="l00340"></a>00340                       <span class="stringliteral">&#39;argnames&#39;</span>: <span class="stringliteral">&#39;&#39;</span> <span class="keywordflow">if</span> <span class="keywordflow">not</span> a.implicit_jscontext <span class="keywordflow">else</span> <span class="stringliteral">&#39;cx, &#39;</span>})
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <span class="keywordflow">if</span> <span class="keywordflow">not</span> a.readonly:
<a name="l00343"></a>00343             fd.write(<span class="stringliteral">&quot;  %s = 0;\n&quot;</span> % <a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(a, <span class="keyword">False</span>))
<a name="l00344"></a>00344         fd.write(<span class="stringliteral">&quot;\n&quot;</span>)
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     defname = iface.name.upper()
<a name="l00347"></a>00347     <span class="keywordflow">if</span> iface.name[0:2] == <span class="stringliteral">&#39;ns&#39;</span>:
<a name="l00348"></a>00348         defname = <span class="stringliteral">&#39;NS_&#39;</span> + defname[2:]
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     names = uuid_decoder.match(iface.attributes.uuid).groupdict()
<a name="l00351"></a>00351     m3str = names[<span class="stringliteral">&#39;m3&#39;</span>] + names[<span class="stringliteral">&#39;m4&#39;</span>]
<a name="l00352"></a>00352     names[<span class="stringliteral">&#39;m3joined&#39;</span>] = <span class="stringliteral">&quot;, &quot;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>([<span class="stringliteral">&quot;0x%s&quot;</span> % m3str[i:i+2] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(0, 16, 2)])
<a name="l00353"></a>00353 
<a name="l00354"></a>00354     <span class="keywordflow">if</span> iface.name[2] == <span class="stringliteral">&#39;I&#39;</span>:
<a name="l00355"></a>00355         implclass = iface.name[:2] + iface.name[3:]
<a name="l00356"></a>00356     <span class="keywordflow">else</span>:
<a name="l00357"></a>00357         implclass = <span class="stringliteral">&#39;_MYCLASS_&#39;</span>
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     names.update({<span class="stringliteral">&#39;defname&#39;</span>: defname,
<a name="l00360"></a>00360                   <span class="stringliteral">&#39;macroname&#39;</span>: iface.name.upper(),
<a name="l00361"></a>00361                   <span class="stringliteral">&#39;name&#39;</span>: iface.name,
<a name="l00362"></a>00362                   <span class="stringliteral">&#39;iid&#39;</span>: iface.attributes.uuid,
<a name="l00363"></a>00363                   <span class="stringliteral">&#39;implclass&#39;</span>: implclass})
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     fd.write(iface_header % names)
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     <a class="code" href="../../d8/dbd/namespaceheader.html#af799c1b56fe2fa99dea4419ff5f2e5a8">printComments</a>(fd, iface.doccomments, <span class="stringliteral">&#39;&#39;</span>)
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     fd.write(<span class="stringliteral">&quot;class &quot;</span>)
<a name="l00370"></a>00370     foundcdata = <span class="keyword">False</span>
<a name="l00371"></a>00371     <span class="keywordflow">for</span> m <span class="keywordflow">in</span> iface.members:
<a name="l00372"></a>00372         <span class="keywordflow">if</span> isinstance(m, xpidl.CDATA):
<a name="l00373"></a>00373             foundcdata = <span class="keyword">True</span>
<a name="l00374"></a>00374 
<a name="l00375"></a>00375     <span class="keywordflow">if</span> <span class="keywordflow">not</span> foundcdata:
<a name="l00376"></a>00376         fd.write(<span class="stringliteral">&quot;NS_NO_VTABLE &quot;</span>)
<a name="l00377"></a>00377 
<a name="l00378"></a>00378     <span class="keywordflow">if</span> iface.attributes.deprecated:
<a name="l00379"></a>00379         fd.write(<span class="stringliteral">&quot;MOZ_DEPRECATED &quot;</span>)
<a name="l00380"></a>00380     fd.write(iface.name)
<a name="l00381"></a>00381     <span class="keywordflow">if</span> iface.base:
<a name="l00382"></a>00382         fd.write(<span class="stringliteral">&quot; : public %s&quot;</span> % iface.base)
<a name="l00383"></a>00383     fd.write(iface_prolog % names)
<a name="l00384"></a>00384 
<a name="l00385"></a>00385     <span class="keywordflow">for</span> key, group <span class="keywordflow">in</span> itertools.groupby(iface.members, key=type):
<a name="l00386"></a>00386         <span class="keywordflow">if</span> key == xpidl.ConstMember:
<a name="l00387"></a>00387             write_const_decls(group) <span class="comment"># iterator of all the consts</span>
<a name="l00388"></a>00388         <span class="keywordflow">else</span>:
<a name="l00389"></a>00389             <span class="keywordflow">for</span> member <span class="keywordflow">in</span> group:
<a name="l00390"></a>00390                 <span class="keywordflow">if</span> key == xpidl.Attribute:
<a name="l00391"></a>00391                     write_attr_decl(member)
<a name="l00392"></a>00392                 <span class="keywordflow">elif</span> key == xpidl.Method:
<a name="l00393"></a>00393                     write_method_decl(member)
<a name="l00394"></a>00394                 <span class="keywordflow">elif</span> key == xpidl.CDATA:
<a name="l00395"></a>00395                     fd.write(<span class="stringliteral">&quot; %s&quot;</span> % member.data)
<a name="l00396"></a>00396                 <span class="keywordflow">else</span>:
<a name="l00397"></a>00397                     <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Unexpected interface member: %s&quot;</span> % member)
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     fd.write(iface_epilog % names)
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="keywordflow">for</span> member <span class="keywordflow">in</span> iface.members:
<a name="l00402"></a>00402         <span class="keywordflow">if</span> isinstance(member, xpidl.Attribute):
<a name="l00403"></a>00403             fd.write(<span class="stringliteral">&quot;\\\n  %s; &quot;</span> % <a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(member, <span class="keyword">True</span>))
<a name="l00404"></a>00404             <span class="keywordflow">if</span> <span class="keywordflow">not</span> member.readonly:
<a name="l00405"></a>00405                 fd.write(<span class="stringliteral">&quot;\\\n  %s; &quot;</span> % <a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(member, <span class="keyword">False</span>))
<a name="l00406"></a>00406         <span class="keywordflow">elif</span> isinstance(member, xpidl.Method):
<a name="l00407"></a>00407             fd.write(<span class="stringliteral">&quot;\\\n  %s; &quot;</span> % <a class="code" href="../../d8/dbd/namespaceheader.html#a6e5c039a96d9f39b239c5c8232ac9bae">methodAsNative</a>(member))
<a name="l00408"></a>00408     <span class="keywordflow">if</span> len(iface.members) == 0:
<a name="l00409"></a>00409         fd.write(<span class="stringliteral">&#39;\\\n  /* no methods! */&#39;</span>)
<a name="l00410"></a>00410     <span class="keywordflow">elif</span> <span class="keywordflow">not</span> member.kind <span class="keywordflow">in</span> (<span class="stringliteral">&#39;attribute&#39;</span>, <span class="stringliteral">&#39;method&#39;</span>):
<a name="l00411"></a>00411        fd.write(<span class="stringliteral">&#39;\\&#39;</span>)
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     fd.write(iface_forward % names)
<a name="l00414"></a>00414 
<a name="l00415"></a>00415     <span class="keyword">def </span>emitTemplate(tmpl, tmpl_notxpcom=None):
<a name="l00416"></a>00416         <span class="keywordflow">if</span> tmpl_notxpcom == <span class="keywordtype">None</span>:
<a name="l00417"></a>00417             tmpl_notxpcom = tmpl
<a name="l00418"></a>00418         <span class="keywordflow">for</span> member <span class="keywordflow">in</span> iface.members:
<a name="l00419"></a>00419             <span class="keywordflow">if</span> isinstance(member, xpidl.Attribute):
<a name="l00420"></a>00420                 fd.write(tmpl % {<span class="stringliteral">&#39;asNative&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(member, <span class="keyword">True</span>),
<a name="l00421"></a>00421                                  <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(member, <span class="keyword">True</span>),
<a name="l00422"></a>00422                                  <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a93b3cc402bb488f296f0991a24c00806">attributeParamNames</a>(member)})
<a name="l00423"></a>00423                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> member.readonly:
<a name="l00424"></a>00424                     fd.write(tmpl % {<span class="stringliteral">&#39;asNative&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a10efb0abfaeea0c0cdd5ecf17c4d310d">attributeAsNative</a>(member, <span class="keyword">False</span>),
<a name="l00425"></a>00425                                      <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(member, <span class="keyword">False</span>),
<a name="l00426"></a>00426                                      <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a93b3cc402bb488f296f0991a24c00806">attributeParamNames</a>(member)})
<a name="l00427"></a>00427             <span class="keywordflow">elif</span> isinstance(member, xpidl.Method):
<a name="l00428"></a>00428                 <span class="keywordflow">if</span> member.notxpcom:
<a name="l00429"></a>00429                     fd.write(tmpl_notxpcom % {<span class="stringliteral">&#39;asNative&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a6e5c039a96d9f39b239c5c8232ac9bae">methodAsNative</a>(member),
<a name="l00430"></a>00430                                               <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#aa39b1e958c028c54bd2615eefd3b5bcd">methodNativeName</a>(member),
<a name="l00431"></a>00431                                               <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a159a961a36b524ce4b54fa1c31ba6dcb">paramlistNames</a>(member)})
<a name="l00432"></a>00432                 <span class="keywordflow">else</span>:
<a name="l00433"></a>00433                     fd.write(tmpl % {<span class="stringliteral">&#39;asNative&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a6e5c039a96d9f39b239c5c8232ac9bae">methodAsNative</a>(member),
<a name="l00434"></a>00434                                      <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#aa39b1e958c028c54bd2615eefd3b5bcd">methodNativeName</a>(member),
<a name="l00435"></a>00435                                      <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a159a961a36b524ce4b54fa1c31ba6dcb">paramlistNames</a>(member)})
<a name="l00436"></a>00436         <span class="keywordflow">if</span> len(iface.members) == 0:
<a name="l00437"></a>00437             fd.write(<span class="stringliteral">&#39;\\\n  /* no methods! */&#39;</span>)
<a name="l00438"></a>00438         <span class="keywordflow">elif</span> <span class="keywordflow">not</span> member.kind <span class="keywordflow">in</span> (<span class="stringliteral">&#39;attribute&#39;</span>, <span class="stringliteral">&#39;method&#39;</span>):
<a name="l00439"></a>00439             fd.write(<span class="stringliteral">&#39;\\&#39;</span>)
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     emitTemplate(<span class="stringliteral">&quot;\\\n  %(asNative)s { return _to %(nativeName)s(%(paramList)s); } &quot;</span>)
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     fd.write(iface_forward_safe % names)
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="comment"># Don&#39;t try to safely forward notxpcom functions, because we have no</span>
<a name="l00446"></a>00446     <span class="comment"># sensible default error return.  Instead, the caller will have to</span>
<a name="l00447"></a>00447     <span class="comment"># implement them.</span>
<a name="l00448"></a>00448     emitTemplate(<span class="stringliteral">&quot;\\\n  %(asNative)s { return !_to ? NS_ERROR_NULL_POINTER : _to-&gt;%(nativeName)s(%(paramList)s); } &quot;</span>,
<a name="l00449"></a>00449                  <span class="stringliteral">&quot;\\\n  %(asNative)s; &quot;</span>)
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     fd.write(iface_template_prolog % names)
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keywordflow">for</span> member <span class="keywordflow">in</span> iface.members:
<a name="l00454"></a>00454         <span class="keywordflow">if</span> isinstance(member, xpidl.ConstMember) <span class="keywordflow">or</span> isinstance(member, xpidl.CDATA): <span class="keywordflow">continue</span>
<a name="l00455"></a>00455         fd.write(<span class="stringliteral">&quot;/* %s */\n&quot;</span> % member.toIDL())
<a name="l00456"></a>00456         <span class="keywordflow">if</span> isinstance(member, xpidl.Attribute):
<a name="l00457"></a>00457             fd.write(example_tmpl % {<span class="stringliteral">&#39;implclass&#39;</span>: implclass,
<a name="l00458"></a>00458                                      <span class="stringliteral">&#39;returntype&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a0e6fcdad58f5b0df8ed3e2b363c4baa0">attributeReturnType</a>(member, <span class="stringliteral">&#39;NS_IMETHODIMP&#39;</span>),
<a name="l00459"></a>00459                                      <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(member, <span class="keyword">True</span>),
<a name="l00460"></a>00460                                      <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a9cb1934051471b880282d8d227517e34">attributeParamlist</a>(member, <span class="keyword">True</span>)})
<a name="l00461"></a>00461             <span class="keywordflow">if</span> <span class="keywordflow">not</span> member.readonly:
<a name="l00462"></a>00462                 fd.write(example_tmpl % {<span class="stringliteral">&#39;implclass&#39;</span>: implclass,
<a name="l00463"></a>00463                                          <span class="stringliteral">&#39;returntype&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a0e6fcdad58f5b0df8ed3e2b363c4baa0">attributeReturnType</a>(member, <span class="stringliteral">&#39;NS_IMETHODIMP&#39;</span>),
<a name="l00464"></a>00464                                          <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8a7af79c422c7aa094262d66fb0066ee">attributeNativeName</a>(member, <span class="keyword">False</span>),
<a name="l00465"></a>00465                                          <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a9cb1934051471b880282d8d227517e34">attributeParamlist</a>(member, <span class="keyword">False</span>)})
<a name="l00466"></a>00466         <span class="keywordflow">elif</span> isinstance(member, xpidl.Method):
<a name="l00467"></a>00467             fd.write(example_tmpl % {<span class="stringliteral">&#39;implclass&#39;</span>: implclass,
<a name="l00468"></a>00468                                      <span class="stringliteral">&#39;returntype&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a18d3ec0b7a86d3c987a3097199d92fc1">methodReturnType</a>(member, <span class="stringliteral">&#39;NS_IMETHODIMP&#39;</span>),
<a name="l00469"></a>00469                                      <span class="stringliteral">&#39;nativeName&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#aa39b1e958c028c54bd2615eefd3b5bcd">methodNativeName</a>(member),
<a name="l00470"></a>00470                                      <span class="stringliteral">&#39;paramList&#39;</span>: <a class="code" href="../../d8/dbd/namespaceheader.html#a8c6b443ae6a79936a552e56afc805fae">paramlistAsNative</a>(member, empty=<span class="stringliteral">&#39;&#39;</span>)})
<a name="l00471"></a>00471         fd.write(<span class="stringliteral">&#39;\n&#39;</span>)
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     fd.write(iface_template_epilog)
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="keywordflow">if</span> __name__ == <span class="stringliteral">&#39;__main__&#39;</span>:
<a name="l00476"></a>00476     <span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser
<a name="l00477"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a1f19773439587cecdc1d5ef61c705086">00477</a>     o = OptionParser()
<a name="l00478"></a>00478     o.add_option(<span class="stringliteral">&#39;-I&#39;</span>, action=<span class="stringliteral">&#39;append&#39;</span>, dest=<span class="stringliteral">&#39;incdirs&#39;</span>, default=[<span class="stringliteral">&#39;.&#39;</span>],
<a name="l00479"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a4f40f7d44b6b7dc8488c0481af56ac49">00479</a>                  help=<span class="stringliteral">&quot;Directory to search for imported files&quot;</span>)
<a name="l00480"></a>00480     o.add_option(<span class="stringliteral">&#39;--cachedir&#39;</span>, dest=<span class="stringliteral">&#39;cachedir&#39;</span>, default=<span class="keywordtype">None</span>,
<a name="l00481"></a>00481                  help=<span class="stringliteral">&quot;Directory in which to cache lex/parse tables.&quot;</span>)
<a name="l00482"></a>00482     o.add_option(<span class="stringliteral">&#39;-o&#39;</span>, dest=<span class="stringliteral">&#39;outfile&#39;</span>, default=<span class="keywordtype">None</span>,
<a name="l00483"></a>00483                  help=<span class="stringliteral">&quot;Output file (default is stdout)&quot;</span>)
<a name="l00484"></a>00484     o.add_option(<span class="stringliteral">&#39;-d&#39;</span>, dest=<span class="stringliteral">&#39;depfile&#39;</span>, default=<span class="keywordtype">None</span>,
<a name="l00485"></a>00485                  help=<span class="stringliteral">&quot;Generate a make dependency file&quot;</span>)
<a name="l00486"></a>00486     o.add_option(<span class="stringliteral">&#39;--regen&#39;</span>, action=<span class="stringliteral">&#39;store_true&#39;</span>, dest=<span class="stringliteral">&#39;regen&#39;</span>, default=<span class="keyword">False</span>,
<a name="l00487"></a>00487                  help=<span class="stringliteral">&quot;Regenerate IDL Parser cache&quot;</span>)
<a name="l00488"></a>00488     options, args = o.parse_args()
<a name="l00489"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a81872a518468d83b210beb01132f9ef8">00489</a>     file = args[0] <span class="keywordflow">if</span> args <span class="keywordflow">else</span> <span class="keywordtype">None</span>
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="keywordflow">if</span> options.cachedir <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00492"></a>00492         <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.isdir(options.cachedir):
<a name="l00493"></a>00493             os.mkdir(options.cachedir)
<a name="l00494"></a>00494         sys.path.append(options.cachedir)
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <span class="comment"># The only thing special about a regen is that there are no input files.</span>
<a name="l00497"></a>00497     <span class="keywordflow">if</span> options.regen:
<a name="l00498"></a>00498         <span class="keywordflow">if</span> options.cachedir <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l00499"></a>00499             <span class="keywordflow">print</span> &gt;&gt;sys.stderr, <span class="stringliteral">&quot;--regen useless without --cachedir&quot;</span>
<a name="l00500"></a>00500         <span class="comment"># Delete the lex/yacc files.  Ply is too stupid to regenerate them</span>
<a name="l00501"></a>00501         <span class="comment"># properly</span>
<a name="l00502"></a>00502         <span class="keywordflow">for</span> fileglobs <span class="keywordflow">in</span> [os.path.join(options.cachedir, f) <span class="keywordflow">for</span> f <span class="keywordflow">in</span> [<span class="stringliteral">&quot;xpidllex.py*&quot;</span>, <span class="stringliteral">&quot;xpidlyacc.py*&quot;</span>]]:
<a name="l00503"></a>00503             <span class="keywordflow">for</span> filename <span class="keywordflow">in</span> glob.glob(fileglobs):
<a name="l00504"></a>00504                 os.remove(filename)
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     <span class="comment"># Instantiate the parser.</span>
<a name="l00507"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aad73c21cc5775aa4f65261819422487e">00507</a>     p = xpidl.IDLParser(outputdir=options.cachedir)
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="keywordflow">if</span> options.regen:
<a name="l00510"></a>00510         sys.exit(0)
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     <span class="keywordflow">if</span> options.depfile <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> options.outfile <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l00513"></a>00513         <span class="keywordflow">print</span> &gt;&gt;sys.stderr, <span class="stringliteral">&quot;-d requires -o&quot;</span>
<a name="l00514"></a>00514         sys.exit(1)
<a name="l00515"></a>00515 
<a name="l00516"></a>00516     <span class="keywordflow">if</span> options.outfile <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00517"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a8ec22105081c3b204e62f258fd676956">00517</a>         outfd = <a class="code" href="../../df/d65/openaudio_8js.html#ad0452adbe6c8d74d2e2afaa489294b68">open</a>(options.outfile, <span class="stringliteral">&#39;w&#39;</span>)
<a name="l00518"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a307e489cf06215c9152927dd0b13b0fc">00518</a>         closeoutfd = <span class="keyword">True</span>
<a name="l00519"></a>00519     <span class="keywordflow">else</span>:
<a name="l00520"></a>00520         outfd = sys.stdout
<a name="l00521"></a>00521         closeoutfd = <span class="keyword">False</span>
<a name="l00522"></a>00522 
<a name="l00523"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a4542322c0734b4012076a4c7c7dcede1">00523</a>     idl = p.parse(<a class="code" href="../../df/d65/openaudio_8js.html#ad0452adbe6c8d74d2e2afaa489294b68">open</a>(file).read(), filename=file)
<a name="l00524"></a>00524     idl.resolve(options.incdirs, p)
<a name="l00525"></a>00525     <a class="code" href="../../d8/dbd/namespaceheader.html#a9b6d35c5d78b3e938143567111d9a5ef">print_header</a>(idl, outfd, file)
<a name="l00526"></a>00526 
<a name="l00527"></a>00527     <span class="keywordflow">if</span> closeoutfd:
<a name="l00528"></a>00528         outfd.close()
<a name="l00529"></a>00529 
<a name="l00530"></a>00530     <span class="keywordflow">if</span> options.depfile <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00531"></a><a class="code" href="../../d8/dbd/namespaceheader.html#aa4eebbad550443538e392a5f16540d87">00531</a>         dirname = os.path.dirname(options.depfile)
<a name="l00532"></a>00532         <span class="keywordflow">if</span> dirname:
<a name="l00533"></a>00533             <span class="keywordflow">try</span>:
<a name="l00534"></a>00534                 os.makedirs(dirname)
<a name="l00535"></a>00535             <span class="keywordflow">except</span>:
<a name="l00536"></a>00536                 <span class="keywordflow">pass</span>
<a name="l00537"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a3b3a15e5856cdfd205c219f9509146b3">00537</a>         depfd = <a class="code" href="../../df/d65/openaudio_8js.html#ad0452adbe6c8d74d2e2afaa489294b68">open</a>(options.depfile, <span class="stringliteral">&#39;w&#39;</span>)
<a name="l00538"></a><a class="code" href="../../d8/dbd/namespaceheader.html#a797dc394d8d01f36bf4af85d08a8cf85">00538</a>         deps = [dep.replace(<span class="stringliteral">&#39;\\&#39;</span>, <span class="stringliteral">&#39;/&#39;</span>) <span class="keywordflow">for</span> dep <span class="keywordflow">in</span> idl.deps]
<a name="l00539"></a>00539 
<a name="l00540"></a>00540         <span class="keywordflow">print</span> &gt;&gt;depfd, <span class="stringliteral">&quot;%s: %s&quot;</span> % (options.outfile, <span class="stringliteral">&quot; &quot;</span>.<a class="code" href="../../de/d11/path_8js.html#a9c4b06c29cf28f47c4f54ed4e30c85b3">join</a>(deps))
<a name="l00541"></a>00541         <span class="keywordflow">for</span> dep <span class="keywordflow">in</span> deps:
<a name="l00542"></a>00542             <span class="keywordflow">print</span> &gt;&gt;depfd, <span class="stringliteral">&quot;%s:&quot;</span> % dep
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../da/d64/header_8py.html">header.py</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:52:09に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
