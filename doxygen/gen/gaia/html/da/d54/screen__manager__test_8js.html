<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: screen_manager_test.js</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('da/d54/screen__manager__test_8js.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">関数</a> &#124;
<a href="#var-members">変数</a>  </div>
  <div class="headertitle">
<div class="title">screen_manager_test.js</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="../../da/d54/screen__manager__test_8js_source.html">ソースコードを見る。</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
関数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">mocha&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d54/screen__manager__test_8js.html#a6e43afb7cf4e69e8cb7da9f5dad90751">globals</a> (['<a class="el" href="../../d8/d91/shared_2js_2settings__listener_8js.html#abe3dd8a60bd635e3d2261110570f3c29">SettingsListener</a>', '<a class="el" href="../../d6/d3a/utility__tray__test_8js.html#a3c6fe3240fb0e28eee97566cb96faa0a">LockScreen</a>', '<a class="el" href="../../d1/d91/apps_2system_2js_2bluetooth_8js.html#a59959263d861d0b8a799bfe6d058af9d">Bluetooth</a>', '<a class="el" href="../../d5/df2/statusbar_8js.html#aecd12bd678c2798875f7715ec3013e84">StatusBar</a>', '<a class="el" href="../../d2/d91/attention__screen_8js.html#a82fc87217ec58a1a7ac2f6c5b66b857e">AttentionScreen</a>', '<a class="el" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>', '<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">addEventListener</a>', '<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>', 'clearIdleTimeout', 'setIdleTimeout', '<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5e67712f1e4602312c66bda052a6f6c4">dispatchEvent</a>', 'WindowManager'])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d54/screen__manager__test_8js.html#a67220c74fe9e32dc0e86cbebbda8ba21">requireApp</a> ('system/<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>/unit/mock_window_manager.js')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a> (originObject, prop, stub, reals, useDefineProperty)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a> (originObject, prop, reals, useDefineProperty)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d54/screen__manager__test_8js.html#a2bf2d42cb23e4beeecec31084b7e881e">suite</a> ('system/<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var reals={};<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozPower', <a class="el" href="../../d9/dab/mock__navigator__moz__power_8js.html#a2aa06f5a0379163aa509d6b619b92bb7">MockMozPower</a>, reals, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, 'WindowManager', <a class="el" href="../../d9/dfd/mock__window__manager_8js.html#ab735433bbbaa5e2615d033fcaba1db03">MockWindowManager</a>, reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d8/d91/shared_2js_2settings__listener_8js.html#abe3dd8a60bd635e3d2261110570f3c29">SettingsListener</a>', <a class="el" href="../../da/d16/shared_2test_2unit_2mocks_2mock__settings__listener_8js.html#a707a6e099d1d6d82cd74ae9ff1b8fe12">MockSettingsListener</a>, reals);this.sinon.useFakeTimers();<a class="el" href="../../da/d16/shared_2test_2unit_2mocks_2mock__settings__listener_8js.html#ada5f8f0f77028802cd46c92cb1ce8fce">requireApp</a>('system/js/screen_manager.js', <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockMozPower.mTeardown</a>();<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockWindowManager.mTeardown</a>();<a class="el" href="../../d7/d13/mock__updatable_8js.html#a3d0fcb481c5d651d1f7a83fa7896504d">MockSettingsListener.mTeardown</a>();<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozPower', reals, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, 'WindowManager', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d8/d91/shared_2js_2settings__listener_8js.html#abe3dd8a60bd635e3d2261110570f3c29">SettingsListener</a>', reals);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">init</a>()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubTelephony={};var stubLockscreen={};var stubById=this.sinon.stub(<a class="el" href="../../d5/d35/tools_2xpcwindow_2lib_2window_2window_8js.html#a400f9ad46a12f3c0d20e97c78e682258">document</a>, '<a class="el" href="../../d4/d8c/viewphoto_8js.html#a6d08c5d82e2ca7c6042afb9f8ae078c1">getElementById</a>');stubById.withArgs('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>').returns(document.createElement('div'));this.sinon.stub(<a class="el" href="../../da/d16/shared_2test_2unit_2mocks_2mock__settings__listener_8js.html#a707a6e099d1d6d82cd74ae9ff1b8fe12">MockSettingsListener</a>, '<a class="el" href="../../d9/d6e/ttlview_8js.html#aab157f1dc1e984fa6ce7c5b7670324ef">observe</a>');<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">stubTelephony.addEventListener</a>=this.sinon.stub();stubLockscreen.locked=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOn');this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '_reconfigScreenTimeout');this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '_setIdleTimeout');<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', stubTelephony, reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d6/d3a/utility__tray__test_8js.html#a3c6fe3240fb0e28eee97566cb96faa0a">LockScreen</a>', stubLockscreen, reals);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d6/d3a/utility__tray__test_8js.html#a3c6fe3240fb0e28eee97566cb96faa0a">LockScreen</a>', reals);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('power.addWakeLockListener handling', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var wakeLockListenerSpy;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){wakeLockListenerSpy=this.sinon.spy(<a class="el" href="../../d9/dab/mock__navigator__moz__power_8js.html#a2aa06f5a0379163aa509d6b619b92bb7">MockMozPower</a>, 'addWakeLockListener');<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">ScreenManager.init</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('General case', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){wakeLockListenerSpy.yield('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>', 'locked-foreground');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager._screenWakeLocked);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.turnScreenOn.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager._reconfigScreenTimeout.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Called with topic&quot;screen&quot;', function(){<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">ScreenManager.turnScreenOn.reset</a>();wakeLockListenerSpy.yield('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>', 'locked-<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#aa550bd736a6ba92fe729eec3be3a51f5">background</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(ScreenManager._screenWakeLocked);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(ScreenManager.turnScreenOn.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager._reconfigScreenTimeout.called);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('Called with topic topic&quot;cpu&quot;', function(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a> is&quot;another-<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a>&quot;', function(){wakeLockListenerSpy.yield('cpu', 'another-<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(MockMozPower.cpuSleepAllowed);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a> is&quot;locked-<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#aa550bd736a6ba92fe729eec3be3a51f5">background</a>&quot;', function(){wakeLockListenerSpy.yield('cpu', 'locked-<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#aa550bd736a6ba92fe729eec3be3a51f5">background</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockMozPower.cpuSleepAllowed);});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Testing <a class="el" href="../../d9/d6e/ttlview_8js.html#aab157f1dc1e984fa6ce7c5b7670324ef">SettingsListener.observe</a> <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> <a class="el" href="../../df/d6d/prpdce_8h.html#a244bf4809fa769d3064852f1f46df24f">screen.timeout</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._firstOn=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">ScreenManager.turnScreenOn.reset</a>();SettingsListener.observe.withArgs('<a class="el" href="../../df/d6d/prpdce_8h.html#a244bf4809fa769d3064852f1f46df24f">screen.timeout</a>').callsArgWith(2, 50);<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">ScreenManager.init</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager._firstOn);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockMozPower.screenBrightness, 0.5);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.turnScreenOn.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Testing <a class="el" href="../../d9/d6e/ttlview_8js.html#aab157f1dc1e984fa6ce7c5b7670324ef">SettingsListener.observe</a> <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> '+ 'screen.automatic-brightness', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">SettingsListener.observe.reset</a>();SettingsListener.observe.withArgs('screen.automatic-brightness').callsArgWith(2, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'setDeviceLightEnabled');<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">ScreenManager.init</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.setDeviceLightEnabled.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Testing <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a> of <a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">telephony.addEventListener</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">navigator.mozTelephony.addEventListener.reset</a>();navigator.mozTelephony.addEventListener.withArgs('callschanged');<a class="el" href="../../d5/d0d/pay_8js.html#af619d0ad365b66772212901ccd40466c">ScreenManager.init</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(navigator.mozTelephony.addEventListener.called);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">handleEvent</a>()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('Testing devicelight <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubAutoAdjust;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubAutoAdjust=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'autoAdjustBrightness');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> _deviceLightEnabled is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._deviceLightEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'devicelight'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAutoAdjust.called);<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">stubAutoAdjust.reset</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> screenEnabled is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'devicelight'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAutoAdjust.called);<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">stubAutoAdjust.reset</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> _inTransition is <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._inTransition=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'devicelight'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAutoAdjust.called);<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">stubAutoAdjust.reset</a>();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('put all together', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._deviceLightEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager._inTransition=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'devicelight'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAutoAdjust.called);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Testing sleep <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubTurnOff=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOff');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'sleep'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOff.calledWith(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, 'powerkey'));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Testing wake <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubTurnOn=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOn');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'wake'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOn.called);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('Testing userproximity <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubTelephony, stubBluetooth, stubStatusBar, stubTurnOn, stubTurnOff;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubTelephony={};stubBluetooth={isProfileConnected:function(){}};stubStatusBar={};stubTurnOn=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOn');stubTurnOff=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOff');<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d1/d91/apps_2system_2js_2bluetooth_8js.html#a59959263d861d0b8a799bfe6d058af9d">Bluetooth</a>', stubBluetooth, reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d5/df2/statusbar_8js.html#aecd12bd678c2798875f7715ec3013e84">StatusBar</a>', stubStatusBar, reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', stubTelephony, reals);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d1/d91/apps_2system_2js_2bluetooth_8js.html#a59959263d861d0b8a799bfe6d058af9d">Bluetooth</a>', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d5/df2/statusbar_8js.html#aecd12bd678c2798875f7715ec3013e84">StatusBar</a>', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', reals);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> <a class="el" href="../../d1/d91/apps_2system_2js_2bluetooth_8js.html#a59959263d861d0b8a799bfe6d058af9d">Bluetooth</a> <a class="el" href="../../d5/d1d/_bluetooth_common_8h.html#a42afbac010d3a15a4475a658ac173d92ab83313f324ddd41ef3db8f159b9811fe">SCO</a> <a class="el" href="../../d9/dc5/mock__handled__call_8js.html#a4dac86cd80b5b7d9bd4d930beafb08f1">connected</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubBluetooth.Profiles={};this.sinon.stub(stubBluetooth, 'isProfileConnected').returns(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'userproximity'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOn.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOff.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> <a class="el" href="../../d1/d91/apps_2system_2js_2bluetooth_8js.html#a59959263d861d0b8a799bfe6d058af9d">Bluetooth</a> <a class="el" href="../../d5/d1d/_bluetooth_common_8h.html#a42afbac010d3a15a4475a658ac173d92ab83313f324ddd41ef3db8f159b9811fe">SCO</a> <a class="el" href="../../d9/dc5/mock__handled__call_8js.html#af872a565c388d56f3bc6c62a61d53a54">disconnected</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubBluetooth.Profiles={};this.sinon.stub(stubBluetooth, 'isProfileConnected').returns(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);stubTelephony.speakerEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;stubStatusBar.headponesActive=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'userproximity'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOn.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOff.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> evt.near is yes', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubBluetooth.Profiles={};this.sinon.stub(stubBluetooth, 'isProfileConnected').returns(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'userproximity', 'near': 'yes'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOn.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOff.calledWith(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, 'proximity'));});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('Testing callschanged <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubTelephony, stubCpuWakeLock, stubAttentionScreen, stubTurnOn, stubRemoveListener;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubTelephony={};stubCpuWakeLock={};stubAttentionScreen={};stubTurnOn=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOn');stubRemoveListener=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>');<a class="el" href="../../d3/d4b/lockscreen_8js.html#a5fcc87d72af0776c43f03559fd828d16">stubCpuWakeLock.unlock</a>=this.sinon.stub();<a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">stubAttentionScreen.show</a>=this.sinon.stub();ScreenManager._cpuWakeLock=stubCpuWakeLock;<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', stubTelephony, reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d2/d91/attention__screen_8js.html#a82fc87217ec58a1a7ac2f6c5b66b857e">AttentionScreen</a>', stubAttentionScreen, reals);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d2/d91/attention__screen_8js.html#a82fc87217ec58a1a7ac2f6c5b66b857e">AttentionScreen</a>', reals);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> <a class="el" href="../../d3/d4a/mock__recipients_8js.html#a8f93e3d7a5d6496d4ad3a9c2efd07229">off</a> by proximity', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubTelephony.calls=[];ScreenManager._screenOffBy= 'proximity';<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'callschanged'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOn.called);assert.isNull(ScreenManager._cpuWakeLock);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubCpuWakeLock.unlock.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAttentionScreen.show.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> <a class="el" href="../../d3/d4a/mock__recipients_8js.html#a8f93e3d7a5d6496d4ad3a9c2efd07229">off</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubTelephony.calls=[];ScreenManager._screenOffBy= '';<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'callschanged'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOn.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubAddListener=this.sinon.stub();stubTelephony.calls=[{'<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">addEventListener</a>':stubAddListener}];<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'callschanged'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAttentionScreen.show.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAddListener.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('without cpuWakeLock', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubAddListener=this.sinon.stub();stubTelephony.calls=[{'<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">addEventListener</a>':stubAddListener}];ScreenManager._cpuWakeLock=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>({'<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'callschanged'});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAttentionScreen.show.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAddListener.called);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('Testing statechange <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubReqWakeLock, stubAddListener, stubCallRemoveListener, evt;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubReqWakeLock=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'requestWakeLock');stubAddListener=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">addEventListener</a>');stubCallRemoveListener=this.sinon.stub();evt={ '<a class="el" href="../../de/d81/xpt__struct_8h.html#ac827fa5fbcdd05dd9ed05984a80679b8">type</a>': 'statechange', '<a class="el" href="../../d9/d04/expat_8h.html#acfcb72e11f425a604663d645d2a4ea80">target</a>':{ '<a class="el" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>':stubCallRemoveListener}};});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a> is <a class="el" href="../../d9/dc5/mock__handled__call_8js.html#af872a565c388d56f3bc6c62a61d53a54">disconnected</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">evt.target.state</a>= '<a class="el" href="../../d9/dc5/mock__handled__call_8js.html#af872a565c388d56f3bc6c62a61d53a54">disconnected</a>';<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>(evt);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubCallRemoveListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAddListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubReqWakeLock.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a> is <a class="el" href="../../d9/dc5/mock__handled__call_8js.html#a4dac86cd80b5b7d9bd4d930beafb08f1">connected</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">evt.target.state</a>= '<a class="el" href="../../d9/dc5/mock__handled__call_8js.html#a4dac86cd80b5b7d9bd4d930beafb08f1">connected</a>';<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac6a12d37a530b7cf73589f08f0fbf311">ScreenManager.handleEvent</a>(evt);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubCallRemoveListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAddListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubReqWakeLock.called);});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('turnScreenOff()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubSetIdle, stubRemoveListener, stubScnClassListAdd, stubScreen, stubFireEvent, stubUnlock, stubSetBrightness;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubSetIdle=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '_setIdleTimeout');stubRemoveListener=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>');stubScnClassListAdd=this.sinon.stub();stubScreen={'classList':{'<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a>':stubScnClassListAdd}};stubFireEvent=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'fireScreenChangeEvent');stubUnlock=this.sinon.stub();stubSetBrightness=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'setScreenBrightness');<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>', stubScreen, reals);ScreenManager._cpuWakeLock={'<a class="el" href="../../d3/d4b/lockscreen_8js.html#a5fcc87d72af0776c43f03559fd828d16">unlock</a>':stubUnlock};});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>', reals);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('when <a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> disabled', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(ScreenManager.turnScreenOff());});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('turn <a class="el" href="../../d3/d4a/mock__recipients_8js.html#a8f93e3d7a5d6496d4ad3a9c2efd07229">off</a> <a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> with instant argument', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.turnScreenOff(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, 'powerkey'));<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(20);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(stubRemoveListener.callCount, 4);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetIdle.calledWith(0));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(ScreenManager.screenEnabled);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubScnClassListAdd.calledWith('screenoff'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(0, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(MockMozPower.screenEnabled);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.fireScreenChangeEvent.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('turn <a class="el" href="../../d3/d4a/mock__recipients_8js.html#a8f93e3d7a5d6496d4ad3a9c2efd07229">off</a> <a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> wihout instant argument', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.turnScreenOff(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubSetIdle.called);<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(ScreenManager._dimNotice);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetIdle.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('turn <a class="el" href="../../d3/d4a/mock__recipients_8js.html#a8f93e3d7a5d6496d4ad3a9c2efd07229">off</a> <a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> but not in transition', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(ScreenManager.turnScreenOff(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>));ScreenManager._inTransition=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d3/d91/j3d_8js.html#aeba439cf129372b4ebc312b3a29efe66">this.sinon.clock.tick</a>(ScreenManager._dimNotice);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubSetIdle.called);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('turnScreenOn()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubSetBrightness, stubReconfTimeout, stubTelephony={}, stubReqWakeLock, stubAddListener, stubScnClassListRemove, stubScreen, stubFireEvent;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubSetBrightness=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'setScreenBrightness');stubReconfTimeout=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '_reconfigScreenTimeout');<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', stubTelephony, reals);stubReqWakeLock=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'requestWakeLock');stubAddListener=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">addEventListener</a>');stubScnClassListRemove=this.sinon.stub();stubScreen={'classList':{'<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a>':stubScnClassListRemove}};<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>', stubScreen, reals);stubFireEvent=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'fireScreenChangeEvent');});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1ab79c9277f7648d0dfe676bab65dde4">navigator</a>, 'mozTelephony', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, '<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a>', reals);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> <a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#ad40d8437f6cf8675f077c4117119c8c0">enabled</a> when _inTransition is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager._inTransition=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(ScreenManager.turnScreenOn(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubReconfTimeout.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> <a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#ad40d8437f6cf8675f077c4117119c8c0">enabled</a> when _inTransition is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._inTransition=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(ScreenManager.turnScreenOn(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubReconfTimeout.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> disabled when _deviceLightEnable is <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;stubTelephony.calls=[];ScreenManager._deviceLightEnable=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager.turnScreenOn(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubScnClassListRemove.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAddListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubReconfTimeout.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubFireEvent.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> disabled when _deviceLightEnable is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._deviceLightEnable=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">stubAddListener.reset</a>();ScreenManager.turnScreenOn(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAddListener.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../dc/db8/system_2test_2unit_2action__menu__test_8js.html#a143b83738f9fab453e3116d14dfac0e7">screen</a> disabled with <a class="el" href="../../d5/de7/jquery_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7345f7c14b7ddbcc9efdc293d79bf303">call</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;stubTelephony.calls=[{'<a class="el" href="../../d2/df8/prthread_8h.html#a22ec211475b54a8de0468990ea9654da">state</a>': '<a class="el" href="../../d9/dc5/mock__handled__call_8js.html#a4dac86cd80b5b7d9bd4d930beafb08f1">connected</a>'}];ScreenManager.turnScreenOn(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubReqWakeLock.calledWith('cpu'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAddListener.calledWith('userproximity'));});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('setScreenBrightness()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubClearTimeout, stubTransBrightness;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubClearTimeout=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../da/da1/timers_8js.html#ab37ff0db33a3bf80b0163adc40a58424">clearTimeout</a>');stubTransBrightness=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'transitionBrightness');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> brightness with instant argument', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.setScreenBrightness(0.5, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTransBrightness.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockMozPower.screenBrightness, 0.5);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> brightness without instant argument', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.setScreenBrightness(0.5, <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTransBrightness.called);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('transitionBrightness()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d2/d7d/jsapi_8h.html#abfba8fa3513c8942905cf6144b77a52d">same</a> brightness', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._transitionBrightnessTimer= 'not <a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>';ScreenManager._targetBrightness=0.5;MockMozPower.screenBrightness=0.5;ScreenManager.transitionBrightness();assert.isNull(ScreenManager._transitionBrightnessTimer);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('brightness from 0.9 <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> 0.4', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){MockMozPower.screenBrightness=0.9;ScreenManager._targetBrightness=0.4;ScreenManager.transitionBrightness();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockMozPower.screenBrightness, 0.9-ScreenManager.BRIGHTNESS_ADJUST_STEP);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('brightness from 0.4 <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> 0.9', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){MockMozPower.screenBrightness=0.4;ScreenManager._targetBrightness=0.9;ScreenManager.transitionBrightness();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(MockMozPower.screenBrightness, 0.4+ScreenManager.BRIGHTNESS_ADJUST_STEP);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('setDeviceLightEnabled()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubSetBrightness, stubAddListener, stubRemoveListener;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubSetBrightness=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'setScreenBrightness');stubAddListener=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d1/d51/test__external__apps_2packstubtest_2js_2app_8js.html#ac189c42168797aa80d7a298a9394ff0b">addEventListener</a>');stubRemoveListener=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../df/d44/permission__manager_8js.html#acf9987ef04ab3791e7ff8b28d748ebcc">removeEventListener</a>');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> setDeviceLightEnabled(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>) and '+ '_deviceLightEnabled is <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._userBrightness=0.5;ScreenManager._deviceLightEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager.setDeviceLightEnabled(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(0.5, <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> argument is <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.setDeviceLightEnabled(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubSetBrightness.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> argument is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.setDeviceLightEnabled(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubAddListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubRemoveListener.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> argument &amp;screenEnabled are both <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager.setDeviceLightEnabled(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubAddListener.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubRemoveListener.called);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('_setIdleTimeout()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubClearIdleTimeout, stubSetIdleTimeout;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubClearIdleTimeout=this.sinon.stub();<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, 'clearIdleTimeout', stubClearIdleTimeout, reals);stubSetIdleTimeout=this.sinon.stub();<a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, 'setIdleTimeout', stubSetIdleTimeout, reals);});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, 'clearIdleTimeout', reals);<a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a>(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, 'setIdleTimeout', reals);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> idle <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> 100', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._setIdleTimeout(100, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubClearIdleTimeout.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetIdleTimeout.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> idle <a class="el" href="../../da/d32/prio_8h.html#a0f2163507f01dc9bb68ca5c72cacaa34">timeout</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> 0', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._setIdleTimeout(0, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubClearIdleTimeout.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubSetIdleTimeout.called);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('fireScreenChangeEvent()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubDispatchEvent=this.sinon.stub(<a class="el" href="../../d0/d94/tools_2xpcwindow_2lib_2loader_8js.html#a1f5517920aaab1f97bda91f10438fb05">window</a>, '<a class="el" href="../../d1/d04/app__install__manager_8js.html#a5e67712f1e4602312c66bda052a6f6c4">dispatchEvent</a>');ScreenManager.fireScreenChangeEvent();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubDispatchEvent.called);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('autoAdjustBrightness()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubSetBrightness;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._targetBrightness=-1;stubSetBrightness=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'setScreenBrightness');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('auto adjust brightness <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> lux 0.1', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.autoAdjustBrightness(0.1);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(0.1));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('auto adjust brightness <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> lux 1', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.autoAdjustBrightness(1);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(0.1));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('auto adjust brightness <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> lux 10', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.autoAdjustBrightness(10);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(0.27));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('auto adjust brightness <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> lux 10000', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.autoAdjustBrightness(10000);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(1));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('auto adjust brightness <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> lux 20000', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.autoAdjustBrightness(20000);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubSetBrightness.calledWith(1));});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('auto adjust <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> <a class="el" href="../../d2/d7d/jsapi_8h.html#abfba8fa3513c8942905cf6144b77a52d">same</a> <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a> as current brightness', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager._targetBrightness=0.1;ScreenManager.autoAdjustBrightness(1);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubSetBrightness.called);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('toggleScreen()', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var stubTurnOff, stubTurnOn;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){stubTurnOff=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOff');stubTurnOn=this.sinon.stub(<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>, 'turnScreenOn');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> screenEnabled is <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;ScreenManager.toggleScreen();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOff.calledWith(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, 'toggle'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOn.called);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a> screenEnabled is <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){ScreenManager.screenEnabled=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;ScreenManager.toggleScreen();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(stubTurnOn.called);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(stubTurnOff.called);});});})</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d1b/test-agent-server_8js.html#aab71dcc804ca4aa3ed2bf7ba887635db">use</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d54/screen__manager__test_8js.html#ae2475e10618961c050dcba04e8c42331">strict</a></td></tr>
</table>
<hr/><h2>関数</h2>
<a class="anchor" id="a6e43afb7cf4e69e8cb7da9f5dad90751"></a><!-- doxytag: member="screen_manager_test.js::globals" ref="a6e43afb7cf4e69e8cb7da9f5dad90751" args="(['SettingsListener', 'LockScreen', 'Bluetooth', 'StatusBar', 'AttentionScreen', 'removeEventListener', 'addEventListener', 'ScreenManager', 'clearIdleTimeout', 'setIdleTimeout', 'dispatchEvent', 'WindowManager'])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mocha <a class="el" href="../../d6/df3/wifi__test_8js.html#a55232262598044b5b781ef18019e2a92">globals</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a67220c74fe9e32dc0e86cbebbda8ba21"></a><!-- doxytag: member="screen_manager_test.js::requireApp" ref="a67220c74fe9e32dc0e86cbebbda8ba21" args="('system/test/unit/mock_window_manager.js')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d16/shared_2test_2unit_2mocks_2mock__settings__listener_8js.html#ada5f8f0f77028802cd46c92cb1ce8fce">requireApp</a> </td>
          <td>(</td>
          <td class="paramtype">'system/<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>/unit/mock_window_manager.js'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a669bd4a0d3a5d976260cbdf5e49934ce"></a><!-- doxytag: member="screen_manager_test.js::restoreProperty" ref="a669bd4a0d3a5d976260cbdf5e49934ce" args="(originObject, prop, reals, useDefineProperty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> <a class="el" href="../../da/d54/screen__manager__test_8js.html#a669bd4a0d3a5d976260cbdf5e49934ce">restoreProperty</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>originObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>useDefineProperty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../da/d54/screen__manager__test_8js_source.html">screen_manager_test.js</a> の <a class="el" href="../../da/d54/screen__manager__test_8js_source.html#l00024">24</a> 行で定義されています。</p>
<div class="fragment"><pre class="fragment">                                                                       {
  <span class="keywordflow">if</span> (!useDefineProperty) {
    originObject[prop] = reals[prop];
  } <span class="keywordflow">else</span> {
    Object.defineProperty(originObject, prop, {
      configurable: <span class="keyword">true</span>,
      <span class="keyword">get</span>: <span class="keyword">function</span>() { <span class="keywordflow">return</span> reals[prop]; }
    });
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2bf2d42cb23e4beeecec31084b7e881e"></a><!-- doxytag: member="screen_manager_test.js::suite" ref="a2bf2d42cb23e4beeecec31084b7e881e" args="('system/ScreenManager', function(){var reals={};setup(function(done){switchProperty(navigator, 'mozPower', MockMozPower, reals, true);switchProperty(window, 'WindowManager', MockWindowManager, reals);switchProperty(window, 'SettingsListener', MockSettingsListener, reals);this.sinon.useFakeTimers();requireApp('system/js/screen_manager.js', done);});teardown(function(){MockMozPower.mTeardown();MockWindowManager.mTeardown();MockSettingsListener.mTeardown();restoreProperty(navigator, 'mozPower', reals, true);restoreProperty(window, 'WindowManager', reals);restoreProperty(window, 'SettingsListener', reals);});suite('init()', function(){setup(function(){var stubTelephony={};var stubLockscreen={};var stubById=this.sinon.stub(document, 'getElementById');stubById.withArgs('screen').returns(document.createElement('div'));this.sinon.stub(MockSettingsListener, 'observe');stubTelephony.addEventListener=this.sinon.stub();stubLockscreen.locked=true;this.sinon.stub(ScreenManager, 'turnScreenOn');this.sinon.stub(ScreenManager, '_reconfigScreenTimeout');this.sinon.stub(ScreenManager, '_setIdleTimeout');switchProperty(navigator, 'mozTelephony', stubTelephony, reals);switchProperty(window, 'LockScreen', stubLockscreen, reals);});teardown(function(){restoreProperty(navigator, 'mozTelephony', reals);restoreProperty(window, 'LockScreen', reals);});suite('power.addWakeLockListener handling', function(){var wakeLockListenerSpy;setup(function(){wakeLockListenerSpy=this.sinon.spy(MockMozPower, 'addWakeLockListener');ScreenManager.init();});test('General case', function(){wakeLockListenerSpy.yield('screen', 'locked&#45;foreground');assert.isTrue(ScreenManager._screenWakeLocked);assert.isTrue(ScreenManager.turnScreenOn.called);assert.isTrue(ScreenManager._reconfigScreenTimeout.called);});test('Called with topic&quot;screen&quot;', function(){ScreenManager.turnScreenOn.reset();wakeLockListenerSpy.yield('screen', 'locked&#45;background');assert.isFalse(ScreenManager._screenWakeLocked);assert.isFalse(ScreenManager.turnScreenOn.called);assert.isTrue(ScreenManager._reconfigScreenTimeout.called);});suite('Called with topic topic&quot;cpu&quot;', function(){test('state is&quot;another&#45;state&quot;', function(){wakeLockListenerSpy.yield('cpu', 'another&#45;state');assert.isTrue(MockMozPower.cpuSleepAllowed);});test('state is&quot;locked&#45;background&quot;', function(){wakeLockListenerSpy.yield('cpu', 'locked&#45;background');assert.isFalse(MockMozPower.cpuSleepAllowed);});});});test('Testing SettingsListener.observe for screen.timeout', function(){ScreenManager._firstOn=false;ScreenManager.turnScreenOn.reset();SettingsListener.observe.withArgs('screen.timeout').callsArgWith(2, 50);ScreenManager.init();assert.isTrue(ScreenManager._firstOn);assert.equal(MockMozPower.screenBrightness, 0.5);assert.isTrue(ScreenManager.turnScreenOn.called);});test('Testing SettingsListener.observe for '+ 'screen.automatic&#45;brightness', function(){SettingsListener.observe.reset();SettingsListener.observe.withArgs('screen.automatic&#45;brightness').callsArgWith(2, true);this.sinon.stub(ScreenManager, 'setDeviceLightEnabled');ScreenManager.init();assert.isTrue(ScreenManager.setDeviceLightEnabled.called);});test('Testing callback of telephony.addEventListener', function(){navigator.mozTelephony.addEventListener.reset();navigator.mozTelephony.addEventListener.withArgs('callschanged');ScreenManager.init();assert.isTrue(navigator.mozTelephony.addEventListener.called);});});suite('handleEvent()', function(){suite('Testing devicelight event', function(){var stubAutoAdjust;setup(function(){stubAutoAdjust=this.sinon.stub(ScreenManager, 'autoAdjustBrightness');});test('if _deviceLightEnabled is false', function(){ScreenManager._deviceLightEnabled=false;ScreenManager.handleEvent({'type': 'devicelight'});assert.isFalse(stubAutoAdjust.called);stubAutoAdjust.reset();});test('if screenEnabled is false', function(){ScreenManager.screenEnabled=false;ScreenManager.handleEvent({'type': 'devicelight'});assert.isFalse(stubAutoAdjust.called);stubAutoAdjust.reset();});test('if _inTransition is true', function(){ScreenManager._inTransition=true;ScreenManager.handleEvent({'type': 'devicelight'});assert.isFalse(stubAutoAdjust.called);stubAutoAdjust.reset();});test('put all together', function(){ScreenManager._deviceLightEnabled=true;ScreenManager.screenEnabled=true;ScreenManager._inTransition=false;ScreenManager.handleEvent({'type': 'devicelight'});assert.isTrue(stubAutoAdjust.called);});});test('Testing sleep event', function(){var stubTurnOff=this.sinon.stub(ScreenManager, 'turnScreenOff');ScreenManager.handleEvent({'type': 'sleep'});assert.isTrue(stubTurnOff.calledWith(true, 'powerkey'));});test('Testing wake event', function(){var stubTurnOn=this.sinon.stub(ScreenManager, 'turnScreenOn');ScreenManager.handleEvent({'type': 'wake'});assert.isTrue(stubTurnOn.called);});suite('Testing userproximity event', function(){var stubTelephony, stubBluetooth, stubStatusBar, stubTurnOn, stubTurnOff;setup(function(){stubTelephony={};stubBluetooth={isProfileConnected:function(){}};stubStatusBar={};stubTurnOn=this.sinon.stub(ScreenManager, 'turnScreenOn');stubTurnOff=this.sinon.stub(ScreenManager, 'turnScreenOff');switchProperty(window, 'Bluetooth', stubBluetooth, reals);switchProperty(window, 'StatusBar', stubStatusBar, reals);switchProperty(navigator, 'mozTelephony', stubTelephony, reals);});teardown(function(){restoreProperty(window, 'Bluetooth', reals);restoreProperty(window, 'StatusBar', reals);restoreProperty(navigator, 'mozTelephony', reals);});test('if Bluetooth SCO connected', function(){stubBluetooth.Profiles={};this.sinon.stub(stubBluetooth, 'isProfileConnected').returns(true);ScreenManager.handleEvent({'type': 'userproximity'});assert.isFalse(stubTurnOn.called);assert.isFalse(stubTurnOff.called);});test('if Bluetooth SCO disconnected', function(){stubBluetooth.Profiles={};this.sinon.stub(stubBluetooth, 'isProfileConnected').returns(false);stubTelephony.speakerEnabled=false;stubStatusBar.headponesActive=false;ScreenManager.handleEvent({'type': 'userproximity'});assert.isTrue(stubTurnOn.called);assert.isFalse(stubTurnOff.called);});test('if evt.near is yes', function(){stubBluetooth.Profiles={};this.sinon.stub(stubBluetooth, 'isProfileConnected').returns(false);ScreenManager.handleEvent({'type': 'userproximity', 'near': 'yes'});assert.isFalse(stubTurnOn.called);assert.isTrue(stubTurnOff.calledWith(true, 'proximity'));});});suite('Testing callschanged event', function(){var stubTelephony, stubCpuWakeLock, stubAttentionScreen, stubTurnOn, stubRemoveListener;setup(function(){stubTelephony={};stubCpuWakeLock={};stubAttentionScreen={};stubTurnOn=this.sinon.stub(ScreenManager, 'turnScreenOn');stubRemoveListener=this.sinon.stub(window, 'removeEventListener');stubCpuWakeLock.unlock=this.sinon.stub();stubAttentionScreen.show=this.sinon.stub();ScreenManager._cpuWakeLock=stubCpuWakeLock;switchProperty(navigator, 'mozTelephony', stubTelephony, reals);switchProperty(window, 'AttentionScreen', stubAttentionScreen, reals);});teardown(function(){restoreProperty(navigator, 'mozTelephony', reals);restoreProperty(window, 'AttentionScreen', reals);});test('screen off by proximity', function(){stubTelephony.calls=[];ScreenManager._screenOffBy= 'proximity';ScreenManager.handleEvent({'type': 'callschanged'});assert.isTrue(stubTurnOn.called);assert.isNull(ScreenManager._cpuWakeLock);assert.isTrue(stubCpuWakeLock.unlock.called);assert.isFalse(stubAttentionScreen.show.called);});test('screen off', function(){stubTelephony.calls=[];ScreenManager._screenOffBy= '';ScreenManager.handleEvent({'type': 'callschanged'});assert.isFalse(stubTurnOn.called);});test('with a call', function(){var stubAddListener=this.sinon.stub();stubTelephony.calls=[{'addEventListener':stubAddListener}];ScreenManager.handleEvent({'type': 'callschanged'});assert.isTrue(stubAttentionScreen.show.called);assert.isFalse(stubAddListener.called);});test('without cpuWakeLock', function(){var stubAddListener=this.sinon.stub();stubTelephony.calls=[{'addEventListener':stubAddListener}];ScreenManager._cpuWakeLock=null;ScreenManager.handleEvent({'type': 'callschanged'});assert.isFalse(stubAttentionScreen.show.called);assert.isTrue(stubAddListener.called);});});suite('Testing statechange event', function(){var stubReqWakeLock, stubAddListener, stubCallRemoveListener, evt;setup(function(){stubReqWakeLock=this.sinon.stub(navigator, 'requestWakeLock');stubAddListener=this.sinon.stub(window, 'addEventListener');stubCallRemoveListener=this.sinon.stub();evt={ 'type': 'statechange', 'target':{ 'removeEventListener':stubCallRemoveListener}};});test('state is disconnected', function(){evt.target.state= 'disconnected';ScreenManager.handleEvent(evt);assert.isFalse(stubCallRemoveListener.called);assert.isFalse(stubAddListener.called);assert.isFalse(stubReqWakeLock.called);});test('state is connected', function(){evt.target.state= 'connected';ScreenManager.handleEvent(evt);assert.isTrue(stubCallRemoveListener.called);assert.isTrue(stubAddListener.called);assert.isTrue(stubReqWakeLock.called);});});});suite('turnScreenOff()', function(){var stubSetIdle, stubRemoveListener, stubScnClassListAdd, stubScreen, stubFireEvent, stubUnlock, stubSetBrightness;setup(function(){stubSetIdle=this.sinon.stub(ScreenManager, '_setIdleTimeout');stubRemoveListener=this.sinon.stub(window, 'removeEventListener');stubScnClassListAdd=this.sinon.stub();stubScreen={'classList':{'add':stubScnClassListAdd}};stubFireEvent=this.sinon.stub(ScreenManager, 'fireScreenChangeEvent');stubUnlock=this.sinon.stub();stubSetBrightness=this.sinon.stub(ScreenManager, 'setScreenBrightness');switchProperty(ScreenManager, 'screen', stubScreen, reals);ScreenManager._cpuWakeLock={'unlock':stubUnlock};});teardown(function(){restoreProperty(ScreenManager, 'screen', reals);});test('when screen disabled', function(){ScreenManager.screenEnabled=false;assert.isFalse(ScreenManager.turnScreenOff());});test('turn off screen with instant argument', function(){ScreenManager.screenEnabled=true;assert.isTrue(ScreenManager.turnScreenOff(true, 'powerkey'));this.sinon.clock.tick(20);assert.equal(stubRemoveListener.callCount, 4);assert.isTrue(stubSetIdle.calledWith(0));assert.isFalse(ScreenManager.screenEnabled);assert.isTrue(stubScnClassListAdd.calledWith('screenoff'));assert.isTrue(stubSetBrightness.calledWith(0, true));assert.isFalse(MockMozPower.screenEnabled);assert.isTrue(ScreenManager.fireScreenChangeEvent.called);});test('turn off screen wihout instant argument', function(){ScreenManager.screenEnabled=true;assert.isTrue(ScreenManager.turnScreenOff(false));assert.isFalse(stubSetIdle.called);this.sinon.clock.tick(ScreenManager._dimNotice);assert.isTrue(stubSetIdle.called);});test('turn off screen but not in transition', function(){ScreenManager.screenEnabled=true;assert.isTrue(ScreenManager.turnScreenOff(false));ScreenManager._inTransition=false;this.sinon.clock.tick(ScreenManager._dimNotice);assert.isFalse(stubSetIdle.called);});});suite('turnScreenOn()', function(){var stubSetBrightness, stubReconfTimeout, stubTelephony={}, stubReqWakeLock, stubAddListener, stubScnClassListRemove, stubScreen, stubFireEvent;setup(function(){stubSetBrightness=this.sinon.stub(ScreenManager, 'setScreenBrightness');stubReconfTimeout=this.sinon.stub(ScreenManager, '_reconfigScreenTimeout');switchProperty(navigator, 'mozTelephony', stubTelephony, reals);stubReqWakeLock=this.sinon.stub(navigator, 'requestWakeLock');stubAddListener=this.sinon.stub(window, 'addEventListener');stubScnClassListRemove=this.sinon.stub();stubScreen={'classList':{'remove':stubScnClassListRemove}};switchProperty(ScreenManager, 'screen', stubScreen, reals);stubFireEvent=this.sinon.stub(ScreenManager, 'fireScreenChangeEvent');});teardown(function(){restoreProperty(navigator, 'mozTelephony', reals);restoreProperty(ScreenManager, 'screen', reals);});test('screen enabled when _inTransition is false', function(){ScreenManager.screenEnabled=true;ScreenManager._inTransition=false;assert.isFalse(ScreenManager.turnScreenOn(true));assert.isFalse(stubReconfTimeout.called);});test('screen enabled when _inTransition is false', function(){ScreenManager._inTransition=true;assert.isFalse(ScreenManager.turnScreenOn(true));assert.isTrue(stubSetBrightness.called);assert.isTrue(stubReconfTimeout.called);});test('screen disabled when _deviceLightEnable is true', function(){ScreenManager.screenEnabled=false;stubTelephony.calls=[];ScreenManager._deviceLightEnable=true;ScreenManager.turnScreenOn(true);assert.isTrue(stubScnClassListRemove.called);assert.isTrue(stubAddListener.called);assert.isTrue(stubReconfTimeout.called);assert.isTrue(stubFireEvent.called);});test('screen disabled when _deviceLightEnable is false', function(){ScreenManager._deviceLightEnable=false;stubAddListener.reset();ScreenManager.turnScreenOn(true);assert.isFalse(stubAddListener.called);});test('screen disabled with a call', function(){ScreenManager.screenEnabled=false;stubTelephony.calls=[{'state': 'connected'}];ScreenManager.turnScreenOn(true);assert.isTrue(stubReqWakeLock.calledWith('cpu'));assert.isTrue(stubAddListener.calledWith('userproximity'));});});suite('setScreenBrightness()', function(){var stubClearTimeout, stubTransBrightness;setup(function(){stubClearTimeout=this.sinon.stub(window, 'clearTimeout');stubTransBrightness=this.sinon.stub(ScreenManager, 'transitionBrightness');});test('set brightness with instant argument', function(){ScreenManager.setScreenBrightness(0.5, true);assert.isFalse(stubTransBrightness.called);assert.equal(MockMozPower.screenBrightness, 0.5);});test('set brightness without instant argument', function(){ScreenManager.setScreenBrightness(0.5, false);assert.isTrue(stubTransBrightness.called);});});suite('transitionBrightness()', function(){test('same brightness', function(){ScreenManager._transitionBrightnessTimer= 'not null';ScreenManager._targetBrightness=0.5;MockMozPower.screenBrightness=0.5;ScreenManager.transitionBrightness();assert.isNull(ScreenManager._transitionBrightnessTimer);});test('brightness from 0.9 to 0.4', function(){MockMozPower.screenBrightness=0.9;ScreenManager._targetBrightness=0.4;ScreenManager.transitionBrightness();assert.equal(MockMozPower.screenBrightness, 0.9&#45;ScreenManager.BRIGHTNESS_ADJUST_STEP);});test('brightness from 0.4 to 0.9', function(){MockMozPower.screenBrightness=0.4;ScreenManager._targetBrightness=0.9;ScreenManager.transitionBrightness();assert.equal(MockMozPower.screenBrightness, 0.4+ScreenManager.BRIGHTNESS_ADJUST_STEP);});});suite('setDeviceLightEnabled()', function(){var stubSetBrightness, stubAddListener, stubRemoveListener;setup(function(){stubSetBrightness=this.sinon.stub(ScreenManager, 'setScreenBrightness');stubAddListener=this.sinon.stub(window, 'addEventListener');stubRemoveListener=this.sinon.stub(window, 'removeEventListener');});test('if setDeviceLightEnabled(false) and '+ '_deviceLightEnabled is true', function(){ScreenManager._userBrightness=0.5;ScreenManager._deviceLightEnabled=true;ScreenManager.setDeviceLightEnabled(false);assert.isTrue(stubSetBrightness.calledWith(0.5, false));});test('if argument is true', function(){ScreenManager.setDeviceLightEnabled(true);assert.isFalse(stubSetBrightness.called);});test('if argument is false', function(){ScreenManager.setDeviceLightEnabled(false);assert.isFalse(stubAddListener.called);assert.isTrue(stubRemoveListener.called);});test('if argument &amp;screenEnabled are both true', function(){ScreenManager.screenEnabled=true;ScreenManager.setDeviceLightEnabled(true);assert.isTrue(stubAddListener.called);assert.isFalse(stubRemoveListener.called);});});test('_setIdleTimeout()', function(){var stubClearIdleTimeout, stubSetIdleTimeout;setup(function(){stubClearIdleTimeout=this.sinon.stub();switchProperty(window, 'clearIdleTimeout', stubClearIdleTimeout, reals);stubSetIdleTimeout=this.sinon.stub();switchProperty(window, 'setIdleTimeout', stubSetIdleTimeout, reals);});teardown(function(){restoreProperty(window, 'clearIdleTimeout', reals);restoreProperty(window, 'setIdleTimeout', reals);});test('set idle timeout to 100', function(){ScreenManager._setIdleTimeout(100, true);assert.isTrue(stubClearIdleTimeout.called);assert.isTrue(stubSetIdleTimeout.called);});test('set idle timeout to 0', function(){ScreenManager._setIdleTimeout(0, true);assert.isTrue(stubClearIdleTimeout.called);assert.isFalse(stubSetIdleTimeout.called);});});test('fireScreenChangeEvent()', function(){var stubDispatchEvent=this.sinon.stub(window, 'dispatchEvent');ScreenManager.fireScreenChangeEvent();assert.isTrue(stubDispatchEvent.called);});suite('autoAdjustBrightness()', function(){var stubSetBrightness;setup(function(){ScreenManager._targetBrightness=&#45;1;stubSetBrightness=this.sinon.stub(ScreenManager, 'setScreenBrightness');});test('auto adjust brightness to lux 0.1', function(){ScreenManager.autoAdjustBrightness(0.1);assert.isTrue(stubSetBrightness.calledWith(0.1));});test('auto adjust brightness to lux 1', function(){ScreenManager.autoAdjustBrightness(1);assert.isTrue(stubSetBrightness.calledWith(0.1));});test('auto adjust brightness to lux 10', function(){ScreenManager.autoAdjustBrightness(10);assert.isTrue(stubSetBrightness.calledWith(0.27));});test('auto adjust brightness to lux 10000', function(){ScreenManager.autoAdjustBrightness(10000);assert.isTrue(stubSetBrightness.calledWith(1));});test('auto adjust brightness to lux 20000', function(){ScreenManager.autoAdjustBrightness(20000);assert.isTrue(stubSetBrightness.calledWith(1));});test('auto adjust to same value as current brightness', function(){ScreenManager._targetBrightness=0.1;ScreenManager.autoAdjustBrightness(1);assert.isFalse(stubSetBrightness.called);});});suite('toggleScreen()', function(){var stubTurnOff, stubTurnOn;setup(function(){stubTurnOff=this.sinon.stub(ScreenManager, 'turnScreenOff');stubTurnOn=this.sinon.stub(ScreenManager, 'turnScreenOn');});test('if screenEnabled is true', function(){ScreenManager.screenEnabled=true;ScreenManager.toggleScreen();assert.isTrue(stubTurnOff.calledWith(true, 'toggle'));assert.isFalse(stubTurnOn.called);});test('if screenEnabled is false', function(){ScreenManager.screenEnabled=false;ScreenManager.toggleScreen();assert.isTrue(stubTurnOn.called);assert.isFalse(stubTurnOff.called);});});})" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a> </td>
          <td>(</td>
          <td class="paramtype">'system/<a class="el" href="../../df/d36/screen__manager_8js.html#a85da607ebbb1d8f4e8873a20150a577c">ScreenManager</a>'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab67f3aaacb8d055bdcdab925b61b72b7"></a><!-- doxytag: member="screen_manager_test.js::switchProperty" ref="ab67f3aaacb8d055bdcdab925b61b72b7" args="(originObject, prop, stub, reals, useDefineProperty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> <a class="el" href="../../da/d54/screen__manager__test_8js.html#ab67f3aaacb8d055bdcdab925b61b72b7">switchProperty</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>originObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>useDefineProperty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../da/d54/screen__manager__test_8js_source.html">screen_manager_test.js</a> の <a class="el" href="../../da/d54/screen__manager__test_8js_source.html#l00012">12</a> 行で定義されています。</p>
<div class="fragment"><pre class="fragment">                                                                            {
  <span class="keywordflow">if</span> (!useDefineProperty) {
    reals[prop] = originObject[prop];
    originObject[prop] = stub;
  } <span class="keywordflow">else</span> {
    Object.defineProperty(originObject, prop, {
      configurable: <span class="keyword">true</span>,
      <span class="keyword">get</span>: <span class="keyword">function</span>() { <span class="keywordflow">return</span> stub; }
    });
  }
}
</pre></div>
</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="ae2475e10618961c050dcba04e8c42331"></a><!-- doxytag: member="screen_manager_test.js::strict" ref="ae2475e10618961c050dcba04e8c42331" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d1b/test-agent-server_8js.html#aab71dcc804ca4aa3ed2bf7ba887635db">use</a> <a class="el" href="../../de/dc5/jsfriendapi_8h.html#a8cddd7ed2617ebace48da2e8e44f267c">strict</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../da/d54/screen__manager__test_8js_source.html">screen_manager_test.js</a> の <a class="el" href="../../da/d54/screen__manager__test_8js_source.html#l00001">1</a> 行で定義されています。</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../da/d54/screen__manager__test_8js.html">screen_manager_test.js</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:57:51に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
