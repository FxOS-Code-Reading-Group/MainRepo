<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: modify_event_test.js</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d8/d0e/modify__event__test_8js.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">関数</a>  </div>
  <div class="headertitle">
<div class="title">modify_event_test.js</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="../../d8/d0e/modify__event__test_8js_source.html">ソースコードを見る。</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
関数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d0e/modify__event__test_8js.html#af2124e4df645d38fd46481d84f4b0d13">requireLib</a> ('provider/abstract.js')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d0e/modify__event__test_8js.html#a8dcd3bbd98527984123eaa2b36c08c43">requireElements</a> ('calendar/elements/modify_event.html')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d0e/modify__event__test_8js.html#a9e4359d0fc96a671db37869ebf35ea31">suiteGroup</a> ('Views.ModifyEvent', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a>;var <a class="el" href="../../d6/da8/facebook__connector__test_8js.html#ab17dfde70922e77b2bbcbd0192a12531">subject</a>;var controller;var <a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>;var <a class="el" href="../../d8/d28/prtime_8h.html#ac0951770f2d686312e30a8056a33fd9a">fmt</a>;var provider;var eventStore;var calendarStore;var accountStore;var settingStore;<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> clearMS(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a94ea84d1e418dad15ea65e006b293fdd">date</a>){var newDate=new Date(date.valueOf());newDate.setMilliseconds(0);<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> newDate;}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> hasClass(<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> subject.element.classList.contains(<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> getEl(<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> subject.getEl(<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> setFieldValue(<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){var field=getEl(<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> <a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">field.value</a>=<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>;}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> fieldValue(<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>){var field=getEl(<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>);<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> <a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">field.value</a>;}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> <a class="el" href="../../d8/d24/apps_2music_2js_2utils_8js.html#a229670477f9e26ed134a0b2c5c195dc8">escapeHTML</a>(html){var template=new <a class="el" href="../../dd/d78/shared_2js_2template_8js.html#a81d0729fc921367758f63c5ace0d54a6">Calendar.Template</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> this.h('<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>');});<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> <a class="el" href="../../d3/d91/j3d_8js.html#ae7817194480cfc900873938c8e7dd602">template.render</a>({value:html});}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> primaryIsEnabled(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(!subject.primaryButton.hasAttribute('aria-disabled'), '<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> is <a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#ad40d8437f6cf8675f077c4117119c8c0">enabled</a>');}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> primaryIsDisabled(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject.primaryButton.hasAttribute('aria-disabled'), '<a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> is disabled');}var <a class="el" href="../../dd/d9c/apps_2communications_2contacts_2test_2unit_2helper_8js.html#a11e5107af8f4ad8bea619753be86950b">triggerEvent</a>;var <a class="el" href="../../dc/d39/system_2js_2value__selector_2input__parser_8js.html#a35c21482da4c13e6507577844bba5fbb">InputParser</a>;suiteSetup(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../dd/d9c/apps_2communications_2contacts_2test_2unit_2helper_8js.html#a11e5107af8f4ad8bea619753be86950b">triggerEvent</a>=<a class="el" href="../../dd/d9c/apps_2communications_2contacts_2test_2unit_2helper_8js.html#a11e5107af8f4ad8bea619753be86950b">testSupport.calendar.triggerEvent</a>;<a class="el" href="../../dc/d39/system_2js_2value__selector_2input__parser_8js.html#a35c21482da4c13e6507577844bba5fbb">InputParser</a>=<a class="el" href="../../dc/d39/system_2js_2value__selector_2input__parser_8js.html#a35c21482da4c13e6507577844bba5fbb">Calendar.Utils.InputParser</a>;});var realGo;teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d7/d8a/list_8js.html#a25e7026ed54a4f203c2c06c4aef7011a">Calendar.App.go</a>=realGo;});suiteTemplate('<a class="el" href="../../db/df4/geoloc_8js.html#a34b2bb38da6ac84e5708382e03478900">show</a>-<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>',{id: '<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>-<a class="el" href="../../db/d80/download_8js.html#acc4e419f5bedc9e697af56e25c615638">view</a>'});suiteTemplate('modify-<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>',{id: 'modify-<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>-<a class="el" href="../../db/d80/download_8js.html#acc4e419f5bedc9e697af56e25c615638">view</a>'});<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a>=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">testSupport.calendar.app</a>();realGo=<a class="el" href="../../d7/d8a/list_8js.html#a25e7026ed54a4f203c2c06c4aef7011a">app.go</a>;eventStore=app.store('<a class="el" href="../../d8/dd1/test_2marionette_2event_8js.html#aded1d021a890cccaab7c7ebd7450f106">Event</a>');accountStore=app.store('Account');calendarStore=app.store('<a class="el" href="../../da/deb/test_2marionette_2calendar_8js.html#a9e59614375174233310bf509a692b91a">Calendar</a>');settingStore=app.store('Setting');provider=app.provider('Mock');<a class="el" href="../../d8/d28/prtime_8h.html#ac0951770f2d686312e30a8056a33fd9a">fmt</a>=<a class="el" href="../../d3/d4b/l10n__date_8js.html#abcbd138ca956bcc812dbabd5df8945f8">navigator.mozL10n.DateTimeFormat</a>();controller=app.timeController;<a class="el" href="../../da/d84/openvideo_8js.html#a2a6896c38bfcbba014743ee706623b5d">app.db.open</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);<a class="el" href="../../d6/da8/facebook__connector__test_8js.html#ab17dfde70922e77b2bbcbd0192a12531">subject</a>=new Calendar.Views.ModifyEvent({app:app});});testSupport.calendar.accountEnvironment();testSupport.calendar.eventEnvironment({startDate:new Date(2012, 1, 1, 1), endDate:new Date(2012, 1, 5, 1)},{startDate:new Date(2012, 1, 1, 1), endDate:new Date(2012, 1, 5, 1)});teardown(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){testSupport.calendar.clearStore(<a class="el" href="../../d1/d0b/browser__db_8js.html#a699c7194b69fa5470e5f97986af77ee1">app.db</a>,['accounts', 'calendars', 'events', 'busytimes', 'alarms'], <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../dd/df0/dialogs__end__init_8js.html#acdb1449d11a5550a30ee4a18b9c7f133">app.db.close</a>();<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});});var remote;var <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>;var calendar;var account;var busytime;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){remote=this.event.remote;<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>=<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">this.event</a>;calendar=this.calendar;account=this.account;busytime=this.busytime;});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('initialization', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){assert.instanceOf(<a class="el" href="../../d6/da8/facebook__connector__test_8js.html#ab17dfde70922e77b2bbcbd0192a12531">subject</a>, Calendar.View);assert.instanceOf(<a class="el" href="../../d6/da8/facebook__connector__test_8js.html#ab17dfde70922e77b2bbcbd0192a12531">subject</a>, Calendar.Views.EventBase);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject._changeToken, 0);<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject._els, 'has fields');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('.<a class="el" href="../../de/d8f/jsdebug_8h.html#a0818854fd36b9ae0fdfe5872464dae94">status</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(<a class="el" href="../../de/d8f/jsdebug_8h.html#a0818854fd36b9ae0fdfe5872464dae94">subject.status</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('.errors', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject.errors);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('.form', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject.form);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject.form.tagName.toLowerCase(), 'form');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('.primaryButton', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject.primaryButton);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('.deleteButton', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject.deleteButton);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('.fieldRoot', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(subject.fieldRoot);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject.fieldRoot, subject.form);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('#getEl', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var expected=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">subject.form.querySelector</a>('[<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>=&quot;title&quot;]');assert.ok(expected);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(expected.tagName.toLowerCase(), '<a class="el" href="../../d2/d7d/jsapi_8h.html#a8908b6d42ac95ee6387e73b7ac543dae">input</a>');var <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#ad4dc7d3fd716004895ed4c669af1c61c">result</a>=subject.getEl('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#ad4dc7d3fd716004895ed4c669af1c61c">result</a>, expected);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#ad4dc7d3fd716004895ed4c669af1c61c">result</a>, subject.getEl('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>'));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">subject._els.title</a>, expected);});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('#_updateUI', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>=subject.element.classList;});<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> updatesValues(overrides, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){getEl('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>').<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>= 'foo';event.remote.description= '&lt; span &gt;foo&lt;/span &gt;';var expected={<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title:remote.title</a>, <a class="el" href="../../d5/d35/tools_2xpcwindow_2lib_2window_2window_8js.html#a009e1b25f7059061a6508b10c9435823">location:remote.location</a>, startDate:InputParser.exportDate(remote.startDate), startTime:InputParser.exportTime(remote.startDate), endDate:InputParser.exportDate(remote.endDate), endTime:InputParser.exportTime(remote.endDate), <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">currentCalendar:calendar.remote.name</a>};var <a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>;<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(overrides){<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a>(<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a> in overrides){expected[<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>]=overrides[<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>];}}<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> verify(){<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(subject.provider.canCreateEvent){expected.calendarId=this.event.calendarId;}<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a>(<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a> in expected){<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(expected.hasOwnProperty(<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>)){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(fieldValue(<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>), expected[<a class="el" href="../../d2/d7d/jsapi_8h.html#a02d8cbd1392e102198d5bb521715f608">key</a>], 'should <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a>&quot;' + key + '&quot;');}}var curCal=getEl('currentCalendar');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(curCal.readOnly, 'current calendar readonly');var expected=<a class="el" href="../../d8/d24/apps_2music_2js_2utils_8js.html#a229670477f9e26ed134a0b2c5c195dc8">escapeHTML</a>(event.remote.description);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(getEl('description').<a class="el" href="../../d1/d04/app__install__manager_8js.html#acd145aedb51101ac15a526f73673b0b9">innerHTML</a>, expected);<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();}subject.onfirstseen();subject.onafteronfirstseen=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.useModel(busytime, <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, verify);};}<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('provider can <a class="el" href="../../d9/d13/shared_2style_2_r_e_a_d_m_e_8md.html#a1b6362cb1eaf9d23d7ff55da0225251e">edit</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){updatesValues(<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(!getEl('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>').readOnly, 'does not <a class="el" href="../../dd/dc2/plarenas_8h.html#af34a496b61ba99953cf618a41fc44b0b">mark</a> as readOnly');});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('provider cannot <a class="el" href="../../d9/d13/shared_2style_2_r_e_a_d_m_e_8md.html#a1b6362cb1eaf9d23d7ff55da0225251e">edit</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){provider.stageEventCapabilities(event._id, <a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>,{canUpdate:false, canCreate:false});remote.startDate=new Date(2012, 0, 1, 10);updatesValues(<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(list.contains(subject.READONLY), 'is readonly');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.ALLDAY), 'is allday');var allday=subject.getEl('allday');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(allday.checked, 'is allday');<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(getEl('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>').readOnly, '<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#a2d75606ecb49f383eca31a7101127d95">marks</a> readonly');});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d7/d1b/test-agent-server_8js.html#aab71dcc804ca4aa3ed2bf7ba887635db">use</a> busytime <a class="el" href="../../d1/d03/locales_2_r_e_a_d_m_e_8md.html#a62bde082af4374a2a9c3399269c7548c">instance</a> when isRecurring', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var eventRecurring=<a class="el" href="../../d4/d6d/factory_8js.html#a95acddcf8d59f67c9a249c3266057e91">Factory</a>('<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>',{calendarId:calendar._id, remote:{isRecurring:true, startDate:new Date(2012, 1, 1, 1), endDate:new Date(2012, 1, 5, 1)}});var busytimeRecurring=<a class="el" href="../../d4/d6d/factory_8js.html#a95acddcf8d59f67c9a249c3266057e91">Factory</a>('busytime',{eventId:eventRecurring._id, startDate:new Date(2012, 10, 30, 1), endDate:new Date(2012, 10, 31, 1)});subject.useModel(busytimeRecurring, eventRecurring, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var expected={startDate:busytimeRecurring.startDate, endDate:busytimeRecurring.endDate};var actual=subject.formData();actual.calendarId=parseInt(actual.calendarId, 10);<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(actual, expected);});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('when <a class="el" href="../../d6/d1b/pprthred_8h.html#a0798cf327c99b856b5ecf03e5f4deb4d">start</a> &amp;<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a> times are 00:00:00', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){remote.startDate=new Date(2012, 0, 1);remote.endDate=new Date(2012, 0, 2);updatesValues({endDate: '2012-01-01'}, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allday=subject.getEl('allday');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(allday.checked, 'checks all day');<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(list.contains(subject.ALLDAY));});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('saved alarms are shown <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> all-day events', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){remote.startDate=new Date(2012, 0, 1);remote.endDate=new Date(2012, 0, 2);remote.alarms=[{trigger:-300},{trigger:0}];var updateTo={alarms:remote.alarms, endDate: '2012-01-01'};updatesValues(updateTo, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allday=subject.getEl('allday');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(allday.checked, 'checks all day');<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(list.contains(subject.ALLDAY));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">subject.event.alarms.length</a>, 2);});});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d3/d4b/lockscreen_8js.html#a94ea84d1e418dad15ea65e006b293fdd">date</a>/<a class="el" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a> are displayed according <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> the <a class="el" href="../../de/dc5/jsfriendapi_8h.html#a38008f9ebcd87acfca726e35504b2e8d">locale</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){remote.startDate=new Date(2012, 11, 30, 1, 2);remote.endDate=new Date(2012, 11, 31, 13, 4);updatesValues({}, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var startDateLocale=<a class="el" href="../../d4/d8c/viewphoto_8js.html#a6d08c5d82e2ca7c6042afb9f8ae078c1">document.getElementById</a>('<a class="el" href="../../d6/d1b/pprthred_8h.html#a0798cf327c99b856b5ecf03e5f4deb4d">start</a>-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a94ea84d1e418dad15ea65e006b293fdd">date</a>-<a class="el" href="../../de/dc5/jsfriendapi_8h.html#a38008f9ebcd87acfca726e35504b2e8d">locale</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">startDateLocale.textContent</a>, '12/30/2012');var endDateLocale=<a class="el" href="../../d4/d8c/viewphoto_8js.html#a6d08c5d82e2ca7c6042afb9f8ae078c1">document.getElementById</a>('<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a>-<a class="el" href="../../d3/d4b/lockscreen_8js.html#a94ea84d1e418dad15ea65e006b293fdd">date</a>-<a class="el" href="../../de/dc5/jsfriendapi_8h.html#a38008f9ebcd87acfca726e35504b2e8d">locale</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">endDateLocale.textContent</a>, '12/31/2012');var startTimeLocale=<a class="el" href="../../d4/d8c/viewphoto_8js.html#a6d08c5d82e2ca7c6042afb9f8ae078c1">document.getElementById</a>('<a class="el" href="../../d6/d1b/pprthred_8h.html#a0798cf327c99b856b5ecf03e5f4deb4d">start</a>-<a class="el" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a>-<a class="el" href="../../de/dc5/jsfriendapi_8h.html#a38008f9ebcd87acfca726e35504b2e8d">locale</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">startTimeLocale.textContent</a>, '1:02 AM');var endTimeLocale=<a class="el" href="../../d4/d8c/viewphoto_8js.html#a6d08c5d82e2ca7c6042afb9f8ae078c1">document.getElementById</a>('<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a>-<a class="el" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a>-<a class="el" href="../../de/dc5/jsfriendapi_8h.html#a38008f9ebcd87acfca726e35504b2e8d">locale</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">endTimeLocale.textContent</a>, '1:04 PM');});});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('#_overrideEvent', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var startDate;var endDate;var <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a86efbc42dbdb988b9a864b83af26e0de">search</a>;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){startDate=new Date(1989, 4, 17, 2, 0, 0, 0);endDate=new Date(1989, 4, 17, 3, 0, 0, 0);var queryString={<a class="el" href="../../dd/d78/shared_2js_2template_8js.html#a47ec4a4c23bf94a45f76da63b59df7af">startDate:startDate.toString</a>(), <a class="el" href="../../dd/d78/shared_2js_2template_8js.html#a47ec4a4c23bf94a45f76da63b59df7af">endDate:endDate.toString</a>()};<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a86efbc42dbdb988b9a864b83af26e0de">search</a>= '?'+<a class="el" href="../../d1/d22/ical_8js.html#a8076921037776baf4e4838660048f802">Calendar.QueryString.stringify</a>(queryString);subject.useModel(this.busytime, <a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">this.event</a>, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('should <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a> startDate and endDate <a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#ac00bf23adf7cb4c5253268889722ca05">on</a> the <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){assert.notEqual(subject.event.startDate.getTime(), startDate.getTime());assert.notEqual(subject.event.endDate.getTime(), endDate.getTime());subject._overrideEvent(<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a86efbc42dbdb988b9a864b83af26e0de">search</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject.event.startDate.getTime(), startDate.getTime());<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject.event.endDate.getTime(), endDate.getTime());});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('#_markReadonly', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject._markReadonly(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);var fields=subject.form.querySelectorAll('[<a class="el" href="../../d9/d04/expat_8h.html#a4a7cccd86625791f7f2ce3fb477aa9c1">name</a>]');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">fields.length</a> &gt; 1, 'has fields');var <a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>=0;var field;<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a>(;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>&lt; <a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">fields.length</a>;<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>++){field=fields[<a class="el" href="../../da/d7d/sylvester_8js.html#a091f0effa2d52e9315e1f032073e953b">i</a>];<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(field.readOnly, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">field.name</a>);}});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('#<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">reset</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>=subject.element.classList;subject._markReadonly(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);var <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>=getEl('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>');<a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">title.value</a>= 'foo';<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">list.add</a>(subject.ALLDAY);<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">list.add</a>(subject.UPDATE);<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">list.add</a>(subject.CREATE);<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">list.add</a>(subject.READONLY);subject._returnTo= 'foo';subject.provider= 'foobar';<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">subject.event</a>= 'foo';subject.busytime= 'foo';var allday=subject.getEl('allday');allday.checked=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;<a class="el" href="../../df/d12/latin__test_8js.html#aa01b7cbc60d07525859f73a229026697">subject.reset</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(allday.checked, 'removes allday check');assert.isNull(subject._returnTo);assert.isNull(subject.provider, '<a class="el" href="../../da/dab/system_2camera_2js_2filmstrip_8js.html#a30a5f1efdb2e5f6d5981b81ea3205a55">clear</a> provider');assert.isNull(<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">subject.event</a>, '<a class="el" href="../../da/dab/system_2camera_2js_2filmstrip_8js.html#a30a5f1efdb2e5f6d5981b81ea3205a55">clear</a> <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>');assert.isNull(subject.busytime, 'clears busytime');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.ALLDAY), 'allday');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.READONLY), 'readonly');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.CREATE), '<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> <a class="el" href="../../d1/dce/utils_81_83_8js.html#ab92647390e7481607cad94f9c4cf38f0">create</a> class');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.UPDATE), '<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> <a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a> class');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(title.readOnly, 'clears readOnly');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">title.value</a>, '', '<a class="el" href="../../da/dab/system_2camera_2js_2filmstrip_8js.html#a30a5f1efdb2e5f6d5981b81ea3205a55">clear</a> <a class="el" href="../../df/d12/latin__test_8js.html#a6c999f72dcd048b9f43513afcab6622d">inputs</a>');});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('#formData', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.onfirstseen();subject.onafteronfirstseen=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.useModel(busytime, <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);};});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('when allday', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allday=getEl('allday');allday.checked=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;setFieldValue('startDate', '2012-01-01');setFieldValue('endDate', '2012-01-02');setFieldValue('endTime', '01:07:00');setFieldValue('<a class="el" href="../../d3/d91/j3d_8js.html#a604297ad8460b8482beeb0c441cf491a">startTime</a>', '01:08:00');var <a class="el" href="../../de/dc5/jsfriendapi_8h.html#a0c4e9efe1571ce3ef20a0baf42a47be9">props</a>=subject.formData();<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(subject.formData(),{startDate:new Date(2012, 0, 1), endDate:new Date(2012, 0, 3)});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('without modifications', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var expected={startDate:clearMS(event.remote.startDate), endDate:clearMS(event.remote.endDate), <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title:event.remote.title</a>, description:event.remote.description, <a class="el" href="../../d5/d35/tools_2xpcwindow_2lib_2window_2window_8js.html#a009e1b25f7059061a6508b10c9435823">location:event.remote.location</a>, calendarId:event.calendarId};<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(subject.formData(), expected);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with modifications', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var newStart=new Date(2011, 7, 1);var startDate=InputParser.exportDate(newStart);var <a class="el" href="../../d3/d91/j3d_8js.html#a604297ad8460b8482beeb0c441cf491a">startTime</a>=InputParser.exportTime(newStart);var newEnd=new Date(2012, 7, 1);var endDate=InputParser.exportDate(newEnd);var endTime=InputParser.exportTime(newEnd);var expected={startDate:newStart, endDate:newEnd, title: 'foo', description: 'bar', location: 'zomg', calendarId:this.calendar._id};setFieldValue('startDate', startDate);setFieldValue('<a class="el" href="../../d3/d91/j3d_8js.html#a604297ad8460b8482beeb0c441cf491a">startTime</a>', <a class="el" href="../../d3/d91/j3d_8js.html#a604297ad8460b8482beeb0c441cf491a">startTime</a>);setFieldValue('endDate', endDate);setFieldValue('endTime', endTime);setFieldValue('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>', <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">expected.title</a>);setFieldValue('description', expected.description);setFieldValue('<a class="el" href="../../d5/d35/tools_2xpcwindow_2lib_2window_2window_8js.html#a009e1b25f7059061a6508b10c9435823">location</a>', <a class="el" href="../../d5/d35/tools_2xpcwindow_2lib_2window_2window_8js.html#a009e1b25f7059061a6508b10c9435823">expected.location</a>);<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(subject.formData(), expected);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('#deleteRecord', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var calledWith;var realGo;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){calledWith=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;provider.deleteEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){calledWith=arguments;};subject.useModel(this.busytime, <a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">this.event</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject._returnTo= '/foo';<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('in <a class="el" href="../../d1/dce/utils_81_83_8js.html#ab92647390e7481607cad94f9c4cf38f0">create</a> <a class="el" href="../../db/da2/pripcsem_8h.html#a5ffbd19d0a0b87f9ff15e7d0c4410984">mode</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){provider.deleteEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){throw new <a class="el" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>('should not trigger delete');};subject.provider=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;subject.deleteRecord();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with an <a class="el" href="../../db/df4/geoloc_8js.html#ac3dbd5af3a73f4aa69249dd1c6b9c980">error</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var err=new Calendar.Error.Authentication();subject.showErrors=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(givenErr){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(err, givenErr);});};provider.deleteEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../d9/d04/expat_8h.html#ac517f0c27408fbd365e7dd34e032faca">model</a>, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){<a class="el" href="../../d6/dec/mocha-bin_8js.html#a537e168ad693c5794e1977de944002a0">Calendar.nextTick</a>(<a class="el" href="../../d3/d91/j3d_8js.html#a1ad2f17c038f79ef240a44e21a46ef14">callback.bind</a>(<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>, err));};subject.deleteRecord();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with valid provider', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){provider.deleteEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(toDelete, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(toDelete._id, event._id, 'deletes <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>');<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();};<a class="el" href="../../d7/d8a/list_8js.html#a25e7026ed54a4f203c2c06c4aef7011a">app.go</a>=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(place){assert.notEqual(place, '/foo', 'redirect is <a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#aea526ac279d0b19b1c082209fc199b73">changed</a> <a class="el" href="../../da/d32/prio_8h.html#a5d467a63df9ff99d33d6749038f6f421">to</a> <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a> <a class="el" href="../../de/d8f/jsdebug_8h.html#a39bb9861b2cb39f94badb5db778de746">url</a>');<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};subject.deleteRecord();});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('#<a class="el" href="../../da/db9/savebookmark_8js.html#aff8bdb5ae1d006c066ccbea289f8e863">save</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var redirectTo;var <a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>;var calledWith;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){calledWith=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>=subject.element.classList;<a class="el" href="../../d7/d8a/list_8js.html#a25e7026ed54a4f203c2c06c4aef7011a">app.go</a>=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(place){redirectTo=place;};});<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> haltsOnError(providerMethod){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('does not persist record when provider fails', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var dispatchesError;var err=new Calendar.Error.Authentication();subject.showErrors=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(gotErr){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(err, gotErr, 'dispatches <a class="el" href="../../db/df4/geoloc_8js.html#ac3dbd5af3a73f4aa69249dd1c6b9c980">error</a>');});};provider[providerMethod]=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d2/d7d/jsapi_8h.html#a52c9936fee3329d49b2cdede9b0fd7c8">args</a>=<a class="el" href="../../d4/d23/binary__string__view_8js.html#a611282d0b962f2d73c40c656cbe37aa5">Array.slice</a>(arguments);var <a class="el" href="../../d2/d7d/jsapi_8h.html#a9c0cec265243907d0da86b92bda26eca">cb</a>=args.pop();<a class="el" href="../../d6/dec/mocha-bin_8js.html#a537e168ad693c5794e1977de944002a0">Calendar.nextTick</a>(<a class="el" href="../../d3/d91/j3d_8js.html#a1ad2f17c038f79ef240a44e21a46ef14">cb.bind</a>(<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>, err));};subject.primary();});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('does not invoke provider when validations fails', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){provider[providerMethod]=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(new <a class="el" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>('should not persist record.'));};var <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>=<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">subject.event</a>;var errors=[new <a class="el" href="../../dc/d06/calendar_2js_2error_8js.html#abd05c43175d3c93c6889542cefc822f3">Error</a>('epic fail')];var displayedErrors;subject.showErrors=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(givenErrs){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){assert.deepEqual(givenErrs, errors, 'shows errors');});};subject.event.validationErrors=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> errors;};subject.primary();});}<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.onfirstseen();subject.onafteronfirstseen=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.useModel(busytime, <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject._returnTo= '/foo';<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});};});haltsOnError('updateEvent');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with provider that can <a class="el" href="../../d9/d13/shared_2style_2_r_e_a_d_m_e_8md.html#a1b6362cb1eaf9d23d7ff55da0225251e">edit</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){provider.updateEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(updated, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(updated._id, event._id, 'updates correcet <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>');var <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>=subject.formData();data.alarms=[];<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">subject.event</a>, <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, 'updated <a class="el" href="../../d9/d04/expat_8h.html#ac517f0c27408fbd365e7dd34e032faca">model</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(list.contains(subject.PROGRESS));<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.PROGRESS));assert.notEqual(redirectTo, '/foo');assert.deepEqual(<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#acd1cdae9d6d8493a6f34d308f8259f55">app.timeController.position</a>, subject.event.startDate, 'moves <a class="el" href="../../d6/da5/certt_8h.html#a5e84b1bdd0770310d2a7fd739ab6dbee">time</a> controller');});};setFieldValue('calendarId', this.calendar._id);setFieldValue('startDate', '2012-1-2');setFieldValue('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>', 'myfoo');subject.primary();});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../d1/dce/utils_81_83_8js.html#ab92647390e7481607cad94f9c4cf38f0">create</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.onfirstseen();subject.onafteronfirstseen=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.dispatch({params:{}});subject.ondispatch=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject._returnTo= '/foo';<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};};});haltsOnError('createEvent');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with provider that can <a class="el" href="../../d1/dce/utils_81_83_8js.html#ab92647390e7481607cad94f9c4cf38f0">create</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){provider.createEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>=subject.formData();data.alarms=[];<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">subject.event</a>, <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>, 'updated <a class="el" href="../../d9/d04/expat_8h.html#ac517f0c27408fbd365e7dd34e032faca">model</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(list.contains(subject.PROGRESS));<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(list.contains(subject.PROGRESS));<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(redirectTo, '/foo');assert.deepEqual(<a class="el" href="../../d8/dd4/ns_c_s_s_prop_list_8h.html#acd1cdae9d6d8493a6f34d308f8259f55">app.timeController.position</a>, subject.event.startDate, 'moves timeController');});};<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(!subject.provider, 'has no provider yet');setFieldValue('calendarId', calendar._id);setFieldValue('startDate', '2012-1-2');setFieldValue('endDate', '2012-1-3');setFieldValue('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a051e403214cb6872ad3fe4e50302a6ee">title</a>', 'myfoo');subject.primary();});});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('calendar <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a> handling', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var accounts=testSupport.calendar.dbFixtures( 'account', 'Account',{one:{_id:55, providerType: 'Mock'}});var calendars=testSupport.calendar.dbFixtures( 'calendar', '<a class="el" href="../../da/deb/test_2marionette_2calendar_8js.html#a9e59614375174233310bf509a692b91a">Calendar</a>',{one:{_id: 'one', accountId:55}, two:{_id: 'two', accountId:55}});var element;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){calendars[calendar._id]=calendar;subject.onafteronfirstseen=<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>;subject.onfirstseen();element=getEl('calendarId');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('calendarId <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a974637b453a6c3808b55236762181a2f">select</a> element', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">assert.length</a>(element.children, 3, 'has two calendars');var <a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>;var option;<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a> in calendars){option=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">element.querySelector</a>('[<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>=&quot;' + id + '&quot;]');assert.ok(option, 'option <a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a089b2988a149c0d135aaab57e2231481">for</a> id: '+<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">option.textContent</a>, calendars[<a class="el" href="../../de/d81/xpt__struct_8h.html#a0ad0ebb641411c0c63079e4440033275">id</a>].<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">remote.name</a>);}});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('rename calendar(#_updateCalendarId)', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.oncalendarupdate=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var option=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">element.querySelector</a>( '[<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>=&quot;' + calendars.one._id + '&quot;]');assert.equal(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">option.textContent</a>, 'fooobar');});};<a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">calendars.one.remote.name</a>= 'fooobar';<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a77912f28da5efe73d20f6c0c487bac9f">calendarStore.emit</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', calendars.one._id, calendars.one);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d9/dd6/_r_e_a_d_m_e_8md.html#ac1934db4e0289fcc2a08b0c7de017cf2">change</a> calendar permissions', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var newCalendar=<a class="el" href="../../d4/d6d/factory_8js.html#a95acddcf8d59f67c9a249c3266057e91">Factory</a>('calendar',{accountId:account._id});subject.onaddcalendar=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){provider.stageCalendarCapabilities(newCalendar._id,{canCreateEvent:false});<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">assert.length</a>(element.children, 4, 'added one');<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a77912f28da5efe73d20f6c0c487bac9f">calendarStore.emit</a>('<a class="el" href="../../dd/d6d/mock__spinner_8js.html#ab10b009b0da48f61217a18daf8e20cd8">update</a>', newCalendar._id, newCalendar);};subject.onremovecalendar=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">assert.length</a>(element.children, 3, 'added one');<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a77912f28da5efe73d20f6c0c487bac9f">calendarStore.emit</a>('<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a>', newCalendar._id, newCalendar);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a> calendar(#_addCalendarId)', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var newCal=<a class="el" href="../../d4/d6d/factory_8js.html#a95acddcf8d59f67c9a249c3266057e91">Factory</a>('calendar',{_id: 'three', accountId:account._id});<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a77912f28da5efe73d20f6c0c487bac9f">calendarStore.emit</a>('<a class="el" href="../../df/d44/permission__manager_8js.html#ae5a9ec7a035c6634f85498958b2c7a12">add</a>', newCal._id, newCal);subject.onaddcalendar=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">assert.length</a>(element.children, 4, 'added one');var option=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">element.querySelector</a>('[<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>=&quot;' + newCal._id + '&quot;]');assert.equal(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a231b448a4b70e9035748897db2fa1c2a">option.textContent</a>, <a class="el" href="../../de/d81/xpt__struct_8h.html#a1956a27e1e0205d6704940d480413e03">newCal.remote.name</a>);<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(option, 'added calendar');});};});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a> calendar(#_removeCalendarId)', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.onremovecalendar=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.onremovecalendar=<a class="el" href="../../d3/d52/blanket_8js.html#a24d794dfc756320ffadb905d526299bc">null</a>;<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">assert.length</a>(element.children, 2, 'removed one');var option=<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9bd72b771a78ff04c5bb1d670f034005">element.querySelector</a>('[<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>=&quot;' + calendars.two._id + '&quot;]');assert.ok(option, 'removed correct item');});};<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a77912f28da5efe73d20f6c0c487bac9f">calendarStore.emit</a>('preRemove', calendars.one._id);<a class="el" href="../../d0/d6e/build__stage_2email_2js_2ext_2mailapi_2imap_2probe_8js.html#a77912f28da5efe73d20f6c0c487bac9f">calendarStore.emit</a>('<a class="el" href="../../d1/d04/app__install__manager_8js.html#a9a509fff9fcf53ecd0f73c0d965a7d6b">remove</a>', calendars.one._id);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('alarm defaults', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var defaultAllDayAlarm;var defaultEventAlarm;var morning=3600 *9;var oneHour=3600;<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var pending=3;subject.onfirstseen();subject.onafteronfirstseen=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.dispatch({params:{}});subject.ondispatch=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject._returnTo= '/foo';next();};};<a class="el" href="../../d6/da5/libpinyin_8js.html#a3462cc6eb617727abfabace38088095d">settingStore.getValue</a>('standardAlarmDefault', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(err, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){defaultEventAlarm=<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>;next();});<a class="el" href="../../d6/da5/libpinyin_8js.html#a3462cc6eb617727abfabace38088095d">settingStore.getValue</a>('alldayAlarmDefault', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(err, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){defaultAllDayAlarm=<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>;next();});<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> next(){<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(!(--pending)){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();}}});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with no alarms <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">set</a>', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){provider.createEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>=subject.formData();<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();assert.deepEqual(data.alarms, subject.event.alarms, 'alarms');});};subject.primary();});<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> testAlarmIsAdded(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>, isAllDay, defaultAlarm){provider.createEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>=subject.formData();<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();assert.deepEqual(data.alarms,[{action: 'DISPLAY', trigger:defaultAlarm},{action: 'DISPLAY', trigger:123}], 'alarms');});};var allday=subject.getEl('allday');allday.checked=isAllDay;subject.event.isAllDay=isAllDay;subject.updateAlarms(isAllDay, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allAlarms=subject.alarmList.querySelectorAll('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a974637b453a6c3808b55236762181a2f">select</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">allAlarms.length</a>, 2);var secondSelect=allAlarms[1];<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(secondSelect);var newOption=document.createElement('option');<a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">newOption.value</a>= '123';secondSelect.appendChild(newOption);<a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">secondSelect.value</a>= '123';subject.primary();});}<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with all day defaults', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){testAlarmIsAdded(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>, <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, defaultAllDayAlarm);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a> defaults', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){testAlarmIsAdded(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>, <a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>, defaultEventAlarm);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('populated with no existing alarms', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.event.alarms=[];subject.updateAlarms(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allAlarms=subject.alarmList.querySelectorAll('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a974637b453a6c3808b55236762181a2f">select</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">allAlarms.length</a>, 2);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(allAlarms[0].<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, defaultAllDayAlarm);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(allAlarms[1].<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, 'none');<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('not populated with existing alarms', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.event.alarms=[{trigger:-300}];subject.updateAlarms(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allAlarms=subject.alarmList.querySelectorAll('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a974637b453a6c3808b55236762181a2f">select</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">allAlarms.length</a>, 2);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(allAlarms[0].<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>,-300);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(allAlarms[1].<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, 'none');<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('populated presaved <a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a> with no existing alarms', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.event.alarms=[];subject.isSaved=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d5/dff/tests_2python_2gaia-ui-tests_2gaiatest_2atoms_2screenshot_8js.html#a6bc243e0e988691de46b9baa46ec6413">return</a> <a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;};subject.updateAlarms(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allAlarms=subject.alarmList.querySelectorAll('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a974637b453a6c3808b55236762181a2f">select</a>');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">allAlarms.length</a>, 1);<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(allAlarms[0].<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>, 'none');<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});});<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> testDefaultAlarms(isAllDay, defaultValue, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){<a class="el" href="../../d6/da5/libpinyin_8js.html#a3462cc6eb617727abfabace38088095d">settingStore.getValue</a>('alldayAlarmDefault', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(err, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){var defaultAlarm=<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>;var defaultAlarmKey;<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(isAllDay===<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>){defaultAlarmKey= 'alldayAlarmDefault';}else{defaultAlarmKey= 'standardAlarmDefault';}<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">settingStore.set</a>(defaultAlarmKey, defaultValue, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(err, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){provider.createEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../df/dea/pkcs11t_8h.html#afaa077e4b9760c92cbaf0d838e743d8c">event</a>, <a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>){var <a class="el" href="../../d9/d04/expat_8h.html#aa11c5d56dba0976f16f07ea50b1999ba">data</a>=subject.formData();<a class="el" href="../../de/dc5/jsfriendapi_8h.html#ae9494ad8646a84b50bd3446d72433e82">callback</a>();<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(defaultValue=== 'none'){assert.deepEqual(data.alarms[0].trigger, 123, 'alarms');}else{assert.deepEqual(data.alarms[0].trigger, defaultValue, 'alarms');}<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a7d50e9587913d4f6634c0b0c8de693c7">settingStore.set</a>(defaultAlarmKey, defaultAlarm, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(err, <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();});};var allday=subject.getEl('allday');allday.checked=isAllDay;subject.event.isAllDay=isAllDay;subject.updateAlarms(isAllDay, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allAlarms=subject.alarmList.querySelectorAll('<a class="el" href="../../dc/d9e/_playlist_drawer_8js.html#a974637b453a6c3808b55236762181a2f">select</a>');var firstSelect=allAlarms[0];<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(firstSelect);<a class="el" href="../../de/dfc/events_8js.html#aa27c1f7f883859f374ef91e69db597bd">if</a>(defaultValue=== 'none'){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">allAlarms.length</a>, 1);var newOption=document.createElement('option');<a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">newOption.value</a>= '123';firstSelect.appendChild(newOption);<a class="el" href="../../db/da2/pripcsem_8h.html#a88ff5d30f0f4ac6ee617c663e93ac1ae">firstSelect.value</a>= '123';}else{<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(<a class="el" href="../../de/d81/xpt__struct_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">allAlarms.length</a>, 2);}subject.primary();});});});}<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Bug 898242-when allday alarm default is none', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var isAllDay=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;var defaultValue= 'none';testDefaultAlarms(isAllDay, defaultValue, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Bug 898242-when allday alarm default is not none', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var isAllDay=<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>;var defaultValue=morning;testDefaultAlarms(isAllDay, defaultValue, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Bug 898242-when standard alarm default is none', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var isAllDay=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;var defaultValue= 'none';testDefaultAlarms(isAllDay, defaultValue, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('Bug 898242-when standard alarm default is not none', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){var isAllDay=<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>;var defaultValue=oneHour;testDefaultAlarms(isAllDay, defaultValue, <a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('#returnTo', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('without returnTo', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject.returnTo(), subject.DEFAULT_VIEW);});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('with returnTo', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a44196e6a5696d10442c29e639437196e">path</a>=subject._returnTo= '/foo';<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#adc6ce99d08573e59428ba38ac0a50479">assert.equal</a>(subject.returnTo(), <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#a44196e6a5696d10442c29e639437196e">path</a>);});});<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('<a class="el" href="../../dd/d85/video_8js.html#a017102f866db15b37d9657454efde4ff">dom</a> events', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../d8/d0f/startup__events__test_8js.html#adac6c636af235a329cc774937d75601b">suite</a>('allday', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var allday;var <a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>;<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a> check(<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>){allday.checked=<a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>;<a class="el" href="../../dd/d9c/apps_2communications_2contacts_2test_2unit_2helper_8js.html#a11e5107af8f4ad8bea619753be86950b">triggerEvent</a>(allday, '<a class="el" href="../../d9/dd6/_r_e_a_d_m_e_8md.html#ac1934db4e0289fcc2a08b0c7de017cf2">change</a>');}<a class="el" href="../../da/db6/ime__test_8js.html#a499aeb7e1826da3a383e443025bfc846">setup</a>(<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.onfirstseen();subject.useModel(this.busytime, <a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">this.event</a>);<a class="el" href="../../d3/d87/mock__contact_8js.html#ad08d759db77b6861afcb4729fc620b95">list</a>=subject.element.classList;allday=subject.getEl('allday');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('initial', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){check(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(list.contains(subject.ALLDAY), 'has allday');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ac3f85391e7b9d85d3879b84b90623375">assert.isTrue</a>(subject.event.isAllDay, '<a class="el" href="../../d9/d04/expat_8h.html#ac517f0c27408fbd365e7dd34e032faca">model</a> is allday');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('uncheck', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){check(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);check(<a class="el" href="../../d7/dd2/qcmstypes_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>);<a class="el" href="../../da/ded/ds-test_8js.html#a96c639e17949eb5b6031072207d80575">assert.ok</a>(!list.contains(subject.ALLDAY), 'has allday');<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#a8e4d922ae3532f8bdfcadccef0881707">assert.isFalse</a>(subject.event.isAllDay, '<a class="el" href="../../d9/d04/expat_8h.html#ac517f0c27408fbd365e7dd34e032faca">model</a> is allday');});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('when <a class="el" href="../../d6/d1b/pprthred_8h.html#a0798cf327c99b856b5ecf03e5f4deb4d">start</a> &amp;<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#abe43fe84431eb0cabf3c21ccc94bd756">end</a> are <a class="el" href="../../d2/d7d/jsapi_8h.html#abfba8fa3513c8942905cf6144b77a52d">same</a> dates(all day)', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){var <a class="el" href="../../d9/d04/expat_8h.html#ac517f0c27408fbd365e7dd34e032faca">model</a>=<a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">subject.event</a>;var <a class="el" href="../../d3/d4b/lockscreen_8js.html#a94ea84d1e418dad15ea65e006b293fdd">date</a>=new Date(2012, 0, 1);var <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>=InputParser.exportDate(<a class="el" href="../../d3/d4b/lockscreen_8js.html#a94ea84d1e418dad15ea65e006b293fdd">date</a>);setFieldValue('startDate', <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);setFieldValue('endDate', <a class="el" href="../../d9/d04/expat_8h.html#aebafa8f4412854cf6c37456c71ff5ee7">value</a>);check(<a class="el" href="../../df/d49/system_2camera_2js_2camera_8js.html#a930920b2bc42824a5c03be681830f4b2">true</a>);var <a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#ad4dc7d3fd716004895ed4c669af1c61c">result</a>=subject.formData();var expected={startDate:new Date(2012, 0, 1), endDate:new Date(2012, 0, 2)};<a class="el" href="../../d9/d08/assertions_8js.html#a8e00d9840873f843252e77018da707c3">assert.hasProperties</a>(<a class="el" href="../../d8/d64/ns_u_r_l_helper_8h.html#ad4dc7d3fd716004895ed4c669af1c61c">result</a>, expected);});});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('submit form', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.onfirstseen();subject.onafteronfirstseen=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){subject.dispatch({params:{}});};subject.ondispatch=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){setFieldValue('calendarId', calendar._id);<a class="el" href="../../dd/d9c/apps_2communications_2contacts_2test_2unit_2helper_8js.html#a11e5107af8f4ad8bea619753be86950b">triggerEvent</a>(subject.form, 'submit');};provider.createEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};});<a class="el" href="../../d2/dc5/homescreen__launcher__test_8js.html#ae39af8ac48077b957ecb9fe16f678936">test</a>('delete <a class="el" href="../../d3/d4b/lockscreen_8js.html#a56a6742e738e925221d41ea45da5851d">button</a> click', <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>){subject.useModel(this.busytime, <a class="el" href="../../df/db4/_h_i_s_t_o_r_y_8md.html#a9bdb27563ba547d319ee562ba0f3bb98">this.event</a>, <a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../dd/d9c/apps_2communications_2contacts_2test_2unit_2helper_8js.html#a11e5107af8f4ad8bea619753be86950b">triggerEvent</a>(subject.deleteButton, 'click');});provider.deleteEvent=<a class="el" href="../../d9/dc4/pralarm_8h.html#a7b570f1c425a05af1046d4e6f37d5a0f">function</a>(){<a class="el" href="../../de/dc7/share-receiver_8js.html#af9c6eaaef1f3af067f5ea1aff90ff861">done</a>();};});});})</td></tr>
</table>
<hr/><h2>関数</h2>
<a class="anchor" id="a8dcd3bbd98527984123eaa2b36c08c43"></a><!-- doxytag: member="modify_event_test.js::requireElements" ref="a8dcd3bbd98527984123eaa2b36c08c43" args="('calendar/elements/modify_event.html')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/dce/everything_8me__test_8js.html#ada00cc9db7904b2eb8c207cef653a230">requireElements</a> </td>
          <td>(</td>
          <td class="paramtype">'calendar/elements/modify_event.html'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af2124e4df645d38fd46481d84f4b0d13"></a><!-- doxytag: member="modify_event_test.js::requireLib" ref="af2124e4df645d38fd46481d84f4b0d13" args="('provider/abstract.js')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d0e/manager__test_8js.html#a160383846e1e348b6643e19d5c153d05">requireLib</a> </td>
          <td>(</td>
          <td class="paramtype">'provider/abstract.js'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9e4359d0fc96a671db37869ebf35ea31"></a><!-- doxytag: member="modify_event_test.js::suiteGroup" ref="a9e4359d0fc96a671db37869ebf35ea31" args="('Views.ModifyEvent', function(){return;var subject;var controller;var app;var fmt;var provider;var eventStore;var calendarStore;var accountStore;var settingStore;function clearMS(date){var newDate=new Date(date.valueOf());newDate.setMilliseconds(0);return newDate;}function hasClass(value){return subject.element.classList.contains(value);}function getEl(name){return subject.getEl(name);}function setFieldValue(name, value){var field=getEl(name);return field.value=value;}function fieldValue(name){var field=getEl(name);return field.value;}function escapeHTML(html){var template=new Calendar.Template(function(){return this.h('value');});return template.render({value:html});}function primaryIsEnabled(){assert.ok(!subject.primaryButton.hasAttribute('aria&#45;disabled'), 'button is enabled');}function primaryIsDisabled(){assert.ok(subject.primaryButton.hasAttribute('aria&#45;disabled'), 'button is disabled');}var triggerEvent;var InputParser;suiteSetup(function(){triggerEvent=testSupport.calendar.triggerEvent;InputParser=Calendar.Utils.InputParser;});var realGo;teardown(function(){Calendar.App.go=realGo;});suiteTemplate('show&#45;event',{id: 'event&#45;view'});suiteTemplate('modify&#45;event',{id: 'modify&#45;event&#45;view'});setup(function(done){app=testSupport.calendar.app();realGo=app.go;eventStore=app.store('Event');accountStore=app.store('Account');calendarStore=app.store('Calendar');settingStore=app.store('Setting');provider=app.provider('Mock');fmt=navigator.mozL10n.DateTimeFormat();controller=app.timeController;app.db.open(done);subject=new Calendar.Views.ModifyEvent({app:app});});testSupport.calendar.accountEnvironment();testSupport.calendar.eventEnvironment({startDate:new Date(2012, 1, 1, 1), endDate:new Date(2012, 1, 5, 1)},{startDate:new Date(2012, 1, 1, 1), endDate:new Date(2012, 1, 5, 1)});teardown(function(done){testSupport.calendar.clearStore(app.db,['accounts', 'calendars', 'events', 'busytimes', 'alarms'], function(){app.db.close();done();});});var remote;var event;var calendar;var account;var busytime;setup(function(){remote=this.event.remote;event=this.event;calendar=this.calendar;account=this.account;busytime=this.busytime;});test('initialization', function(){assert.instanceOf(subject, Calendar.View);assert.instanceOf(subject, Calendar.Views.EventBase);assert.equal(subject._changeToken, 0);assert.ok(subject._els, 'has fields');});test('.status', function(){assert.ok(subject.status);});test('.errors', function(){assert.ok(subject.errors);});test('.form', function(){assert.ok(subject.form);assert.equal(subject.form.tagName.toLowerCase(), 'form');});test('.primaryButton', function(){assert.ok(subject.primaryButton);});test('.deleteButton', function(){assert.ok(subject.deleteButton);});test('.fieldRoot', function(){assert.ok(subject.fieldRoot);assert.equal(subject.fieldRoot, subject.form);});test('#getEl', function(){var expected=subject.form.querySelector('[name=&quot;title&quot;]');assert.ok(expected);assert.equal(expected.tagName.toLowerCase(), 'input');var result=subject.getEl('title');assert.equal(result, expected);assert.equal(result, subject.getEl('title'));assert.equal(subject._els.title, expected);});suite('#_updateUI', function(){var list;setup(function(){list=subject.element.classList;});function updatesValues(overrides, callback){getEl('title').value= 'foo';event.remote.description= '&lt; span &gt;foo&lt;/span &gt;';var expected={title:remote.title, location:remote.location, startDate:InputParser.exportDate(remote.startDate), startTime:InputParser.exportTime(remote.startDate), endDate:InputParser.exportDate(remote.endDate), endTime:InputParser.exportTime(remote.endDate), currentCalendar:calendar.remote.name};var key;if(overrides){for(key in overrides){expected[key]=overrides[key];}}function verify(){if(subject.provider.canCreateEvent){expected.calendarId=this.event.calendarId;}for(key in expected){if(expected.hasOwnProperty(key)){assert.equal(fieldValue(key), expected[key], 'should set&quot;' + key + '&quot;');}}var curCal=getEl('currentCalendar');assert.isTrue(curCal.readOnly, 'current calendar readonly');var expected=escapeHTML(event.remote.description);assert.equal(getEl('description').innerHTML, expected);callback();}subject.onfirstseen();subject.onafteronfirstseen=function(){subject.useModel(busytime, event, verify);};}test('provider can edit', function(done){updatesValues(null, function(){done(function(){assert.ok(!getEl('title').readOnly, 'does not mark as readOnly');});});});test('provider cannot edit', function(done){provider.stageEventCapabilities(event._id, null,{canUpdate:false, canCreate:false});remote.startDate=new Date(2012, 0, 1, 10);updatesValues(null, function(){done(function(){assert.isTrue(list.contains(subject.READONLY), 'is readonly');assert.isFalse(list.contains(subject.ALLDAY), 'is allday');var allday=subject.getEl('allday');assert.isFalse(allday.checked, 'is allday');assert.ok(getEl('title').readOnly, 'marks readonly');});});});test('use busytime instance when isRecurring', function(done){var eventRecurring=Factory('event',{calendarId:calendar._id, remote:{isRecurring:true, startDate:new Date(2012, 1, 1, 1), endDate:new Date(2012, 1, 5, 1)}});var busytimeRecurring=Factory('busytime',{eventId:eventRecurring._id, startDate:new Date(2012, 10, 30, 1), endDate:new Date(2012, 10, 31, 1)});subject.useModel(busytimeRecurring, eventRecurring, function(){done(function(){var expected={startDate:busytimeRecurring.startDate, endDate:busytimeRecurring.endDate};var actual=subject.formData();actual.calendarId=parseInt(actual.calendarId, 10);assert.hasProperties(actual, expected);});});});test('when start &amp;end times are 00:00:00', function(done){remote.startDate=new Date(2012, 0, 1);remote.endDate=new Date(2012, 0, 2);updatesValues({endDate: '2012&#45;01&#45;01'}, function(){done(function(){var allday=subject.getEl('allday');assert.isTrue(allday.checked, 'checks all day');assert.ok(list.contains(subject.ALLDAY));});});});test('saved alarms are shown for all&#45;day events', function(done){remote.startDate=new Date(2012, 0, 1);remote.endDate=new Date(2012, 0, 2);remote.alarms=[{trigger:&#45;300},{trigger:0}];var updateTo={alarms:remote.alarms, endDate: '2012&#45;01&#45;01'};updatesValues(updateTo, function(){done(function(){var allday=subject.getEl('allday');assert.isTrue(allday.checked, 'checks all day');assert.ok(list.contains(subject.ALLDAY));assert.equal(subject.event.alarms.length, 2);});});});test('date/time are displayed according to the locale', function(done){remote.startDate=new Date(2012, 11, 30, 1, 2);remote.endDate=new Date(2012, 11, 31, 13, 4);updatesValues({}, function(){done(function(){var startDateLocale=document.getElementById('start&#45;date&#45;locale');assert.equal(startDateLocale.textContent, '12/30/2012');var endDateLocale=document.getElementById('end&#45;date&#45;locale');assert.equal(endDateLocale.textContent, '12/31/2012');var startTimeLocale=document.getElementById('start&#45;time&#45;locale');assert.equal(startTimeLocale.textContent, '1:02 AM');var endTimeLocale=document.getElementById('end&#45;time&#45;locale');assert.equal(endTimeLocale.textContent, '1:04 PM');});});});});suite('#_overrideEvent', function(done){var startDate;var endDate;var search;setup(function(){startDate=new Date(1989, 4, 17, 2, 0, 0, 0);endDate=new Date(1989, 4, 17, 3, 0, 0, 0);var queryString={startDate:startDate.toString(), endDate:endDate.toString()};search= '?'+Calendar.QueryString.stringify(queryString);subject.useModel(this.busytime, this.event, done);});test('should set startDate and endDate on the event', function(){assert.notEqual(subject.event.startDate.getTime(), startDate.getTime());assert.notEqual(subject.event.endDate.getTime(), endDate.getTime());subject._overrideEvent(search);assert.equal(subject.event.startDate.getTime(), startDate.getTime());assert.equal(subject.event.endDate.getTime(), endDate.getTime());});});test('#_markReadonly', function(){subject._markReadonly(true);var fields=subject.form.querySelectorAll('[name]');assert.isTrue(fields.length &gt; 1, 'has fields');var i=0;var field;for(;i&lt; fields.length;i++){field=fields[i];assert.isTrue(field.readOnly, field.name);}});test('#reset', function(){var list=subject.element.classList;subject._markReadonly(true);var title=getEl('title');title.value= 'foo';list.add(subject.ALLDAY);list.add(subject.UPDATE);list.add(subject.CREATE);list.add(subject.READONLY);subject._returnTo= 'foo';subject.provider= 'foobar';subject.event= 'foo';subject.busytime= 'foo';var allday=subject.getEl('allday');allday.checked=true;subject.reset();assert.isFalse(allday.checked, 'removes allday check');assert.isNull(subject._returnTo);assert.isNull(subject.provider, 'clear provider');assert.isNull(subject.event, 'clear event');assert.isNull(subject.busytime, 'clears busytime');assert.isFalse(list.contains(subject.ALLDAY), 'allday');assert.isFalse(list.contains(subject.READONLY), 'readonly');assert.isFalse(list.contains(subject.CREATE), 'remove create class');assert.isFalse(list.contains(subject.UPDATE), 'remove update class');assert.isFalse(title.readOnly, 'clears readOnly');assert.equal(title.value, '', 'clear inputs');});suite('#formData', function(){setup(function(done){subject.onfirstseen();subject.onafteronfirstseen=function(){subject.useModel(busytime, event, done);};});test('when allday', function(){var allday=getEl('allday');allday.checked=true;setFieldValue('startDate', '2012&#45;01&#45;01');setFieldValue('endDate', '2012&#45;01&#45;02');setFieldValue('endTime', '01:07:00');setFieldValue('startTime', '01:08:00');var props=subject.formData();assert.hasProperties(subject.formData(),{startDate:new Date(2012, 0, 1), endDate:new Date(2012, 0, 3)});});test('without modifications', function(){var expected={startDate:clearMS(event.remote.startDate), endDate:clearMS(event.remote.endDate), title:event.remote.title, description:event.remote.description, location:event.remote.location, calendarId:event.calendarId};assert.hasProperties(subject.formData(), expected);});test('with modifications', function(){var newStart=new Date(2011, 7, 1);var startDate=InputParser.exportDate(newStart);var startTime=InputParser.exportTime(newStart);var newEnd=new Date(2012, 7, 1);var endDate=InputParser.exportDate(newEnd);var endTime=InputParser.exportTime(newEnd);var expected={startDate:newStart, endDate:newEnd, title: 'foo', description: 'bar', location: 'zomg', calendarId:this.calendar._id};setFieldValue('startDate', startDate);setFieldValue('startTime', startTime);setFieldValue('endDate', endDate);setFieldValue('endTime', endTime);setFieldValue('title', expected.title);setFieldValue('description', expected.description);setFieldValue('location', expected.location);assert.hasProperties(subject.formData(), expected);});});suite('#deleteRecord', function(){var calledWith;var realGo;setup(function(done){calledWith=null;provider.deleteEvent=function(){calledWith=arguments;};subject.useModel(this.busytime, this.event, function(){subject._returnTo= '/foo';done();});});test('in create mode', function(){provider.deleteEvent=function(){throw new Error('should not trigger delete');};subject.provider=null;subject.deleteRecord();});test('with an error', function(done){var err=new Calendar.Error.Authentication();subject.showErrors=function(givenErr){done(function(){assert.equal(err, givenErr);});};provider.deleteEvent=function(model, callback){Calendar.nextTick(callback.bind(null, err));};subject.deleteRecord();});test('with valid provider', function(done){provider.deleteEvent=function(toDelete, callback){assert.equal(toDelete._id, event._id, 'deletes event');callback();};app.go=function(place){assert.notEqual(place, '/foo', 'redirect is changed to event url');done();};subject.deleteRecord();});});suite('#save', function(){var redirectTo;var list;var calledWith;setup(function(){calledWith=null;list=subject.element.classList;app.go=function(place){redirectTo=place;};});function haltsOnError(providerMethod){test('does not persist record when provider fails', function(done){var dispatchesError;var err=new Calendar.Error.Authentication();subject.showErrors=function(gotErr){done(function(){assert.equal(err, gotErr, 'dispatches error');});};provider[providerMethod]=function(){var args=Array.slice(arguments);var cb=args.pop();Calendar.nextTick(cb.bind(null, err));};subject.primary();});test('does not invoke provider when validations fails', function(done){provider[providerMethod]=function(){done(new Error('should not persist record.'));};var event=subject.event;var errors=[new Error('epic fail')];var displayedErrors;subject.showErrors=function(givenErrs){done(function(){assert.deepEqual(givenErrs, errors, 'shows errors');});};subject.event.validationErrors=function(){return errors;};subject.primary();});}suite('update', function(){setup(function(done){subject.onfirstseen();subject.onafteronfirstseen=function(){subject.useModel(busytime, event, function(){subject._returnTo= '/foo';done();});};});haltsOnError('updateEvent');test('with provider that can edit', function(done){provider.updateEvent=function(updated, callback){done(function(){assert.equal(updated._id, event._id, 'updates correcet event');var data=subject.formData();data.alarms=[];assert.hasProperties(subject.event, data, 'updated model');assert.isTrue(list.contains(subject.PROGRESS));callback();assert.isFalse(list.contains(subject.PROGRESS));assert.notEqual(redirectTo, '/foo');assert.deepEqual(app.timeController.position, subject.event.startDate, 'moves time controller');});};setFieldValue('calendarId', this.calendar._id);setFieldValue('startDate', '2012&#45;1&#45;2');setFieldValue('title', 'myfoo');subject.primary();});});suite('create', function(){setup(function(done){subject.onfirstseen();subject.onafteronfirstseen=function(){subject.dispatch({params:{}});subject.ondispatch=function(){subject._returnTo= '/foo';done();};};});haltsOnError('createEvent');test('with provider that can create', function(done){provider.createEvent=function(event, callback){done(function(){var data=subject.formData();data.alarms=[];assert.hasProperties(subject.event, data, 'updated model');assert.isTrue(list.contains(subject.PROGRESS));callback();assert.isFalse(list.contains(subject.PROGRESS));assert.equal(redirectTo, '/foo');assert.deepEqual(app.timeController.position, subject.event.startDate, 'moves timeController');});};assert.ok(!subject.provider, 'has no provider yet');setFieldValue('calendarId', calendar._id);setFieldValue('startDate', '2012&#45;1&#45;2');setFieldValue('endDate', '2012&#45;1&#45;3');setFieldValue('title', 'myfoo');subject.primary();});});});suite('calendar id handling', function(){var accounts=testSupport.calendar.dbFixtures( 'account', 'Account',{one:{_id:55, providerType: 'Mock'}});var calendars=testSupport.calendar.dbFixtures( 'calendar', 'Calendar',{one:{_id: 'one', accountId:55}, two:{_id: 'two', accountId:55}});var element;setup(function(done){calendars[calendar._id]=calendar;subject.onafteronfirstseen=done;subject.onfirstseen();element=getEl('calendarId');});test('calendarId select element', function(){assert.length(element.children, 3, 'has two calendars');var id;var option;for(id in calendars){option=element.querySelector('[value=&quot;' + id + '&quot;]');assert.ok(option, 'option for id: '+id);assert.equal(option.textContent, calendars[id].remote.name);}});test('rename calendar(#_updateCalendarId)', function(done){subject.oncalendarupdate=function(){done(function(){var option=element.querySelector( '[value=&quot;' + calendars.one._id + '&quot;]');assert.equal(option.textContent, 'fooobar');});};calendars.one.remote.name= 'fooobar';calendarStore.emit('update', calendars.one._id, calendars.one);});test('change calendar permissions', function(done){var newCalendar=Factory('calendar',{accountId:account._id});subject.onaddcalendar=function(){provider.stageCalendarCapabilities(newCalendar._id,{canCreateEvent:false});assert.length(element.children, 4, 'added one');calendarStore.emit('update', newCalendar._id, newCalendar);};subject.onremovecalendar=function(){assert.length(element.children, 3, 'added one');done();};calendarStore.emit('add', newCalendar._id, newCalendar);});test('add calendar(#_addCalendarId)', function(done){var newCal=Factory('calendar',{_id: 'three', accountId:account._id});calendarStore.emit('add', newCal._id, newCal);subject.onaddcalendar=function(){done(function(){assert.length(element.children, 4, 'added one');var option=element.querySelector('[value=&quot;' + newCal._id + '&quot;]');assert.equal(option.textContent, newCal.remote.name);assert.ok(option, 'added calendar');});};});test('remove calendar(#_removeCalendarId)', function(done){subject.onremovecalendar=function(){subject.onremovecalendar=null;done(function(){assert.length(element.children, 2, 'removed one');var option=element.querySelector('[value=&quot;' + calendars.two._id + '&quot;]');assert.ok(option, 'removed correct item');});};calendarStore.emit('preRemove', calendars.one._id);calendarStore.emit('remove', calendars.one._id);});});suite('alarm defaults', function(){var defaultAllDayAlarm;var defaultEventAlarm;var morning=3600 *9;var oneHour=3600;setup(function(done){var pending=3;subject.onfirstseen();subject.onafteronfirstseen=function(){subject.dispatch({params:{}});subject.ondispatch=function(){subject._returnTo= '/foo';next();};};settingStore.getValue('standardAlarmDefault', function(err, value){defaultEventAlarm=value;next();});settingStore.getValue('alldayAlarmDefault', function(err, value){defaultAllDayAlarm=value;next();});function next(){if(!(&#45;&#45;pending)){done();}}});test('with no alarms set', function(done){provider.createEvent=function(event, callback){done(function(){var data=subject.formData();callback();assert.deepEqual(data.alarms, subject.event.alarms, 'alarms');});};subject.primary();});function testAlarmIsAdded(done, isAllDay, defaultAlarm){provider.createEvent=function(event, callback){done(function(){var data=subject.formData();callback();assert.deepEqual(data.alarms,[{action: 'DISPLAY', trigger:defaultAlarm},{action: 'DISPLAY', trigger:123}], 'alarms');});};var allday=subject.getEl('allday');allday.checked=isAllDay;subject.event.isAllDay=isAllDay;subject.updateAlarms(isAllDay, function(){var allAlarms=subject.alarmList.querySelectorAll('select');assert.equal(allAlarms.length, 2);var secondSelect=allAlarms[1];assert.ok(secondSelect);var newOption=document.createElement('option');newOption.value= '123';secondSelect.appendChild(newOption);secondSelect.value= '123';subject.primary();});}test('with all day defaults', function(done){testAlarmIsAdded(done, true, defaultAllDayAlarm);});test('with event defaults', function(done){testAlarmIsAdded(done, false, defaultEventAlarm);});test('populated with no existing alarms', function(done){subject.event.alarms=[];subject.updateAlarms(true, function(){var allAlarms=subject.alarmList.querySelectorAll('select');assert.equal(allAlarms.length, 2);assert.equal(allAlarms[0].value, defaultAllDayAlarm);assert.equal(allAlarms[1].value, 'none');done();});});test('not populated with existing alarms', function(done){subject.event.alarms=[{trigger:&#45;300}];subject.updateAlarms(true, function(){var allAlarms=subject.alarmList.querySelectorAll('select');assert.equal(allAlarms.length, 2);assert.equal(allAlarms[0].value,&#45;300);assert.equal(allAlarms[1].value, 'none');done();});});test('populated presaved event with no existing alarms', function(done){subject.event.alarms=[];subject.isSaved=function(){return true;};subject.updateAlarms(true, function(){var allAlarms=subject.alarmList.querySelectorAll('select');assert.equal(allAlarms.length, 1);assert.equal(allAlarms[0].value, 'none');done();});});function testDefaultAlarms(isAllDay, defaultValue, done){settingStore.getValue('alldayAlarmDefault', function(err, value){var defaultAlarm=value;var defaultAlarmKey;if(isAllDay===true){defaultAlarmKey= 'alldayAlarmDefault';}else{defaultAlarmKey= 'standardAlarmDefault';}settingStore.set(defaultAlarmKey, defaultValue, function(err, value){provider.createEvent=function(event, callback){var data=subject.formData();callback();if(defaultValue=== 'none'){assert.deepEqual(data.alarms[0].trigger, 123, 'alarms');}else{assert.deepEqual(data.alarms[0].trigger, defaultValue, 'alarms');}settingStore.set(defaultAlarmKey, defaultAlarm, function(err, value){done();});};var allday=subject.getEl('allday');allday.checked=isAllDay;subject.event.isAllDay=isAllDay;subject.updateAlarms(isAllDay, function(){var allAlarms=subject.alarmList.querySelectorAll('select');var firstSelect=allAlarms[0];assert.ok(firstSelect);if(defaultValue=== 'none'){assert.equal(allAlarms.length, 1);var newOption=document.createElement('option');newOption.value= '123';firstSelect.appendChild(newOption);firstSelect.value= '123';}else{assert.equal(allAlarms.length, 2);}subject.primary();});});});}test('Bug 898242&#45;when allday alarm default is none', function(done){var isAllDay=true;var defaultValue= 'none';testDefaultAlarms(isAllDay, defaultValue, done);});test('Bug 898242&#45;when allday alarm default is not none', function(done){var isAllDay=true;var defaultValue=morning;testDefaultAlarms(isAllDay, defaultValue, done);});test('Bug 898242&#45;when standard alarm default is none', function(done){var isAllDay=false;var defaultValue= 'none';testDefaultAlarms(isAllDay, defaultValue, done);});test('Bug 898242&#45;when standard alarm default is not none', function(done){var isAllDay=false;var defaultValue=oneHour;testDefaultAlarms(isAllDay, defaultValue, done);});});suite('#returnTo', function(){test('without returnTo', function(){assert.equal(subject.returnTo(), subject.DEFAULT_VIEW);});test('with returnTo', function(){var path=subject._returnTo= '/foo';assert.equal(subject.returnTo(), path);});});suite('dom events', function(){suite('allday', function(){var allday;var list;function check(value){allday.checked=value;triggerEvent(allday, 'change');}setup(function(){subject.onfirstseen();subject.useModel(this.busytime, this.event);list=subject.element.classList;allday=subject.getEl('allday');});test('initial', function(){check(true);assert.ok(list.contains(subject.ALLDAY), 'has allday');assert.isTrue(subject.event.isAllDay, 'model is allday');});test('uncheck', function(){check(true);check(false);assert.ok(!list.contains(subject.ALLDAY), 'has allday');assert.isFalse(subject.event.isAllDay, 'model is allday');});test('when start &amp;end are same dates(all day)', function(){var model=subject.event;var date=new Date(2012, 0, 1);var value=InputParser.exportDate(date);setFieldValue('startDate', value);setFieldValue('endDate', value);check(true);var result=subject.formData();var expected={startDate:new Date(2012, 0, 1), endDate:new Date(2012, 0, 2)};assert.hasProperties(result, expected);});});test('submit form', function(done){subject.onfirstseen();subject.onafteronfirstseen=function(){subject.dispatch({params:{}});};subject.ondispatch=function(){setFieldValue('calendarId', calendar._id);triggerEvent(subject.form, 'submit');};provider.createEvent=function(){done();};});test('delete button click', function(done){subject.useModel(this.busytime, this.event, function(){triggerEvent(subject.deleteButton, 'click');});provider.deleteEvent=function(){done();};});});})" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d5e/views_2week__test_8js.html#ac63109f8f0c5b5ff6964f5d42af22de9">suiteGroup</a> </td>
          <td>(</td>
          <td class="paramtype">'Views.ModifyEvent'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d8/d0e/modify__event__test_8js.html">modify_event_test.js</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:56:19に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
