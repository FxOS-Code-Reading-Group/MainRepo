<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: クラス テンプレート mozStorageTransactionBase&lt; T, U &gt;</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li><a href="../../classes.html"><span>データ構造索引</span></a></li>
      <li><a href="../../inherits.html"><span>クラス階層</span></a></li>
      <li><a href="../../functions.html"><span>データフィールド</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d8/d58/classmoz_storage_transaction_base.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public メソッド</a> &#124;
<a href="#pro-attribs">Protected 変数</a>  </div>
  <div class="headertitle">
<div class="title">クラス テンプレート mozStorageTransactionBase&lt; T, U &gt;</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="mozStorageTransactionBase" -->
<p><code>#include &lt;<a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a>&gt;</code></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#ac5853fd04fe0415570aa8ce5fa20b841">mozStorageTransactionBase</a> (T *aConnection, <a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a> aCommitOnComplete, int32_t <a class="el" href="../../df/d33/ns_x_u_l_app_a_p_i_8h.html#a02213a397ee55db7eba28bed963f63df">aType</a>=<a class="el" href="../../db/d9d/interfacemoz_i_storage_connection.html#ae582da4f5540c90208ad2d8fd9dd8cec">mozIStorageConnection::TRANSACTION_DEFERRED</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a00e185ba975890d35cd55f5615521122">~mozStorageTransactionBase</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/dcf/ns_error_8h.html#ae1573874dc40023f078c3a69c4ce4538">nsresult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a72c71cf6c275255f8d71113e215cc762">Commit</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/dcf/ns_error_8h.html#ae1573874dc40023f078c3a69c4ce4538">nsresult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a7f0ba697a58e6d6bbf7eeef40b226e94">Rollback</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a70cdc74ab338e2bf479accb490fa7389">HasTransaction</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d2c/prtpool_8h.html#a7797d332996f57719d6d316bee73873d">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#ae4ffbb33f30d681066b725e72bda4a7e">SetDefaultAction</a> (<a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a> aCommitOnComplete)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">U&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a4ae8fefa942b79088b7fb209b8f6259a">mCommitOnComplete</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>説明</h2>
<div class="textblock"><h3>template&lt;typename T, typename U&gt;<br/>
class mozStorageTransactionBase&lt; T, U &gt;</h3>

<p>This class wraps a transaction inside a given C++ scope, guaranteeing that the transaction will be completed even if you have an exception or return early.</p>
<p>aCommitOnComplete controls whether the transaction is committed or rolled back when it goes out of scope. A common use is to create an instance with commitOnComplete = FALSE (rollback), then call Commit on this object manually when your function completes successfully.</p>
<p>Note that nested transactions are not supported by sqlite, so if a transaction is already in progress, this object does nothing. Note that in this case, you may not get the transaction type you ask for, and you won't be able to rollback.</p>
<p>Note: This class is templatized to be also usable with internal data structures. External users of this class should generally use |mozStorageTransaction| instead. </p>

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00036">36</a> 行で定義されています。</p>
</div><hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="ac5853fd04fe0415570aa8ce5fa20b841"></a><!-- doxytag: member="mozStorageTransactionBase::mozStorageTransactionBase" ref="ac5853fd04fe0415570aa8ce5fa20b841" args="(T *aConnection, bool aCommitOnComplete, int32_t aType=mozIStorageConnection::TRANSACTION_DEFERRED)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a> </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>aConnection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a>&#160;</td>
          <td class="paramname"><em>aCommitOnComplete</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>aType</em> = <code><a class="el" href="../../db/d9d/interfacemoz_i_storage_connection.html#ae582da4f5540c90208ad2d8fd9dd8cec">mozIStorageConnection::TRANSACTION_DEFERRED</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00039">39</a> 行で定義されています。</p>

<p>参照先 <a class="el" href="../../df/d33/ns_x_u_l_app_a_p_i_8h_source.html#l00282">aType</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00127">mozStorageTransactionBase&lt; T, U &gt;::mConnection</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00128">mozStorageTransactionBase&lt; T, U &gt;::mHasTransaction</a>, と <a class="el" href="../../d8/dcf/ns_error_8h_source.html#l00187">NS_SUCCEEDED</a>.</p>
<div class="fragment"><pre class="fragment">    : <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>(aConnection),
      <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a>(<span class="keyword">false</span>),
      <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a4ae8fefa942b79088b7fb209b8f6259a">mCommitOnComplete</a>(aCommitOnComplete),
      <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a>(<span class="keyword">false</span>)
  {
    <span class="comment">// We won&#39;t try to get a transaction if one is already in progress.</span>
    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>)
      <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a> = <a class="code" href="../../d8/dcf/ns_error_8h.html#acd00c826e726e26de788f186895a26b7">NS_SUCCEEDED</a>(<a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>-&gt;BeginTransactionAs(<a class="code" href="../../df/d33/ns_x_u_l_app_a_p_i_8h.html#a02213a397ee55db7eba28bed963f63df">aType</a>));
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a00e185ba975890d35cd55f5615521122"></a><!-- doxytag: member="mozStorageTransactionBase::~mozStorageTransactionBase" ref="a00e185ba975890d35cd55f5615521122" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::~<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00051">51</a> 行で定義されています。</p>

<p>参照先 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00129">mozStorageTransactionBase&lt; T, U &gt;::mCommitOnComplete</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00130">mozStorageTransactionBase&lt; T, U &gt;::mCompleted</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00127">mozStorageTransactionBase&lt; T, U &gt;::mConnection</a>, と <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00128">mozStorageTransactionBase&lt; T, U &gt;::mHasTransaction</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a> &amp;&amp; <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a> &amp;&amp; ! <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a>) {
      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a4ae8fefa942b79088b7fb209b8f6259a">mCommitOnComplete</a>)
        <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>-&gt;CommitTransaction();
      <span class="keywordflow">else</span>
        <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>-&gt;RollbackTransaction();
    }
  }
</pre></div>
</div>
</div>
<hr/><h2>メソッド</h2>
<a class="anchor" id="a72c71cf6c275255f8d71113e215cc762"></a><!-- doxytag: member="mozStorageTransactionBase::Commit" ref="a72c71cf6c275255f8d71113e215cc762" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/dcf/ns_error_8h.html#ae1573874dc40023f078c3a69c4ce4538">nsresult</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a72c71cf6c275255f8d71113e215cc762">Commit</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Commits the transaction if one is in progress. If one is not in progress, this is a NOP since the actual owner of the transaction outside of our scope is in charge of finally comitting or rolling back the transaction. </p>

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00066">66</a> 行で定義されています。</p>

<p>参照先 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00130">mozStorageTransactionBase&lt; T, U &gt;::mCompleted</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00127">mozStorageTransactionBase&lt; T, U &gt;::mConnection</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00128">mozStorageTransactionBase&lt; T, U &gt;::mHasTransaction</a>, <a class="el" href="../../d7/dda/_error_list_c_defines_8h_source.html#l00003">NS_OK</a>, と <a class="el" href="../../d8/dcf/ns_error_8h_source.html#l00187">NS_SUCCEEDED</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a> || <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a>)
      <span class="keywordflow">return</span> <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a03a7f9e8069d114c0495679caefca965">NS_OK</a>; <span class="comment">// no connection, or already done</span>
    <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a> = <span class="keyword">true</span>;
    <span class="keywordflow">if</span> (! <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a>)
      <span class="keywordflow">return</span> <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a03a7f9e8069d114c0495679caefca965">NS_OK</a>; <span class="comment">// transaction not ours, ignore</span>
    <a class="code" href="../../d8/dcf/ns_error_8h.html#ae1573874dc40023f078c3a69c4ce4538">nsresult</a> rv = <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>-&gt;CommitTransaction();
    <span class="keywordflow">if</span> (<a class="code" href="../../d8/dcf/ns_error_8h.html#acd00c826e726e26de788f186895a26b7">NS_SUCCEEDED</a>(rv))
      <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a> = <span class="keyword">false</span>;

    <span class="keywordflow">return</span> rv;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a70cdc74ab338e2bf479accb490fa7389"></a><!-- doxytag: member="mozStorageTransactionBase::HasTransaction" ref="a70cdc74ab338e2bf479accb490fa7389" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a70cdc74ab338e2bf479accb490fa7389">HasTransaction</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns whether this object wraps a real transaction. False means that this object doesn't do anything because there was already a transaction in progress when it was created. </p>

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00112">112</a> 行で定義されています。</p>

<p>参照先 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00128">mozStorageTransactionBase&lt; T, U &gt;::mHasTransaction</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a>;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a7f0ba697a58e6d6bbf7eeef40b226e94"></a><!-- doxytag: member="mozStorageTransactionBase::Rollback" ref="a7f0ba697a58e6d6bbf7eeef40b226e94" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/dcf/ns_error_8h.html#ae1573874dc40023f078c3a69c4ce4538">nsresult</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a7f0ba697a58e6d6bbf7eeef40b226e94">Rollback</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Rolls back the transaction in progress. You should only call this function if this object has a real transaction (<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a70cdc74ab338e2bf479accb490fa7389">HasTransaction()</a> = true) because otherwise, there is no transaction to roll back. </p>

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00085">85</a> 行で定義されています。</p>

<p>参照先 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00130">mozStorageTransactionBase&lt; T, U &gt;::mCompleted</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00127">mozStorageTransactionBase&lt; T, U &gt;::mConnection</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00128">mozStorageTransactionBase&lt; T, U &gt;::mHasTransaction</a>, <a class="el" href="../../d7/dda/_error_list_c_defines_8h_source.html#l00023">NS_ERROR_FAILURE</a>, <a class="el" href="../../d7/dda/_error_list_c_defines_8h_source.html#l00767">NS_ERROR_STORAGE_BUSY</a>, <a class="el" href="../../d7/dda/_error_list_c_defines_8h_source.html#l00003">NS_OK</a>, <a class="el" href="../../d8/dcf/ns_error_8h_source.html#l00187">NS_SUCCEEDED</a>, <a class="el" href="../../d7/dc8/prinrval_8h_source.html#l00053">PR_INTERVAL_NO_WAIT</a>, と <a class="el" href="../../d4/da9/png_8h_source.html#l02147">void</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a> || <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a>)
      <span class="keywordflow">return</span> <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a03a7f9e8069d114c0495679caefca965">NS_OK</a>; <span class="comment">// no connection, or already done</span>
    <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a> = <span class="keyword">true</span>;
    <span class="keywordflow">if</span> (! <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a>)
      <span class="keywordflow">return</span> <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a9de321fc4356efa6a090b3b736a206c2">NS_ERROR_FAILURE</a>;

    <span class="comment">// It is possible that a rollback will return busy, so we busy wait...</span>
    <a class="code" href="../../d8/dcf/ns_error_8h.html#ae1573874dc40023f078c3a69c4ce4538">nsresult</a> rv = <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a03a7f9e8069d114c0495679caefca965">NS_OK</a>;
    <span class="keywordflow">do</span> {
      rv = <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a>-&gt;RollbackTransaction();
      <span class="keywordflow">if</span> (rv == <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a486791178d078b252148f6fe2a75250d">NS_ERROR_STORAGE_BUSY</a>)
        (<a class="code" href="../../d4/da9/png_8h.html#ab30926da86712184b070e550789f8bf7">void</a>)PR_Sleep(<a class="code" href="../../d7/dc8/prinrval_8h.html#ae8322ac2b9c210db2ae69235091526de">PR_INTERVAL_NO_WAIT</a>);
    } <span class="keywordflow">while</span> (rv == <a class="code" href="../../d7/dda/_error_list_c_defines_8h.html#a486791178d078b252148f6fe2a75250d">NS_ERROR_STORAGE_BUSY</a>);

    <span class="keywordflow">if</span> (<a class="code" href="../../d8/dcf/ns_error_8h.html#acd00c826e726e26de788f186895a26b7">NS_SUCCEEDED</a>(rv))
      <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a> = <span class="keyword">false</span>;

    <span class="keywordflow">return</span> rv;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="ae4ffbb33f30d681066b725e72bda4a7e"></a><!-- doxytag: member="mozStorageTransactionBase::SetDefaultAction" ref="ae4ffbb33f30d681066b725e72bda4a7e" args="(bool aCommitOnComplete)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d2c/prtpool_8h.html#a7797d332996f57719d6d316bee73873d">void</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#ae4ffbb33f30d681066b725e72bda4a7e">SetDefaultAction</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a>&#160;</td>
          <td class="paramname"><em>aCommitOnComplete</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This sets the default action (commit or rollback) when this object goes out of scope. </p>

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00121">121</a> 行で定義されています。</p>

<p>参照先 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00129">mozStorageTransactionBase&lt; T, U &gt;::mCommitOnComplete</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <a class="code" href="../../d8/d58/classmoz_storage_transaction_base.html#a4ae8fefa942b79088b7fb209b8f6259a">mCommitOnComplete</a> = aCommitOnComplete;
  }
</pre></div>
</div>
</div>
<hr/><h2>構造体</h2>
<a class="anchor" id="a4ae8fefa942b79088b7fb209b8f6259a"></a><!-- doxytag: member="mozStorageTransactionBase::mCommitOnComplete" ref="a4ae8fefa942b79088b7fb209b8f6259a" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a4ae8fefa942b79088b7fb209b8f6259a">mCommitOnComplete</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00129">129</a> 行で定義されています。</p>

<p>参照元 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00121">mozStorageTransactionBase&lt; T, U &gt;::SetDefaultAction()</a>, と <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00051">mozStorageTransactionBase&lt; T, U &gt;::~mozStorageTransactionBase()</a>.</p>

</div>
</div>
<a class="anchor" id="aff967e67911ac7949e6d7ff02e90d5b6"></a><!-- doxytag: member="mozStorageTransactionBase::mCompleted" ref="aff967e67911ac7949e6d7ff02e90d5b6" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#aff967e67911ac7949e6d7ff02e90d5b6">mCompleted</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00130">130</a> 行で定義されています。</p>

<p>参照元 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00066">mozStorageTransactionBase&lt; T, U &gt;::Commit()</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00085">mozStorageTransactionBase&lt; T, U &gt;::Rollback()</a>, と <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00051">mozStorageTransactionBase&lt; T, U &gt;::~mozStorageTransactionBase()</a>.</p>

</div>
</div>
<a class="anchor" id="a5abc2e23170f848f77420b44c6a48663"></a><!-- doxytag: member="mozStorageTransactionBase::mConnection" ref="a5abc2e23170f848f77420b44c6a48663" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">U <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a5abc2e23170f848f77420b44c6a48663">mConnection</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00127">127</a> 行で定義されています。</p>

<p>参照元 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00066">mozStorageTransactionBase&lt; T, U &gt;::Commit()</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00039">mozStorageTransactionBase&lt; T, U &gt;::mozStorageTransactionBase()</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00085">mozStorageTransactionBase&lt; T, U &gt;::Rollback()</a>, と <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00051">mozStorageTransactionBase&lt; T, U &gt;::~mozStorageTransactionBase()</a>.</p>

</div>
</div>
<a class="anchor" id="a232ab28a3d0df3c0e85935692a46097a"></a><!-- doxytag: member="mozStorageTransactionBase::mHasTransaction" ref="a232ab28a3d0df3c0e85935692a46097a" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dd2/qcmstypes_8h.html#acac1f8caeb95c0bd16fe8c0743249831">bool</a> <a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>&lt; T, U &gt;::<a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html#a232ab28a3d0df3c0e85935692a46097a">mHasTransaction</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p> <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a> の <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00128">128</a> 行で定義されています。</p>

<p>参照元 <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00066">mozStorageTransactionBase&lt; T, U &gt;::Commit()</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00112">mozStorageTransactionBase&lt; T, U &gt;::HasTransaction()</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00039">mozStorageTransactionBase&lt; T, U &gt;::mozStorageTransactionBase()</a>, <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00085">mozStorageTransactionBase&lt; T, U &gt;::Rollback()</a>, と <a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html#l00051">mozStorageTransactionBase&lt; T, U &gt;::~mozStorageTransactionBase()</a>.</p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li><a class="el" href="../../d5/deb/moz_storage_helper_8h_source.html">mozStorageHelper.h</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d8/d58/classmoz_storage_transaction_base.html">mozStorageTransactionBase</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:59:06に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
