<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FxOS Code Reading: cmst.h ソースファイル</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FxOS Code Reading
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 作成： Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'検索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>メインページ</span></a></li>
      <li><a href="../../pages.html"><span>関連ページ</span></a></li>
      <li><a href="../../modules.html"><span>モジュール</span></a></li>
      <li><a href="../../namespaces.html"><span>パッケージ</span></a></li>
      <li><a href="../../annotated.html"><span>データ構造</span></a></li>
      <li class="current"><a href="../../files.html"><span>ファイル</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>ファイル一覧</span></a></li>
      <li><a href="../../globals.html"><span>グローバル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d0/d84/cmst_8h.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">cmst.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d0/d84/cmst_8h.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* This Source Code Form is subject to the terms of the Mozilla Public</span>
<a name="l00002"></a>00002 <span class="comment"> * License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<a name="l00003"></a>00003 <span class="comment"> * file, You can obtain one at http://mozilla.org/MPL/2.0/. */</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">/*</span>
<a name="l00006"></a>00006 <span class="comment"> * Header for CMS types.</span>
<a name="l00007"></a>00007 <span class="comment"> */</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef _CMST_H_</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define _CMST_H_</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="../../dc/d39/seccomon_8h.html">seccomon.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/secoidt_8h.html">secoidt.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/da5/certt_8h.html">certt.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dfa/secmodt_8h.html">secmodt.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="../../d6/dfa/secmodt_8h.html">secmodt.h</a>&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="../../d5/d70/plarena_8h.html">plarena.h</a>&quot;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="comment">/* Non-opaque objects.  NOTE, though: I want them to be treated as</span>
<a name="l00021"></a>00021 <span class="comment"> * opaque as much as possible.  If I could hide them completely,</span>
<a name="l00022"></a>00022 <span class="comment"> * I would.  (I tried, but ran into trouble that was taking me too</span>
<a name="l00023"></a>00023 <span class="comment"> * much time to get out of.)  I still intend to try to do so.</span>
<a name="l00024"></a>00024 <span class="comment"> * In fact, the only type that &quot;outsiders&quot; should even *name* is</span>
<a name="l00025"></a>00025 <span class="comment"> * NSSCMSMessage, and they should not reference its fields.</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 <span class="comment">/* rjr: PKCS #11 cert handling (pk11cert.c) does use NSSCMSRecipientInfo&#39;s.</span>
<a name="l00028"></a>00028 <span class="comment"> * This is because when we search the recipient list for the cert and key we</span>
<a name="l00029"></a>00029 <span class="comment"> * want, we need to invert the order of the loops we used to have. The old</span>
<a name="l00030"></a>00030 <span class="comment"> * loops were:</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment"> *  For each recipient {</span>
<a name="l00033"></a>00033 <span class="comment"> *       find_cert = PK11_Find_AllCert(recipient-&gt;issuerSN);</span>
<a name="l00034"></a>00034 <span class="comment"> *       [which unrolls to... ]</span>
<a name="l00035"></a>00035 <span class="comment"> *       For each slot {</span>
<a name="l00036"></a>00036 <span class="comment"> *            Log into slot;</span>
<a name="l00037"></a>00037 <span class="comment"> *            search slot for cert;</span>
<a name="l00038"></a>00038 <span class="comment"> *      }</span>
<a name="l00039"></a>00039 <span class="comment"> *  }</span>
<a name="l00040"></a>00040 <span class="comment"> *</span>
<a name="l00041"></a>00041 <span class="comment"> *  the new loop searchs all the recipients at once on a slot. this allows</span>
<a name="l00042"></a>00042 <span class="comment"> *  PKCS #11 to order slots in such a way that logout slots don&#39;t get checked</span>
<a name="l00043"></a>00043 <span class="comment"> *  if we can find the cert on a logged in slot. This eliminates lots of</span>
<a name="l00044"></a>00044 <span class="comment"> *  spurious password prompts when smart cards are installed... so why this</span>
<a name="l00045"></a>00045 <span class="comment"> *  comment? If you make NSSCMSRecipientInfo completely opaque, you need</span>
<a name="l00046"></a>00046 <span class="comment"> *  to provide a non-opaque list of issuerSN&#39;s (the only field PKCS#11 needs</span>
<a name="l00047"></a>00047 <span class="comment"> *  and fix up pk11cert.c first. NOTE: Only S/MIME calls this special PKCS #11</span>
<a name="l00048"></a>00048 <span class="comment"> *  function.</span>
<a name="l00049"></a>00049 <span class="comment"> */</span>
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="../../d0/d84/cmst_8h.html#af04830f056e111f0fa267d5ba03d0930">00051</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessageStr</a> <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="../../d0/d84/cmst_8h.html#a6004f914c52a6db81064b899df733038">00053</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html">NSSCMSContentUnion</a> <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html">NSSCMSContent</a>;
<a name="l00054"></a><a class="code" href="../../d0/d84/cmst_8h.html#a49fce18baf8b1bf1c1cb9f7a961a27ca">00054</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfoStr</a> <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>;
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="../../d0/d84/cmst_8h.html#a4739fb9977c20de7b2a00f2d26b0320a">00056</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html">NSSCMSSignedDataStr</a> <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html">NSSCMSSignedData</a>;
<a name="l00057"></a><a class="code" href="../../d0/d84/cmst_8h.html#a9e451331f7d22d53b8ad30b852e67023">00057</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html">NSSCMSSignerInfoStr</a> <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html">NSSCMSSignerInfo</a>;
<a name="l00058"></a><a class="code" href="../../d0/d84/cmst_8h.html#a4c47485cdc4b5d938edecd85ad2e2855">00058</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html">NSSCMSSignerIdentifierStr</a> <a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html">NSSCMSSignerIdentifier</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="../../d0/d84/cmst_8h.html#a3b554284c43ad8a4947603e3a5e86411">00060</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html">NSSCMSEnvelopedDataStr</a> <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html">NSSCMSEnvelopedData</a>;
<a name="l00061"></a><a class="code" href="../../d0/d84/cmst_8h.html#acc4602fd387d5a388bbd2018d407f74e">00061</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html">NSSCMSOriginatorInfoStr</a> <a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html">NSSCMSOriginatorInfo</a>;
<a name="l00062"></a><a class="code" href="../../d0/d84/cmst_8h.html#a5cbb3e8164a547bbe184425c67e3250f">00062</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html">NSSCMSRecipientInfoStr</a> <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html">NSSCMSRecipientInfo</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="../../d0/d84/cmst_8h.html#af6a11fec12ea4f8cc0de2ddaf5555030">00064</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html">NSSCMSDigestedDataStr</a> <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html">NSSCMSDigestedData</a>;
<a name="l00065"></a><a class="code" href="../../d0/d84/cmst_8h.html#a312424ad171ae03c67059aab6242ba5b">00065</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html">NSSCMSEncryptedDataStr</a> <a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html">NSSCMSEncryptedData</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="../../d0/d84/cmst_8h.html#a0582e84cb49db97b14b87089f2ae407e">00067</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">NSSCMSGenericWrapperDataStr</a> <a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">NSSCMSGenericWrapperData</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="../../d0/d84/cmst_8h.html#ab13812bd262cbd13bea541ed1bb96a83">00069</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttributeStr</a> <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttribute</a>;
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="../../d0/d84/cmst_8h.html#a3f9fd52dbcd5a8ab244b9cfddac72c6b">00071</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>NSSCMSDecoderContextStr <a class="code" href="../../d0/d84/cmst_8h.html#a3f9fd52dbcd5a8ab244b9cfddac72c6b">NSSCMSDecoderContext</a>;
<a name="l00072"></a><a class="code" href="../../d0/d84/cmst_8h.html#a6e3e707908ed2ad2c9a6d9b00960b217">00072</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>NSSCMSEncoderContextStr <a class="code" href="../../d0/d84/cmst_8h.html#a6e3e707908ed2ad2c9a6d9b00960b217">NSSCMSEncoderContext</a>;
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="../../d0/d84/cmst_8h.html#a20ea7ec98c80eea92826c4b0c66fb27c">00074</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>NSSCMSCipherContextStr <a class="code" href="../../d0/d84/cmst_8h.html#a20ea7ec98c80eea92826c4b0c66fb27c">NSSCMSCipherContext</a>;
<a name="l00075"></a><a class="code" href="../../d0/d84/cmst_8h.html#ac4633f3dffe6dc2d9fa6145e5bc3e158">00075</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>NSSCMSDigestContextStr <a class="code" href="../../d0/d84/cmst_8h.html#ac4633f3dffe6dc2d9fa6145e5bc3e158">NSSCMSDigestContext</a>;
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="../../d0/d84/cmst_8h.html#a2d643111fdd8d5c3da82ebfcb77e4cbf">00077</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>NSSCMSContentInfoPrivateStr <a class="code" href="../../d0/d84/cmst_8h.html#a2d643111fdd8d5c3da82ebfcb77e4cbf">NSSCMSContentInfoPrivate</a>;
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="keyword">typedef</span> <a class="code" href="../../dc/d39/seccomon_8h.html#ae72b0946e3dc35a285c0a9f7c33bdab2">SECStatus</a> (*<a class="code" href="../../d0/d84/cmst_8h.html#a218852fefbb624a80638747921e5837d">NSSCMSGenericWrapperDataCallback</a>)
<a name="l00080"></a><a class="code" href="../../d0/d84/cmst_8h.html#a218852fefbb624a80638747921e5837d">00080</a>                         (<a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">NSSCMSGenericWrapperData</a> *);
<a name="l00081"></a>00081 <span class="keyword">typedef</span>   <a class="code" href="../../d4/da9/png_8h.html#ab30926da86712184b070e550789f8bf7">void</a>    (*<a class="code" href="../../d0/d84/cmst_8h.html#ae6cd236f9b0878101fff29d6ebb7c0cf">NSSCMSGenericWrapperDataDestroy</a>) 
<a name="l00082"></a><a class="code" href="../../d0/d84/cmst_8h.html#ae6cd236f9b0878101fff29d6ebb7c0cf">00082</a>                         (<a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">NSSCMSGenericWrapperData</a> *);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="../../dc/ddf/structsec___a_s_n1_template__struct.html">SEC_ASN1Template</a> <a class="code" href="../../d0/d84/cmst_8h.html#a608544d938715f67c7ce05da92d546a9">NSSCMSGenericWrapperDataTemplate</a>[];
<a name="l00085"></a>00085 <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="../../dc/ddf/structsec___a_s_n1_template__struct.html">SEC_ASN1Template</a> <a class="code" href="../../d0/d84/cmst_8h.html#af20a9185499571a79882f71367717918">NSS_PointerToCMSGenericWrapperDataTemplate</a>[];
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <a class="code" href="../../d0/d24/secasn1t_8h.html#a351df71d213df10f80b66c1a0c28f7db">SEC_ASN1_CHOOSER_DECLARE</a>(NSS_PointerToCMSGenericWrapperDataTemplate)
<a name="l00088"></a>00088 <a class="code" href="../../d0/d24/secasn1t_8h.html#a351df71d213df10f80b66c1a0c28f7db">SEC_ASN1_CHOOSER_DECLARE</a>(NSSCMSGenericWrapperDataTemplate)
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="comment">/*</span>
<a name="l00093"></a>00093 <span class="comment"> * Type of function passed to NSSCMSDecode or NSSCMSDecoderStart.</span>
<a name="l00094"></a>00094 <span class="comment"> * If specified, this is where the content bytes (only) will be &quot;sent&quot;</span>
<a name="l00095"></a>00095 <span class="comment"> * as they are recovered during the decoding.</span>
<a name="l00096"></a>00096 <span class="comment"> * And:</span>
<a name="l00097"></a>00097 <span class="comment"> * Type of function passed to NSSCMSEncode or NSSCMSEncoderStart.</span>
<a name="l00098"></a>00098 <span class="comment"> * This is where the DER-encoded bytes will be &quot;sent&quot;.</span>
<a name="l00099"></a>00099 <span class="comment"> *</span>
<a name="l00100"></a>00100 <span class="comment"> * XXX Should just combine this with NSSCMSEncoderContentCallback type</span>
<a name="l00101"></a>00101 <span class="comment"> * and use a simpler, common name.</span>
<a name="l00102"></a>00102 <span class="comment"> */</span>
<a name="l00103"></a><a class="code" href="../../d0/d84/cmst_8h.html#a9152e8a46a51f0a6eff540c5d6cfff7b">00103</a> typedef <span class="keywordtype">void</span> (*<a class="code" href="../../dc/da7/ns_i_c_m_s_decoder_8idl.html#a9152e8a46a51f0a6eff540c5d6cfff7b">NSSCMSContentCallback</a>)(<span class="keywordtype">void</span> *<a class="code" href="../../d2/dbe/jsprf_8h.html#ae036856e415526e58e249638733f6752">arg</a>, <a class="code" href="../../d6/d92/cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <span class="keywordtype">char</span> *<a class="code" href="../../da/d32/prio_8h.html#ac14417684334d01b4e1e807a19d92816">buf</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d9/d04/expat_8h.html#a5df20ff5bc70fb664abe3912796e90df">len</a>);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">/*</span>
<a name="l00106"></a>00106 <span class="comment"> * Type of function passed to NSSCMSDecode or NSSCMSDecoderStart</span>
<a name="l00107"></a>00107 <span class="comment"> * to retrieve the decryption key.  This function is intended to be</span>
<a name="l00108"></a>00108 <span class="comment"> * used for EncryptedData content info&#39;s which do not have a key available</span>
<a name="l00109"></a>00109 <span class="comment"> * in a certificate, etc.</span>
<a name="l00110"></a>00110 <span class="comment"> */</span>
<a name="l00111"></a><a class="code" href="../../d0/d84/cmst_8h.html#aa99e585f6318d654999179c3e49f8a22">00111</a> typedef <a class="code" href="../../d6/dfa/secmodt_8h.html#a3b5d3f869df0d9a37bf99f7cdde966a2">PK11SymKey</a> *(*<a class="code" href="../../d0/d84/cmst_8h.html#aa99e585f6318d654999179c3e49f8a22">NSSCMSGetDecryptKeyCallback</a>)(<span class="keywordtype">void</span> *arg, <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a> *algid);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">/* =============================================================================</span>
<a name="l00115"></a>00115 <span class="comment"> * ENCAPSULATED CONTENTINFO &amp; CONTENTINFO</span>
<a name="l00116"></a>00116 <span class="comment"> */</span>
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html">00118</a> union <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html">NSSCMSContentUnion</a> {
<a name="l00119"></a>00119     <span class="comment">/* either unstructured */</span>
<a name="l00120"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#acd520e7c92c7efc5b4e29ba97d495c41">00120</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *           <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#acd520e7c92c7efc5b4e29ba97d495c41">data</a>;
<a name="l00121"></a>00121     <span class="comment">/* or structured data */</span>
<a name="l00122"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a02bc715b22fd00441fa8634852aeef6e">00122</a>     <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html">NSSCMSDigestedData</a> *    <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a02bc715b22fd00441fa8634852aeef6e">digestedData</a>;
<a name="l00123"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a1822af7a15d9d35a193f8acae9889566">00123</a>     <a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html">NSSCMSEncryptedData</a> *   <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a1822af7a15d9d35a193f8acae9889566">encryptedData</a>;
<a name="l00124"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a58459c18de0554e01b66b08210298a85">00124</a>     <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html">NSSCMSEnvelopedData</a> *   <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a58459c18de0554e01b66b08210298a85">envelopedData</a>;
<a name="l00125"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a84e69fc0753fa241524521604f8992cf">00125</a>     <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html">NSSCMSSignedData</a> *      <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a84e69fc0753fa241524521604f8992cf">signedData</a>;
<a name="l00126"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#ae392f527c03e6364ade15655e911da92">00126</a>     <a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">NSSCMSGenericWrapperData</a> *  <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#ae392f527c03e6364ade15655e911da92">genericData</a>;
<a name="l00127"></a>00127     <span class="comment">/* or anonymous pointer to something */</span>
<a name="l00128"></a><a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a348338f5db4c2cbb102e82b70ec45310">00128</a>     <span class="keywordtype">void</span> *          <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html#a348338f5db4c2cbb102e82b70ec45310">pointer</a>;
<a name="l00129"></a>00129 };
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">00131</a> <span class="keyword">struct </span><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfoStr</a> {
<a name="l00132"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#ae5cc9c8599c7c013bcff7324e04c9f7b">00132</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#ae5cc9c8599c7c013bcff7324e04c9f7b">contentType</a>;
<a name="l00133"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a3ab4d18fbd10251edbe841c72a4a02f9">00133</a>     <a class="code" href="../../d5/d6b/union_n_s_s_c_m_s_content_union.html">NSSCMSContent</a>       <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a3ab4d18fbd10251edbe841c72a4a02f9">content</a>;
<a name="l00134"></a>00134     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00135"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a3ac19e4623df7b7c15ae8242ff9c8269">00135</a>     <a class="code" href="../../db/df2/struct_s_e_c_oid_data_str.html">SECOidData</a> *        <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a3ac19e4623df7b7c15ae8242ff9c8269">contentTypeTag</a>; 
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="comment">/* additional info for encryptedData and envelopedData */</span>
<a name="l00138"></a>00138     <span class="comment">/* we waste this space for signedData and digestedData. sue me. */</span>
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#abe04d63640aacb2137a34108a55303e9">00140</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>      <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#abe04d63640aacb2137a34108a55303e9">contentEncAlg</a>;
<a name="l00141"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#acffccbd5d8e6454be011c4ad9414939f">00141</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *           <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#acffccbd5d8e6454be011c4ad9414939f">rawContent</a>;     <span class="comment">/* encrypted DER, optional */</span>
<a name="l00142"></a>00142                             <span class="comment">/* XXXX bytes not encrypted, but encoded? */</span>
<a name="l00143"></a>00143     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00144"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a8c88c446ed92f1725c6991753539048e">00144</a>     <a class="code" href="../../d6/dfa/secmodt_8h.html#a3b5d3f869df0d9a37bf99f7cdde966a2">PK11SymKey</a> *        <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a8c88c446ed92f1725c6991753539048e">bulkkey</a>;        <span class="comment">/* bulk encryption key */</span>
<a name="l00145"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a47e434724af5b47ad9030dca611ee4e1">00145</a>     <span class="keywordtype">int</span>             <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a47e434724af5b47ad9030dca611ee4e1">keysize</a>;        <span class="comment">/* size of bulk encryption key</span>
<a name="l00146"></a>00146 <span class="comment">                             * (only used by creation code) */</span>
<a name="l00147"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#abc37a746a2188e536287849ec0a4ec41">00147</a>     <a class="code" href="../../de/d47/secoidt_8h.html#a12df3d414e7f1d49862a0ceb68fce9d0">SECOidTag</a>           <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#abc37a746a2188e536287849ec0a4ec41">contentEncAlgTag</a>;   <span class="comment">/* oid tag of encryption algorithm</span>
<a name="l00148"></a>00148 <span class="comment">                             * (only used by creation code) */</span>
<a name="l00149"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a19300eda3551ac44f9dda3ecdeb54f1b">00149</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a2d643111fdd8d5c3da82ebfcb77e4cbf">NSSCMSContentInfoPrivate</a>    *<a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a19300eda3551ac44f9dda3ecdeb54f1b">privateInfo</a>;       <span class="comment">/* place for NSS private info */</span>
<a name="l00150"></a><a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a4daf183413bd633e870bc32ecb390e40">00150</a>     <span class="keywordtype">void</span>        *<a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html#a4daf183413bd633e870bc32ecb390e40">reserved</a>;          <span class="comment">/* keep binary compatibility */</span>
<a name="l00151"></a>00151 };
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">/* =============================================================================</span>
<a name="l00154"></a>00154 <span class="comment"> * MESSAGE</span>
<a name="l00155"></a>00155 <span class="comment"> */</span>
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">00157</a> <span class="keyword">struct </span><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessageStr</a> {
<a name="l00158"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a67370a60c52316a5143f766dcb0e56f5">00158</a>     <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>   <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a67370a60c52316a5143f766dcb0e56f5">contentInfo</a>;        <span class="comment">/* &quot;outer&quot; cinfo */</span>
<a name="l00159"></a>00159     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00160"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#af37ed7d431dae4bf3124fe55fd0432d5">00160</a>     <a class="code" href="../../df/db7/struct_p_l_arena_pool.html">PLArenaPool</a> *   <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#af37ed7d431dae4bf3124fe55fd0432d5">poolp</a>;
<a name="l00161"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a40f4702079621578788cda421c3fe10d">00161</a>     <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>      <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a40f4702079621578788cda421c3fe10d">poolp_is_ours</a>;
<a name="l00162"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#aad234a36a5f98f63e357f8bafd2ea51c">00162</a>     <span class="keywordtype">int</span>         <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#aad234a36a5f98f63e357f8bafd2ea51c">refCount</a>;
<a name="l00163"></a>00163     <span class="comment">/* properties of the &quot;inner&quot; data */</span>
<a name="l00164"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a64b3cfc99c4a1349cb607d67ff6e40a4">00164</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a> **   <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a64b3cfc99c4a1349cb607d67ff6e40a4">detached_digestalgs</a>;
<a name="l00165"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#aa9c617bb3f9d10f1e69f097c9953bcab">00165</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **      <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#aa9c617bb3f9d10f1e69f097c9953bcab">detached_digests</a>;
<a name="l00166"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a106fcf8f9a6ddccf8399731e1b278de5">00166</a>     <span class="keywordtype">void</span> *      <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a106fcf8f9a6ddccf8399731e1b278de5">pwfn_arg</a>;
<a name="l00167"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#ab498f7fd7fb9a7824dcfd763e6be5de2">00167</a>     <a class="code" href="../../d0/d84/cmst_8h.html#aa99e585f6318d654999179c3e49f8a22">NSSCMSGetDecryptKeyCallback</a> <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#ab498f7fd7fb9a7824dcfd763e6be5de2">decrypt_key_cb</a>;
<a name="l00168"></a><a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a4229d46677c130c6f58d3c99bb8865fa">00168</a>     <span class="keywordtype">void</span> *      <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html#a4229d46677c130c6f58d3c99bb8865fa">decrypt_key_cb_arg</a>;
<a name="l00169"></a>00169 };
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">/* ============================================================================</span>
<a name="l00172"></a>00172 <span class="comment"> * GENERIC WRAPPER</span>
<a name="l00173"></a>00173 <span class="comment"> * </span>
<a name="l00174"></a>00174 <span class="comment"> * used for user defined types.</span>
<a name="l00175"></a>00175 <span class="comment"> */</span>
<a name="l00176"></a><a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">00176</a> <span class="keyword">struct </span><a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html">NSSCMSGenericWrapperDataStr</a> {
<a name="l00177"></a><a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html#a683ae392907131c438e2b20ddd622b5b">00177</a>     <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>   <a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html#a683ae392907131c438e2b20ddd622b5b">contentInfo</a>;
<a name="l00178"></a>00178     <span class="comment">/* ---- local; not part of encoding ------ */</span>
<a name="l00179"></a><a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html#a503b2c55bdc9f46eceae4169013bd59d">00179</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> * <a class="code" href="../../d3/dc7/struct_n_s_s_c_m_s_generic_wrapper_data_str.html#a503b2c55bdc9f46eceae4169013bd59d">cmsg</a>;
<a name="l00180"></a>00180     <span class="comment">/* wrapperspecific data starts here */</span>
<a name="l00181"></a>00181 };
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">/* =============================================================================</span>
<a name="l00184"></a>00184 <span class="comment"> * SIGNEDDATA</span>
<a name="l00185"></a>00185 <span class="comment"> */</span>
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html">00187</a> <span class="keyword">struct </span><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html">NSSCMSSignedDataStr</a> {
<a name="l00188"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a6209a3f566d1405bce3db54d5e71ef4f">00188</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a6209a3f566d1405bce3db54d5e71ef4f">version</a>;
<a name="l00189"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a289a2793015fce101d98362b9674049f">00189</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a> **       <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a289a2793015fce101d98362b9674049f">digestAlgorithms</a>;
<a name="l00190"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a6f5216f3024b04ae361821d1f79cf901">00190</a>     <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>       <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a6f5216f3024b04ae361821d1f79cf901">contentInfo</a>;
<a name="l00191"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a5359cca17c7ba4e5139986ab6155c428">00191</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **          <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a5359cca17c7ba4e5139986ab6155c428">rawCerts</a>;
<a name="l00192"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#ae067552dbdf2f84f357d5b0924953a52">00192</a>     <a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a> **        <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#ae067552dbdf2f84f357d5b0924953a52">crls</a>;
<a name="l00193"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#aa441ebe886e93df70a5b4538e21a4d0c">00193</a>     <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html">NSSCMSSignerInfo</a> **     <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#aa441ebe886e93df70a5b4538e21a4d0c">signerInfos</a>;
<a name="l00194"></a>00194     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00195"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a8e80af83e85a9a3ab660e25946720947">00195</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> *     <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a8e80af83e85a9a3ab660e25946720947">cmsg</a>;           <span class="comment">/* back pointer to message */</span>
<a name="l00196"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a080a0fbd782f531f59cc4f7742752e0b">00196</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **          <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a080a0fbd782f531f59cc4f7742752e0b">digests</a>;
<a name="l00197"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a7071a6f49c9e0addc70da5de4e893a6d">00197</a>     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> **      <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a7071a6f49c9e0addc70da5de4e893a6d">certs</a>;
<a name="l00198"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a533fd0170dba8e53714346113c7b4fd1">00198</a>     <a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> **  <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a533fd0170dba8e53714346113c7b4fd1">certLists</a>;
<a name="l00199"></a><a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a5ab5e5d194fa9a90c90a1aaf5f2adbe4">00199</a>     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> **          <a class="code" href="../../d2/d82/struct_n_s_s_c_m_s_signed_data_str.html#a5ab5e5d194fa9a90c90a1aaf5f2adbe4">tempCerts</a>;              <span class="comment">/* temporary certs, needed</span>
<a name="l00200"></a>00200 <span class="comment">                                                         * for example for signature</span>
<a name="l00201"></a>00201 <span class="comment">                                                         * verification */</span>
<a name="l00202"></a>00202 };
<a name="l00203"></a><a class="code" href="../../d0/d84/cmst_8h.html#a85e608286a5cd073ffceee74286770f5">00203</a> <span class="preprocessor">#define NSS_CMS_SIGNED_DATA_VERSION_BASIC   1   </span><span class="comment">/* what we *create* */</span>
<a name="l00204"></a><a class="code" href="../../d0/d84/cmst_8h.html#a02c6026c454c0d7da9f051282da91402">00204</a> <span class="preprocessor">#define NSS_CMS_SIGNED_DATA_VERSION_EXT     3   </span><span class="comment">/* what we *create* */</span>
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30">00206</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00207"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a818560a57d962e74fe7536f8774a0af7">00207</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a818560a57d962e74fe7536f8774a0af7">NSSCMSVS_Unverified</a> = 0,
<a name="l00208"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30abedcf62bc9b67751669943698ccc4784">00208</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30abedcf62bc9b67751669943698ccc4784">NSSCMSVS_GoodSignature</a> = 1,
<a name="l00209"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a09ae997c314705508a2239c04f136c55">00209</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a09ae997c314705508a2239c04f136c55">NSSCMSVS_BadSignature</a> = 2,
<a name="l00210"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a63732090bc6d938d6162496428b901c0">00210</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a63732090bc6d938d6162496428b901c0">NSSCMSVS_DigestMismatch</a> = 3,
<a name="l00211"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a9b3b3f44c6fb72125b4ad165cc9b2718">00211</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a9b3b3f44c6fb72125b4ad165cc9b2718">NSSCMSVS_SigningCertNotFound</a> = 4,
<a name="l00212"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a728145b91256fb3cd1a0b88d061ebc3d">00212</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a728145b91256fb3cd1a0b88d061ebc3d">NSSCMSVS_SigningCertNotTrusted</a> = 5,
<a name="l00213"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30aac42f3e69572e0471346969fb2510a9d">00213</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30aac42f3e69572e0471346969fb2510a9d">NSSCMSVS_SignatureAlgorithmUnknown</a> = 6,
<a name="l00214"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30ae8e3c857d4cc4e6e727140a012461b59">00214</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30ae8e3c857d4cc4e6e727140a012461b59">NSSCMSVS_SignatureAlgorithmUnsupported</a> = 7,
<a name="l00215"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30aab52ed6faaeefc544c72952f739594f5">00215</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30aab52ed6faaeefc544c72952f739594f5">NSSCMSVS_MalformedSignature</a> = 8,
<a name="l00216"></a><a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a5cbd80b8efc41485063b39a6f31479a4">00216</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30a5cbd80b8efc41485063b39a6f31479a4">NSSCMSVS_ProcessingError</a> = 9
<a name="l00217"></a>00217 } <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30">NSSCMSVerificationStatus</a>;
<a name="l00218"></a>00218 
<a name="l00219"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040">00219</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00220"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040a63c318f79705c0a2125e93f2ffb97022">00220</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040a63c318f79705c0a2125e93f2ffb97022">NSSCMSSignerID_IssuerSN</a> = 0,
<a name="l00221"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040a5b14c5be03fd1afd1b4b68035f2c99b5">00221</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040a5b14c5be03fd1afd1b4b68035f2c99b5">NSSCMSSignerID_SubjectKeyID</a> = 1
<a name="l00222"></a>00222 } <a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040">NSSCMSSignerIDSelector</a>;
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html">00224</a> <span class="keyword">struct </span><a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html">NSSCMSSignerIdentifierStr</a> {
<a name="l00225"></a><a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#ab9edbe1df77721f46bba09b5b1fb7cb0">00225</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad8eb38d9ff29f03097bd935796bc8040">NSSCMSSignerIDSelector</a> <a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#ab9edbe1df77721f46bba09b5b1fb7cb0">identifierType</a>;
<a name="l00226"></a>00226     <span class="keyword">union </span>{
<a name="l00227"></a><a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#a41047925dda0a585598068ba9e3e4322">00227</a>     <a class="code" href="../../db/de1/struct_c_e_r_t_issuer_and_s_n_str.html">CERTIssuerAndSN</a> *<a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#a41047925dda0a585598068ba9e3e4322">issuerAndSN</a>;
<a name="l00228"></a><a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#ab4078abfb7e7581a3a4eff87d7d08d2e">00228</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *<a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#ab4078abfb7e7581a3a4eff87d7d08d2e">subjectKeyID</a>;
<a name="l00229"></a>00229     } <a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html#a9f5cbf39de7c4d455aa7a303ed8f8999">id</a>;
<a name="l00230"></a>00230 };
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html">00232</a> <span class="keyword">struct </span><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html">NSSCMSSignerInfoStr</a> {
<a name="l00233"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#ade23b326f207381c49865e9491f98996">00233</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#ade23b326f207381c49865e9491f98996">version</a>;
<a name="l00234"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a1689d5fb3d4b1c57e97d566958571eff">00234</a>     <a class="code" href="../../d3/d3b/struct_n_s_s_c_m_s_signer_identifier_str.html">NSSCMSSignerIdentifier</a>  <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a1689d5fb3d4b1c57e97d566958571eff">signerIdentifier</a>;
<a name="l00235"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#aff76d09c57f87b9564fc8fa8a38b477c">00235</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>      <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#aff76d09c57f87b9564fc8fa8a38b477c">digestAlg</a>;
<a name="l00236"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a36aac95e38896d99fac3378edd566ae0">00236</a>     <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttribute</a> **      <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a36aac95e38896d99fac3378edd566ae0">authAttr</a>;
<a name="l00237"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a20ee6d423e52b65f6e0810ec3de4cc60">00237</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>      <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a20ee6d423e52b65f6e0810ec3de4cc60">digestEncAlg</a>;
<a name="l00238"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a46e3a1d35179add9b6c2b574f646641d">00238</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a46e3a1d35179add9b6c2b574f646641d">encDigest</a>;
<a name="l00239"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a64bee2355569f7cc2935849040bc0032">00239</a>     <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttribute</a> **      <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a64bee2355569f7cc2935849040bc0032">unAuthAttr</a>;
<a name="l00240"></a>00240     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00241"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#aef97272065d7ecf88d6fe36eed72825e">00241</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> *     <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#aef97272065d7ecf88d6fe36eed72825e">cmsg</a>;           <span class="comment">/* back pointer to message */</span>
<a name="l00242"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a2aaefe653822981bfa072030e3f5d5b9">00242</a>     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *       <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a2aaefe653822981bfa072030e3f5d5b9">cert</a>;
<a name="l00243"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a11de81dd6e70b548e817a73a6f527573">00243</a>     <a class="code" href="../../d2/d8f/struct_c_e_r_t_certificate_list_str.html">CERTCertificateList</a> *   <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a11de81dd6e70b548e817a73a6f527573">certList</a>;
<a name="l00244"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a464ef14a6caaf00e5dd66b1465369f41">00244</a>     <a class="code" href="../../db/d12/nsrootidl_8idl.html#a72b6a1b9e3f0db9889388315f0c24ab2">PRTime</a>          <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a464ef14a6caaf00e5dd66b1465369f41">signingTime</a>;
<a name="l00245"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a895f4b335f253e124feabb73bb851778">00245</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a27facf168a065c9553a7d9239bdfaf30">NSSCMSVerificationStatus</a>    <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a895f4b335f253e124feabb73bb851778">verificationStatus</a>;
<a name="l00246"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a7423cca163071245a007def93347eca2">00246</a>     <a class="code" href="../../dd/db7/struct_s_e_c_k_e_y_private_key_str.html">SECKEYPrivateKey</a> *          <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#a7423cca163071245a007def93347eca2">signingKey</a>; <span class="comment">/* Used if we&#39;re using subjKeyID*/</span>
<a name="l00247"></a><a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#ab62b582f7a3c89dfe2fd4b9eacb8bdeb">00247</a>     <a class="code" href="../../d6/d1a/struct_s_e_c_k_e_y_public_key_str.html">SECKEYPublicKey</a> *           <a class="code" href="../../d9/d05/struct_n_s_s_c_m_s_signer_info_str.html#ab62b582f7a3c89dfe2fd4b9eacb8bdeb">pubKey</a>;
<a name="l00248"></a>00248 };
<a name="l00249"></a><a class="code" href="../../d0/d84/cmst_8h.html#a5f5eb6e4af950c0bc3dafb2ccc14f947">00249</a> <span class="preprocessor">#define NSS_CMS_SIGNER_INFO_VERSION_ISSUERSN    1   </span><span class="comment">/* what we *create* */</span>
<a name="l00250"></a><a class="code" href="../../d0/d84/cmst_8h.html#a352be52d72a5e85ac1dd2727b1fc6994">00250</a> <span class="preprocessor">#define NSS_CMS_SIGNER_INFO_VERSION_SUBJKEY 3   </span><span class="comment">/* what we *create* */</span>
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7f">00252</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00253"></a><a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7facbde157c245226a7b82fa841a4021e8d">00253</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7facbde157c245226a7b82fa841a4021e8d">NSSCMSCM_None</a> = 0,
<a name="l00254"></a><a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7fae86610f71c781d834966379d0f05681f">00254</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7fae86610f71c781d834966379d0f05681f">NSSCMSCM_CertOnly</a> = 1,
<a name="l00255"></a><a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7fa816765f7a94579daeea5eee6a6cb7dd2">00255</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7fa816765f7a94579daeea5eee6a6cb7dd2">NSSCMSCM_CertChain</a> = 2,
<a name="l00256"></a><a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7fa2a0dbe2d2eafe5b9ab8ca4064fa9c1b0">00256</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7fa2a0dbe2d2eafe5b9ab8ca4064fa9c1b0">NSSCMSCM_CertChainWithRoot</a> = 3
<a name="l00257"></a>00257 } <a class="code" href="../../d0/d84/cmst_8h.html#a89fd9b07ca5b2d25ab6e53043c3f8f7f">NSSCMSCertChainMode</a>;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="comment">/* =============================================================================</span>
<a name="l00260"></a>00260 <span class="comment"> * ENVELOPED DATA</span>
<a name="l00261"></a>00261 <span class="comment"> */</span>
<a name="l00262"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html">00262</a> <span class="keyword">struct </span><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html">NSSCMSEnvelopedDataStr</a> {
<a name="l00263"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#ad485a04ea385d7b5adfc093eb577fb86">00263</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#ad485a04ea385d7b5adfc093eb577fb86">version</a>;
<a name="l00264"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#aaa6abe720b0b7dfedc86e27e78f98a71">00264</a>     <a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html">NSSCMSOriginatorInfo</a> *  <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#aaa6abe720b0b7dfedc86e27e78f98a71">originatorInfo</a>;     <span class="comment">/* optional */</span>
<a name="l00265"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#a75c94ee8ab7230de165e62f4e760d832">00265</a>     <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html">NSSCMSRecipientInfo</a> **  <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#a75c94ee8ab7230de165e62f4e760d832">recipientInfos</a>;
<a name="l00266"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#ac146ac4cd7fb2bda643482f875d3613f">00266</a>     <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>       <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#ac146ac4cd7fb2bda643482f875d3613f">contentInfo</a>;
<a name="l00267"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#ad1d0c635bf37b97cfe7bd186e3e0bf08">00267</a>     <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttribute</a> **      <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#ad1d0c635bf37b97cfe7bd186e3e0bf08">unprotectedAttr</a>;
<a name="l00268"></a>00268     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00269"></a><a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#a5334e40438393cf3ea640082ec7f2418">00269</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> *     <a class="code" href="../../d3/d41/struct_n_s_s_c_m_s_enveloped_data_str.html#a5334e40438393cf3ea640082ec7f2418">cmsg</a>;           <span class="comment">/* back pointer to message */</span>
<a name="l00270"></a>00270 };
<a name="l00271"></a><a class="code" href="../../d0/d84/cmst_8h.html#aa56097fcfb76ceadceddb1a0a952ffcd">00271</a> <span class="preprocessor">#define NSS_CMS_ENVELOPED_DATA_VERSION_REG  0   </span><span class="comment">/* what we *create* */</span>
<a name="l00272"></a><a class="code" href="../../d0/d84/cmst_8h.html#aef0257e5c97c909aed8ca76e73c173e9">00272</a> <span class="preprocessor">#define NSS_CMS_ENVELOPED_DATA_VERSION_ADV  2   </span><span class="comment">/* what we *create* */</span>
<a name="l00273"></a>00273 
<a name="l00274"></a><a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html">00274</a> <span class="keyword">struct </span><a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html">NSSCMSOriginatorInfoStr</a> {
<a name="l00275"></a><a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html#af71c68f75664cb06cdbe771a7432bdf9">00275</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **          <a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html#af71c68f75664cb06cdbe771a7432bdf9">rawCerts</a>;
<a name="l00276"></a><a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html#aa28a7a25b1d8d2832810a51c73c05edc">00276</a>     <a class="code" href="../../dc/dd0/struct_c_e_r_t_signed_crl_str.html">CERTSignedCrl</a> **        <a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html#aa28a7a25b1d8d2832810a51c73c05edc">crls</a>;
<a name="l00277"></a>00277     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00278"></a><a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html#a262ac1d688e5e3e2262efb7addff9977">00278</a>     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> **      <a class="code" href="../../d8/d4f/struct_n_s_s_c_m_s_originator_info_str.html#a262ac1d688e5e3e2262efb7addff9977">certs</a>;
<a name="l00279"></a>00279 };
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00282"></a>00282 <span class="comment"> * key transport recipient info</span>
<a name="l00283"></a>00283 <span class="comment"> */</span>
<a name="l00284"></a><a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2">00284</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00285"></a><a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2a13833427f58c7fce69b82ac27840daa4">00285</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2a13833427f58c7fce69b82ac27840daa4">NSSCMSRecipientID_IssuerSN</a> = 0,
<a name="l00286"></a><a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2a9392dbf008c767cc36c7138f3d07104f">00286</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2a9392dbf008c767cc36c7138f3d07104f">NSSCMSRecipientID_SubjectKeyID</a> = 1,
<a name="l00287"></a><a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2a3a6987f59317312e6a0ab26d23fabcdc">00287</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2a3a6987f59317312e6a0ab26d23fabcdc">NSSCMSRecipientID_BrandNew</a> = 2
<a name="l00288"></a>00288 } <a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2">NSSCMSRecipientIDSelector</a>;
<a name="l00289"></a>00289 
<a name="l00290"></a><a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html">00290</a> <span class="keyword">struct </span><a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html">NSSCMSRecipientIdentifierStr</a> {
<a name="l00291"></a><a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#a448f7ec7b843df59d6c3c65e7e1df0a6">00291</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a371402837dd67c7ab9c89ea2011008d2">NSSCMSRecipientIDSelector</a>   <a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#a448f7ec7b843df59d6c3c65e7e1df0a6">identifierType</a>;
<a name="l00292"></a>00292     <span class="keyword">union </span>{
<a name="l00293"></a><a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#ac0c45f43b63849dfd243f76ddbfcec0c">00293</a>     <a class="code" href="../../db/de1/struct_c_e_r_t_issuer_and_s_n_str.html">CERTIssuerAndSN</a>     *<a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#ac0c45f43b63849dfd243f76ddbfcec0c">issuerAndSN</a>;
<a name="l00294"></a><a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#aa0551ea8e46f32ab05976f4e1293d101">00294</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         *<a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#aa0551ea8e46f32ab05976f4e1293d101">subjectKeyID</a>;
<a name="l00295"></a>00295     } <a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html#a4572327e846655a19c99765bd2b1a424">id</a>;
<a name="l00296"></a>00296 };
<a name="l00297"></a><a class="code" href="../../d0/d84/cmst_8h.html#a63f8050ea7fdeef350c4350825ff5c45">00297</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html">NSSCMSRecipientIdentifierStr</a> <a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html">NSSCMSRecipientIdentifier</a>;
<a name="l00298"></a>00298 
<a name="l00299"></a><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html">00299</a> <span class="keyword">struct </span><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html">NSSCMSKeyTransRecipientInfoStr</a> {
<a name="l00300"></a><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#af69aff1bab6906ff8a3f8aa5df94012f">00300</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#af69aff1bab6906ff8a3f8aa5df94012f">version</a>;
<a name="l00301"></a><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#a678e58e16c91b3552cceed0443e93a84">00301</a>     <a class="code" href="../../d3/d4b/struct_n_s_s_c_m_s_recipient_identifier_str.html">NSSCMSRecipientIdentifier</a>   <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#a678e58e16c91b3552cceed0443e93a84">recipientIdentifier</a>;
<a name="l00302"></a><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#a8408a91728bf0b03e8789cfa408419ed">00302</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>      <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#a8408a91728bf0b03e8789cfa408419ed">keyEncAlg</a>;
<a name="l00303"></a><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#ac0007212ca75c2abb412bd5f4c25849b">00303</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html#ac0007212ca75c2abb412bd5f4c25849b">encKey</a>;
<a name="l00304"></a>00304 };
<a name="l00305"></a><a class="code" href="../../d0/d84/cmst_8h.html#a153739b242d727b25199370798d0ed67">00305</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html">NSSCMSKeyTransRecipientInfoStr</a> <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html">NSSCMSKeyTransRecipientInfo</a>;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="comment">/*</span>
<a name="l00308"></a>00308 <span class="comment"> * View comments before NSSCMSRecipientInfoStr for purpose of this</span>
<a name="l00309"></a>00309 <span class="comment"> * structure.</span>
<a name="l00310"></a>00310 <span class="comment"> */</span>
<a name="l00311"></a><a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html">00311</a> <span class="keyword">struct </span><a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html">NSSCMSKeyTransRecipientInfoExStr</a> {
<a name="l00312"></a><a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html#aa0ec57dcbea5646bf16db7b19237e05e">00312</a>     <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html">NSSCMSKeyTransRecipientInfo</a> <a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html#aa0ec57dcbea5646bf16db7b19237e05e">recipientInfo</a>;
<a name="l00313"></a><a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html#af157e9c7ef9e18fdac6f2a6f2759df95">00313</a>     <span class="keywordtype">int</span> <a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html#af157e9c7ef9e18fdac6f2a6f2759df95">version</a>;  <span class="comment">/* version of this structure (0) */</span>
<a name="l00314"></a><a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html#ae980c0cc19cd04770a7cfcfcff838d8e">00314</a>     <a class="code" href="../../d6/d1a/struct_s_e_c_k_e_y_public_key_str.html">SECKEYPublicKey</a> *<a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html#ae980c0cc19cd04770a7cfcfcff838d8e">pubKey</a>;
<a name="l00315"></a>00315 };
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="../../d0/d84/cmst_8h.html#a0332ee6501cb4edae682e84e1cf85a65">00317</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html">NSSCMSKeyTransRecipientInfoExStr</a> <a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html">NSSCMSKeyTransRecipientInfoEx</a>;
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="../../d0/d84/cmst_8h.html#a37eb1fd25acf249d138fc86ba7445342">00319</a> <span class="preprocessor">#define NSS_CMS_KEYTRANS_RECIPIENT_INFO_VERSION_ISSUERSN    0   </span><span class="comment">/* what we *create* */</span>
<a name="l00320"></a><a class="code" href="../../d0/d84/cmst_8h.html#a155c2ae28fffc39994a3ff1b4baea9d7">00320</a> <span class="preprocessor">#define NSS_CMS_KEYTRANS_RECIPIENT_INFO_VERSION_SUBJKEY     2   </span><span class="comment">/* what we *create* */</span>
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00323"></a>00323 <span class="comment"> * key agreement recipient info</span>
<a name="l00324"></a>00324 <span class="comment"> */</span>
<a name="l00325"></a><a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html">00325</a> <span class="keyword">struct </span><a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html">NSSCMSOriginatorPublicKeyStr</a> {
<a name="l00326"></a><a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html#ac11e6d8f4c6b8d1b5e58c3d8803ec1a8">00326</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>          <a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html#ac11e6d8f4c6b8d1b5e58c3d8803ec1a8">algorithmIdentifier</a>;
<a name="l00327"></a><a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html#aa27b8ad6e36ffa3e2803c23120195cd3">00327</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>             <a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html#aa27b8ad6e36ffa3e2803c23120195cd3">publicKey</a>;          <span class="comment">/* bit string! */</span>
<a name="l00328"></a>00328 };
<a name="l00329"></a><a class="code" href="../../d0/d84/cmst_8h.html#a8797c79f9427220015a48d6a981ca6ef">00329</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html">NSSCMSOriginatorPublicKeyStr</a> <a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html">NSSCMSOriginatorPublicKey</a>;
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890">00331</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00332"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890a5572d8592d6cf662ef95db859991077f">00332</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890a5572d8592d6cf662ef95db859991077f">NSSCMSOriginatorIDOrKey_IssuerSN</a> = 0,
<a name="l00333"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890a83d2524d8a71ed8575b289ae430a638b">00333</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890a83d2524d8a71ed8575b289ae430a638b">NSSCMSOriginatorIDOrKey_SubjectKeyID</a> = 1,
<a name="l00334"></a><a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890a7c32390774ecf2cbf1630504762de7a0">00334</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890a7c32390774ecf2cbf1630504762de7a0">NSSCMSOriginatorIDOrKey_OriginatorPublicKey</a> = 2
<a name="l00335"></a>00335 } <a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890">NSSCMSOriginatorIDOrKeySelector</a>;
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html">00337</a> <span class="keyword">struct </span><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html">NSSCMSOriginatorIdentifierOrKeyStr</a> {
<a name="l00338"></a><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#a805b8150fd9a58a1fd24ca0554e1446b">00338</a>     <a class="code" href="../../d0/d84/cmst_8h.html#ad692a3c6cfb434958e0a5755c15d5890">NSSCMSOriginatorIDOrKeySelector</a> <a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#a805b8150fd9a58a1fd24ca0554e1446b">identifierType</a>;
<a name="l00339"></a>00339     <span class="keyword">union </span>{
<a name="l00340"></a><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#aad11386b781acce522ba24ee456d18d4">00340</a>     <a class="code" href="../../db/de1/struct_c_e_r_t_issuer_and_s_n_str.html">CERTIssuerAndSN</a>         *<a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#aad11386b781acce522ba24ee456d18d4">issuerAndSN</a>;       <span class="comment">/* static-static */</span>
<a name="l00341"></a><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#aa7d11debd2f735c69299d4314cadfd1f">00341</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>             *<a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#aa7d11debd2f735c69299d4314cadfd1f">subjectKeyID</a>;      <span class="comment">/* static-static */</span>
<a name="l00342"></a><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#ac818e91a0bb4dfa8111bb0193727c6f9">00342</a>     <a class="code" href="../../d4/d55/struct_n_s_s_c_m_s_originator_public_key_str.html">NSSCMSOriginatorPublicKey</a>   <a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#ac818e91a0bb4dfa8111bb0193727c6f9">originatorPublicKey</a>;    <span class="comment">/* ephemeral-static */</span>
<a name="l00343"></a>00343     } <a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html#a318d88a8f95938e025fcb65a31eb8453">id</a>;
<a name="l00344"></a>00344 };
<a name="l00345"></a><a class="code" href="../../d0/d84/cmst_8h.html#a826a8fbbf0a6489edf3248744ce951fe">00345</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html">NSSCMSOriginatorIdentifierOrKeyStr</a> <a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html">NSSCMSOriginatorIdentifierOrKey</a>;
<a name="l00346"></a>00346 
<a name="l00347"></a><a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html">00347</a> <span class="keyword">struct </span><a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html">NSSCMSRecipientKeyIdentifierStr</a> {
<a name="l00348"></a><a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html#aa3ee80fbf019c7e15760736f1954bcb6">00348</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *               <a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html#aa3ee80fbf019c7e15760736f1954bcb6">subjectKeyIdentifier</a>;
<a name="l00349"></a><a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html#af7a28d98ccf6adb8b76e602d06d60c79">00349</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *               <a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html#af7a28d98ccf6adb8b76e602d06d60c79">date</a>;           <span class="comment">/* optional */</span>
<a name="l00350"></a><a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html#a69637de6cb7696ce10102f44fa2bab97">00350</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *               <a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html#a69637de6cb7696ce10102f44fa2bab97">other</a>;          <span class="comment">/* optional */</span>
<a name="l00351"></a>00351 };
<a name="l00352"></a><a class="code" href="../../d0/d84/cmst_8h.html#a41281c4ce3d7c995b2a7c78910183c53">00352</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html">NSSCMSRecipientKeyIdentifierStr</a> <a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html">NSSCMSRecipientKeyIdentifier</a>;
<a name="l00353"></a>00353 
<a name="l00354"></a><a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0">00354</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00355"></a><a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0a21248a4b1f40d7391f5bd2ba790faece">00355</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0a21248a4b1f40d7391f5bd2ba790faece">NSSCMSKeyAgreeRecipientID_IssuerSN</a> = 0,
<a name="l00356"></a><a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0a6ef2100595c66f10dcebd6f0d7ba9c7f">00356</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0a6ef2100595c66f10dcebd6f0d7ba9c7f">NSSCMSKeyAgreeRecipientID_RKeyID</a> = 1
<a name="l00357"></a>00357 } <a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0">NSSCMSKeyAgreeRecipientIDSelector</a>;
<a name="l00358"></a>00358 
<a name="l00359"></a><a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html">00359</a> <span class="keyword">struct </span><a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html">NSSCMSKeyAgreeRecipientIdentifierStr</a> {
<a name="l00360"></a><a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#a67e9c7975896a3668427d8f73c450d49">00360</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a346fbc7c9f58abc31e47d9820299e4d0">NSSCMSKeyAgreeRecipientIDSelector</a>   <a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#a67e9c7975896a3668427d8f73c450d49">identifierType</a>;
<a name="l00361"></a>00361     <span class="keyword">union </span>{
<a name="l00362"></a><a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#ae0699652381b9c47f7e0cd062f9bdad9">00362</a>     <a class="code" href="../../db/de1/struct_c_e_r_t_issuer_and_s_n_str.html">CERTIssuerAndSN</a>         *<a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#ae0699652381b9c47f7e0cd062f9bdad9">issuerAndSN</a>;
<a name="l00363"></a><a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#a6802ca3293c1d727ae6eecc41ff4b950">00363</a>     <a class="code" href="../../d7/d5d/struct_n_s_s_c_m_s_recipient_key_identifier_str.html">NSSCMSRecipientKeyIdentifier</a>    <a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#a6802ca3293c1d727ae6eecc41ff4b950">recipientKeyIdentifier</a>;
<a name="l00364"></a>00364     } <a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html#a29e0641f9f3e99930f27e6c7e348701b">id</a>;
<a name="l00365"></a>00365 };
<a name="l00366"></a><a class="code" href="../../d0/d84/cmst_8h.html#ab3cab9112fd52eb7350ebe02998eef7b">00366</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html">NSSCMSKeyAgreeRecipientIdentifierStr</a> <a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html">NSSCMSKeyAgreeRecipientIdentifier</a>;
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html">00368</a> <span class="keyword">struct </span><a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html">NSSCMSRecipientEncryptedKeyStr</a> {
<a name="l00369"></a><a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html#aeb2da7ef0e9169fd637ca369e4177caf">00369</a>     <a class="code" href="../../df/d3c/struct_n_s_s_c_m_s_key_agree_recipient_identifier_str.html">NSSCMSKeyAgreeRecipientIdentifier</a>   <a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html#aeb2da7ef0e9169fd637ca369e4177caf">recipientIdentifier</a>;
<a name="l00370"></a><a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html#a115156a72987054e79a5d69ef98c07c6">00370</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>             <a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html#a115156a72987054e79a5d69ef98c07c6">encKey</a>;
<a name="l00371"></a>00371 };
<a name="l00372"></a><a class="code" href="../../d0/d84/cmst_8h.html#abfe61389bd7c440c13bb3f61aac9a036">00372</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html">NSSCMSRecipientEncryptedKeyStr</a> <a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html">NSSCMSRecipientEncryptedKey</a>;
<a name="l00373"></a>00373 
<a name="l00374"></a><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html">00374</a> <span class="keyword">struct </span><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html">NSSCMSKeyAgreeRecipientInfoStr</a> {
<a name="l00375"></a><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#a8ef3df27e89a22e65298605b4a89911f">00375</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>             <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#a8ef3df27e89a22e65298605b4a89911f">version</a>;
<a name="l00376"></a><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#aeb114f42ef5ca55e337105a0da540324">00376</a>     <a class="code" href="../../d7/d7a/struct_n_s_s_c_m_s_originator_identifier_or_key_str.html">NSSCMSOriginatorIdentifierOrKey</a> <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#aeb114f42ef5ca55e337105a0da540324">originatorIdentifierOrKey</a>;
<a name="l00377"></a><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#a4195049ee5fd419184c0c2eb21f18caa">00377</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *               <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#a4195049ee5fd419184c0c2eb21f18caa">ukm</a>;                <span class="comment">/* optional */</span>
<a name="l00378"></a><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#ac8512a9a11be77489676254072d50a7e">00378</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>          <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#ac8512a9a11be77489676254072d50a7e">keyEncAlg</a>;
<a name="l00379"></a><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#a448713b370d002f90c50215859a25197">00379</a>     <a class="code" href="../../d6/d67/struct_n_s_s_c_m_s_recipient_encrypted_key_str.html">NSSCMSRecipientEncryptedKey</a> **  <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html#a448713b370d002f90c50215859a25197">recipientEncryptedKeys</a>;
<a name="l00380"></a>00380 };
<a name="l00381"></a><a class="code" href="../../d0/d84/cmst_8h.html#a2e22b7d93baf131fbc7ec29b2b8710d3">00381</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html">NSSCMSKeyAgreeRecipientInfoStr</a> <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html">NSSCMSKeyAgreeRecipientInfo</a>;
<a name="l00382"></a>00382 
<a name="l00383"></a><a class="code" href="../../d0/d84/cmst_8h.html#a3bf313e2029c06fa218f5cafe4467d01">00383</a> <span class="preprocessor">#define NSS_CMS_KEYAGREE_RECIPIENT_INFO_VERSION 3   </span><span class="comment">/* what we *create* */</span>
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00386"></a>00386 <span class="comment"> * KEK recipient info</span>
<a name="l00387"></a>00387 <span class="comment"> */</span>
<a name="l00388"></a><a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html">00388</a> <span class="keyword">struct </span><a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html">NSSCMSKEKIdentifierStr</a> {
<a name="l00389"></a><a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html#aca0600c5895f29a73751c514198feb5d">00389</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html#aca0600c5895f29a73751c514198feb5d">keyIdentifier</a>;
<a name="l00390"></a><a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html#afdd6ee6b5add4b85a2a1f1d4ae386671">00390</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *           <a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html#afdd6ee6b5add4b85a2a1f1d4ae386671">date</a>;           <span class="comment">/* optional */</span>
<a name="l00391"></a><a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html#a4959f90307302806fbe8413d0cb1e281">00391</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> *           <a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html#a4959f90307302806fbe8413d0cb1e281">other</a>;          <span class="comment">/* optional */</span>
<a name="l00392"></a>00392 };
<a name="l00393"></a><a class="code" href="../../d0/d84/cmst_8h.html#a74bf16d2fa08a7c23da436ae5cf4e96d">00393</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html">NSSCMSKEKIdentifierStr</a> <a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html">NSSCMSKEKIdentifier</a>;
<a name="l00394"></a>00394 
<a name="l00395"></a><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html">00395</a> <span class="keyword">struct </span><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html">NSSCMSKEKRecipientInfoStr</a> {
<a name="l00396"></a><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#a192c7103f748e01d644241a5fc56f52e">00396</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#a192c7103f748e01d644241a5fc56f52e">version</a>;
<a name="l00397"></a><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#ae70b7833243d5256232baf5384411f7d">00397</a>     <a class="code" href="../../d8/de9/struct_n_s_s_c_m_s_k_e_k_identifier_str.html">NSSCMSKEKIdentifier</a>     <a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#ae70b7833243d5256232baf5384411f7d">kekIdentifier</a>;
<a name="l00398"></a><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#a8e4f437b3e9a6f5e806af10bfa4a3ed2">00398</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>      <a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#a8e4f437b3e9a6f5e806af10bfa4a3ed2">keyEncAlg</a>;
<a name="l00399"></a><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#a61531568606eb2e79384b54ada574ef1">00399</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html#a61531568606eb2e79384b54ada574ef1">encKey</a>;
<a name="l00400"></a>00400 };
<a name="l00401"></a><a class="code" href="../../d0/d84/cmst_8h.html#ae490fd49d9527644d3b4493fc372e39b">00401</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html">NSSCMSKEKRecipientInfoStr</a> <a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html">NSSCMSKEKRecipientInfo</a>;
<a name="l00402"></a>00402 
<a name="l00403"></a><a class="code" href="../../d0/d84/cmst_8h.html#a05fa34d0d294cc4b08a531800f02b105">00403</a> <span class="preprocessor">#define NSS_CMS_KEK_RECIPIENT_INFO_VERSION  4   </span><span class="comment">/* what we *create* */</span>
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00406"></a>00406 <span class="comment"> * recipient info</span>
<a name="l00407"></a>00407 <span class="comment"> */</span>
<a name="l00408"></a>00408 
<a name="l00409"></a><a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2">00409</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00410"></a><a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2a45b474dd1e2f992e09bac4dd8b160239">00410</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2a45b474dd1e2f992e09bac4dd8b160239">NSSCMSRecipientInfoID_KeyTrans</a> = 0,
<a name="l00411"></a><a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2ab4febd93f56d300e0e6a1de507bc9fb6">00411</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2ab4febd93f56d300e0e6a1de507bc9fb6">NSSCMSRecipientInfoID_KeyAgree</a> = 1,
<a name="l00412"></a><a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2a03b9ffb3c47707094f7a6ce35186b63e">00412</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2a03b9ffb3c47707094f7a6ce35186b63e">NSSCMSRecipientInfoID_KEK</a> = 2
<a name="l00413"></a>00413 } <a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2">NSSCMSRecipientInfoIDSelector</a>;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="comment">/*</span>
<a name="l00416"></a>00416 <span class="comment"> * In order to preserve backwards binary compatibility when implementing</span>
<a name="l00417"></a>00417 <span class="comment"> * creation of Recipient Info&#39;s that uses subjectKeyID in the </span>
<a name="l00418"></a>00418 <span class="comment"> * keyTransRecipientInfo we need to stash a public key pointer in this</span>
<a name="l00419"></a>00419 <span class="comment"> * structure somewhere.  We figured out that NSSCMSKeyTransRecipientInfo</span>
<a name="l00420"></a>00420 <span class="comment"> * is the smallest member of the ri union.  We&#39;re in luck since that&#39;s</span>
<a name="l00421"></a>00421 <span class="comment"> * the very structure that would need to use the public key. So we created</span>
<a name="l00422"></a>00422 <span class="comment"> * a new structure NSSCMSKeyTransRecipientInfoEx which has a member </span>
<a name="l00423"></a>00423 <span class="comment"> * NSSCMSKeyTransRecipientInfo as the first member followed by a version</span>
<a name="l00424"></a>00424 <span class="comment"> * and a public key pointer.  This way we can keep backwards compatibility</span>
<a name="l00425"></a>00425 <span class="comment"> * without changing the size of this structure.</span>
<a name="l00426"></a>00426 <span class="comment"> *</span>
<a name="l00427"></a>00427 <span class="comment"> * BTW, size of structure:</span>
<a name="l00428"></a>00428 <span class="comment"> * NSSCMSKeyTransRecipientInfo:  9 ints, 4 pointers</span>
<a name="l00429"></a>00429 <span class="comment"> * NSSCMSKeyAgreeRecipientInfo: 12 ints, 8 pointers</span>
<a name="l00430"></a>00430 <span class="comment"> * NSSCMSKEKRecipientInfo:      10 ints, 7 pointers</span>
<a name="l00431"></a>00431 <span class="comment"> *</span>
<a name="l00432"></a>00432 <span class="comment"> * The new structure:</span>
<a name="l00433"></a>00433 <span class="comment"> * NSSCMSKeyTransRecipientInfoEx: sizeof(NSSCMSKeyTransRecipientInfo) +</span>
<a name="l00434"></a>00434 <span class="comment"> *                                1 int, 1 pointer</span>
<a name="l00435"></a>00435 <span class="comment"> */</span>
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html">00437</a> <span class="keyword">struct </span><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html">NSSCMSRecipientInfoStr</a> {
<a name="l00438"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a1a22383f9bd7e0c11a172c4bacc0d502">00438</a>     <a class="code" href="../../d0/d84/cmst_8h.html#a85294eee746317a7aa0d354f74c5f2a2">NSSCMSRecipientInfoIDSelector</a> <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a1a22383f9bd7e0c11a172c4bacc0d502">recipientInfoType</a>;
<a name="l00439"></a>00439     <span class="keyword">union </span>{
<a name="l00440"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#acb3e2377735c908c300e90b75521eb14">00440</a>     <a class="code" href="../../d0/ddb/struct_n_s_s_c_m_s_key_trans_recipient_info_str.html">NSSCMSKeyTransRecipientInfo</a> <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#acb3e2377735c908c300e90b75521eb14">keyTransRecipientInfo</a>;
<a name="l00441"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a9ab84a6fc90156b43993df1d3eb8e9c0">00441</a>     <a class="code" href="../../d2/db8/struct_n_s_s_c_m_s_key_agree_recipient_info_str.html">NSSCMSKeyAgreeRecipientInfo</a> <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a9ab84a6fc90156b43993df1d3eb8e9c0">keyAgreeRecipientInfo</a>;
<a name="l00442"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a135ad810a50520fdb54a775656a70c47">00442</a>     <a class="code" href="../../de/d61/struct_n_s_s_c_m_s_k_e_k_recipient_info_str.html">NSSCMSKEKRecipientInfo</a> <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a135ad810a50520fdb54a775656a70c47">kekRecipientInfo</a>;
<a name="l00443"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a85fb5fe78570e4e6011c5f725cd95670">00443</a>     <a class="code" href="../../db/d8b/struct_n_s_s_c_m_s_key_trans_recipient_info_ex_str.html">NSSCMSKeyTransRecipientInfoEx</a> <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a85fb5fe78570e4e6011c5f725cd95670">keyTransRecipientInfoEx</a>;
<a name="l00444"></a>00444     } <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a680c131c1b503cca664201637c85e528">ri</a>;
<a name="l00445"></a>00445     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00446"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a815ad0d44dacdd9da1a1dd201fb7ff61">00446</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> *     <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a815ad0d44dacdd9da1a1dd201fb7ff61">cmsg</a>;           <span class="comment">/* back pointer to message */</span>
<a name="l00447"></a><a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a02dca05e709db1ed89d746a0822070fd">00447</a>     <a class="code" href="../../d8/d93/struct_c_e_r_t_certificate_str.html">CERTCertificate</a> *       <a class="code" href="../../de/de2/struct_n_s_s_c_m_s_recipient_info_str.html#a02dca05e709db1ed89d746a0822070fd">cert</a>;           <span class="comment">/* recipient&#39;s certificate */</span>
<a name="l00448"></a>00448 };
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 <span class="comment">/* =============================================================================</span>
<a name="l00451"></a>00451 <span class="comment"> * DIGESTED DATA</span>
<a name="l00452"></a>00452 <span class="comment"> */</span>
<a name="l00453"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html">00453</a> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html">NSSCMSDigestedDataStr</a> {
<a name="l00454"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a919c4a8fd1c6e573f767d80b3eecb1a6">00454</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a919c4a8fd1c6e573f767d80b3eecb1a6">version</a>;
<a name="l00455"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a2ccd4368554bf2187300a109ffcf2ae2">00455</a>     <a class="code" href="../../d9/dc8/struct_s_e_c_algorithm_i_d_str.html">SECAlgorithmID</a>      <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a2ccd4368554bf2187300a109ffcf2ae2">digestAlg</a>;
<a name="l00456"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a46e69ca391b14e8af3a19a85ab3c06c4">00456</a>     <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>       <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a46e69ca391b14e8af3a19a85ab3c06c4">contentInfo</a>;
<a name="l00457"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#aff9817ae51bcdb268502b2049295c0f6">00457</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#aff9817ae51bcdb268502b2049295c0f6">digest</a>;
<a name="l00458"></a>00458     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00459"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a7806b0299008310d87826c984f58b099">00459</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> *     <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a7806b0299008310d87826c984f58b099">cmsg</a>;       <span class="comment">/* back pointer */</span>
<a name="l00460"></a><a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a5b90fcb6474c13a392d38f96223432a8">00460</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d0/d6c/struct_n_s_s_c_m_s_digested_data_str.html#a5b90fcb6474c13a392d38f96223432a8">cdigest</a>;    <span class="comment">/* calculated digest */</span>
<a name="l00461"></a>00461 };
<a name="l00462"></a><a class="code" href="../../d0/d84/cmst_8h.html#ab0f0b690a95cf1eeb3de52e292df3b51">00462</a> <span class="preprocessor">#define NSS_CMS_DIGESTED_DATA_VERSION_DATA  0   </span><span class="comment">/* what we *create* */</span>
<a name="l00463"></a><a class="code" href="../../d0/d84/cmst_8h.html#a0d5d74c9d41d9849cf0f0df6b46b0e75">00463</a> <span class="preprocessor">#define NSS_CMS_DIGESTED_DATA_VERSION_ENCAP 2   </span><span class="comment">/* what we *create* */</span>
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="comment">/* =============================================================================</span>
<a name="l00466"></a>00466 <span class="comment"> * ENCRYPTED DATA</span>
<a name="l00467"></a>00467 <span class="comment"> */</span>
<a name="l00468"></a><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html">00468</a> <span class="keyword">struct </span><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html">NSSCMSEncryptedDataStr</a> {
<a name="l00469"></a><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#ade9301d891b9bf85351880d76ada36a8">00469</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#ade9301d891b9bf85351880d76ada36a8">version</a>;
<a name="l00470"></a><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#a202d26f8eb9ed3102c254395c7ec58d0">00470</a>     <a class="code" href="../../dd/d2d/struct_n_s_s_c_m_s_content_info_str.html">NSSCMSContentInfo</a>       <a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#a202d26f8eb9ed3102c254395c7ec58d0">contentInfo</a>;
<a name="l00471"></a><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#ab26a9e4cd098f24ca2aef2fd6fe05be8">00471</a>     <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttribute</a> **      <a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#ab26a9e4cd098f24ca2aef2fd6fe05be8">unprotectedAttr</a>;    <span class="comment">/* optional */</span>
<a name="l00472"></a>00472     <span class="comment">/* --------- local; not part of encoding --------- */</span>
<a name="l00473"></a><a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#aa679e06297a11163ec031d06b3ac12b7">00473</a>     <a class="code" href="../../df/d10/struct_n_s_s_c_m_s_message_str.html">NSSCMSMessage</a> *     <a class="code" href="../../d2/dc9/struct_n_s_s_c_m_s_encrypted_data_str.html#aa679e06297a11163ec031d06b3ac12b7">cmsg</a>;       <span class="comment">/* back pointer */</span>
<a name="l00474"></a>00474 };
<a name="l00475"></a><a class="code" href="../../d0/d84/cmst_8h.html#aad721ffaea69786008e07c775361ca55">00475</a> <span class="preprocessor">#define NSS_CMS_ENCRYPTED_DATA_VERSION      0   </span><span class="comment">/* what we *create* */</span>
<a name="l00476"></a><a class="code" href="../../d0/d84/cmst_8h.html#a461adbbf6998b9a4354ca75040350d77">00476</a> <span class="preprocessor">#define NSS_CMS_ENCRYPTED_DATA_VERSION_UPATTR   2   </span><span class="comment">/* what we *create* */</span>
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 <span class="comment">/*</span>
<a name="l00479"></a>00479 <span class="comment"> * *****************************************************************************</span>
<a name="l00480"></a>00480 <span class="comment"> * *****************************************************************************</span>
<a name="l00481"></a>00481 <span class="comment"> * *****************************************************************************</span>
<a name="l00482"></a>00482 <span class="comment"> */</span>
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 <span class="comment">/*</span>
<a name="l00485"></a>00485 <span class="comment"> * See comment above about this type not really belonging to CMS.</span>
<a name="l00486"></a>00486 <span class="comment"> */</span>
<a name="l00487"></a><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">00487</a> <span class="keyword">struct </span><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html">NSSCMSAttributeStr</a> {
<a name="l00488"></a>00488     <span class="comment">/* The following fields make up an encoded Attribute: */</span>
<a name="l00489"></a><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#a54199018faa36231dcbd98c53080a076">00489</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a>         <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#a54199018faa36231dcbd98c53080a076">type</a>;
<a name="l00490"></a><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#aacfe6a909a40a610489b040c6ad3f71b">00490</a>     <a class="code" href="../../d2/d86/struct_s_e_c_item_str.html">SECItem</a> **          <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#aacfe6a909a40a610489b040c6ad3f71b">values</a>; <span class="comment">/* data may or may not be encoded */</span>
<a name="l00491"></a>00491     <span class="comment">/* The following fields are not part of an encoded Attribute: */</span>
<a name="l00492"></a><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#a6a1fe30f6d4e999839f5d19558d33fe3">00492</a>     <a class="code" href="../../db/df2/struct_s_e_c_oid_data_str.html">SECOidData</a> *        <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#a6a1fe30f6d4e999839f5d19558d33fe3">typeTag</a>;
<a name="l00493"></a><a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#acecfa214c9badb6b9b28b910a99fb566">00493</a>     <a class="code" href="../../dc/d23/prtypes_8h.html#aa38ce1156b728d85df094a363f09a7b7">PRBool</a>          <a class="code" href="../../dd/d35/struct_n_s_s_c_m_s_attribute_str.html#acecfa214c9badb6b9b28b910a99fb566">encoded</a>;    <span class="comment">/* when true, values are encoded */</span>
<a name="l00494"></a>00494 };
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 <span class="preprocessor">#endif </span><span class="comment">/* _CMST_H_ */</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>データ構造</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d0/d84/cmst_8h.html">cmst.h</a>      </li>

    <li class="footer">FxOS Code Readingに対してSat Oct 19 2013 00:51:43に生成されました。
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
